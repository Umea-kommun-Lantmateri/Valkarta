!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ol=t():n.ol=t()}(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=7)}([function(n){n.exports=function(){"use strict";function l(n,t,i,u,f){!function n(t,i,u,f,e){for(;f>u;){if(f-u>600){var s=f-u+1,a=i-u+1,v=Math.log(s),c=.5*Math.exp(2*v/3),y=.5*Math.sqrt(v*c*(s-c)/s)*(a-s/2<0?-1:1);n(t,i,Math.max(u,Math.floor(i-a*c/s+y)),Math.min(f,Math.floor(i+(s-a)*c/s+y)),e)}var l=t[i],h=u,o=f;for(r(t,u,i),e(t[f],l)>0&&r(t,u,f);h<o;){for(r(t,h,o),h++,o--;e(t[h],l)<0;)h++;for(;e(t[o],l)>0;)o--}0===e(t[u],l)?r(t,u,o):r(t,++o,f);o<=i&&(u=o+1);i<=o&&(f=o-1)}}(n,t,i||0,u||n.length-1,f||a)}function r(n,t,i){var r=n[t];n[t]=n[i];n[i]=r}function a(n,t){return n<t?-1:n>t?1:0}function v(n,t,i){if(!i)return t.indexOf(n);for(var r=0;r<t.length;r++)if(i(n,t[r]))return r;return-1}function t(n,t){u(n,0,n.children.length,t,n)}function u(n,t,r,u,e){var o,s;for(e||(e=i(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0,o=t;o<r;o++)s=n.children[o],f(e,n.leaf?u(s):s);return e}function f(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function y(n,t){return n.minX-t.minX}function p(n,t){return n.minY-t.minY}function s(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function e(n){return n.maxX-n.minX+(n.maxY-n.minY)}function h(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function o(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function i(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function c(n,t,i,r,u){for(var e,f=[t,i];f.length;)(i=f.pop())-(t=f.pop())<=r||(e=t+Math.ceil((i-t)/r/2)*r,l(n,e,t,i,u),f.push(t,e,e,i))}var n=function(n){void 0===n&&(n=9);this._maxEntries=Math.max(4,n);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));this.clear()};return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(n){var t=this.data,r=[],s,f,u,i,e;if(!o(n,t))return r;for(s=this.toBBox,f=[];t;){for(u=0;u<t.children.length;u++)i=t.children[u],e=t.leaf?s(i):i,o(n,e)&&(t.leaf?r.push(i):h(n,e)?this._all(i,r):f.push(i));t=f.pop()}return r},n.prototype.collides=function(n){var t=this.data,u,i,r,f;if(!o(n,t))return!1;for(u=[];t;){for(i=0;i<t.children.length;i++)if(r=t.children[i],f=t.leaf?this.toBBox(r):r,o(n,f)){if(t.leaf||h(n,f))return!0;u.push(r)}t=u.pop()}return!1},n.prototype.load=function(n){var i,t,r;if(!n||!n.length)return this;if(n.length<this._minEntries){for(i=0;i<n.length;i++)this.insert(n[i]);return this}return t=this._build(n.slice(),0,n.length-1,0),this.data.children.length?this.data.height===t.height?this._splitRoot(this.data,t):(this.data.height<t.height&&(r=this.data,this.data=t,t=r),this._insert(t,this.data.height-t.height-1,!0)):this.data=t,this},n.prototype.insert=function(n){return n&&this._insert(n,this.data.height-1),this},n.prototype.clear=function(){return this.data=i([]),this},n.prototype.remove=function(n,t){var o;if(!n)return this;for(var u,f,e,i=this.data,c=this.toBBox(n),r=[],s=[];i||r.length;){if((i||(i=r.pop(),f=r[r.length-1],u=s.pop(),e=!0),i.leaf)&&(o=v(n,i.children,t),-1!==o))return i.children.splice(o,1),r.push(i),this._condense(r),this;e||i.leaf||!h(i,c)?f?(u++,i=f.children[u],e=!1):i=null:(r.push(i),s.push(u),u=0,f=i,i=i.children[0])}return this},n.prototype.toBBox=function(n){return n},n.prototype.compareMinX=function(n,t){return n.minX-t.minX},n.prototype.compareMinY=function(n,t){return n.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(n){return this.data=n,this},n.prototype._all=function(n,t){for(var i=[];n;)n.leaf?t.push.apply(t,n.children):i.push.apply(i,n.children),n=i.pop();return t},n.prototype._build=function(n,r,u,f){var e,a=u-r+1,o=this._maxEntries,h,v,s,y,l,p;if(a<=o)return t(e=i(n.slice(r,u+1)),this.toBBox),e;for(f||(f=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,f-1))),(e=i([])).leaf=!1,e.height=f,h=Math.ceil(a/o),v=h*Math.ceil(Math.sqrt(o)),c(n,r,u,v,this.compareMinX),s=r;s<=u;s+=v)for(y=Math.min(s+v-1,u),c(n,s,y,h,this.compareMinY),l=s;l<=y;l+=h)p=Math.min(l+h-1,y),e.children.push(this._build(n,l,p,f-1));return t(e,this.toBBox),e},n.prototype._chooseSubtree=function(n,t,i,r){for(var e,o;r.push(t),!t.leaf&&r.length-1!==i;){for(var u=1/0,c=1/0,l=void 0,a=0;a<t.children.length;a++){var h=t.children[a],f=s(h),v=(e=n,o=h,(Math.max(o.maxX,e.maxX)-Math.min(o.minX,e.minX))*(Math.max(o.maxY,e.maxY)-Math.min(o.minY,e.minY))-f);v<c?(c=v,u=f<u?f:u,l=h):v===c&&f<u&&(u=f,l=h)}t=l||t.children[0]}return t},n.prototype._insert=function(n,t,i){var u=i?n:this.toBBox(n),r=[],e=this._chooseSubtree(u,this.data,t,r);for(e.children.push(n),f(e,u);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(u,r,t)},n.prototype._split=function(n,r){var u=n[r],o=u.children.length,s=this._minEntries,e,f;this._chooseSplitAxis(u,s,o);e=this._chooseSplitIndex(u,s,o);f=i(u.children.splice(e,u.children.length-e));f.height=u.height;f.leaf=u.leaf;t(u,this.toBBox);t(f,this.toBBox);r?n[r-1].children.push(f):this._splitRoot(u,f)},n.prototype._splitRoot=function(n,r){this.data=i([n,r]);this.data.height=n.height+1;this.data.leaf=!1;t(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(n,t,i){for(var c,f,e,v,y,p,w,l=1/0,o=1/0,r=t;r<=i-t;r++){var b=u(n,0,r,this.toBBox),k=u(n,r,i,this.toBBox),a=(f=b,e=k,v=Math.max(f.minX,e.minX),y=Math.max(f.minY,e.minY),p=Math.min(f.maxX,e.maxX),w=Math.min(f.maxY,e.maxY),Math.max(0,p-v)*Math.max(0,w-y)),h=s(b)+s(k);a<l?(l=a,c=r,o=h<o?h:o):a===l&&h<o&&(o=h,c=r)}return c||i-t},n.prototype._chooseSplitAxis=function(n,t,i){var r=n.leaf?this.compareMinX:y,u=n.leaf?this.compareMinY:p;this._allDistMargin(n,t,i,r)<this._allDistMargin(n,t,i,u)&&n.children.sort(r)},n.prototype._allDistMargin=function(n,t,i,r){var v,s,y;n.children.sort(r);for(var o=this.toBBox,h=u(n,0,t,o),c=u(n,i-t,i,o),l=e(h)+e(c),a=t;a<i-t;a++)v=n.children[a],f(h,n.leaf?o(v):v),l+=e(h);for(s=i-t-1;s>=t;s--)y=n.children[s],f(c,n.leaf?o(y):y),l+=e(c);return l},n.prototype._adjustParentBBoxes=function(n,t,i){for(var r=i;r>=0;r--)f(t[r],n)},n.prototype._condense=function(n){for(var i=n.length-1,r=void 0;i>=0;i--)0===n[i].children.length?i>0?(r=n[i-1].children).splice(r.indexOf(n[i]),1):this.clear():t(n[i],this.toBBox)},n}()},function(n){
/*!
 * PEP v0.5.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
n.exports=function(){"use strict";function f(n,t){var i,f,r,u;for(t=t||Object.create(null),i=document.createEvent("Event"),i.initEvent(n,t.bubbles||!1,t.cancelable||!1),r=2;r<y.length;r++)i[f=y[r]]=t[f]||ft[r];return i.buttons=t.buttons||0,u=0,u=void 0!==t.pressure&&i.buttons?t.pressure:i.buttons?.5:0,i.x=i.clientX,i.y=i.clientY,i.pointerId=t.pointerId||0,i.width=t.width||1,i.height=t.height||1,i.pressure=u,i.tiltX=t.tiltX||0,i.tiltY=t.tiltY||0,i.twist=t.twist||0,i.tangentialPressure=t.tangentialPressure||0,i.pointerType=t.pointerType||"",i.hwTimestamp=t.hwTimestamp||0,i.isPrimary=t.isPrimary||!1,i.detail=0,i}function w(){this.array=[];this.size=0}function s(n,t,i,r){this.addCallback=n.bind(r);this.removeCallback=t.bind(r);this.changedCallback=i.bind(r);k&&(this.observer=new k(this.mutationWatcher.bind(this)))}function d(n){return"{ -ms-touch-action: "+n+"; touch-action: "+n+"; }"}function o(t){if(!n.pointermap.has(t)){var i=new Error("NotFoundError");throw i.name="NotFoundError",i;}}function rt(n){for(var i,t=n.parentNode;t&&t!==n.ownerDocument;)t=t.parentNode;if(!t){i=new Error("InvalidStateError");throw i.name="InvalidStateError",i;}}function ut(t){return 0!==n.pointermap.get(t).buttons}var y=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],ft=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],p=window.Map&&window.Map.prototype.forEach?Map:w;w.prototype={set:function(n,t){if(void 0===t)return this.delete(n);this.has(n)||this.size++;this.array[n]=t},has:function(n){return void 0!==this.array[n]},"delete":function(n){this.has(n)&&(delete this.array[n],this.size--)},get:function(n){return this.array[n]},clear:function(){this.array.length=0;this.size=0},forEach:function(n,t){return this.array.forEach(function(i,r){n.call(t,i,r,this)},this)}};var b=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],et=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],ot={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},st="undefined"!=typeof SVGElementInstance,n={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(n,t){var i=t,r=i.events;r&&(r.forEach(function(n){i[n]&&(this.eventMap[n]=i[n].bind(i))},this),this.eventSources[n]=i,this.eventSourceList.push(i))},register:function(n){for(var t,r=this.eventSourceList.length,i=0;i<r&&(t=this.eventSourceList[i]);i++)t.register.call(t,n)},unregister:function(n){for(var t,r=this.eventSourceList.length,i=0;i<r&&(t=this.eventSourceList[i]);i++)t.unregister.call(t,n)},contains:function(n,t){try{return n.contains(t)}catch(n){return!1}},down:function(n){n.bubbles=!0;this.fireEvent("pointerdown",n)},move:function(n){n.bubbles=!0;this.fireEvent("pointermove",n)},up:function(n){n.bubbles=!0;this.fireEvent("pointerup",n)},enter:function(n){n.bubbles=!1;this.fireEvent("pointerenter",n)},leave:function(n){n.bubbles=!1;this.fireEvent("pointerleave",n)},over:function(n){n.bubbles=!0;this.fireEvent("pointerover",n)},out:function(n){n.bubbles=!0;this.fireEvent("pointerout",n)},cancel:function(n){n.bubbles=!0;this.fireEvent("pointercancel",n)},leaveOut:function(n){this.out(n);this.propagate(n,this.leave,!1)},enterOver:function(n){this.over(n);this.propagate(n,this.enter,!0)},eventHandler:function(n){if(!n._handledByPE){var i=n.type,t=this.eventMap&&this.eventMap[i];t&&t(n);n._handledByPE=!0}},listen:function(n,t){t.forEach(function(t){this.addEvent(n,t)},this)},unlisten:function(n,t){t.forEach(function(t){this.removeEvent(n,t)},this)},addEvent:function(n,t){n.addEventListener(t,this.boundHandler)},removeEvent:function(n,t){n.removeEventListener(t,this.boundHandler)},makeEvent:function(n,t){this.captureInfo[t.pointerId]&&(t.relatedTarget=null);var i=new f(n,t);return t.preventDefault&&(i.preventDefault=t.preventDefault),i._target=i._target||t.target,i},fireEvent:function(n,t){var i=this.makeEvent(n,t);return this.dispatchEvent(i)},cloneEvent:function(n){for(var t,i=Object.create(null),r=0;r<b.length;r++)i[t=b[r]]=n[t]||et[r],st&&("target"===t||"relatedTarget"===t)&&i[t]instanceof SVGElementInstance&&(i[t]=i[t].correspondingUseElement);return n.preventDefault&&(i.preventDefault=function(){n.preventDefault()}),i},getTarget:function(n){var t=this.captureInfo[n.pointerId];return t?n._target!==t&&n.type in ot?void 0:t:n._target},propagate:function(n,t,i){for(var r=n.target,u=[];null!=r&&r!==document&&!r.contains(n.relatedTarget);)if(u.push(r),!(r=r.parentNode))return;i&&u.reverse();u.forEach(function(i){n.target=i;t.call(this,n)},this)},setCapture:function(n,t,i){this.captureInfo[n]&&this.releaseCapture(n,i);this.captureInfo[n]=t;this.implicitRelease=this.releaseCapture.bind(this,n,i);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var r=new f("gotpointercapture",{bubbles:!0});r.pointerId=n;r._target=t;i||this.asyncDispatchEvent(r)},releaseCapture:function(n,t){var r=this.captureInfo[n],i;r&&(this.captureInfo[n]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),i=new f("lostpointercapture",{bubbles:!0}),i.pointerId=n,i._target=r,t||this.asyncDispatchEvent(i))},dispatchEvent:function(n){var t=this.getTarget(n);if(t)return t.dispatchEvent(n)},asyncDispatchEvent:function(n){requestAnimationFrame(this.dispatchEvent.bind(this,n))}};n.boundHandler=n.eventHandler.bind(n);var r={shadow:function(n){if(n)return n.shadowRoot||n.webkitShadowRoot},canTarget:function(n){return n&&Boolean(n.elementFromPoint)},targetingShadow:function(n){var t=this.shadow(n);if(this.canTarget(t))return t},olderShadow:function(n){var t=n.olderShadowRoot,i;return t||(i=n.querySelector("shadow"),i&&(t=i.olderShadowRoot)),t},allShadows:function(n){for(var i=[],t=this.shadow(n);t;)i.push(t),t=this.olderShadow(t);return i},searchRoot:function(n,t,i){var u,r,f,e;if(n){for(f=n.elementFromPoint(t,i),r=this.targetingShadow(f);r;){if(u=r.elementFromPoint(t,i))return e=this.targetingShadow(u),this.searchRoot(e,t,i)||u;r=this.olderShadow(r)}return f}},owner:function(n){for(var t=n;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(n){var i=n.clientX,r=n.clientY,t=this.owner(n.target);return t.elementFromPoint(i,r)||(t=document),this.searchRoot(t,i,r)}},ht=Array.prototype.forEach.call.bind(Array.prototype.forEach),ct=Array.prototype.map.call.bind(Array.prototype.map),lt=Array.prototype.slice.call.bind(Array.prototype.slice),at=Array.prototype.filter.call.bind(Array.prototype.filter),k=window.MutationObserver||window.WebKitMutationObserver,vt={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};s.prototype={watchSubtree:function(n){this.observer&&r.canTarget(n)&&this.observer.observe(n,vt)},enableOnSubtree:function(n){this.watchSubtree(n);n===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(n)},installNewSubtree:function(n){ht(this.findElements(n),this.addElement,this)},findElements:function(n){return n.querySelectorAll?n.querySelectorAll("[touch-action]"):[]},removeElement:function(n){this.removeCallback(n)},addElement:function(n){this.addCallback(n)},elementChanged:function(n,t){this.changedCallback(n,t)},concatLists:function(n,t){return n.concat(lt(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(n){return n.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(n){var t=ct(n,this.findElements,this);return t.push(at(n,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(n){n.forEach(this.mutationHandler,this)},mutationHandler:function(n){"childList"===n.type?(this.flattenMutationTree(n.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(n.removedNodes).forEach(this.removeElement,this)):"attributes"===n.type&&this.elementChanged(n.target,n.oldValue)}};var yt=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],h="",pt=window.PointerEvent||window.MSPointerEvent,wt=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,i=n.pointermap,c=[1,4,2,8,16],u=!1;try{u=1===new MouseEvent("test",{buttons:1}).buttons}catch(y){}var g,nt={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){n.listen(t,this.events)},unregister:function(t){n.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(n){for(var u,f,t,r=this.lastTouches,e=n.clientX,o=n.clientY,i=0,s=r.length;i<s&&(t=r[i]);i++)if(u=Math.abs(e-t.x),f=Math.abs(o-t.y),u<=25&&f<=25)return!0},prepareEvent:function(t){var i=n.cloneEvent(t),r=i.preventDefault;return i.preventDefault=function(){t.preventDefault();r()},i.pointerId=this.POINTER_ID,i.isPrimary=!0,i.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(i.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),i},prepareButtonsForMove:function(n,t){var r=i.get(this.POINTER_ID);n.buttons=0!==t.which&&r?r.buttons:0;t.buttons=n.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var f=i.get(this.POINTER_ID),r=this.prepareEvent(t);u||(r.buttons=c[r.button],f&&(r.buttons|=f.buttons),t.buttons=r.buttons);i.set(this.POINTER_ID,t);f&&0!==f.buttons?n.move(r):n.down(r)}},webkitmouseforcechanged:function(n){this.mousemove(n)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var r=this.prepareEvent(t);u||this.prepareButtonsForMove(r,t);r.button=-1;i.set(this.POINTER_ID,t);n.move(r)}},mouseup:function(t){var f,r,e;this.isEventSimulatedFromTouch(t)||(f=i.get(this.POINTER_ID),r=this.prepareEvent(t),u||(e=c[r.button],r.buttons=f?f.buttons&~e:0,t.buttons=r.buttons),i.set(this.POINTER_ID,t),r.buttons&=~c[r.button],0===r.buttons?n.up(r):n.move(r))},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var r=this.prepareEvent(t);u||this.prepareButtonsForMove(r,t);r.button=-1;i.set(this.POINTER_ID,t);n.enterOver(r)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var i=this.prepareEvent(t);u||this.prepareButtonsForMove(i,t);i.button=-1;n.leaveOut(i)}},cancel:function(t){var i=this.prepareEvent(t);n.cancel(i);this.deactivateMouse()},deactivateMouse:function(){i.delete(this.POINTER_ID)}},bt=n.captureInfo,kt=r.findTarget.bind(r),l=r.allShadows.bind(r),t=n.pointermap,e={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(n){g.enableOnSubtree(n)},unregister:function(){},elementAdded:function(t){var r=t.getAttribute("touch-action"),i=this.touchActionToScrollType(r);"number"==typeof i&&(t._scrollType=i,n.listen(t,this.events),l(t).forEach(function(t){t._scrollType=i;n.listen(t,this.events)},this))},elementRemoved:function(i){if(t.size>0){var r=this.events;i.addEventListener("touchend",function(){i._scrollType=void 0;n.unlisten(i,r)})}else i._scrollType=void 0,n.unlisten(i,this.events);l(i).forEach(function(t){t._scrollType=void 0;n.unlisten(t,this.events)},this)},elementChanged:function(n,t){var u=n.getAttribute("touch-action"),i=this.touchActionToScrollType(u),r=this.touchActionToScrollType(t);"number"==typeof i&&"number"==typeof r?(n._scrollType=i,l(n).forEach(function(n){n._scrollType=i},this)):"number"==typeof r?this.elementRemoved(n):"number"==typeof i&&this.elementAdded(n)},scrollTypes:{UP:function(n){return n.includes("pan-y")||n.includes("pan-up")?1:0},DOWN:function(n){return n.includes("pan-y")||n.includes("pan-down")?2:0},LEFT:function(n){return n.includes("pan-x")||n.includes("pan-left")?4:0},RIGHT:function(n){return n.includes("pan-x")||n.includes("pan-right")?8:0}},touchActionToScrollType:function(n){if(n){if("auto"===n)return 15;if("none"===n)return 0;var t=n.split(" "),i=this.scrollTypes;return i.UP(t)|i.DOWN(t)|i.LEFT(t)|i.RIGHT(t)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(n){return this.firstTouch===n.identifier},setPrimaryTouch:function(n){(0===t.size||1===t.size&&t.has(1))&&(this.firstTouch=n.identifier,this.firstXY={X:n.clientX,Y:n.clientY},this.scrolling=!1)},removePrimaryPointer:function(n){n.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(n){var t=0;return"touchstart"!==n&&"touchmove"!==n&&"touchforcechange"!==n||(t=1),t},touchToPointer:function(t){var r=this.currentTouchEvent,i=n.cloneEvent(t),o=i.pointerId=t.identifier+2,u,f,e;return(i.target=bt[o]||kt(i),i.bubbles=!0,i.cancelable=!0,i.button=0,i.buttons=this.typeToButtons(r.type),i.width=2*(t.radiusX||t.webkitRadiusX||0),i.height=2*(t.radiusY||t.webkitRadiusY||0),i.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,i.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle)?(u=Math.tan(t.altitudeAngle),f=180/Math.PI,i.tiltX=Math.atan(Math.cos(t.azimuthAngle)/u)*f,i.tiltY=Math.atan(Math.sin(t.azimuthAngle)/u)*f):(i.tiltX=0,i.tiltY=0),i.pointerType="stylus"===t.touchType?"pen":this.POINTER_TYPE,i.altKey=r.altKey,i.ctrlKey=r.ctrlKey,i.metaKey=r.metaKey,i.shiftKey=r.shiftKey,e=this,i.preventDefault=function(){e.scrolling=!1;e.firstXY=null;r.preventDefault()},i},processTouches:function(n,t){var r=n.changedTouches,u,i;for(this.currentTouchEvent=n,i=0;i<r.length;i++)u=r[i],t.call(this,this.touchToPointer(u))},shouldScroll:function(n){var t,i;if(this.firstXY){if(i=n.currentTarget._scrollType,0===i)t=!1;else if(15===i)t=!0;else{var o=n.changedTouches[0],f=o.clientY-this.firstXY.Y,r=Math.abs(f),e=o.clientX-this.firstXY.X,u=Math.abs(e),s=1&i,h=2&i,c=4&i,l=8&i;c&&l?t=u>r:c?t=u>r&&e>0:l&&(t=u>r&&e<0);t||(s&&h?t=u<r:s?t=u<r&&f>0:h&&(t=u<r&&f<0))}return this.firstXY=null,t}},findTouch:function(n,t){for(var r,i=0,u=n.length;i<u&&(r=n[i]);i++)if(r.identifier===t)return!0},vacuumTouches:function(n){var r=n.touches,i;t.size>=r.length&&(i=[],t.forEach(function(n,t){if(1!==t&&!this.findTouch(r,t-2)){var u=n.out;i.push(u)}},this),i.forEach(this.cancelOut,this))},touchstart:function(n){this.vacuumTouches(n);this.setPrimaryTouch(n.changedTouches[0]);this.dedupSynthMouse(n);this.scrolling||this.processTouches(n,this.overDown)},overDown:function(i){t.set(i.pointerId,{target:i.target,out:i,outTarget:i.target});n.enterOver(i);n.down(i)},touchforcechange:function(n){this.touchmove(n)},touchmove:function(n){this.scrolling||(this.shouldScroll(n)?(this.scrolling=!0,this.touchcancel(n)):("touchforcechange"!==n.type&&n.preventDefault(),this.processTouches(n,this.moveOverOut)))},moveOverOut:function(i){var r=i,u=t.get(r.pointerId),f,e;u&&(f=u.out,e=u.outTarget,n.move(r),f&&e!==r.target&&(f.relatedTarget=r.target,r.relatedTarget=e,f.target=e,r.target?(n.leaveOut(f),n.enterOver(r)):(r.target=e,r.relatedTarget=null,this.cancelOut(r))),u.out=r,u.outTarget=r.target)},touchend:function(n){this.dedupSynthMouse(n);this.processTouches(n,this.upOut)},upOut:function(t){this.scrolling||(n.up(t),n.leaveOut(t));this.cleanUpPointer(t)},touchcancel:function(n){this.processTouches(n,this.cancelOut)},cancelOut:function(t){n.cancel(t);n.leaveOut(t);this.cleanUpPointer(t)},cleanUpPointer:function(n){t.delete(n.pointerId);this.removePrimaryPointer(n)},dedupSynthMouse:function(n){var r=nt.lastTouches,t=n.changedTouches[0],i,u;this.isPrimaryTouch(t)&&(i={x:t.clientX,y:t.clientY},r.push(i),u=function(n,t){var i=n.indexOf(t);i>-1&&n.splice(i,1)}.bind(null,r,i),setTimeout(u,2500))}};g=new s(e.elementAdded,e.elementRemoved,e.elementChanged,e);var a,v,tt,it=n.pointermap,dt=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,gt={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){n.listen(t,this.events)},unregister:function(t){n.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var i=t;return dt&&((i=n.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),i},cleanup:function(n){it.delete(n)},MSPointerDown:function(t){it.set(t.pointerId,t);var i=this.prepareEvent(t);n.down(i)},MSPointerMove:function(t){var i=this.prepareEvent(t);n.move(i)},MSPointerUp:function(t){var i=this.prepareEvent(t);n.up(i);this.cleanup(t.pointerId)},MSPointerOut:function(t){var i=this.prepareEvent(t);n.leaveOut(i)},MSPointerOver:function(t){var i=this.prepareEvent(t);n.enterOver(i)},MSPointerCancel:function(t){var i=this.prepareEvent(t);n.cancel(i);this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var i=n.makeEvent("lostpointercapture",t);n.dispatchEvent(i)},MSGotPointerCapture:function(t){var i=n.makeEvent("gotpointercapture",t);n.dispatchEvent(i)}};return window.navigator.msPointerEnabled?(a=function(t){o(t);rt(this);ut(t)&&(n.setCapture(t,this,!0),this.msSetPointerCapture(t))},v=function(t){o(t);n.releaseCapture(t,!0);this.msReleasePointerCapture(t)}):(a=function(t){o(t);rt(this);ut(t)&&n.setCapture(t,this)},v=function(t){o(t);n.releaseCapture(t)}),tt=function(t){return!!n.captureInfo[t]},function(){if(pt){yt.forEach(function(n){h+=n.selector+d(n.value)+"\n";wt&&(h+=function(n){return"body /shadow-deep/ "+n}(n.selector)+d(n.value)+"\n")});var n=document.createElement("style");n.textContent=h;document.head.appendChild(n)}}(),function(){if(!window.PointerEvent){if(window.PointerEvent=f,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0});n.registerSource("ms",gt)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),n.registerSource("mouse",nt),void 0!==window.ontouchstart&&n.registerSource("touch",e);n.register(document)}}(),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:a},releasePointerCapture:{value:v},hasPointerCapture:{value:tt}}),{dispatcher:n,Installer:s,PointerEvent:f,PointerMap:p,targetFinding:r}}()},function(n,t,i){"use strict";function r(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0);this.pos=0;this.type=0;this.length=this.buf.length}function u(n){return n.type===r.Bytes?n.readVarint()+n.pos:n.pos+1}function f(n,t,i){return i?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function c(n,t,i){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2)),r;for(i.realloc(u),r=i.pos-1;r>=n;r--)i.buf[r+u]=i.buf[r]}function a(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function v(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function y(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function p(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function w(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function b(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function k(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function d(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function g(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}function s(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function e(n,t,i){n[i]=t;n[i+1]=t>>>8;n[i+2]=t>>>16;n[i+3]=t>>>24}function l(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}var o,h;n.exports=r;o=i(4);r.Varint=0;r.Fixed64=1;r.Bytes=2;r.Fixed32=5;h="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),u=r>>3,f=this.pos;this.type=7&r;n(u,t,this);this.pos===f&&this.skip(r)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=s(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=l(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=s(this.buf,this.pos)+4294967296*s(this.buf,this.pos+4);return this.pos+=8,n},readSFixed64:function(){var n=s(this.buf,this.pos)+4294967296*l(this.buf,this.pos+4);return this.pos+=8,n},readFloat:function(){var n=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,i,r=this.buf;return t=127&(i=r[this.pos++]),i<128?t:(t|=(127&(i=r[this.pos++]))<<7,i<128?t:(t|=(127&(i=r[this.pos++]))<<14,i<128?t:(t|=(127&(i=r[this.pos++]))<<21,i<128?t:function(n,t,i){var u,r,e=i.buf;if((r=e[i.pos++],u=(112&r)>>4,r<128)||(r=e[i.pos++],u|=(127&r)<<3,r<128)||(r=e[i.pos++],u|=(127&r)<<10,r<128)||(r=e[i.pos++],u|=(127&r)<<17,r<128)||(r=e[i.pos++],u|=(127&r)<<24,r<128)||(r=e[i.pos++],u|=(1&r)<<31,r<128))return f(n,u,t);throw new Error("Expected varint not more than 10 bytes");}(t|=(15&(i=r[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&h?function(n,t,i){return h.decode(n.subarray(t,i))}(this.buf,t,n):function(n,t,i){for(var h="",u=t;u<i;){var f,s,c,e=n[u],r=null,o=e>239?4:e>223?3:e>191?2:1;if(u+o>i)break;1===o?e<128&&(r=e):2===o?128==(192&(f=n[u+1]))&&(r=(31&e)<<6|63&f)<=127&&(r=null):3===o?(f=n[u+1],s=n[u+2],128==(192&f)&&128==(192&s)&&((r=(15&e)<<12|(63&f)<<6|63&s)<=2047||r>=55296&&r<=57343)&&(r=null)):4===o&&(f=n[u+1],s=n[u+2],c=n[u+3],128==(192&f)&&128==(192&s)&&128==(192&c)&&((r=(15&e)<<18|(63&f)<<12|(63&s)<<6|63&c)<=65535||r>=1114112)&&(r=null));null===r?(r=65533,o=1):r>65535&&(r-=65536,h+=String.fromCharCode(r>>>10&1023|55296),r=56320|1023&r);h+=String.fromCharCode(r);u+=o}return h}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==r.Bytes)return n.push(this.readVarint(t));var i=u(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==r.Bytes)return n.push(this.readSVarint());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==r.Bytes)return n.push(this.readBoolean());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==r.Bytes)return n.push(this.readFloat());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==r.Bytes)return n.push(this.readDouble());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==r.Bytes)return n.push(this.readFixed32());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==r.Bytes)return n.push(this.readSFixed32());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==r.Bytes)return n.push(this.readFixed64());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==r.Bytes)return n.push(this.readSFixed64());var t=u(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===r.Varint)for(;this.buf[this.pos++]>127;);else if(t===r.Bytes)this.pos=this.readVarint()+this.pos;else if(t===r.Fixed32)this.pos+=4;else{if(t!==r.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var i,t=this.length||16;t<this.pos+n;)t*=2;t!==this.length&&(i=new Uint8Array(t),i.set(this.buf),this.buf=i,this.length=t)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4);e(this.buf,n,this.pos);this.pos+=4},writeSFixed32:function(n){this.realloc(4);e(this.buf,n,this.pos);this.pos+=4},writeFixed64:function(n){this.realloc(8);e(this.buf,-1&n,this.pos);e(this.buf,Math.floor(n*(1/4294967296)),this.pos+4);this.pos+=8},writeSFixed64:function(n){this.realloc(8);e(this.buf,-1&n,this.pos);e(this.buf,Math.floor(n*(1/4294967296)),this.pos+4);this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(n,t){var i,r;if(n>=0?(i=n%4294967296|0,r=n/4294967296|0):(r=~(-n/4294967296),4294967295^(i=~(-n%4294967296))?i=i+1|0:(i=0,r=r+1|0)),n>=0x10000000000000000||n<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(n,t,i){i.buf[i.pos++]=127&n|128;n>>>=7;i.buf[i.pos++]=127&n|128;n>>>=7;i.buf[i.pos++]=127&n|128;n>>>=7;i.buf[i.pos++]=127&n|128;n>>>=7;i.buf[i.pos]=127&n}(i,0,t),function(n,t){var i=(7&n)<<4;(t.buf[t.pos++]|=i|((n>>>=3)?128:0),n)&&(t.buf[t.pos++]=127&n|((n>>>=7)?128:0),n)&&(t.buf[t.pos++]=127&n|((n>>>=7)?128:0),n)&&(t.buf[t.pos++]=127&n|((n>>>=7)?128:0),n)&&(t.buf[t.pos++]=127&n|((n>>>=7)?128:0),n)&&(t.buf[t.pos++]=127&n)}(r,t)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){var i,t;n=String(n);this.realloc(4*n.length);this.pos++;i=this.pos;this.pos=function(n,t,i){for(var r,u,f=0;f<t.length;f++){if((r=t.charCodeAt(f))>55295&&r<57344){if(!u){r>56319||f+1===t.length?(n[i++]=239,n[i++]=191,n[i++]=189):u=r;continue}if(r<56320){n[i++]=239;n[i++]=191;n[i++]=189;u=r;continue}r=u-55296<<10|r-56320|65536;u=null}else u&&(n[i++]=239,n[i++]=191,n[i++]=189,u=null);r<128?n[i++]=r:(r<2048?n[i++]=r>>6|192:(r<65536?n[i++]=r>>12|224:(n[i++]=r>>18|240,n[i++]=r>>12&63|128),n[i++]=r>>6&63|128),n[i++]=63&r|128)}return i}(this.buf,n,this.pos);t=this.pos-i;t>=128&&c(i,t,this);this.pos=i-1;this.writeVarint(t);this.pos+=t},writeFloat:function(n){this.realloc(4);o.write(this.buf,n,this.pos,!0,23,4);this.pos+=4},writeDouble:function(n){this.realloc(8);o.write(this.buf,n,this.pos,!0,52,8);this.pos+=8},writeBytes:function(n){var i=n.length,t;for(this.writeVarint(i),this.realloc(i),t=0;t<i;t++)this.buf[this.pos++]=n[t]},writeRawMessage:function(n,t){var r,i;this.pos++;r=this.pos;n(t,this);i=this.pos-r;i>=128&&c(r,i,this);this.pos=r-1;this.writeVarint(i);this.pos+=i},writeMessage:function(n,t,i){this.writeTag(n,r.Bytes);this.writeRawMessage(t,i)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,a,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,v,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,w,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,y,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,p,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,b,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,k,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,d,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,g,t)},writeBytesField:function(n,t){this.writeTag(n,r.Bytes);this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,r.Fixed32);this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,r.Fixed32);this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,r.Fixed64);this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,r.Fixed64);this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,r.Varint);this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,r.Varint);this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,r.Bytes);this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,r.Fixed32);this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,r.Fixed64);this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,Boolean(t))}}},function(n,t,i){var r=i(5);t.Processor=r},function(n,t){t.read=function(n,t,i,r,u){var f,o,l=8*u-r-1,a=(1<<l)-1,v=a>>1,e=-7,s=i?u-1:0,c=i?-1:1,h=n[t+s];for(s+=c,f=h&(1<<-e)-1,h>>=-e,e+=l;e>0;f=256*f+n[t+s],s+=c,e-=8);for(o=f&(1<<-e)-1,f>>=-e,e+=r;e>0;o=256*o+n[t+s],s+=c,e-=8);if(0===f)f=1-v;else{if(f===a)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r);f-=v}return(h?-1:1)*o*Math.pow(2,f-r)};t.write=function(n,t,i,r,u,f){var e,o,s,l=8*f-u-1,a=(1<<l)-1,h=a>>1,y=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,c=r?0:f-1,v=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,e=a):(e=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-e))<1&&(e--,s*=2),(t+=e+h>=1?y/s:y*Math.pow(2,1-h))*s>=2&&(e++,s/=2),e+h>=a?(o=0,e=a):e+h>=1?(o=(t*s-1)*Math.pow(2,u),e+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,u),e=0));u>=8;n[i+c]=255&o,c+=v,o/=256,u-=8);for(e=e<<u|o,l+=u;l>0;n[i+c]=255&e,c+=v,e/=256,l-=8);n[i+c-v]|=128*p}},function(n,t,i){function u(n){function i(n,i,r){return t?new ImageData(n,i,r):{data:n,width:i,height:r}}var t=!0;try{new ImageData(10,10)}catch(n){t=!1}return function(t){var e,r,l=t.buffers,y=t.meta,w=t.imageOps,b=t.width,k=t.height,s=l.length,p=l[0].byteLength,a,v,o,u,f,h,c;if(w){for(a=new Array(s),r=0;r<s;++r)a[r]=i(new Uint8ClampedArray(l[r]),b,k);e=n(a,y).data}else{for(e=new Uint8ClampedArray(p),v=new Array(s),o=new Array(s),r=0;r<s;++r)v[r]=new Uint8ClampedArray(l[r]),o[r]=[0,0,0,0];for(u=0;u<p;u+=4){for(f=0;f<s;++f)h=v[f],o[f][0]=h[u],o[f][1]=h[u+1],o[f][2]=h[u+2],o[f][3]=h[u+3];c=n(o,y);e[u]=c[0];e[u+1]=c[1];e[u+2]=c[2];e[u+3]=c[3]}}return e.buffer}}function e(n,t){var r=Object.keys(n.lib||{}).map(function(t){return"var "+t+" = "+n.lib[t].toString()+";"}).concat(["var __minion__ = ("+u.toString()+")(",n.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),f=new Blob(r,{type:"text/javascript"}),e=URL.createObjectURL(f),i=new Worker(e);return i.addEventListener("message",t),i}function r(n){var r,i,t;if(this._imageOps=!!n.imageOps,i=[],r=0===n.threads?0:this._imageOps?1:n.threads||1)for(t=0;t<r;++t)i[t]=e(n,this._onWorkerMessage.bind(this,t));else i[0]=function(n,t){var i=u(n.operation);return{postMessage:function(n){setTimeout(function(){t({data:{buffer:i(n),meta:n.meta}})},0)}}}(n,this._onWorkerMessage.bind(this,0));this._workers=i;this._queue=[];this._maxQueueLength=n.queue||1/0;this._running=0;this._dataLookup={};this._job=null}var f=i(6).newImageData;r.prototype.process=function(n,t,i){this._enqueue({inputs:n,meta:t,callback:i});this._dispatch()};r.prototype.destroy=function(){for(var n in this)this[n]=null;this._destroyed=!0};r.prototype._enqueue=function(n){for(this._queue.push(n);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)};r.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var n=this._job=this._queue.shift(),f=n.inputs[0].width,e=n.inputs[0].height,i=n.inputs.map(function(n){return n.data.buffer}),r=this._workers.length;if(this._running=r,1===r)this._workers[0].postMessage({buffers:i,meta:n.meta,imageOps:this._imageOps,width:f,height:e},i);else for(var c=n.inputs[0].data.length,o=4*Math.ceil(c/4/r),t=0;t<r;++t){for(var s=t*o,u=[],h=0,l=i.length;h<l;++h)u.push(i[t].slice(s,s+o));this._workers[t].postMessage({buffers:u,meta:n.meta,imageOps:this._imageOps,width:f,height:e},u)}}};r.prototype._onWorkerMessage=function(n,t){this._destroyed||(this._dataLookup[n]=t.data,--this._running,0===this._running&&this._resolveJob())};r.prototype._resolveJob=function(){var t,i,r=this._job,e=this._workers.length,u,o,n,s,h;if(1===e)t=new Uint8ClampedArray(this._dataLookup[0].buffer),i=this._dataLookup[0].meta;else for(u=r.inputs[0].data.length,t=new Uint8ClampedArray(u),i=new Array(u),o=4*Math.ceil(u/4/e),n=0;n<e;++n)s=this._dataLookup[n].buffer,h=n*o,t.set(new Uint8ClampedArray(s),h),i[n]=this._dataLookup[n].meta;this._job=null;this._dataLookup={};r.callback(null,f(t,r.inputs[0].width,r.inputs[0].height),i);this._dispatch()};n.exports=r},function(n,t){var i=!0,r;try{new ImageData(10,10)}catch(n){i=!1}r=document.createElement("canvas").getContext("2d");t.newImageData=function(n,t,u){if(i)return new ImageData(n,t,u);var f=r.createImageData(t,u);return f.data.set(n),f}},function(n,t,i){"use strict";function w(){return function(){throw new Error("Unimplemented abstract method.");}()}function v(n){return n.ol_uid||(n.ol_uid=String(++ytt))}function pe(n){for(var t in n)delete n[t]}function bo(n){for(var t in n)return!1;return!t}function nt(n,t,i,r,u){var f,e;return(r&&r!==n&&(i=i.bind(r)),u)&&(f=i,i=function(){n.removeEventListener(t,i);f.apply(this,arguments)}),e={target:n,type:t,listener:i},n.addEventListener(t,i),e}function fh(n,t,i,r){return nt(n,t,i,r,!0)}function ct(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),pe(n))}function we(n,t){return n>t?1:n<t?-1:0}function di(n,t){return n.indexOf(t)>=0}function rv(n,t,i){var u=n.length,r;if(n[0]<=t)return 0;if(t<=n[u-1])return u-1;if(r=void 0,i>0){for(r=1;r<u;++r)if(n[r]<t)return r-1}else if(i<0){for(r=1;r<u;++r)if(n[r]<=t)return r}else for(r=1;r<u;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return u-1}function ewt(n,t,i){for(;t<i;){var r=n[t];n[t]=n[i];n[i]=r;++t;--i}}function pt(n,t){for(var r=Array.isArray(t)?t:[t],u=r.length,i=0;i<u;i++)n[n.length]=r[i]}function gc(n,t){for(var r,u=n.length>>>0,i=0;i<u;i++)if(t(r=n[i],i,n))return r;return null}function be(n,t){var r=n.length,i;if(r!==t.length)return!1;for(i=0;i<r;i++)if(n[i]!==t[i])return!1;return!0}function wtt(n,t){var i;return n.every(function(r,u){return i=u,!t(r,u,n)})?-1:i}function tu(){return!0}function go(){return!1}function gf(){}function owt(n){n.stopPropagation()}function ri(n){return lw.hasOwnProperty(n)?lw[n]:lw[n]="change:"+n}function p(n,t){if(!n)throw new ptt(t);}function oi(n){for(var i=tit(),t=0,r=n.length;t<r;++t)hh(i,n[t]);return i}function iu(n,t,i){return i?(i[0]=n[0]-t,i[1]=n[1]-t,i[2]=n[2]+t,i[3]=n[3]+t,i):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function nit(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function ns(n,t,i){var r,u;return(r=t<n[0]?n[0]-t:n[2]<t?t-n[2]:0)*r+(u=i<n[1]?n[1]-i:n[3]<i?i-n[3]:0)*u}function fv(n,t){return ev(n,t[0],t[1])}function tr(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function ev(n,t,i){return n[0]<=t&&t<=n[2]&&n[1]<=i&&i<=n[3]}function aw(n,t){var f=n[0],e=n[1],o=n[2],s=n[3],r=t[0],u=t[1],i=nr.UNKNOWN;return r<f?i|=nr.LEFT:r>o&&(i|=nr.RIGHT),u<e?i|=nr.BELOW:u>s&&(i|=nr.ABOVE),i===nr.UNKNOWN&&(i=nr.INTERSECTING),i}function tit(){return[1/0,1/0,-1/0,-1/0]}function ru(n,t,i,r,u){return u?(u[0]=n,u[1]=t,u[2]=i,u[3]=r,u):[n,t,i,r]}function oh(n){return ru(1/0,1/0,-1/0,-1/0,n)}function sh(n,t){var i=n[0],r=n[1];return ru(i,r,i,r,t)}function vw(n,t,i,r,u){return iit(oh(u),n,t,i,r)}function uu(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function ov(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function hh(n,t){t[0]<n[0]&&(n[0]=t[0]);t[0]>n[2]&&(n[2]=t[0]);t[1]<n[1]&&(n[1]=t[1]);t[1]>n[3]&&(n[3]=t[1])}function awt(n,t){for(var i=0,r=t.length;i<r;++i)hh(n,t[i]);return n}function iit(n,t,i,r,u){for(;i<r;i+=u)vwt(n,t[i],t[i+1]);return n}function vwt(n,t,i){n[0]=Math.min(n[0],t);n[1]=Math.min(n[1],i);n[2]=Math.max(n[2],t);n[3]=Math.max(n[3],i)}function rit(n,t){var i;return(i=t(ne(n)))?i:(i=t(ke(n)))?i:(i=t(de(n)))?i:(i=t(yr(n)))||!1}function sv(n){var t=0;return ts(n)||(t=vt(n)*ni(n)),t}function ne(n){return[n[0],n[1]]}function ke(n){return[n[2],n[1]]}function vr(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function ywt(n,t){var i;return t===nl.BOTTOM_LEFT?i=ne(n):t===nl.BOTTOM_RIGHT?i=ke(n):t===nl.TOP_LEFT?i=yr(n):t===nl.TOP_RIGHT?i=de(n):p(!1,13),i}function tl(n,t,i,r,u){var l=t*r[0]/2,a=t*r[1]/2,v=Math.cos(i),y=Math.sin(i),f=l*v,e=l*y,o=a*v,s=a*y,h=n[0],c=n[1],p=h-f+s,w=h-f-s,b=h+f-s,k=h+f+s,d=c-e-o,g=c-e+o,nt=c+e+o,tt=c+e-o;return ru(Math.min(p,w,b,k),Math.min(d,g,nt,tt),Math.max(p,w,b,k),Math.max(d,g,nt,tt),u)}function ni(n){return n[3]-n[1]}function vu(n,t,i){var r=i||[1/0,1/0,-1/0,-1/0];return fi(n,t)?(r[0]=n[0]>t[0]?n[0]:t[0],r[1]=n[1]>t[1]?n[1]:t[1],r[2]=n[2]<t[2]?n[2]:t[2],r[3]=n[3]<t[3]?n[3]:t[3]):oh(r),r}function yr(n){return[n[0],n[3]]}function de(n){return[n[2],n[3]]}function vt(n){return n[2]-n[0]}function fi(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function ts(n){return n[2]<n[0]||n[3]<n[1]}function il(n,t){var i=(n[2]-n[0])/2*(t-1),r=(n[3]-n[1])/2*(t-1);n[0]-=i;n[2]+=i;n[1]-=r;n[3]+=r}function rl(n,t,i){var r=[n[0],n[1],n[0],n[3],n[2],n[1],n[2],n[3]];return t(r,r,2),function(n,t,i){return ru(Math.min.apply(null,n),Math.min.apply(null,t),Math.max.apply(null,n),Math.max.apply(null,t),i)}([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],i)}function ge(n,t,i,r,u,f){for(var h,c,e=f||[],o=0,s=t;s<i;s+=r)h=n[s],c=n[s+1],e[o++]=u[0]*h+u[2]*c+u[4],e[o++]=u[1]*h+u[3]*c+u[5];return f&&e.length!=o&&(e.length=o),e}function uit(n,t,i,r,u,f,e){for(var l,a,c,o=e||[],v=Math.cos(u),y=Math.sin(u),p=f[0],w=f[1],h=0,s=t;s<i;s+=r)for(l=n[s]-p,a=n[s+1]-w,o[h++]=p+l*v-a*y,o[h++]=w+l*y+a*v,c=s+2;c<s+r;++c)o[h++]=n[c];return e&&o.length!=h&&(o.length=h),o}function fit(n,t,i,r,u,f,e){for(var c,o=e||[],h=0,s=t;s<i;s+=r)for(o[h++]=n[s]+u,o[h++]=n[s+1]+f,c=s+2;c<s+r;++c)o[h++]=n[c];return e&&o.length!=h&&(o.length=h),o}function kt(n,t,i){return Math.min(Math.max(n,t),i)}function oit(n,t,i,r,u,f){var e=u-i,o=f-r,s;return(0!==e||0!==o)&&(s=((n-i)*e+(t-r)*o)/(e*e+o*o),s>1?(i=u,r=f):s>0&&(i+=e*s,r+=o*s)),is(n,t,i,r)}function is(n,t,i,r){var u=i-n,f=r-t;return u*u+f*f}function sit(n){return 180*n/Math.PI}function yu(n){return n*Math.PI/180}function pu(n,t){var i=n%t;return i*t<0?i+t:i}function ch(n,t,i){return n+i*(t-n)}function hv(n,t,i){var s=i||ul,r=yu(n[1]),u=yu(t[1]),f=(u-r)/2,e=yu(t[0]-n[0])/2,o=Math.sin(f)*Math.sin(f)+Math.sin(e)*Math.sin(e)*Math.cos(r)*Math.cos(u);return 2*s*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function yw(n,t){for(var r=0,i=0,u=n.length;i<u-1;++i)r+=hv(n[i],n[i+1],t);return r}function cv(n,t){for(var u,f,e=0,r=n.length,o=n[r-1][0],s=n[r-1][1],i=0;i<r;i++)u=n[i][0],f=n[i][1],e+=yu(u-o)*(2+Math.sin(yu(s))+Math.sin(yu(f))),o=u,s=f;return e*t*t/2}function pwt(n,t,i,r){var o=r||ul,u=yu(n[1]),s=yu(n[0]),f=t/o,e=Math.asin(Math.sin(u)*Math.cos(f)+Math.cos(u)*Math.sin(f)*Math.cos(i));return[sit(s+Math.atan2(Math.sin(i)*Math.sin(f)*Math.cos(u),Math.cos(f)-Math.sin(u)*Math.sin(e))),sit(e)]}function dwt(n,t,i){var o=n.length,s=i>1?i:2,e=t,u,r,f;for(void 0===e&&(e=s>2?n.slice():new Array(o)),u=ah,r=0;r<o;r+=s)e[r]=u*n[r]/180,f=lv*Math.log(Math.tan(Math.PI*(+n[r+1]+90)/360)),f>u?f=u:f<-u&&(f=-u),e[r+1]=f;return e}function gwt(n,t,i){var f=n.length,e=i>1?i:2,u=t,r;for(void 0===u&&(u=e>2?n.slice():new Array(f)),r=0;r<f;r+=e)u[r]=180*n[r]/ah,u[r+1]=360*Math.atan(Math.exp(n[r+1]/lv))/Math.PI-90;return u}function yh(n,t,i){var r=n.getCode(),u=t.getCode();r in vh||(vh[r]={});vh[r][u]=i}function ait(n,t){var i;return n in vh&&t in vh[n]&&(i=vh[n][t]),i}function ww(n,t){var r,i,u;if(void 0!==t){for(i=0,u=n.length;i<u;++i)t[i]=n[i];r=t}else r=n.slice();return r}function bw(n,t){if(void 0!==t&&n!==t){for(var i=0,r=n.length;i<r;++i)t[i]=n[i];n=t}return n}function kw(n){!function(n,t){pw[n]=t}(n.getCode(),n);yh(n,n,ww)}function y(n){return"string"==typeof n?pw[n]||null:n||null}function av(n,t,i,r){var u,o=(n=y(n)).getPointResolutionFunc(),e,s,f;return o?(u=o(t,i),r&&r!==n.getUnits()&&(e=n.getMetersPerUnit())&&(u=u*e/cu[r])):(n.getUnits()!=lu.DEGREES||r)&&r!=lu.DEGREES?(s=wu(n,y("EPSG:4326")),f=[i[0]-t/2,i[1],i[0]+t/2,i[1],i[0],i[1]-t/2,i[0],i[1]+t/2],u=(hv((f=s(f,f,2)).slice(0,2),f.slice(2,4))+hv(f.slice(4,6),f.slice(6,8)))/2,void 0!==(e=r?cu[r]:n.getMetersPerUnit())&&(u/=e)):u=t,u}function vv(n){!function(n){n.forEach(kw)}(n);n.forEach(function(t){n.forEach(function(n){t!==n&&yh(t,n,ww)})})}function dw(n,t){return n?"string"==typeof n?y(n):n:y(t)}function vit(n){return function(t,i,r){for(var o,f,s=t.length,h=void 0!==r?r:2,e=void 0!==i?i:new Array(s),u=0;u<s;u+=h)for(o=n([t[u],t[u+1]]),e[u]=o[0],e[u+1]=o[1],f=h-1;f>=2;--f)e[u+f]=t[u+f];return e}}function yit(n,t,i,r){var u=y(n),f=y(t);yh(u,f,vit(i));yh(f,u,vit(r))}function pr(n,t){if(n===t)return!0;var i=n.getUnits()===t.getUnits();return n.getCode()===t.getCode()?i:wu(n,t)===ww&&i}function wu(n,t){var i=ait(n.getCode(),t.getCode());return i||(i=bw),i}function tf(n,t){return wu(y(n),y(t))}function to(n,t,i){return tf(t,i)(n,void 0,n.length)}function io(n,t,i){return rl(n,tf(t,i))}function yv(){return rf}function el(n,t){return rf?to(n,t,rf):n}function pi(n,t){return rf?to(n,rf,t):n}function ol(n,t){return rf?io(n,t,rf):n}function uf(n,t){return rf?io(n,rf,t):n}function sl(n){return hl(n,1,0,0,1,0,0)}function ph(n,t){var i=n[0],r=n[1],u=n[2],f=n[3],a=n[4],v=n[5],e=t[0],o=t[1],s=t[2],h=t[3],c=t[4],l=t[5];return n[0]=i*e+u*o,n[1]=r*e+f*o,n[2]=i*s+u*h,n[3]=r*s+f*h,n[4]=i*c+u*l+a,n[5]=r*c+f*l+v,n}function hl(n,t,i,r,u,f,e){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n[4]=f,n[5]=e,n}function bt(n,t){var i=t[0],r=t[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function cl(n,t,i){return ph(n,hl(pv,t,0,0,i,0,0))}function wr(n,t,i,r,u,f,e,o){var s=Math.sin(f),h=Math.cos(f);return n[0]=r*h,n[1]=u*s,n[2]=-r*s,n[3]=u*h,n[4]=e*r*h-o*r*s+t,n[5]=e*u*s+o*u*h+i,n}function ll(n,t){var r,i=(r=t)[0]*r[3]-r[1]*r[2];p(0!==i,32);var u=t[0],f=t[1],e=t[2],o=t[3],s=t[4],h=t[5];return n[0]=o/i,n[1]=-f/i,n[2]=-e/i,n[3]=u/i,n[4]=(e*h-o*s)/i,n[5]=-(u*h-f*s)/i,n}function kit(n){return"matrix("+n.join(", ")+")"}function nb(n){var t;return n==l.XY?t=2:n==l.XYZ||n==l.XYM?t=3:n==l.XYZM&&(t=4),t}function git(n,t,i,r){for(var u,f,e=0,o=n[i-r],s=n[i-r+1];t<i;t+=r)u=n[t],f=n[t+1],e+=s*u-o*f,o=u,s=f;return e/2}function nrt(n,t,i,r){for(var f,e=0,u=0,o=i.length;u<o;++u)f=i[u],e+=git(n,t,f,r),t=f;return e}function trt(n,t,i,r,u,f,e){var s,a=n[t],v=n[t+1],h=n[i]-a,c=n[i+1]-v,l,o;if(0===h&&0===c)s=t;else if(l=((u-a)*h+(f-v)*c)/(h*h+c*c),l>1)s=i;else{if(l>0){for(o=0;o<r;++o)e[o]=ch(n[t+o],n[i+o],l);return void(e.length=r)}s=t}for(o=0;o<r;++o)e[o]=n[s+o];e.length=r}function tb(n,t,i,r,u){var f=n[t],e=n[t+1];for(t+=r;t<i;t+=r){var o=n[t],s=n[t+1],h=is(f,e,o,s);h>u&&(u=h);f=o;e=s}return u}function ib(n,t,i,r,u){for(var e,f=0,o=i.length;f<o;++f)e=i[f],u=tb(n,t,e,r,u),t=e;return u}function rb(n,t,i,r,u,f,e,o,s,h,c){var l,v,a,y;if(t==i)return h;if(0===u){if((v=is(e,o,n[t],n[t+1]))<h){for(l=0;l<r;++l)s[l]=n[t+l];return s.length=r,v}return h}for(a=c||[NaN,NaN],y=t+r;y<i;)if(trt(n,y-r,y,r,e,o,a),(v=is(e,o,a[0],a[1]))<h){for(h=v,l=0;l<r;++l)s[l]=a[l];s.length=r;y+=r}else y+=r*Math.max((Math.sqrt(v)-Math.sqrt(h))/u|0,1);if(f&&(trt(n,i-r,t,r,e,o,a),(v=is(e,o,a[0],a[1]))<h)){for(h=v,l=0;l<r;++l)s[l]=a[l];s.length=r}return h}function ub(n,t,i,r,u,f,e,o,s,h,c){for(var a,v=c||[NaN,NaN],l=0,y=i.length;l<y;++l)a=i[l],h=rb(n,t,a,r,u,f,e,o,s,h,v),t=a;return h}function irt(n,t,i){for(var r=0,u=i.length;r<u;++r)n[t++]=i[r];return t}function al(n,t,i,r){for(var o,f,u=0,e=i.length;u<e;++u)for(o=i[u],f=0;f<r;++f)n[t++]=o[f];return t}function fb(n,t,i,r,u){for(var o,f=u||[],s=0,e=0,h=i.length;e<h;++e)o=al(n,t,i[e],r),f[s++]=o,t=o;return f.length=s,f}function wh(n,t,i,r,u){for(var e=void 0!==u?u:[],o=0,f=t;f<i;f+=r)e[o++]=n.slice(f,f+r);return e.length=o,e}function wv(n,t,i,r,u){for(var s,f=void 0!==u?u:[],e=0,o=0,h=i.length;o<h;++o)s=i[o],f[e++]=wh(n,t,s,r,f[e]),t=s;return f.length=e,f}function rrt(n,t,i,r,u){for(var e,f=void 0!==u?u:[],o=0,s=0,h=i.length;s<h;++s)e=i[s],f[o++]=wv(n,t,e,r,f[o]),t=e[e.length-1];return f.length=o,f}function eb(n,t,i,r,u,f,e){var v=(i-t)/r,c,h,s,p;if(v<3){for(;t<i;t+=r)f[e++]=n[t],f[e++]=n[t+1];return e}for(c=new Array(v),c[0]=1,c[v-1]=1,h=[t,i-r],s=0;h.length>0;){for(var l=h.pop(),a=h.pop(),y=0,w=n[a],b=n[a+1],k=n[l],d=n[l+1],o=a+r;o<l;o+=r)p=oit(n[o],n[o+1],w,b,k,d),p>y&&(s=o,y=p);y>u&&(c[(s-t)/r]=1,a+r<s&&h.push(a,s),s+r<l&&h.push(s,l))}for(o=0;o<v;++o)c[o]&&(f[e++]=n[t+o*r],f[e++]=n[t+o*r+1]);return e}function ubt(n,t,i,r,u,f,e,o){for(var h,s=0,c=i.length;s<c;++s)h=i[s],e=eb(n,t,h,r,u,f,e),o.push(e),t=h;return e}function us(n,t){return t*Math.round(n/t)}function fbt(n,t,i,r,u,f,e){var o,s,h,c,v,y;if(t==i)return e;h=us(n[t],u);c=us(n[t+1],u);t+=r;f[e++]=h;f[e++]=c;do if(o=us(n[t],u),s=us(n[t+1],u),(t+=r)==i)return f[e++]=o,f[e++]=s,e;while(o==h&&s==c);for(;t<i;)if(v=us(n[t],u),y=us(n[t+1],u),t+=r,v!=o||y!=s){var l=o-h,a=s-c,p=v-h,w=y-c;l*w==a*p&&(l<0&&p<l||l==p||l>0&&p>l)&&(a<0&&w<a||a==w||a>0&&w>a)?(o=v,s=y):(f[e++]=o,f[e++]=s,h=o,c=s,o=v,s=y)}return f[e++]=o,f[e++]=s,e}function urt(n,t,i,r,u,f,e,o){for(var h,s=0,c=i.length;s<c;++s)h=i[s],e=fbt(n,t,h,r,u,f,e),o.push(e),t=h;return e}function sbt(n,t,i,r,u){return!rit(u,function(u){return!fs(n,t,i,r,u[0],u[1])})}function fs(n,t,i,r,u,f){for(var h,o,c=0,s=n[i-r],e=n[i-r+1];t<i;t+=r)h=n[t],o=n[t+1],e<=f?o>f&&(h-s)*(f-e)-(u-s)*(o-e)>0&&c++:o<=f&&(h-s)*(f-e)-(u-s)*(o-e)<0&&c--,s=h,e=o;return 0!==c}function ob(n,t,i,r,u,f){if(0===i.length||!fs(n,t,i[0],r,u,f))return!1;for(var e=1,o=i.length;e<o;++e)if(fs(n,i[e-1],i[e],r,u,f))return!1;return!0}function sb(n,t,i,r,u,f,e){for(var b,a,p,d,o,g,w,s,c,l,v,h=u[f+1],y=[],k=0,nt=i.length;k<nt;++k)for(b=i[k],s=n[b-r],l=n[b-r+1],o=t;o<b;o+=r)c=n[o],v=n[o+1],(h<=l&&v<=h||l<=h&&h<=v)&&(w=(h-l)/(v-l)*(c-s)+s,y.push(w)),s=c,l=v;for(a=NaN,p=-1/0,y.sort(we),s=y[0],o=1,g=y.length;o<g;++o)c=y[o],d=Math.abs(c-s),d>p&&ob(n,t,i,r,w=(s+c)/2,h)&&(a=w,p=d),s=c;return isNaN(a)&&(a=u[f]),e?(e.push(a,h,p),e):[a,h,p]}function frt(n,t,i,r,u){for(var e,o=[],f=0,s=i.length;f<s;++f)e=i[f],o=sb(n,t,e,r,u,2*f,o),t=e[e.length-1];return o}function ert(n,t,i,r,u){for(var o,e=[n[t],n[t+1]],f=[];t+r<i;t+=r){if(f[0]=n[t+r],f[1]=n[t+r+1],o=u(e,f))return o;e[0]=f[0];e[1]=f[1]}return!1}function bv(n,t,i,r,u){var f=iit([1/0,1/0,-1/0,-1/0],n,t,i,r);return!!fi(u,f)&&(!!tr(u,f)||f[0]>=u[0]&&f[2]<=u[2]||f[1]>=u[1]&&f[3]<=u[3]||ert(n,t,i,r,function(n,t){return function(n,t,i){var r=!1,u=aw(n,t),f=aw(n,i);if(u===nr.INTERSECTING||f===nr.INTERSECTING)r=!0;else{var l=n[0],a=n[1],v=n[2],y=n[3],p=t[0],w=t[1],e=i[0],o=i[1],s=(o-w)/(e-p),h=void 0,c=void 0;f&nr.ABOVE&&!(u&nr.ABOVE)&&(r=(h=e-(o-y)/s)>=l&&h<=v);r||!(f&nr.RIGHT)||u&nr.RIGHT||(r=(c=o-(e-v)*s)>=a&&c<=y);r||!(f&nr.BELOW)||u&nr.BELOW||(r=(h=e-(o-a)/s)>=l&&h<=v);r||!(f&nr.LEFT)||u&nr.LEFT||(r=(c=o-(e-l)*s)>=a&&c<=y)}return r}(u,n,t)}))}function ort(n,t,i,r,u){if(!function(n,t,i,r,u){return!!bv(n,t,i,r,u)||!!fs(n,t,i,r,u[0],u[1])||!!fs(n,t,i,r,u[0],u[3])||!!fs(n,t,i,r,u[2],u[1])||!!fs(n,t,i,r,u[2],u[3])}(n,t,i[0],r,u))return!1;if(1===i.length)return!0;for(var f=1,e=i.length;f<e;++f)if(sbt(n,i[f-1],i[f],r,u)&&!bv(n,i[f-1],i[f],r,u))return!1;return!0}function hbt(n,t,i,r){for(var u,f;t<i-r;){for(u=0;u<r;++u)f=n[t+u],n[t+u]=n[i-r+u],n[i-r+u]=f;t+=r;i-=r}}function kv(n,t,i,r){for(var u,f,e=0,o=n[i-r],s=n[i-r+1];t<i;t+=r)u=n[t],f=n[t+1],e+=(u-o)*(f+s),o=u,s=f;return e>0}function srt(n,t,i,r,u){for(var s,f,e=void 0!==u&&u,o=0,h=i.length;o<h;++o){if(s=i[o],f=kv(n,t,s,r),0===o){if(e&&f||!e&&!f)return!1}else if(e&&!f||!e&&f)return!1;t=s}return!0}function hb(n,t,i,r,u){for(var s,f,e=void 0!==u&&u,o=0,h=i.length;o<h;++o)s=i[o],f=kv(n,t,s,r),(0===o?e&&f||!e&&!f:e&&!f||!e&&f)&&hbt(n,t,s,r),t=s;return t}function hrt(n,t,i,r,u){for(var f=0,e=i.length;f<e;++f)t=hb(n,t,i[f],r,u);return t}function crt(n,t,i,r){for(var e=i||32,u=[],f=0;f<e;++f)pt(u,pwt(n,t,2*Math.PI*f/e,r));return u.push(u[0],u[1]),new dv(u,l.XY,[u.length])}function es(n){var t=n[0],i=n[1],r=n[2],u=n[3],f=[t,i,t,u,r,u,r,i,t,i];return new dv(f,l.XY,[f.length])}function cb(n,t,i){for(var f,c,o,l=t||32,e=n.getStride(),a=n.getLayout(),s=n.getCenter(),h=e*(l+1),r=new Array(h),u=0;u<h;u+=e)for(r[u]=0,r[u+1]=0,f=2;f<e;f++)r[u+f]=s[f];return c=[r.length],o=new dv(r,a,c),lrt(o,s,n.getRadius(),i),o}function lrt(n,t,i,r){for(var o,s,f=n.getFlatCoordinates(),h=n.getStride(),e=f.length/h-1,c=r||0,u=0;u<=e;++u)o=u*h,s=c+2*pu(u,e)*Math.PI/e,f[o]=t[0]+i*Math.cos(s),f[o+1]=t[1]+i*Math.sin(s);n.changed()}function grt(n,t,i){return function(r,u,f,e){if(r){var a=t?0:f[0]*u,v=t?0:f[1]*u,s=n[0]+a/2,h=n[2]-a/2,c=n[1]+v/2,l=n[3]-v/2;s>h&&(h=s=(h+s)/2);c>l&&(l=c=(l+c)/2);var y=kt(r[0],s,h),p=kt(r[1],c,l),o=30*u;return e&&i&&(y+=-o*Math.log(1+Math.max(0,s-r[0])/o)+o*Math.log(1+Math.max(0,r[0]-h)/o),p+=-o*Math.log(1+Math.max(0,c-r[1])/o)+o*Math.log(1+Math.max(0,r[1]-l)/o)),[y,p]}}}function okt(n){return n}function lb(n,t,i){var r=vt(t)/i[0],u=ni(t)/i[1];return Math.min(n,Math.min(r,u))}function ab(n,t,i){var r=Math.min(n,t);return r*=Math.log(1+50*Math.max(0,n/t-1))/50+1,i&&(r=Math.max(r,i),r/=Math.log(1+50*Math.max(0,i/n-1))/50+1),kt(r,i/2,2*t)}function nut(n,t,i,r){return function(u,f,e,o){if(void 0!==u){var s=r?lb(n,r,e):n;return(void 0===i||i)&&o?ab(u,s,t):kt(u,t,s)}}}function vb(n){if(void 0!==n)return 0}function tut(n){if(void 0!==n)return n}function os(n,t,i){var r=void 0!==i?n.toFixed(i):""+n,u=r.indexOf(".");return(u=-1===u?r.length:u)>t?r:new Array(1+t-u).join("0")+r}function iut(n,t){for(var r,u,f=(""+n).split("."),e=(""+t).split("."),i=0;i<Math.max(f.length,e.length);i++){if(r=parseInt(f[i]||"0",10),u=parseInt(e[i]||"0",10),r>u)return 1;if(u>r)return-1}return 0}function pb(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function iy(n,t){var u,f,v=n[0],y=n[1],h=t[0],c=t[1],e=h[0],o=h[1],l=c[0],a=c[1],i=l-e,r=a-o,s=0===i&&0===r?0:(i*(v-e)+r*(y-o))/(i*i+r*r||0);return s<=0?(u=e,f=o):s>=1?(u=l,f=a):(u=e+s*i,f=o+s*r),[u,f]}function ry(n,t,i){var e=pu(t+180,360)-180,o=Math.abs(3600*e),s=i||0,h=Math.pow(10,s),u=Math.floor(o/3600),r=Math.floor((o-3600*u)/60),f=o-3600*u-60*r;return(f=Math.ceil(f*h)/h)>=60&&(f=0,r+=1),r>=60&&(r=0,u+=1),u+" "+os(r,2)+" "+os(f,2,s)+""+(0==e?"":" "+n.charAt(e<0?1:0))}function rut(n,t,i){return n?t.replace("{x}",n[0].toFixed(i)).replace("{y}",n[1].toFixed(i)):""}function ef(n,t){for(var r=!0,i=n.length-1;i>=0;--i)if(n[i]!=t[i]){r=!1;break}return r}function uy(n,t){var i=Math.cos(t),r=Math.sin(t),u=n[0]*i-n[1]*r,f=n[1]*i+n[0]*r;return n[0]=u,n[1]=f,n}function uut(n,t){return n[0]*=t,n[1]*=t,n}function eu(n,t){var i=n[0]-t[0],r=n[1]-t[1];return i*i+r*r}function fy(n,t){return Math.sqrt(eu(n,t))}function ey(n,t){return eu(n,iy(n,t))}function fut(n,t){return rut(n,"{x}, {y}",t)}function wb(n){return Math.pow(n,3)}function uo(n){return 1-wb(1-n)}function oy(n){return 3*n*n-2*n*n*n}function eut(n){return n}function hy(n,t){setTimeout(function(){n(t)},0)}function skt(n){return!(n.sourceCenter&&n.targetCenter&&!ef(n.sourceCenter,n.targetCenter))&&n.sourceResolution===n.targetResolution&&n.sourceRotation===n.targetRotation}function ci(n,t){var i=document.createElement("canvas");return n&&(i.width=n),t&&(i.height=t),i.getContext("2d")}function hkt(n){var i=n.offsetWidth,t=getComputedStyle(n);return i+(parseInt(t.marginLeft,10)+parseInt(t.marginRight,10))}function ckt(n){var i=n.offsetHeight,t=getComputedStyle(n);return i+(parseInt(t.marginTop,10)+parseInt(t.marginBottom,10))}function nc(n,t){var i=t.parentNode;i&&i.replaceChild(n,t)}function cy(n){return n&&n.parentNode?n.parentNode.removeChild(n):null}function sut(n){for(;n.lastChild;)n.removeChild(n.lastChild)}function cut(n,t,i){return void 0===i&&(i=[0,0]),i[0]=n[0]+2*t,i[1]=n[1]+2*t,i}function gb(n,t,i){return void 0===i&&(i=[0,0]),i[0]=n[0]*t+.5|0,i[1]=n[1]*t+.5|0,i}function hr(n,t){return Array.isArray(n)?n:(void 0===t?t=[n,n]:(t[0]=n,t[1]=n),t)}function nk(n,t){n.style.msTouchAction=t;n.style.touchAction=t;n.setAttribute("touch-action",t)}function yy(n,t){var i,r;return n.visible?(i=t.resolution,i<n.minResolution||i>=n.maxResolution)?!1:(r=t.zoom,r>n.minZoom&&r<=n.maxZoom):!1}function vut(n){this.updateElement_(n.frameState)}function put(n){var r=n.frameState,t,u,i;r&&(t=r.viewState.rotation,t!=this.rotation_&&(u="rotate("+t+"rad)",this.autoHide_&&(i=this.element.classList.contains(ay),i||0!==t?i&&0!==t&&this.element.classList.remove(ay):this.element.classList.add(ay)),this.label_.style.transform=u),this.rotation_=t)}function kut(n){var t=n||{},i=new gi;return(void 0===t.zoom||t.zoom)&&i.push(new but(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&i.push(new wut(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&i.push(new ik(t.attributionOptions)),i}function rk(n,t,i,r){var u=n.getZoom(),f,e;void 0!==u&&(f=n.getConstrainedZoom(u+t),e=n.getResolutionForZoom(f),n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:e,anchor:i,duration:void 0!==r?r:250,easing:uo}))}function dkt(n){var t=!1;if(n.type==st.DBLCLICK){var i=n.originalEvent,r=n.map,u=n.coordinate,f=i.shiftKey?-this.delta_:this.delta_;rk(r.getView(),f,u,this.duration_);n.preventDefault();t=!0}return!t}function hk(n){for(var i=n.length,r=0,u=0,t=0;t<i;t++)r+=n[t].clientX,u+=n[t].clientY;return[r/i,u/i]}function ndt(n){return py(n)&&sk(n)}function sdt(){var e,h,i=this.getMap(),n=i.getView(),r=i.getSize(),t=this.getGeometry().getExtent(),u,o,f,s;this.out_&&(u=n.calculateExtentInternal(r),o=(e=[i.getPixelFromCoordinateInternal(ne(t)),i.getPixelFromCoordinateInternal(de(t))],awt(oh(h),e)),il(u,1/n.getResolutionForExtentInternal(o,r)),t=u);f=n.getConstrainedResolution(n.getResolutionForExtentInternal(t,r));s=n.getConstrainedCenter(vr(t),f);n.animateInternal({resolution:f,center:s,duration:this.duration_,easing:uo})}function cdt(n){var o=!1,t,e;if(n.type==a.KEYDOWN&&(t=n.originalEvent.keyCode,this.condition_(n)&&(t==cs.DOWN||t==cs.LEFT||t==cs.RIGHT||t==cs.UP))){var r=n.map.getView(),i=r.getResolution()*this.pixelDelta_,u=0,f=0;t==cs.DOWN?f=-i:t==cs.LEFT?u=-i:t==cs.RIGHT?u=i:f=i;e=[u,f];uy(e,r.getRotation()),function(n,t,i){var r=n.getCenterInternal(),u;r&&(u=[r[0]+t[0],r[1]+t[1]],n.animateInternal({duration:void 0!==i?i:250,easing:eut,center:n.getConstrainedCenter(u)}))}(r,e,this.duration_);n.preventDefault();o=!0}return!o}function ldt(n){var i=!1,t,r,u;return(n.type==a.KEYDOWN||n.type==a.KEYPRESS)&&(t=n.originalEvent.charCode,this.condition_(n)&&(t=="+".charCodeAt(0)||t=="-".charCodeAt(0))&&(r=n.map,u=t=="+".charCodeAt(0)?this.delta_:-this.delta_,rk(r.getView(),u,void 0,this.duration_),n.preventDefault(),i=!0)),!i}function wft(n){var t=n||{},i=new gi,r=new vrt(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&i.push(new eft),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&i.push(new nft({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&i.push(new fft({condition:t.onFocusOnly?uk:void 0,kinetic:r})),(void 0===t.pinchRotate||t.pinchRotate)&&i.push(new yft),(void 0===t.pinchZoom||t.pinchZoom)&&i.push(new pft({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(i.push(new lk),i.push(new lft({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&i.push(new vft({condition:t.onFocusOnly?uk:void 0,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&i.push(new hft({duration:t.zoomDuration})),i}function kft(n){return"string"==typeof n?n:net(n)}function ddt(n){var t=document.createElement("div"),i;return(t.style.color=n,""!==t.style.color)?(document.body.appendChild(t),i=getComputedStyle(t).color,document.body.removeChild(t),i):""}function wy(n){return Array.isArray(n)?n:dft(n)}function gft(n){return n[0]=kt(n[0]+.5|0,0,255),n[1]=kt(n[1]+.5|0,0,255),n[2]=kt(n[2]+.5|0,0,255),n[3]=kt(n[3],0,1),n}function net(n){var r=n[0],t,i;return r!=(0|r)&&(r=r+.5|0),t=n[1],t!=(0|t)&&(t=t+.5|0),i=n[2],i!=(0|i)&&(i=i+.5|0),"rgba("+r+","+t+","+i+","+(void 0===n[3]?1:n[3])+")"}function iet(n,t,i){return t+":"+n+":"+(i?kft(i):"null")}function bu(n){return Array.isArray(n)?net(n):n}function fet(){return ky||(ky=ci(1,1)),ky}function oet(n,t){var i=fet();return n!=ak&&(i.font=n,ak=i.font),i.measureText(t).width}function set(n,t,i){if(t in i)return i[t];var r=oet(n,t);return i[t]=r,r}function het(n,t,i,r){0!==t&&(n.translate(i,r),n.rotate(t),n.translate(-i,-r))}function aet(n,t,i,r,u,f,e,o,s,h,c){var l;1!=i&&(l=n.globalAlpha,n.globalAlpha=l*i);t&&n.setTransform.apply(n,t);n.drawImage(r,u,f,e,o,s,h,e*c,o*c);1!=i&&(n.globalAlpha=l);t&&n.setTransform.apply(n,cet)}function egt(n,t){return parseInt(v(n),10)-parseInt(v(t),10)}function wk(n,t){var i=yet(n,t);return i*i}function yet(n,t){return fgt*n/t}function dy(n,t,i,r,u,e){var h=!1,o=i.getImage(),s;return o&&(s=o.getImageState(),s==et.LOADED||s==et.ERROR?o.unlistenImageChange(u):(s==et.IDLE&&o.load(),s=o.getImageState(),o.listenImageChange(u),h=!0)),function(n,t,i,r,u){var o=i.getGeometryFunction()(t),e;o&&(e=o.simplifyTransformed(r,u),i.getRenderer()?!function n(t,i,r,u){var s;if(i.getType()==f.GEOMETRY_COLLECTION){for(var o=i.getGeometries(),e=0,h=o.length;e<h;++e)n(t,o[e],r,u);return}s=t.getBuilder(r.getZIndex(),lt.DEFAULT);s.drawCustom(i,u,r.getRenderer())}(n,e,i,t):vet[e.getType()](n,e,i,t))}(n,t,i,r,e),h}function pet(n,t){var r,u;for(t&&t.clear(),r=n.declutterItems,u=r.length-1;u>=0;--u)for(var e=r[u],f=e.items,i=0,o=f.length;i<o;i+=3)t=f[i].renderDeclutter(f[i+1],f[i+2],e.opacity,t);return r.length=0,t}function ogt(){tc.expire()}function det(n,t,i,r){return function(u,f,e){var o=new XMLHttpRequest;o.open("GET","function"==typeof n?n(u,f,e):n,!0);t.getType()==ue.ARRAY_BUFFER&&(o.responseType="arraybuffer");o.withCredentials=ket;o.onload=function(){if(!o.status||o.status>=200&&o.status<300){var f=t.getType(),n=void 0;f==ue.JSON||f==ue.TEXT?n=o.responseText:f==ue.XML?(n=o.responseXML)||(n=(new DOMParser).parseFromString(o.responseText,"application/xml")):f==ue.ARRAY_BUFFER&&(n=o.response);n?i.call(this,t.readFeatures(n,{extent:u,featureProjection:e}),t.readProjection(n)):r.call(this)}else r.call(this)}.bind(this);o.onerror=function(){r.call(this)}.bind(this);o.send()}}function kk(n,t){return det(n,t,function(n){"function"==typeof this.addFeatures&&this.addFeatures(n)},gf)}function get(){return[[-1/0,-1/0,1/0,1/0]]}function not(n){return[n]}function gk(n,t,i,r,u){return void 0!==u?(u.minX=n,u.maxX=t,u.minY=i,u.maxY=r,u):new dk(n,t,i,r)}function td(n,t,i,r){return void 0!==r?(r[0]=n,r[1]=t,r[2]=i,r):[n,t,i]}function fo(n,t,i){return n+"/"+t+"/"+i}function gy(n){return fo(n[0],n[1],n[2])}function id(n){return(n[1]<<n[0])+n[2]}function iot(n){var t=n.getDefaultTileGrid();return t||(t=uot(n),n.setDefaultTileGrid(t)),t}function rc(n){var t=n||{},i=t.extent||y("EPSG:3857").getExtent(),r={extent:i,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:rot(i,t.maxZoom,t.tileSize)};return new ls(r)}function rot(n,t,i){for(var o=void 0!==t?t:ekt,s=ni(n),h=vt(n),u=hr(void 0!==i?i:gh),c=Math.max(h/u[0],s/u[1]),f=o+1,e=new Array(f),r=0;r<f;++r)e[r]=c/Math.pow(2,r);return e}function uot(n,t,i,r){return function(n,t,i,r){var u=void 0!==r?r:nl.TOP_LEFT,f=rot(n,t,i);return new ls({extent:n,origin:ywt(n,u),resolutions:f,tileSize:i})}(as(n),t,i,r)}function as(n){var i=(n=y(n)).getExtent(),t;return i||(t=180*cu[lu.DEGREES]/n.getMetersPerUnit(),i=ru(-t,-t,t,t)),i}function eot(n,t){for(var r,u=fot.length,i=0;i<u;++i)try{if(r=n.getContext(fot[i],t),r)return r}catch(n){}return null}function rt(n,t){return vs.createElementNS(n,t)}function ar(n,t){return function n(t,i,r){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)i?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else for(var u=void 0,u=t.firstChild;u;u=u.nextSibling)n(u,i,r);return r}(n,t,[]).join("")}function lf(n){return"documentElement"in n}function ku(n){return(new DOMParser).parseFromString(n,"application/xml")}function oot(n,t){return function(i,r){var u=n.call(void 0!==t?t:this,i,r);void 0!==u&&pt(r[r.length-1],u)}}function b(n,t){return function(i,r){var u=n.call(void 0!==t?t:this,i,r);void 0!==u&&r[r.length-1].push(u)}}function tt(n,t){return function(i,r){var u=n.call(void 0!==t?t:this,i,r);void 0!==u&&(r[r.length-1]=u)}}function ti(n,t,i){return function(r,u){var s=n.call(void 0!==i?i:this,r,u);if(void 0!==s){var e=u[u.length-1],o=void 0!==t?t:r.localName,f=void 0;o in e?f=e[o]:(f=[],e[o]=f);f.push(s)}}}function u(n,t,i){return function(r,u){var f=n.call(void 0!==i?i:this,r,u);void 0!==f&&(u[u.length-1][void 0!==t?t:r.localName]=f)}}function e(n,t){return function(i,r,u){n.call(void 0!==t?t:this,i,r,u);u[u.length-1].node.appendChild(i)}}function sot(n){var t,i;return function(r,u,f){if(void 0===t){t={};var e={};e[r.localName]=n;t[r.namespaceURI]=e;i=gt(r.localName)}hot(t,i,u,f)}}function gt(n,t){var i=n;return function(n,r,u){var e=r[r.length-1].node,f=i;return void 0===f&&(f=u),rt(void 0!==t?t:e.namespaceURI,f)}}function su(n,t){for(var r=t.length,u=new Array(r),i=0;i<r;++i)u[i]=n[t[i]];return u}function o(n,t,i){for(var f=void 0!==i?i:{},r=0,u=n.length;r<u;++r)f[n[r]]=t;return f}function kr(n,t,i,r){for(var f,e,u=t.firstElementChild;u;u=u.nextElementSibling)f=n[u.namespaceURI],void 0!==f&&(e=f[u.localName],void 0!==e&&e.call(r,u,i))}function s(n,t,i,r,u){return r.push(n),kr(t,i,r,u),r.pop()}function hot(n,t,i,r,u,f){for(var s,e,h=(void 0!==u?u:i).length,o=0;o<h;++o)void 0!==(s=i[o])&&void 0!==(e=t.call(void 0!==f?f:this,s,r,void 0!==u?u[o]:void 0))&&n[e.namespaceURI][e.localName].call(f,e,s,r)}function it(n,t,i,r,u,f,e){return u.push(n),hot(t,i,r,u,f,e),u.pop()}function ud(n){switch(n){case kl:return Float32Array;case np:return Uint32Array;default:return Float32Array}}function fd(n,t){return n[0]=t[0],n[1]=t[1],n[4]=t[2],n[5]=t[3],n[12]=t[4],n[13]=t[5],n}function lot(n){for(var r,i=0,t=0;t<n.length;t++)r=n[t],i+=r.size*aot(r.type);return i}function aot(n){switch(n){case du.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case du.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case du.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case du.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}function wot(n,t,i){var u=[],f=[],r=[],e=[],o=[],s=void 0!==i?i:[],h=n.SupportedCRS,c=y(h.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||y(h),l=c.getMetersPerUnit(),a="ne"==c.getAxisOrientation().substr(0,2);return n.TileMatrix.sort(function(n,t){return t.ScaleDenominator-n.ScaleDenominator}),n.TileMatrix.forEach(function(t){if(!(s.length>0)||gc(s,function(i){return t.Identifier==i.TileMatrix||-1===t.Identifier.indexOf(":")&&n.Identifier+":"+t.Identifier===i.TileMatrix})){f.push(t.Identifier);var c=.00028*t.ScaleDenominator/l,i=t.TileWidth,h=t.TileHeight;a?r.push([t.TopLeftCorner[1],t.TopLeftCorner[0]]):r.push(t.TopLeftCorner);u.push(c);e.push(i==h?i:[i,h]);o.push([t.MatrixWidth,t.MatrixHeight])}}),new pot({extent:t,origins:r,resolutions:u,matrixIds:f,tileSizes:e,sizes:o})}function cd(n,t,i){var r=n,f,u,e;return r.src&&wrt?(f=r.decode(),u=!0,f.then(function(){u&&t()}).catch(function(n){u&&("EncodingError"===n.name&&"Invalid image type."===n.message?t():i())}),function(){u=!1}):(e=[fh(r,a.LOAD,t),fh(r,a.ERROR,i)],function(){e.forEach(ct)})}function unt(){if(!ld){var n=new vf({color:"rgba(255,255,255,0.4)"}),t=new gu({color:"#3399CC",width:1.25});ld=[new fc({image:new sd({fill:n,stroke:t,radius:5}),fill:n,stroke:t})]}return ld}function ta(){var n={},t=[255,255,255,1],i=[0,153,255,1];return n[f.POLYGON]=[new fc({fill:new vf({color:[255,255,255,.5]})})],n[f.MULTI_POLYGON]=n[f.POLYGON],n[f.LINE_STRING]=[new fc({stroke:new gu({color:t,width:5})}),new fc({stroke:new gu({color:i,width:3})})],n[f.MULTI_LINE_STRING]=n[f.LINE_STRING],n[f.CIRCLE]=n[f.POLYGON].concat(n[f.LINE_STRING]),n[f.POINT]=[new fc({image:new sd({radius:6,fill:new vf({color:i}),stroke:new gu({color:t,width:1.5})}),zIndex:1/0})],n[f.MULTI_POINT]=n[f.POINT],n[f.GEOMETRY_COLLECTION]=n[f.POLYGON].concat(n[f.LINE_STRING],n[f.POINT]),n}function kot(n){return n.getGeometry()}function ent(n,t){var i=/\{z\}/g,r=/\{x\}/g,u=/\{y\}/g,f=/\{-y\}/g;return function(e){if(e)return n.replace(i,e[0].toString()).replace(r,e[1].toString()).replace(u,e[2].toString()).replace(f,function(){var i=e[0],n=t.getFullTileRange(i);return p(n,55),(n.getHeight()-e[2]-1).toString()})}}function ad(n,t){for(var r=n.length,u=new Array(r),i=0;i<r;++i)u[i]=ent(n[i],t);return ra(u)}function ra(n){return 1===n.length?n[0]:function(t,i,r){if(t){var u=pu(id(t),n.length);return n[u](t,i,r)}}}function vd(){}function yd(n){var i=[],t=/\{([a-z])-([a-z])\}/.exec(n),f,u;if(t){for(var e=t[1].charCodeAt(0),o=t[2].charCodeAt(0),r=void 0,r=e;r<=o;++r)i.push(n.replace(t[0],String.fromCharCode(r)));return i}if(t=/\{(\d+)-(\d+)\}/.exec(n)){for(f=parseInt(t[2],10),u=parseInt(t[1],10);u<=f;u++)i.push(n.replace(t[0],u.toString()));return i}return i.push(n),i}function rp(n,t,i,r){function e(){delete window[f];u.parentNode.removeChild(u)}var u=document.createElement("script"),f="olc_"+v(t),o;u.async=!0;u.src=n+(-1==n.indexOf("?")?"?":"&")+(r||"callback")+"="+f;o=setTimeout(function(){e();i&&i()},1e4);window[f]=function(n){clearTimeout(o);e();t(n)};document.getElementsByTagName("head")[0].appendChild(u)}function nst(){var n=ci(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}function up(n,t,i,r){var s=to(i,t,n),u=av(t,r,i),h=t.getMetersPerUnit(),e,o,f;return void 0!==h&&(u*=h),e=n.getMetersPerUnit(),void 0!==e&&(u/=e),o=n.getExtent(),(!o||fv(o,s))&&(f=av(n,u,s)/u,isFinite(f)&&f>0&&(u/=f)),u}function pd(n,t,i,r){var u=i-n,f=r-t,e=Math.sqrt(u*u+f*f);return[Math.round(i+u/e),Math.round(r+f/e)]}function rst(n,t,i,r,u,f,e,o,s,h,c){var l=ci(Math.round(i*n),Math.round(i*t)),v,a;if(0===s.length)return l.canvas;l.scale(i,i);v=[1/0,1/0,-1/0,-1/0];s.forEach(function(n){ov(v,n.extent)});var w=vt(v),b=ni(v),p=ci(Math.round(i*w/r),Math.round(i*b/r)),y=i/r;return s.forEach(function(n){var t=n.extent[0]-v[0],i=-(n.extent[3]-v[3]),r=vt(n.extent),u=ni(n.extent);p.drawImage(n.image,h,h,n.image.width-2*h,n.image.height-2*h,t*y,i*y,r*y,u*y)}),a=yr(e),o.getTriangles().forEach(function(n){var t=n.source,u=n.target,nt=t[0][0],tt=t[0][1],it=t[1][0],rt=t[1][1],ut=t[2][0],ft=t[2][1],o=(u[0][0]-a[0])/f,s=-(u[0][1]-a[1])/f,h=(u[1][0]-a[0])/f,c=-(u[1][1]-a[1])/f,y=(u[2][0]-a[0])/f,w=-(u[2][1]-a[1])/f,b=nt,k=tt,e;if(nt=0,tt=0,e=function(n){for(var l,a,f,v,u,s,i,e,r=n.length,t=0;t<r;t++){for(var h=t,c=Math.abs(n[t][t]),o=t+1;o<r;o++)l=Math.abs(n[o][t]),l>c&&(c=l,h=o);if(0===c)return null;for(a=n[h],n[h]=n[t],n[t]=a,f=t+1;f<r;f++)for(v=-n[f][t]/n[t][t],u=t;u<r+1;u++)t==u?n[f][u]=0:n[f][u]+=v*n[t][u]}for(s=new Array(r),i=r-1;i>=0;i--)for(s[i]=n[i][r]/n[i][i],e=i-1;e>=0;e--)n[e][r]-=n[e][i]*s[i];return s}([[it-=b,rt-=k,0,0,h-o],[ut-=b,ft-=k,0,0,y-o],[0,0,it,rt,c-s],[0,0,ut,ft,w-s]]),e){l.save();l.beginPath();var d=(o+h+y)/3,g=(s+c+w)/3,et=pd(d,g,o,s),ot=pd(d,g,h,c),st=pd(d,g,y,w);l.moveTo(ot[0],ot[1]);l.lineTo(et[0],et[1]);l.lineTo(st[0],st[1]);l.clip();l.transform(e[0],e[2],e[1],e[3],o,s);l.translate(v[0]-b,v[3]-k);l.scale(r/i,-r/i);l.drawImage(p.canvas,0,0);l.restore()}}),c&&(l.save(),l.strokeStyle="black",l.lineWidth=1,o.getTriangles().forEach(function(n){var t=n.target,i=(t[0][0]-a[0])/f,r=-(t[0][1]-a[1])/f,u=(t[1][0]-a[0])/f,e=-(t[1][1]-a[1])/f,o=(t[2][0]-a[0])/f,s=-(t[2][1]-a[1])/f;l.beginPath();l.moveTo(u,e);l.lineTo(i,r);l.lineTo(o,s);l.closePath();l.stroke()}),l.restore()),l.canvas}function fst(n){return n?Array.isArray(n)?function(){return n}:"function"==typeof n?n:function(){return[n]}:null}function nti(n,t){n.getImage().src=t}function ea(n){return n.toLocaleString("en",{maximumFractionDigits:10})}function sp(n,t){n.getImage().src=t}function oe(n,t){var i=[],r;return Object.keys(t).forEach(function(n){null!==t[n]&&void 0!==t[n]&&i.push(n+"="+encodeURIComponent(t[n]))}),r=i.join("&"),(n=-1===(n=n.replace(/[?&]$/,"")).indexOf("?")?n+"?":n+"&")+r}function tri(n,t){var f=n.getRenderer(),e;if(!f)throw new Error("Unsupported layer type: "+n);if(!f.prepareFrame(t))return null;var u,i=t.size[0],r=t.size[1],o=f.renderFrame(t,null);if(o&&(u=o.firstElementChild),!(u instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+u);return u.width===i&&u.height===r?u.getContext("2d").getImageData(0,0,i,r):(bs?(e=bs.canvas,e.width!==i||e.height!==r?bs=ci(i,r):bs.clearRect(0,0,i,r)):bs=ci(i,r),bs.drawImage(u,0,0,i,r),bs.getImageData(0,0,i,r))}function iri(n){var t;return n instanceof oc?n instanceof fp?t=new fht({source:n}):n instanceof ee&&(t=new iht({source:n})):t=n,t}function cri(n,t,i){var r=this.getTileGrid(),e,u,f;if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=n[0]))return 1==t||this.hidpi_||(t=1),e=r.getTileCoordExtent(n,this.tmpExtent_),u=hr(r.getTileSize(n[0]),this.tmpSize),1!=t&&(u=gb(u,t,this.tmpSize)),f={F:"image",FORMAT:"PNG32",TRANSPARENT:!0},d(f,this.params_),this.getRequestUrl_(n,u,e,t,i,f)}function bri(n,t,i){var r=this.getTileGrid(),o;if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=n[0])){1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);var s=r.getResolution(n[0]),f=r.getTileCoordExtent(n,this.tmpExtent_),u=hr(r.getTileSize(n[0]),this.tmpSize),e=this.gutter_;return 0!==e&&(u=cut(u,e,this.tmpSize),f=iu(f,s*e,f)),1!=t&&(u=gb(u,t,this.tmpSize)),o={SERVICE:"WMS",VERSION:oo,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},d(o,this.params_),this.getRequestUrl_(n,u,f,t,i,o)}}function eui(n,t){var i=det(t,n.getFormat(),n.onLoad.bind(n),n.onError.bind(n));n.setLoader(i)}function lht(n){var i=this.requestEncoding_,t={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_},r,u;return i==so.KVP&&d(t,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),n=i==so.KVP?oe(n,t):n.replace(/\{(\w+?)\}/g,function(n,i){return i.toLowerCase()in t?t[i.toLowerCase()]:n}),r=this.tileGrid,u=this.dimensions_,function(t){var f,e;if(t)return f={TileMatrix:r.getMatrixId(t[0]),TileCol:t[1],TileRow:t[2]},d(f,u),e=n,i==so.KVP?oe(e,f):e.replace(/\{(\w+?)\}/g,function(n,t){return f[t]})}}function tfi(n,t,i,r,u){for(var c,h,l,b,a,k,e,o,d=i,g=i,v=0,s=0,y=i,p,w,f=i;f<r;f+=u)p=t[f],w=t[f+1],void 0!==l&&(e=p-l,o=w-b,h=Math.sqrt(e*e+o*o),void 0!==a&&(s+=c,Math.acos((a*e+k*o)/(c*h))>n&&(s>v&&(v=s,d=y,g=f),s=0,y=f-u)),c=h,a=e,k=o),l=p,b=w;return(s+=h)>v?[y,f]:[d,g]}function bht(n,t,i,r){for(var f,e,o=n[t],s=n[t+1],h=0,u=t+r;u<i;u+=r)f=n[u],e=n[u+1],h+=Math.sqrt((f-o)*(f-o)+(e-s)*(e-s)),o=f,s=e;return h}function ufi(n,t,i,r,u,f,e,o,s,h,c){for(var st,y,p,rt,g,l=[],ut=n[t]>n[i-r],ft=u.length,w=n[t],b=n[t+1],a=n[t+=r],v=n[t+1],nt=0,k=Math.sqrt(Math.pow(a-w,2)+Math.pow(v-b,2)),tt=!1,d=0;d<ft;++d){for(var et=u[rt=ut?ft-d-1:d],it=o*s(h,et,c),ot=f+it/2;t<i-r&&nt+k<ot;)w=a,b=v,a=n[t+=r],v=n[t+1],nt+=k,k=Math.sqrt(Math.pow(a-w,2)+Math.pow(v-b,2));if(st=ot-nt,y=Math.atan2(v-b,a-w),(ut&&(y+=y>0?-Math.PI:Math.PI),void 0!==g)&&(p=y-g,tt=tt||0!==p,p+=p>Math.PI?-2*Math.PI:p<-Math.PI?2*Math.PI:0,Math.abs(p)>e))return null;g=y;var ht=st/k,ct=ch(w,a,ht),lt=ch(b,v,ht);l[rt]=[ct,lt,it/2,y,et];f+=it}return tt?l:[[l[0][0],l[0][1],l[0][2],l[0][3],u]]}function co(n,t,i){var r,u=Math.floor(n.length/2);if(t>=u)for(r=u;r<t;r++)n[r][i]=!0;else if(t<u)for(r=t+1;r<u;r++)n[r][i]=!0}function kht(n,t,i,r,u,f){for(var e,a,c=Object.keys(n).map(Number).sort(we),o=0,v=c.length;o<v;++o)for(var s=n[c[o].toString()],l=void 0,h=0,y=s.length;h<y;)e=s[h++],e!==l&&(l=e,f.push({items:e.declutterItems,opacity:r})),a=s[h++],e.execute(t,a,i,u)}function dht(n,t,i,r,u,e,o){var b=ci(n[0]/2,n[1]/2),d,lt,p,et,h,a,g,nt,y,ot,w,st,yt,s,pt,tt,it,wt;b.imageSmoothingEnabled=!1;for(var ht=b.canvas,rt=new pk(b,.5,u,null,o),ct=i.length,bt=Math.ceil(16777216/ct),k={},c=0;c<ct;++c)if(d=i[c],lt=d.getStyleFunction()||r,r){p=lt(d,e);Array.isArray(p)||(p=[p]);for(var ut="#"+("000000"+(c*bt).toString(16)).slice(-6),l=0,ft=p.length;l<ft;++l){var at=p[l],v=at.clone(),vt=v.getFill();vt&&vt.setColor(ut);et=v.getStroke();et&&et.setColor(ut);v.setText(void 0);h=at.getImage();h&&(a=h.getImageSize(),g=document.createElement("canvas"),g.width=a[0],g.height=a[1],nt=g.getContext("2d",{alpha:!1}),nt.fillStyle=ut,y=nt.canvas,nt.fillRect(0,0,y.width,y.height),ci(a?a[0]:y.width,a?a[1]:y.height).drawImage(y,0,0),v.setImage(new ip({img:y,imgSize:a,anchor:h.getAnchor(),anchorXUnits:er.PIXELS,anchorYUnits:er.PIXELS,offset:h.getOrigin(),size:h.getSize(),opacity:h.getOpacity(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()})));ot=Number(v.getZIndex());(s=k[ot])||(s={},k[ot]=s,s[f.POLYGON]=[],s[f.CIRCLE]=[],s[f.LINE_STRING]=[],s[f.POINT]=[]);w=v.getGeometryFunction()(d);w&&fi(u,w.getExtent())&&s[w.getType().replace("Multi","")].push(w,v)}}for(st=Object.keys(k).map(Number).sort(we),yt=(c=0,st.length);c<yt;++c){s=k[st[c]];for(pt in s)for(tt=s[pt],l=0,ft=tt.length;l<ft;l+=2)for(rt.setStyle(tt[l+1]),it=0,wt=t.length;it<wt;++it)rt.setTransform(t[it]),rt.drawGeometry(tt[l])}return b.getImageData(0,0,ht.width,ht.height)}function ap(n,t,i){var u=[];if(i){var r=4*(Math.round(n[0]/2)+Math.round(n[1]/2)*i.width),o=i.data[r],s=i.data[r+1],f=i.data[r+2]+256*(s+256*o),e=Math.ceil(16777216/t.length);f%e==0&&u.push(t[f/e])}return u}function yp(n,t,i,r,u,f){var o=NaN,s=NaN,y=(i-t)/r,a,v,k,e,d,c;if(1===y)o=n[t],s=n[t+1];else if(2==y)o=(1-u)*n[t]+u*n[t+r],s=(1-u)*n[t+1]+u*n[t+r+1];else if(0!==y){for(var p=n[t],w=n[t+1],b=0,h=[0],l=t+r;l<i;l+=r)a=n[l],v=n[l+1],b+=Math.sqrt((a-p)*(a-p)+(v-w)*(v-w)),h.push(b),p=a,w=v;k=u*b;e=function(n,t,i){for(var u,e,s=i||we,r=0,f=n.length,o=!1;r<f;)(e=+s(n[u=r+(f-r>>1)],t))<0?r=u+1:(f=u,o=!e);return o?r:~r}(h,k);e<0?(d=(k-h[-e-2])/(h[-e-1]-h[-e-2]),c=t+(-e-2)*r,o=ch(n[c],n[c+r],d),s=ch(n[c+1],n[c+r+1],d)):(o=n[t+e*r],s=n[t+e*r+1])}return f?(f[0]=o,f[1]=s,f):[o,s]}function og(n,t,i,r,u,f){var o,e,h,c,l,a,s;if(i==t)return null;if(u<n[t+r-1])return f?((o=n.slice(t,t+r))[r-1]=u,o):null;if(n[i-1]<u)return f?((o=n.slice(i-r,i))[r-1]=u,o):null;if(u==n[t+r-1])return n.slice(t,t+r);for(e=t/r,h=i/r;e<h;)c=e+h>>1,u<n[(c+1)*r-1]?h=c:e=c+1;if(l=n[e*r-1],u==l)return n.slice((e-1)*r,(e-1)*r+r);for(a=(u-l)/(n[(e+1)*r-1]-l),o=[],s=0;s<r-1;++s)o.push(ch(n[(e-1)*r+s],n[e*r+s],a));return o.push(u),o}function ict(n,t,i){for(var l,f,e,o,a,v,y=[],s=n(0),h=n(1),r=t(s),u=t(h),p=[h,s],w=[u,r],c=[1,0],b={},k=1e5;--k>0&&c.length>0;)e=c.pop(),s=p.pop(),r=w.pop(),(v=e.toString())in b||(y.push(r[0],r[1]),b[v]=!0),o=c.pop(),h=p.pop(),u=w.pop(),oit((f=t(l=n(a=(e+o)/2)))[0],f[1],r[0],r[1],u[0],u[1])<i?(y.push(u[0],u[1]),b[v=o.toString()]=!0):(c.push(o,a,a,e),w.push(u,f,f,r),p.push(h,l,l,s));return y}function oei(n){for(var i,r,u=n.dataTransfer.files,t=0,f=u.length;t<f;++t)i=u.item(t),r=new FileReader,r.addEventListener(a.LOAD,this.handleResult_.bind(this,i)),r.readAsText(i)}function sg(n){n.stopPropagation();n.preventDefault();n.dataTransfer.dropEffect="copy"}function fct(n,t,i,r){for(var f,o=[],u=[1/0,1/0,-1/0,-1/0],e=0,s=i.length;e<s;++e)f=i[e],u=vw(n,t,f[0],r),o.push((u[0]+u[2])/2,(u[1]+u[3])/2),t=f[f.length-1];return o}function dei(){var n=ta();return function(){return n[f.POLYGON]}}function gei(){var n=ta();return function(){return n[f.POINT]}}function hct(n){return function(t){return oi([n,t])}}function cct(n,t){return n[0]==t[0]?function(i){return oi([n,[i[0],t[1]]])}:n[1]==t[1]?function(i){return oi([n,[t[0],i[1]]])}:null}function ioi(n,t){return n.index-t.index}function yct(n,t,i){var e=t.geometry,r,o,u,s;return e.getType()===f.CIRCLE&&(r=e,t.index===aa)?(o=eu(r.getCenter(),n),u=Math.sqrt(o)-r.getRadius(),u*u):(s=pi(n,i),sc[0]=pi(t.segment[0],i),sc[1]=pi(t.segment[1],i),ey(s,sc))}function pct(n,t,i){var r=t.geometry,u;return r.getType()===f.CIRCLE&&t.index===aa?r.getClosestPoint(n):(u=pi(n,i),sc[0]=pi(t.segment[0],i),sc[1]=pi(t.segment[1],i),el(iy(u,sc),i))}function roi(){var n=ta();return function(){return n[f.POINT]}}function ooi(n){var u,f,s,e;if(!this.condition_(n))return!0;var h=this.addCondition_(n),c=this.removeCondition_(n),o=this.toggleCondition_(n),a=!h&&!c&&!o,l=n.map,i=this.getFeatures(),r=[],t=[];if(a){for(pe(this.featureLayerAssociation_),l.forEachFeatureAtPixel(n.pixel,function(n,i){if(this.filter_(n,i))return t.push(n),this.addFeatureLayerAssociation_(n,i),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_}),u=i.getLength()-1;u>=0;--u)f=i.item(u),s=t.indexOf(f),s>-1?t.splice(s,1):(i.remove(f),r.push(f));0!==t.length&&i.extend(t)}else{for(l.forEachFeatureAtPixel(n.pixel,function(n,u){if(this.filter_(n,u))return!h&&!o||di(i.getArray(),n)?(c||o)&&di(i.getArray(),n)&&(r.push(n),this.removeFeatureLayerAssociation_(n)):(t.push(n),this.addFeatureLayerAssociation_(n,u)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_}),e=r.length-1;e>=0;--e)i.remove(r[e]);i.extend(t)}return(t.length>0||r.length>0)&&this.dispatchEvent(new eoi(foi.SELECT,t,r,n)),!0}function dct(n){return n.feature?n.feature:n.element?n.element:void 0}function nlt(n){for(var i=[],t=0,r=n.length;t<r;++t)i.push(n[t].clone());return i}function ei(n,t,i){var r,u=i?y(i.featureProjection):null,f=i?y(i.dataProjection):null,e;return(r=u&&f&&!pr(u,f)?(t?n.clone():n).transform(t?u:f,t?f:u):n,t&&i&&void 0!==i.decimals)&&(e=Math.pow(10,i.decimals),r===n&&(r=n.clone()),r.applyTransform(function(n){for(var t=0,i=n.length;t<i;++t)n[t]=Math.round(n[t]*e)/e;return n})),r}function vg(n,t){var i=t?y(t.featureProjection):null,r=t?y(t.dataProjection):null;return i&&r&&!pr(i,r)?io(n,r,i):n}function pp(n){if("string"==typeof n){var t=JSON.parse(n);return t||null}return null!==n?n:null}function ilt(n,t){var u,e,i;if(!n)return null;if("number"==typeof n.x&&"number"==typeof n.y)i=f.POINT;else if(n.points)i=f.MULTI_POINT;else if(n.paths)i=1===n.paths.length?f.LINE_STRING:f.MULTI_LINE_STRING;else if(n.rings){var o=n,s=lc(o),r=function(n,t){for(var u=[],r=[],e=[],f,o,h,i=0,s=n.length;i<s;++i)u.length=0,al(u,0,n[i],t.length),kv(u,0,u.length,t.length)?r.push([n[i]]):e.push(n[i]);for(;e.length;){for(f=e.shift(),o=!1,i=r.length-1;i>=0;i--)if(h=r[i][0],tr(new bh(h).getExtent(),new bh(f).getExtent())){r[i].push(f);o=!0;break}o||r.push([f.reverse()])}return r}(o.rings,s);1===r.length?(i=f.POLYGON,n=Object.assign({},n,((u={}).rings=r[0],u))):(i=f.MULTI_POLYGON,n=Object.assign({},n,((e={}).rings=r,e)))}return ei(nh[i](n),!1,t)}function lc(n){var t=l.XY;return!0===n.hasZ&&!0===n.hasM?t=l.XYZM:!0===n.hasZ?t=l.XYZ:!0===n.hasM&&(t=l.XYM),t}function va(n){var t=n.getLayout();return{hasZ:t===l.XYZ||t===l.XYZM,hasM:t===l.XYM||t===l.XYZM}}function rlt(n,t){return ao[n.getType()](ei(n,!0,t),t)}function vo(n){return th(ar(n,!1))}function th(n){var t=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(t)return void 0!==t[1]||!1}function pg(n){var i=ar(n,!1),t=Date.parse(i);if(!isNaN(t))return t/1e3}function yt(n){return ce(ar(n,!1))}function ce(n){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(t)return parseFloat(t[1])}function rr(n){return le(ar(n,!1))}function le(n){var t=/^\s*(\d+)\s*$/.exec(n);if(t)return parseInt(t[1],10)}function h(n){return ar(n,!1).trim()}function wp(n,t){ut(n,t?"1":"0")}function gr(n,t){var i=t.toPrecision();n.appendChild(vs.createTextNode(i))}function bp(n,t){var i=t.toString();n.appendChild(vs.createTextNode(i))}function ut(n,t){n.appendChild(vs.createTextNode(t))}function chi(n,t){var r=n.getGeometry(),i;if(r&&(i=hhi[r.getType()],i))return rt(t[t.length-1].node.namespaceURI,i)}function wg(n,t,i,r){return n.push(parseFloat(i.getAttribute("lon")),parseFloat(i.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,t.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,t.hasM=!0):n.push(0),n}function bg(n,t,i){var f=l.XY,u=2,r,e;if(n.hasZ&&n.hasM?(f=l.XYZM,u=4):n.hasZ?(f=l.XYZ,u=3):n.hasM&&(f=l.XYM,u=3),4!==u){for(r=0,e=t.length/4;r<e;r++)t[r*u]=t[4*r],t[r*u+1]=t[4*r+1],n.hasZ&&(t[r*u+2]=t[4*r+2]),n.hasM&&(t[r*u+2]=t[4*r+3]);if(t.length=t.length/4*u,i)for(r=0,e=i.length;r<e;r++)i[r]=i[r]/4*u}return f}function kg(n,t){var r=t[t.length-1],i=n.getAttribute("href");null!==i&&(r.link=i);kr(csi,n,t)}function dg(n,t){t[t.length-1].extensionsNode_=n}function ult(n,t){var h=t[0],i=s({flatCoordinates:[],layoutOptions:{}},vsi,n,t),r,e,o,u,f;if(i)return r=i.flatCoordinates,delete i.flatCoordinates,e=i.layoutOptions,delete i.layoutOptions,o=bg(e,r),u=new ai(r,o),ei(u,!1,h),f=new ui(u),f.setProperties(i,!0),f}function flt(n,t){var c=t[0],i=s({flatCoordinates:[],ends:[],layoutOptions:{}},psi,n,t),r,u,o,h,f,e;if(i)return r=i.flatCoordinates,delete i.flatCoordinates,u=i.ends,delete i.ends,o=i.layoutOptions,delete i.layoutOptions,h=bg(o,r,u),f=new au(r,h,u),ei(f,!1,c),e=new ui(f),e.setProperties(i,!0),e}function elt(n,t){var o=t[0],i=s({},ksi,n,t),r;if(i){var u={},f=wg([],u,n,i),h=bg(u,f),e=new si(f,h);return ei(e,!1,o),r=new ui(e),r.setProperties(i,!0),r}}function gg(n,t,i){n.setAttribute("href",t);var r=i[i.length-1].properties,u=[r.linkText,r.linkType];it({node:n},gsi,ir,u,i,dsi)}function nn(n,t,i){var u=i[i.length-1],e=u.node.namespaceURI,r=u.properties,f,o;switch(n.setAttributeNS(null,"lat",String(t[1])),n.setAttributeNS(null,"lon",String(t[0])),u.geometryLayout){case l.XYZM:0!==t[3]&&(r.time=t[3]);case l.XYZ:0!==t[2]&&(r.ele=t[2]);break;case l.XYM:0!==t[2]&&(r.time=t[2])}f="rtept"==n.nodeName?ihi[e]:ohi[e];o=su(r,f);it({node:n,properties:r},shi,ir,o,i,f)}function tn(n,t){if(!n)return null;var i;switch(n.type){case f.POINT:i=function(n){return new si(n.coordinates)}(n);break;case f.LINE_STRING:i=function(n){return new ai(n.coordinates)}(n);break;case f.POLYGON:i=function(n){return new fr(n.coordinates)}(n);break;case f.MULTI_POINT:i=function(n){return new wf(n.coordinates)}(n);break;case f.MULTI_LINE_STRING:i=function(n){return new au(n.coordinates)}(n);break;case f.MULTI_POLYGON:i=function(n){return new bf(n.coordinates)}(n);break;case f.GEOMETRY_COLLECTION:i=function(n,t){var i=n.geometries.map(function(n){return tn(n,t)});return new lo(i)}(n);break;default:throw new Error("Unsupported GeoJSON type: "+n.type);}return ei(i,!1,t)}function rn(n,t){var i,r=(n=ei(n,!0,t)).getType();switch(r){case f.POINT:i=function(n){return{type:"Point",coordinates:n.getCoordinates()}}(n);break;case f.LINE_STRING:i=function(n){return{type:"LineString",coordinates:n.getCoordinates()}}(n);break;case f.POLYGON:i=function(n,t){var i;return t&&(i=t.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(i)}}(n,t);break;case f.MULTI_POINT:i=function(n){return{type:"MultiPoint",coordinates:n.getCoordinates()}}(n);break;case f.MULTI_LINE_STRING:i=function(n){return{type:"MultiLineString",coordinates:n.getCoordinates()}}(n);break;case f.MULTI_POLYGON:i=function(n,t){var i;return t&&(i=t.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(i)}}(n,t);break;case f.GEOMETRY_COLLECTION:i=function(n,t){return{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(n){var i=d({},t);return delete i.featureProjection,rn(n,i)})}}(n,t);break;case f.CIRCLE:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+r);}return i}function gp(n){return"string"==typeof n?n:""}function yn(n,t){var i=null,f=[0,0],o="start",r,e,u;return n.getImage()&&(r=n.getImage().getImageSize(),(null===r&&(r=nw),2==r.length)&&(e=n.getImage().getScale(),f[0]=e*r[0]/2,f[1]=-e*r[1]/2,o="left")),null!==n.getText()?(u=n.getText(),(i=u.clone()).setFont(u.getFont()||ih.getFont()),i.setScale(u.getScale()||ih.getScale()),i.setFill(u.getFill()||ih.getFill()),i.setStroke(u.getStroke()||ln)):i=ih.clone(),i.setText(t),i.setOffsetX(f[0]),i.setOffsetY(f[1]),i.setTextAlign(o),new ys({text:i})}function pn(n){var r=ar(n,!1),i=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(r),t;if(i)return t=i[1],[parseInt(t.substr(6,2),16),parseInt(t.substr(4,2),16),parseInt(t.substr(2,2),16),parseInt(t.substr(0,2),16)/255]}function ylt(n){for(var t,i=ar(n,!1),r=[];t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i.exec(i);){var u=parseFloat(t[1]),f=parseFloat(t[2]),e=t[3]?parseFloat(t[3]):0;r.push(u,f,e);i=i.substr(t[0].length)}if(""===i)return r}function iw(n){var i=ar(n,!1).trim(),t=n.baseURI;return t&&"about:blank"!=t||(t=window.location.href),t?new URL(i,t).href:i}function plt(n){return yt(n)}function blt(n,t){return s(void 0,wlt,n,t)}function klt(n,t){return s(null,oci,n,t)}function nat(n,t){var r=s({flatCoordinates:[],whens:[]},glt,n,t);if(r){for(var u=r.flatCoordinates,f=r.whens,i=0,e=Math.min(u.length,f.length);i<e;++i)u[4*i+3]=f[i];return new ai(u,l.XYZM)}}function wn(n,t){return s(null,iat,n,t)}function rat(n,t){var u=s({},ba,n,t),r=wn(n,t),i;if(r)return i=new ai(r,l.XYZ),i.setProperties(u,!0),i}function uat(n,t){var u=s({},ba,n,t),i=wn(n,t),r;if(i)return r=new fr(i,l.XYZ,[i.length]),r.setProperties(u,!0),r}function eat(n,t){var u,i=s([],fat,n,t),c,o,l;if(!i)return null;if(0===i.length)return new lo(i);for(var a=!0,e=i[0].getType(),r=1,h=i.length;r<h;++r)if(i[r].getType()!=e){a=!1;break}if(a)if(c=void 0,o=void 0,e==f.POINT){for(l=i[0],c=l.getLayout(),o=l.getFlatCoordinates(),r=1,h=i.length;r<h;++r)pt(o,i[r].getFlatCoordinates());kn(u=new wf(o,c),i)}else e==f.LINE_STRING?kn(u=new au(i),i):e==f.POLYGON?kn(u=new bf(i),i):e==f.GEOMETRY_COLLECTION?u=new lo(i):p(!1,37);else u=new lo(i);return u}function oat(n,t){var u=s({},ba,n,t),r=wn(n,t),i;if(r)return i=new si(r,l.XYZ),i.setProperties(u,!0),i}function hat(n,t){var o=s({},ba,n,t),i=s([null],sat,n,t),f;if(i&&i[0]){for(var r=i[0],e=[r.length],u=1,h=i.length;u<h;++u)pt(r,i[u]),e.push(r.length);return f=new fr(r,l.XYZ,e),f.setProperties(o,!0),f}}function bn(n,t){var i=s({},cat,n,t),r,u,f;if(!i)return null;u="fillStyle"in i?i.fillStyle:tw;f=i.fill;void 0===f||f||(u=null);"imageStyle"in i?i.imageStyle!=hn&&(r=i.imageStyle):r=cn;var h="textStyle"in i?i.textStyle:ih,e="strokeStyle"in i?i.strokeStyle:an,o=i.outline;return void 0===o||o||(e=null),[new ys({fill:u,image:r,stroke:e,text:h,zIndex:void 0})]}function kn(n,t){var r,u,f,c=t.length,o=new Array(t.length),s=new Array(t.length),h=new Array(t.length),i,e;for(r=!1,u=!1,f=!1,i=0;i<c;++i)e=t[i],o[i]=e.get("extrude"),s[i]=e.get("tessellate"),h[i]=e.get("altitudeMode"),r=r||void 0!==o[i],u=u||void 0!==s[i],f=f||h[i];r&&n.set("extrude",o);u&&n.set("tessellate",s);f&&n.set("altitudeMode",h)}function vat(n,t){kr(aat,n,t)}function yat(n,t){kr(alt,n,t)}function dn(n,t){for(var u,i=wy(t),f=[255*(4==i.length?i[3]:1),i[2],i[1],i[0]],r=0;r<4;++r)u=Math.floor(f[r]).toString(16),f[r]=1==u.length?"0"+u:u;ut(n,f.join(""))}function kat(n,t,i){var r,u,o={node:n},e=t.getType();e==f.GEOMETRY_COLLECTION?(r=t.getGeometries(),u=bat):e==f.MULTI_POINT?(r=t.getPoints(),u=uli):e==f.MULTI_LINE_STRING?(r=t.getLineStrings(),u=fli):e==f.MULTI_POLYGON?(r=t.getPolygons(),u=oli):p(!1,39);it(o,sli,u,r,i)}function gat(n,t,i){it({node:n},dat,eli,[t],i)}function nvt(n,t,i){var o={node:n},r,s,e,h,u,c,l,v,y,f;t.getId()&&n.setAttribute("id",t.getId());r=t.getProperties();s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[t.getGeometryName()]=1;e=Object.keys(r||{}).sort().filter(function(n){return!s[n]});h=t.getStyleFunction();h&&(u=h(t,0),u&&(c=Array.isArray(u)?u[0]:u,this.writeStyles_&&(r.Style=c),l=c.getText(),l&&(r.name=l.getText())));var p=i[i.length-1].node,a=hli[p.namespaceURI],w=su(r,a);(it(o,gn,ir,w,i,a),e.length>0)&&(v=su(r,e),it(o,gn,cli,[{names:e,values:v}],i));y=i[0];f=t.getGeometry();f&&(f=ei(f,!0,y));it(o,gn,bat,[f],i)}function vc(n,t,i){var e=t.getFlatCoordinates(),r={node:n},u;r.layout=t.getLayout();r.stride=t.getStride();u=t.getProperties();u.coordinates=e;var o=i[i.length-1].node,f=tvt[o.namespaceURI],s=su(u,f);it(r,ivt,ir,s,i,f)}function uvt(n,t,i){var r=t.getLinearRings(),f=r.shift(),u={node:n};it(u,rvt,lli,r,i);it(u,rvt,ali,[f],i)}function ovt(n,t){gr(n,Math.round(1e6*t)/1e6)}function kli(n,t,i){if(3===n){var r={keys:[],values:[],features:[]},u=i.readVarint()+i.pos;i.readFields(dli,r,u);r.length=r.features.length;r.length&&(t[r.name]=r)}}function dli(n,t,i){if(15===n)t.version=i.readVarint();else if(1===n)t.name=i.readString();else if(5===n)t.extent=i.readVarint();else if(2===n)t.features.push(i.pos);else if(3===n)t.keys.push(i.readString());else if(4===n){for(var r=null,u=i.readVarint()+i.pos;i.pos<u;)r=1==(n=i.readVarint()>>3)?i.readString():2===n?i.readFloat():3===n?i.readDouble():4===n?i.readVarint64():5===n?i.readVarint():6===n?i.readSVarint():7===n?i.readBoolean():null;t.values.push(r)}}function gli(n,t,i){var r,u,f;if(1==n)t.id=i.readVarint();else if(2==n)for(r=i.readVarint()+i.pos;i.pos<r;)u=t.layer.keys[i.readVarint()],f=t.layer.values[i.readVarint()],t.properties[u]=f;else 3==n?t.type=i.readVarint():4==n&&(t.geometry=i.pos)}function nai(n,t,i){n.pos=t.features[i];var u=n.readVarint()+n.pos,r={layer:t,type:0,properties:{}};return n.readFields(gli,r,u),r}function cvt(n,t){t[t.length-1].tags[n.getAttribute("k")]=n.getAttribute("v")}function avt(n,t,i,r,u,f){var e,o,s,c,h;for(void 0!==u?(e=u,o=void 0!==f?f:0):(e=[],o=0),s=t;s<i;)for(c=n[s++],e[o++]=n[s++],e[o++]=c,h=2;h<r;++h)e[o++]=n[s++];return e.length=o,e}function yvt(n,t,i){for(var h=i||1e5,f=new Array(t),u,o,e,s,r=0;r<t;++r)f[r]=0;for(u=0,o=n.length;u<o;)for(r=0;r<t;++r,++u)e=n[u],s=e-f[r],f[r]=e,n[u]=s;return wvt(n,h)}function pvt(n,t,i){for(var o=i||1e5,e=new Array(t),r=0;r<t;++r)e[r]=0;for(var u=bvt(n,o),f=0,s=u.length;f<s;)for(r=0;r<t;++r,++f)e[r]+=u[f],u[f]=e[r];return u}function wvt(n,t){for(var r=t||1e5,i=0,u=n.length;i<u;++i)n[i]=Math.round(n[i]*r);return function(n){for(var i,t=0,r=n.length;t<r;++t)i=n[t],n[t]=i<0?~(i<<1):i<<1;return function(n){for(var i="",t=0,r=n.length;t<r;++t)i+=oai(n[t]);return i}(n)}(n)}function bvt(n,t){for(var u=t||1e5,i=function(n){for(var r,t=function(n){for(var u,f=[],t=0,i=0,r=0,e=n.length;r<e;++r)u=n.charCodeAt(r)-63,t|=(31&u)<<i,u<32?(f.push(t),t=0,i=0):i+=5;return f}(n),i=0,u=t.length;i<u;++i)r=t[i],t[i]=1&r?~(r>>1):r>>1;return t}(n),r=0,f=i.length;r<f;++r)i[r]/=u;return i}function oai(n){for(var t,i="";n>=32;)t=63+(32|31&n),i+=String.fromCharCode(t),n>>=5;return t=n+63,i+String.fromCharCode(t)}function uw(n,t){for(var r,o,u,e,i=[],f=0,s=n.length;f<s;++f)u=n[f],f>0&&i.pop(),e=u>=0?t[u]:t[~u].slice().reverse(),i.push.apply(i,e);for(r=0,o=i.length;r<o;++r)i[r]=i[r].slice();return i}function aai(n,t,i,r,u,f,e){for(var s=n.geometries,h=[],o=0,c=s.length;o<c;++o)h[o]=kvt(s[o],t,i,r,u,f,e);return h}function kvt(n,t,i,r,u,f,e){var c,h=n.type,l=lai[h],s,o;return c="Point"===h||"MultiPoint"===h?l(n,i,r):l(n,t),s=new ui,s.setGeometry(ei(c,!1,e)),void 0!==n.id&&s.setId(n.id),o=n.properties,u&&(o||(o={}),o[u]=f),o&&s.setProperties(o,!0),s}function vai(n,t,i){for(var r,f=0,e=0,u=0,o=n.length;u<o;++u)r=n[u],f+=r[0],e+=r[1],r[0]=f,r[1]=e,itt(r,t,i)}function itt(n,t,i){n[0]=n[0]*t[0]+i[0];n[1]=n[1]*t[1]+i[1]}function pyt(){var n=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(bai,n))}function wyt(n,t,i){return new gvt(n,t,i)}function gyt(n,t){var i=rt(rh,"Filter"),r=rt(rh,"FeatureId");i.appendChild(r);r.setAttribute("fid",t);n.appendChild(i)}function ftt(n,t){var i=(n=n||byt)+":";return 0===t.indexOf(i)?t:i+t}function npt(n,t,i){it({node:n},nv,gt(t.getTagName()),[t],i)}function tpt(n,t,i){for(var u,e={node:n},f=t.conditions,r=0,o=f.length;r<o;++r)u=f[r],it(e,nv,gt(u.getTagName()),[u],i)}function wc(n,t){void 0!==t.matchCase&&n.setAttribute("matchCase",t.matchCase.toString());yo(n,t.propertyName);ew(n,""+t.expression)}function ipt(n,t,i){var r=rt(rh,n);ut(r,i);t.appendChild(r)}function yo(n,t){ipt("PropertyName",n,t)}function ew(n,t){ipt("Literal",n,t)}function rpt(n,t){var r=rt(kf,"TimeInstant"),i;n.appendChild(r);i=rt(kf,"timePosition");r.appendChild(i);ut(i,t)}function hpt(n){var t=n.getCoordinates();return 0===t.length?"":t.join(" ")}function ott(n){for(var i=n.getCoordinates(),r=[],t=0,u=i.length;t<u;++t)r.push(i[t].join(" "));return r.join(",")}function cpt(n){for(var i=[],r=n.getLinearRings(),t=0,u=r.length;t<u;++t)i.push("("+ott(r[t])+")");return i.join(",")}function apt(n){var t=n.getType(),r=lpt[t](n),i;return(t=t.toUpperCase(),"function"==typeof n.getFlatCoordinates)&&(i=function(n){var t=n.getLayout(),i="";return t!==l.XYZ&&t!==l.XYZM||(i+=ept),t!==l.XYM&&t!==l.XYZM||(i+=opt),i}(n),i.length>0&&(t+=" "+i)),0===r.length?t+" "+fpt:t+"("+r+")"}function kc(n){return n.getAttributeNS(ypt,"href")}function ye(n,t){return s({},epi,n,t)}function htt(n,t){return s({},ipi,n,t)}function wpt(n,t){var i=ye(n,t),r;if(i)return r=[le(n.getAttribute("width")),le(n.getAttribute("height"))],i.size=r,i}function bpt(n,t){return s([],opi,n,t)}function ctt(n){var t=h(n).split(/\s+/),i,r;if(t&&2==t.length&&(i=+t[0],r=+t[1],!isNaN(i)&&!isNaN(r)))return[i,r]}function dpt(){var n=document.body;return!!(n.webkitRequestFullscreen||n.msRequestFullscreen&&document.msFullscreenEnabled||n.requestFullscreen&&document.fullscreenEnabled)}function ltt(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function gpt(n){n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}function nwt(n){var t=n.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}function iwt(){this.validateExtent_();this.updateBox_()}function rwt(n){var t=n.frameState;this.viewState_=t?t.viewState:null;this.updateElement_()}function uwt(n){if(n.frameState){this.sliderInitialized_||this.initSlider_();var t=n.frameState.viewState.resolution;this.currentResolution_=t;this.setThumbPosition_(t)}}var ytt,iv,ko,l,f,eit,ul,lh,cu,pw,pit,wit,bit,rf,pv,ff,out,sy,bb,lut,yl,aut,ik,yut,pl,dut,ie,gut,ou,uft,lk,cft,dft,tet,tc,cf,yk,eet,cet,wet,dk,nd,tot,ls,vs,eo,ir,cot,gl,na,vst,yst,ee,fg,tct,ai,bct,kct,lo,cc,tlt,ao,ht,ft,kp,olt,slt,hlt,clt,wlt,dlt,glt,tat,iat,ba,fat,sat,cat,lat,aat,dat,tvt,ivt,fvt,evt,ntt,hvt,lvt,vvt,nv,ett,lpt,vpt,ypt;i.r(t);ytt=0;var sw,hw="6.1.1",fwt=(sw=function(n,t){return(sw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}sw(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ptt=function(n){function t(t){var i=this,r="Assertion failed. See https://openlayers.org/en/"+("latest"===hw?hw:"v"+hw.split("-")[0])+"/doc/errors/#"+t+" for details.";return(i=n.call(this,r)||this).code=t,i.name="AssertionError",i.message=r,i}return fwt(t,n),t}(Error),yi={ADD:"add",REMOVE:"remove"},wo="propertychange",d="function"==typeof Object.assign?Object.assign:function(n){var t,i;if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var u=Object(n),r=1,f=arguments.length;r<f;++r)if(t=arguments[r],null!=t)for(i in t)t.hasOwnProperty(i)&&(u[i]=t[i]);return u};iv="function"==typeof Object.values?Object.values:function(n){var t=[];for(var i in n)t.push(n[i]);return t};ko=function(){function n(){this.disposed_=!1}return n.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},n.prototype.disposeInternal=function(){},n}();var ur=function(){function n(n){this.propagationStopped;this.type=n;this.target=null}return n.prototype.preventDefault=function(){this.propagationStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n}(),swt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eh=function(n){function t(t){var i=n.call(this)||this;return i.eventTarget_=t,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return swt(t,n),t.prototype.addEventListener=function(n,t){if(n&&t){var i=this.listeners_[n];i||(i=[],this.listeners_[n]=i);-1===i.indexOf(t)&&i.push(t)}},t.prototype.dispatchEvent=function(n){var i="string"==typeof n?new ur(n):n,t=i.type,f,r,u,e,o;if(i.target||(i.target=this.eventTarget_||this),r=this.listeners_[t],r){for((t in this.dispatching_)||(this.dispatching_[t]=0,this.pendingRemovals_[t]=0),++this.dispatching_[t],u=0,e=r.length;u<e;++u)if(!1===r[u].call(this,i)||i.propagationStopped){f=!1;break}if(--this.dispatching_[t],0===this.dispatching_[t]){for(o=this.pendingRemovals_[t],delete this.pendingRemovals_[t];o--;)this.removeEventListener(t,gf);delete this.dispatching_[t]}return f}},t.prototype.disposeInternal=function(){pe(this.listeners_)},t.prototype.getListeners=function(n){return this.listeners_[n]},t.prototype.hasListener=function(n){return n?n in this.listeners_:Object.keys(this.listeners_).length>0},t.prototype.removeEventListener=function(n,t){var i=this.listeners_[n],r;i&&(r=i.indexOf(t),-1!==r&&(n in this.pendingRemovals_?(i[r]=gf,++this.pendingRemovals_[n]):(i.splice(r,1),0===i.length&&delete this.listeners_[n])))},t}(ko),a={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",WHEEL:"wheel"},hwt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cw=function(n){function t(){var t=n.call(this)||this;return t.revision_=0,t}return hwt(t,n),t.prototype.changed=function(){++this.revision_;this.dispatchEvent(a.CHANGE)},t.prototype.getRevision=function(){return this.revision_},t.prototype.on=function(n,t){if(Array.isArray(n)){for(var r=n.length,u=new Array(r),i=0;i<r;++i)u[i]=nt(this,n[i],t);return u}return nt(this,n,t)},t.prototype.once=function(n,t){if(Array.isArray(n)){for(var r=n.length,u=new Array(r),i=0;i<r;++i)u[i]=fh(this,n[i],t);return u}return fh(this,n,t)},t.prototype.un=function(n,t){if(Array.isArray(n))for(var i=0,r=n.length;i<r;++i)this.removeEventListener(n[i],t);else this.removeEventListener(n,t)},t}(eh),btt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ktt=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.key=i,u.oldValue=r,u}return btt(t,n),t}(ur),cwt=function(n){function t(t){var i=n.call(this)||this;return v(i),i.values_={},void 0!==t&&i.setProperties(t),i}return btt(t,n),t.prototype.get=function(n){var t;return this.values_.hasOwnProperty(n)&&(t=this.values_[n]),t},t.prototype.getKeys=function(){return Object.keys(this.values_)},t.prototype.getProperties=function(){return d({},this.values_)},t.prototype.notify=function(n,t){var i;i=ri(n);this.dispatchEvent(new ktt(i,n,t));i=wo;this.dispatchEvent(new ktt(i,n,t))},t.prototype.set=function(n,t,i){if(i)this.values_[n]=t;else{var r=this.values_[n];this.values_[n]=t;r!==t&&this.notify(n,r)}},t.prototype.setProperties=function(n,t){for(var i in n)this.set(i,n[i],t)},t.prototype.unset=function(n,t){if(n in this.values_){var i=this.values_[n];delete this.values_[n];t||this.notify(n,i)}},t}(cw),lw={};var hu=cwt,dtt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gtt="length",uv=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.element=i,u.index=r,u}return dtt(t,n),t}(ur),gi=function(n){function t(t,i){var r=n.call(this)||this,e=i||{},u,f;if(r.unique_=!!e.unique,r.array_=t||[],r.unique_)for(u=0,f=r.array_.length;u<f;++u)r.assertUnique_(r.array_[u],u);return r.updateLength_(),r}return dtt(t,n),t.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},t.prototype.extend=function(n){for(var t=0,i=n.length;t<i;++t)this.push(n[t]);return this},t.prototype.forEach=function(n){for(var i=this.array_,t=0,r=i.length;t<r;++t)n(i[t],t,i)},t.prototype.getArray=function(){return this.array_},t.prototype.item=function(n){return this.array_[n]},t.prototype.getLength=function(){return this.get(gtt)},t.prototype.insertAt=function(n,t){this.unique_&&this.assertUnique_(t);this.array_.splice(n,0,t);this.updateLength_();this.dispatchEvent(new uv(yi.ADD,t,n))},t.prototype.pop=function(){return this.removeAt(this.getLength()-1)},t.prototype.push=function(n){this.unique_&&this.assertUnique_(n);var t=this.getLength();return this.insertAt(t,n),this.getLength()},t.prototype.remove=function(n){for(var i=this.array_,t=0,r=i.length;t<r;++t)if(i[t]===n)return this.removeAt(t)},t.prototype.removeAt=function(n){var t=this.array_[n];return this.array_.splice(n,1),this.updateLength_(),this.dispatchEvent(new uv(yi.REMOVE,t,n)),t},t.prototype.setAt=function(n,t){var r=this.getLength(),u,i;if(n<r)this.unique_&&this.assertUnique_(t,n),u=this.array_[n],this.array_[n]=t,this.dispatchEvent(new uv(yi.REMOVE,u,n)),this.dispatchEvent(new uv(yi.ADD,t,n));else{for(i=r;i<n;++i)this.insertAt(i,void 0);this.insertAt(n,t)}},t.prototype.updateLength_=function(){this.set(gtt,this.array_.length)},t.prototype.assertUnique_=function(n,t){for(var i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===n&&i!==t)throw new ptt(58);},t}(hu);var lwt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ui=function(n){function t(t){var i=n.call(this)||this,r,u;return(i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener(ri(i.geometryName_),i.handleGeometryChanged_),t)&&("function"==typeof t.getSimplifiedGeometry?(r=t,i.setGeometry(r)):(u=t,i.setProperties(u))),i}return lwt(t,n),t.prototype.clone=function(){var n=new t(this.getProperties()),i,r;return n.setGeometryName(this.getGeometryName()),i=this.getGeometry(),i&&n.setGeometry(i.clone()),r=this.getStyle(),r&&n.setStyle(r),n},t.prototype.getGeometry=function(){return this.get(this.geometryName_)},t.prototype.getId=function(){return this.id_},t.prototype.getGeometryName=function(){return this.geometryName_},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.handleGeometryChange_=function(){this.changed()},t.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(ct(this.geometryChangeKey_),this.geometryChangeKey_=null);var n=this.getGeometry();n&&(this.geometryChangeKey_=nt(n,a.CHANGE,this.handleGeometryChange_,this));this.changed()},t.prototype.setGeometry=function(n){this.set(this.geometryName_,n)},t.prototype.setStyle=function(n){this.style_=n;this.styleFunction_=n?function(n){if("function"==typeof n)return n;var t;return Array.isArray(n)?t=n:(p("function"==typeof n.getZIndex,41),t=[n]),function(){return t}}(n):void 0;this.changed()},t.prototype.setId=function(n){this.id_=n;this.changed()},t.prototype.setGeometryName=function(n){this.removeEventListener(ri(this.geometryName_),this.handleGeometryChanged_);this.geometryName_=n;this.addEventListener(ri(this.geometryName_),this.handleGeometryChanged_);this.handleGeometryChanged_()},t}(hu),nl={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},nr={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};l={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};f={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};eit="cosh"in Math?Math.cosh:function(n){var t=Math.exp(n);return(t+1/t)/2};
/**
 * @license
 * Latitude/longitude spherical geodesy formulae taken from
 * http://www.movable-type.co.uk/scripts/latlong.html
 * Licensed under CC-BY-3.0.
 */
ul=6371008.8;lh={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};cu={};cu[lh.DEGREES]=12741994*Math.PI/360;cu[lh.FEET]=.3048;cu[lh.METERS]=1;cu[lh.USFEET]=1200/3937;var lu=lh,fl=function(){function n(n){this.code_=n.code;this.units_=n.units;this.extent_=void 0!==n.extent?n.extent:null;this.worldExtent_=void 0!==n.worldExtent?n.worldExtent:null;this.axisOrientation_=void 0!==n.axisOrientation?n.axisOrientation:"enu";this.global_=void 0!==n.global&&n.global;this.canWrapX_=!(!this.global_||!this.extent_);this.getPointResolutionFunc_=n.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=n.metersPerUnit}return n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||cu[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(n){this.global_=n;this.canWrapX_=!(!n||!this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(n){this.defaultTileGrid_=n},n.prototype.setExtent=function(n){this.extent_=n;this.canWrapX_=!(!this.global_||!n)},n.prototype.setWorldExtent=function(n){this.worldExtent_=n},n.prototype.setGetPointResolution=function(n){this.getPointResolutionFunc_=n},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},n}(),wwt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lv=6378137,ah=Math.PI*lv,bwt=[-ah,-ah,ah,ah],kwt=[-180,-85,180,85],rs=function(n){function t(t){return n.call(this,{code:t,units:lu.METERS,extent:bwt,global:!0,worldExtent:kwt,getPointResolution:function(n,t){return n/eit(t[1]/lv)}})||this}return wwt(t,n),t}(fl),hit=[new rs("EPSG:3857"),new rs("EPSG:102100"),new rs("EPSG:102113"),new rs("EPSG:900913"),new rs("urn:ogc:def:crs:EPSG:6.18:3:3857"),new rs("urn:ogc:def:crs:EPSG::3857"),new rs("http://www.opengis.net/gml/srs/epsg.xml#3857")];var nbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cit=[-180,-90,180,90],tbt=6378137*Math.PI/180,no=function(n){function t(t,i){return n.call(this,{code:t,units:lu.DEGREES,extent:cit,axisOrientation:i,global:!0,metersPerUnit:tbt,worldExtent:cit})||this}return nbt(t,n),t}(fl),lit=[new no("CRS:84"),new no("EPSG:4326","neu"),new no("urn:ogc:def:crs:EPSG::4326","neu"),new no("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new no("urn:ogc:def:crs:OGC:1.3:CRS84"),new no("urn:ogc:def:crs:OGC:2:84"),new no("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new no("urn:x-ogc:def:crs:EPSG:4326","neu")],vh={};pw={};rf=null;vv(hit);vv(lit);pit=hit;wit=dwt;bit=gwt;lit.forEach(function(n){pit.forEach(function(t){yh(n,t,wit);yh(t,n,bit)})});pv=new Array(6);var ibt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dit=[1,0,0,1,0,0],gw=function(n){function t(){var r,u,f,e,i,t=n.call(this)||this;return t.extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(r=function(n,t,i){if(!i)return this.getSimplifiedGeometry(t);var r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)},i=!1,function(){var n=Array.prototype.slice.call(arguments);return i&&this===e&&be(n,f)||(i=!0,e=this,f=n,u=r.apply(this,arguments)),u}),t}return ibt(t,n),t.prototype.simplifyTransformed=function(n,t){return this.simplifyTransformedInternal(this.getRevision(),n,t)},t.prototype.clone=function(){return w()},t.prototype.closestPointXY=function(){return w()},t.prototype.containsXY=function(n,t){var i=this.getClosestPoint([n,t]);return i[0]===n&&i[1]===t},t.prototype.getClosestPoint=function(n,t){var i=t||[NaN,NaN];return this.closestPointXY(n[0],n[1],i,1/0),i},t.prototype.intersectsCoordinate=function(n){return this.containsXY(n[0],n[1])},t.prototype.computeExtent=function(){return w()},t.prototype.getExtent=function(n){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}(this.extent_,n)},t.prototype.rotate=function(){w()},t.prototype.scale=function(){w()},t.prototype.simplify=function(n){return this.getSimplifiedGeometry(n*n)},t.prototype.getSimplifiedGeometry=function(){return w()},t.prototype.getType=function(){return w()},t.prototype.applyTransform=function(){w()},t.prototype.intersectsExtent=function(){return w()},t.prototype.translate=function(){w()},t.prototype.transform=function(n,t){var i=y(n),r=i.getUnits()==lu.TILE_PIXELS?function(n,r,u){var o=i.getExtent(),f=i.getWorldExtent(),e=ni(f)/ni(o);return wr(dit,f[0],f[3],e,-e,0,0,0),ge(n,0,n.length,u,dit,r),tf(i,t)(n,r,u)}:tf(i,t);return this.applyTransform(r),this},t}(hu),rbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();ff=function(n){function t(){var t=n.call(this)||this;return t.layout=l.XY,t.stride=2,t.flatCoordinates=null,t}return rbt(t,n),t.prototype.computeExtent=function(n){return vw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n)},t.prototype.getCoordinates=function(){return w()},t.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.getFlatCoordinates=function(){return this.flatCoordinates},t.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},t.prototype.getLayout=function(){return this.layout},t.prototype.getSimplifiedGeometry=function(n){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),n<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&n<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var t=this.getSimplifiedGeometryInternal(n);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=n,this)},t.prototype.getSimplifiedGeometryInternal=function(){return this},t.prototype.getStride=function(){return this.stride},t.prototype.setFlatCoordinates=function(n,t){this.stride=nb(n);this.layout=n;this.flatCoordinates=t},t.prototype.setCoordinates=function(){w()},t.prototype.setLayout=function(n,t,i){var r,u;if(n)r=nb(n);else{for(u=0;u<i;++u){if(0===t.length)return this.layout=l.XY,void(this.stride=2);t=t[0]}n=function(n){var t;return 2==n?t=l.XY:3==n?t=l.XYZ:4==n&&(t=l.XYZM),t}(r=t.length)}this.layout=n;this.stride=r},t.prototype.applyTransform=function(n){this.flatCoordinates&&(n(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},t.prototype.rotate=function(n,t){var i=this.getFlatCoordinates(),r;i&&(r=this.getStride(),uit(i,0,i.length,r,n,t,i),this.changed())},t.prototype.scale=function(n,t,i){var f=t,u,r,e;void 0===f&&(f=n);u=i;u||(u=vr(this.getExtent()));r=this.getFlatCoordinates();r&&(e=this.getStride(),!function(n,t,i,r,u,f,e,o){for(var y,p,l,h=o||[],a=e[0],v=e[1],c=0,s=t;s<i;s+=r)for(y=n[s]-a,p=n[s+1]-v,h[c++]=a+u*y,h[c++]=v+f*p,l=s+2;l<s+r;++l)h[c++]=n[l];o&&h.length!=c&&(h.length=c)}(r,0,r.length,e,n,f,u,r),this.changed())},t.prototype.translate=function(n,t){var i=this.getFlatCoordinates(),r;i&&(r=this.getStride(),fit(i,0,i.length,r,n,t,i),this.changed())},t}(gw);var ebt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bh=function(n){function t(t,i){var r=n.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return ebt(t,n),t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(n,t,i,r){return r<ns(this.getExtent(),n,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,n,t,i,r))},t.prototype.getArea=function(){return git(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getCoordinates=function(){return wh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getSimplifiedGeometryInternal=function(n){var i=[];return i.length=eb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n,i,0),new t(i,l.XY)},t.prototype.getType=function(){return f.LINEAR_RING},t.prototype.intersectsExtent=function(){return!1},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=al(this.flatCoordinates,0,n,this.stride);this.changed()},t}(ff),obt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),si=function(n){function t(t,i){var r=n.call(this)||this;return r.setCoordinates(t,i),r}return obt(t,n),t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(n,t,i,r){var f=this.flatCoordinates,o=is(n,t,f[0],f[1]),e,u;if(o<r){for(e=this.stride,u=0;u<e;++u)i[u]=f[u];return i.length=e,o}return r},t.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},t.prototype.computeExtent=function(n){return sh(this.flatCoordinates,n)},t.prototype.getType=function(){return f.POINT},t.prototype.intersectsExtent=function(n){return ev(n,this.flatCoordinates[0],this.flatCoordinates[1])},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,0);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=irt(this.flatCoordinates,0,n,this.stride);this.changed()},t}(ff);var cbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dv=function(n){function t(t,i,r){var u=n.call(this)||this;return u.ends_=[],u.flatInteriorPointRevision_=-1,u.flatInteriorPoint_=null,u.maxDelta_=-1,u.maxDeltaRevision_=-1,u.orientedRevision_=-1,u.orientedFlatCoordinates_=null,void 0!==i&&r?(u.setFlatCoordinates(i,t),u.ends_=r):u.setCoordinates(t,i),u}return cbt(t,n),t.prototype.appendLinearRing=function(n){this.flatCoordinates?pt(this.flatCoordinates,n.getFlatCoordinates()):this.flatCoordinates=n.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()},t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},t.prototype.closestPointXY=function(n,t,i,r){return r<ns(this.getExtent(),n,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ib(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ub(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,n,t,i,r))},t.prototype.containsXY=function(n,t){return ob(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,n,t)},t.prototype.getArea=function(){return nrt(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},t.prototype.getCoordinates=function(n){var t;return void 0!==n?hb(t=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,n):t=this.flatCoordinates,wv(t,0,this.ends_,this.stride)},t.prototype.getEnds=function(){return this.ends_},t.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var n=vr(this.getExtent());this.flatInteriorPoint_=sb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,n,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},t.prototype.getInteriorPoint=function(){return new si(this.getFlatInteriorPoint(),l.XYM)},t.prototype.getLinearRingCount=function(){return this.ends_.length},t.prototype.getLinearRing=function(n){return n<0||this.ends_.length<=n?null:new bh(this.flatCoordinates.slice(0===n?0:this.ends_[n-1],this.ends_[n]),this.layout)},t.prototype.getLinearRings=function(){for(var t,f,e=this.layout,o=this.flatCoordinates,i=this.ends_,r=[],u=0,n=0,s=i.length;n<s;++n)t=i[n],f=new bh(o.slice(u,t),e),r.push(f),u=t;return r},t.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var n=this.flatCoordinates;srt(n,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=n:(this.orientedFlatCoordinates_=n.slice(),this.orientedFlatCoordinates_.length=hb(this.orientedFlatCoordinates_,0,this.ends_,this.stride));this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},t.prototype.getSimplifiedGeometryInternal=function(n){var i=[],r=[];return i.length=urt(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(n),i,0,r),new t(i,l.XY,r)},t.prototype.getType=function(){return f.POLYGON},t.prototype.intersectsExtent=function(n){return ort(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,n)},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,2);this.flatCoordinates||(this.flatCoordinates=[]);var i=fb(this.flatCoordinates,0,n,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1];this.changed()},t}(ff),fr=dv;var art=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hi={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},lbt=function(n){function t(t){var i=n.call(this,a.ERROR)||this;return i.code=t.code,i.message=t.message,i}return art(t,n),t}(ur),abt=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.position_=null,i.transform_=bw,i.watchId_=void 0,i.addEventListener(ri(hi.PROJECTION),i.handleProjectionChanged_),i.addEventListener(ri(hi.TRACKING),i.handleTrackingChanged_),void 0!==r.projection&&i.setProjection(r.projection),void 0!==r.trackingOptions&&i.setTrackingOptions(r.trackingOptions),i.setTracking(void 0!==r.tracking&&r.tracking),i}return art(t,n),t.prototype.disposeInternal=function(){this.setTracking(!1);n.prototype.disposeInternal.call(this)},t.prototype.handleProjectionChanged_=function(){var n=this.getProjection();n&&(this.transform_=wu(y("EPSG:4326"),n),this.position_&&this.set(hi.POSITION,this.transform_(this.position_)))},t.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var n=this.getTracking();n&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):n||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},t.prototype.positionChange_=function(n){var t=n.coords,r,i;this.set(hi.ACCURACY,t.accuracy);this.set(hi.ALTITUDE,null===t.altitude?void 0:t.altitude);this.set(hi.ALTITUDE_ACCURACY,null===t.altitudeAccuracy?void 0:t.altitudeAccuracy);this.set(hi.HEADING,null===t.heading?void 0:yu(t.heading));this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];r=this.transform_(this.position_);this.set(hi.POSITION,r);this.set(hi.SPEED,null===t.speed?void 0:t.speed);i=crt(this.position_,t.accuracy);i.applyTransform(this.transform_);this.set(hi.ACCURACY_GEOMETRY,i);this.changed()},t.prototype.positionError_=function(n){this.setTracking(!1);this.dispatchEvent(new lbt(n))},t.prototype.getAccuracy=function(){return this.get(hi.ACCURACY)},t.prototype.getAccuracyGeometry=function(){return this.get(hi.ACCURACY_GEOMETRY)||null},t.prototype.getAltitude=function(){return this.get(hi.ALTITUDE)},t.prototype.getAltitudeAccuracy=function(){return this.get(hi.ALTITUDE_ACCURACY)},t.prototype.getHeading=function(){return this.get(hi.HEADING)},t.prototype.getPosition=function(){return this.get(hi.POSITION)},t.prototype.getProjection=function(){return this.get(hi.PROJECTION)},t.prototype.getSpeed=function(){return this.get(hi.SPEED)},t.prototype.getTracking=function(){return this.get(hi.TRACKING)},t.prototype.getTrackingOptions=function(){return this.get(hi.TRACKING_OPTIONS)},t.prototype.setProjection=function(n){this.set(hi.PROJECTION,y(n))},t.prototype.setTracking=function(n){this.set(hi.TRACKING,n)},t.prototype.setTrackingOptions=function(n){this.set(hi.TRACKING_OPTIONS,n)},t}(hu),vrt=function(){function n(n,t,i){this.decay_=n;this.minVelocity_=t;this.delay_=i;this.points_=[];this.angle_=0;this.initialVelocity_=0}return n.prototype.begin=function(){this.points_.length=0;this.angle_=0;this.initialVelocity_=0},n.prototype.update=function(n,t){this.points_.push(n,t,Date.now())},n.prototype.end=function(){var u,t,n,f,i,r;if(this.points_.length<6||(u=Date.now()-this.delay_,t=this.points_.length-3,this.points_[t+2]<u))return!1;for(n=t-3;n>0&&this.points_[n+2]>u;)n-=3;return(f=this.points_[t+2]-this.points_[n+2],f<1e3/60)?!1:(i=this.points_[t]-this.points_[n],r=this.points_[t+1]-this.points_[n+1],this.angle_=Math.atan2(r,i),this.initialVelocity_=Math.sqrt(i*i+r*r)/f,this.initialVelocity_>this.minVelocity_)},n.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},n.prototype.getAngle=function(){return this.angle_},n}(),vbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gv=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.map=i,u.frameState=void 0!==r?r:null,u}return vbt(t,n),t}(ur),ybt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yrt=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i,f)||this;return e.originalEvent=r,e.pixel_=null,e.coordinate_=null,e.dragging=void 0!==u&&u,e}return ybt(t,n),Object.defineProperty(t.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(n){this.pixel_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(n){this.coordinate_=n},enumerable:!0,configurable:!0}),t.prototype.preventDefault=function(){n.prototype.preventDefault.call(this);this.originalEvent.preventDefault()},t.prototype.stopPropagation=function(){n.prototype.stopPropagation.call(this);this.originalEvent.stopPropagation()},t}(gv),kh=(i(1),"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():""),pbt=-1!==kh.indexOf("firefox"),wbt=(-1!==kh.indexOf("safari")&&kh.indexOf("chrom"),-1!==kh.indexOf("webkit")&&-1==kh.indexOf("edge")),prt=-1!==kh.indexOf("macintosh"),dh=window.devicePixelRatio||1,wrt="undefined"!=typeof Image&&Image.prototype.decode,st={SINGLECLICK:"singleclick",CLICK:a.CLICK,DBLCLICK:a.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},bbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ro=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i,r,u,f)||this;return e.pointerEvent=r,e}return bbt(t,n),t}(yrt),te={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},kbt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dbt=function(n){function t(t,i){var r=n.call(this,t)||this,u;return r.map_=t,r.clickTimeoutId_,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=i?i*dh:dh,r.down_=null,u=r.map_.getViewport(),r.activePointers_=0,r.trackedTouches_={},r.element_=u,r.pointerdownListenerKey_=nt(u,te.POINTERDOWN,r.handlePointerDown_,r),r.relayedListenerKey_=nt(u,te.POINTERMOVE,r.relayEvent_,r),r}return kbt(t,n),t.prototype.emulateClick_=function(n){var t=new ro(st.CLICK,this.map_,n);this.dispatchEvent(t);void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new ro(st.DBLCLICK,this.map_,n),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var t=new ro(st.SINGLECLICK,this.map_,n);this.dispatchEvent(t)}.bind(this),250)},t.prototype.updateActivePointers_=function(n){var t=n;t.type==st.POINTERUP||t.type==st.POINTERCANCEL?delete this.trackedTouches_[t.pointerId]:t.type==st.POINTERDOWN&&(this.trackedTouches_[t.pointerId]=!0);this.activePointers_=Object.keys(this.trackedTouches_).length},t.prototype.handlePointerUp_=function(n){this.updateActivePointers_(n);var t=new ro(st.POINTERUP,this.map_,n);this.dispatchEvent(t);t.propagationStopped||this.dragging_||!this.isMouseActionButton_(n)||this.emulateClick_(this.down_);0===this.activePointers_&&(this.dragListenerKeys_.forEach(ct),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},t.prototype.isMouseActionButton_=function(n){return 0===n.button},t.prototype.handlePointerDown_=function(n){this.updateActivePointers_(n);var t=new ro(st.POINTERDOWN,this.map_,n);this.dispatchEvent(t);this.down_=n;0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(nt(document,st.POINTERMOVE,this.handlePointerMove_,this),nt(document,st.POINTERUP,this.handlePointerUp_,this),nt(this.element_,st.POINTERCANCEL,this.handlePointerUp_,this))},t.prototype.handlePointerMove_=function(n){if(this.isMoving_(n)){this.dragging_=!0;var t=new ro(st.POINTERDRAG,this.map_,n,this.dragging_);this.dispatchEvent(t)}},t.prototype.relayEvent_=function(n){var t=!(!this.down_||!this.isMoving_(n));this.dispatchEvent(new ro(n.type,this.map_,n,t))},t.prototype.isMoving_=function(n){return this.dragging_||Math.abs(n.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(n.clientY-this.down_.clientY)>this.moveTolerance_},t.prototype.disposeInternal=function(){this.relayedListenerKey_&&(ct(this.relayedListenerKey_),this.relayedListenerKey_=null);this.pointerdownListenerKey_&&(ct(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null);this.dragListenerKeys_.forEach(ct);this.dragListenerKeys_.length=0;this.element_=null;n.prototype.disposeInternal.call(this)},t}(eh),ny="postrender",gbt="movestart",nkt="moveend",sr={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},tkt="prerender",ikt="postrender",brt="precompose",rkt="postcompose",krt="rendercomplete",c={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},ukt=function(){function n(n,t){this.priorityFunction_=n;this.keyFunction_=t;this.elements_=[];this.priorities_=[];this.queuedElements_={}}return n.prototype.clear=function(){this.elements_.length=0;this.priorities_.length=0;pe(this.queuedElements_)},n.prototype.dequeue=function(){var n=this.elements_,t=this.priorities_,i=n[0],r;return 1==n.length?(n.length=0,t.length=0):(n[0]=n.pop(),t[0]=t.pop(),this.siftUp_(0)),r=this.keyFunction_(i),delete this.queuedElements_[r],i},n.prototype.enqueue=function(n){p(!(this.keyFunction_(n)in this.queuedElements_),31);var t=this.priorityFunction_(n);return t!=1/0&&(this.elements_.push(n),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(n)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},n.prototype.getCount=function(){return this.elements_.length},n.prototype.getLeftChildIndex_=function(n){return 2*n+1},n.prototype.getRightChildIndex_=function(n){return 2*n+2},n.prototype.getParentIndex_=function(n){return n-1>>1},n.prototype.heapify_=function(){for(var n=(this.elements_.length>>1)-1;n>=0;n--)this.siftUp_(n)},n.prototype.isEmpty=function(){return 0===this.elements_.length},n.prototype.isKeyQueued=function(n){return n in this.queuedElements_},n.prototype.isQueued=function(n){return this.isKeyQueued(this.keyFunction_(n))},n.prototype.siftUp_=function(n){for(var i=this.elements_,t=this.priorities_,f=i.length,o=i[n],s=t[n],h=n;n<f>>1;){var e=this.getLeftChildIndex_(n),r=this.getRightChildIndex_(n),u=r<f&&t[r]<t[e]?r:e;i[n]=i[u];t[n]=t[u];n=u}i[n]=o;t[n]=s;this.siftDown_(h,n)},n.prototype.siftDown_=function(n,t){for(var r,u=this.elements_,i=this.priorities_,e=u[t],f=i[t];t>n;){if(r=this.getParentIndex_(t),!(i[r]>f))break;u[t]=u[r];i[t]=i[r];t=r}u[t]=e;i[t]=f},n.prototype.reprioritize=function(){for(var r,u,e=this.priorityFunction_,t=this.elements_,f=this.priorities_,i=0,o=t.length,n=0;n<o;++n)(u=e(r=t[n]))==1/0?delete this.queuedElements_[this.keyFunction_(r)]:(f[i]=u,t[i++]=r);t.length=i;f.length=i;this.heapify_()},n}(),fkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),drt=function(n){function t(t,i){var r=n.call(this,function(n){return t.apply(null,n)},function(n){return n[0].getKey()})||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=i,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return fkt(t,n),t.prototype.enqueue=function(t){var i=n.prototype.enqueue.call(this,t);return i&&t[0].addEventListener(a.CHANGE,this.boundHandleTileChange_),i},t.prototype.getTilesLoading=function(){return this.tilesLoading_},t.prototype.handleTileChange=function(n){var t=n.target,i=t.getState(),r;(t.hifi&&i===c.LOADED||i===c.ERROR||i===c.EMPTY||i===c.ABORT)&&(t.removeEventListener(a.CHANGE,this.boundHandleTileChange_),r=t.getKey(),r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_())},t.prototype.loadMoreTiles=function(n,t){for(var f,i,r,u=0,e=!1;this.tilesLoading_<n&&u<t&&this.getCount()>0;)r=(i=this.dequeue()[0]).getKey(),(f=i.getState())===c.ABORT?e=!0:f!==c.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++u,i.load());0===u&&e&&this.tileChangeCallback_()},t}(ukt),ekt=42,gh=256;var lr=0,fu=1,ty="center",yb="resolution",vl="rotation";out=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();sy=0;bb=function(n){function t(t){var i=n.call(this)||this,r=d({},t);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=dw(r.projection,"EPSG:3857"),i.targetCenter_=null,i.targetResolution_,i.targetRotation_,r.center&&(r.center=pi(r.center,i.projection_)),r.extent&&(r.extent=uf(r.extent,i.projection_)),i.applyOptions_(r),i}return out(t,n),t.prototype.applyOptions_=function(n){var t=function(n){var a,t,i,f=void 0!==n.minZoom?n.minZoom:sy,e=void 0!==n.maxZoom?n.maxZoom:28,r=void 0!==n.zoomFactor?n.zoomFactor:2,p=void 0!==n.multiWorld&&n.multiWorld,h=void 0===n.smoothResolutionConstraint||n.smoothResolutionConstraint,v=dw(n.projection,"EPSG:3857"),c=v.getExtent(),s=n.constrainOnlyCenter,o=n.extent,u,l,y;return p||o||!v.isGlobal()||(s=!1,o=c),void 0!==n.resolutions?(u=n.resolutions,t=u[f],i=void 0!==u[e]?u[e]:u[u.length-1],a=n.constrainResolution?function(n,t,i){return function(r,u,f,e){var l,o;if(void 0!==r){var h=n[0],c=n[n.length-1],s=i?lb(h,i,f):h;return e?void 0===t||t?ab(r,s,c):kt(r,c,s):(l=Math.min(s,r),o=Math.floor(rv(n,l,u)),n[o]>s&&o<n.length-1?n[o+1]:n[o])}}}(u,h,!s&&o):nut(t,i,h,!s&&o)):(l=(c?Math.max(vt(c),ni(c)):360*cu[lu.DEGREES]/v.getMetersPerUnit())/gh/Math.pow(2,sy),y=l/Math.pow(2,28-sy),void 0!==(t=n.maxResolution)?f=0:t=l/Math.pow(r,f),void 0===(i=n.minResolution)&&(i=void 0!==n.maxZoom?void 0!==n.maxResolution?t/Math.pow(r,e):l/Math.pow(r,e):y),e=f+Math.floor(Math.log(t/i)/Math.log(r)),i=t/Math.pow(r,e-f),a=n.constrainResolution?function(n,t,i,r,u){return function(f,e,o,s){var h,c;if(void 0!==f){if(h=u?lb(t,u,o):t,c=void 0!==i?i:0,s)return void 0===r||r?ab(f,h,c):kt(f,c,h);var l=Math.ceil(Math.log(t/h)/Math.log(n)-1e-9),a=-e*(.5-1e-9)+.5,v=Math.min(h,f),y=Math.floor(Math.log(t/v)/Math.log(n)+a),p=Math.max(l,y);return kt(t/Math.pow(n,p),c,h)}}}(r,t,i,h,!s&&o):nut(t,i,h,!s&&o)),{constraint:a,maxResolution:t,minResolution:i,minZoom:f,zoomFactor:r}}(n);this.maxResolution_=t.maxResolution;this.minResolution_=t.minResolution;this.zoomFactor_=t.zoomFactor;this.resolutions_=n.resolutions;this.minZoom_=t.minZoom;var i=function(n){var r,i,t;return void 0!==n.extent?(r=void 0===n.smoothExtentConstraint||n.smoothExtentConstraint,grt(n.extent,n.constrainOnlyCenter,r)):(i=dw(n.projection,"EPSG:3857"),!0!==n.multiWorld&&i.isGlobal())?(t=i.getExtent().slice(),t[0]=-1/0,t[2]=1/0,grt(t,!1,!1)):okt}(n),r=t.constraint,u=function(n){var t,r,i,f,u;return void 0===n.enableRotation||n.enableRotation?(t=n.constrainRotation,void 0===t||!0===t?(u=f||yu(5),function(n,t){return t?n:void 0!==n?Math.abs(n)<=u?0:n:void 0}):!1===t?tut:"number"==typeof t?(r=t,i=2*Math.PI/r,function(n,t){return t?n:void 0!==n?n=Math.floor(n/i+.5)*i:void 0}):tut):vb}(n);this.constraints_={center:i,resolution:r,rotation:u};this.setRotation(void 0!==n.rotation?n.rotation:0);this.setCenterInternal(void 0!==n.center?n.center:null);void 0!==n.resolution?this.setResolution(n.resolution):void 0!==n.zoom&&this.setZoom(n.zoom);this.resolveConstraints(0);this.setProperties({});this.options_=n},t.prototype.getUpdatedOptions_=function(n){var t=d({},this.options_);return void 0!==t.resolution?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),d({},t,n)},t.prototype.animate=function(){var i,t,n;for(this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0),i=new Array(arguments.length),t=0;t<i.length;++t)n=arguments[t],n.center&&((n=d({},n)).center=pi(n.center,this.getProjection())),n.anchor&&((n=d({},n)).anchor=pi(n.anchor,this.getProjection())),i[t]=n;this.animateInternal.apply(this,i)},t.prototype.animateInternal=function(){var u,r=arguments.length,i,t,n,l;if(r>1&&"function"==typeof arguments[r-1]&&(u=arguments[r-1],--r),!this.isDef())return i=arguments[r-1],i.center&&this.setCenterInternal(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(u&&hy(u,!0));for(var s=Date.now(),h=this.targetCenter_.slice(),f=this.targetResolution_,e=this.targetRotation_,c=[],o=0;o<r;++o)t=arguments[o],n={start:s,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||oy,callback:u},(t.center&&(n.sourceCenter=h,n.targetCenter=t.center.slice(),h=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=f,n.targetResolution=this.getResolutionForZoom(t.zoom),f=n.targetResolution):t.resolution&&(n.sourceResolution=f,n.targetResolution=t.resolution,f=n.targetResolution),void 0!==t.rotation)&&(n.sourceRotation=e,l=pu(t.rotation-e+Math.PI,2*Math.PI)-Math.PI,n.targetRotation=e+l,e=n.targetRotation),skt(n)?n.complete=!0:s+=n.duration,c.push(n);this.animations_.push(c);this.setHint(lr,1);this.updateAnimations_()},t.prototype.getAnimating=function(){return this.hints_[lr]>0},t.prototype.getInteracting=function(){return this.hints_[fu]>0},t.prototype.cancelAnimations=function(){var n,i,t;for(this.setHint(lr,-this.hints_[lr]),n=0,i=this.animations_.length;n<i;++n)t=this.animations_[n],t[0].callback&&hy(t[0].callback,!1);this.animations_.length=0},t.prototype.updateAnimations_=function(){var n,l,r,t,e,y,p,o,w,s;if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var b=Date.now(),h=!1,i=this.animations_.length-1;i>=0;--i){for(var u=this.animations_[i],c=!0,f=0,k=u.length;f<k;++f)if(n=u[f],!n.complete){if(l=b-n.start,r=n.duration>0?l/n.duration:1,r>=1?(n.complete=!0,r=1):c=!1,t=n.easing(r),n.sourceCenter){var a=n.sourceCenter[0],v=n.sourceCenter[1],d=a+t*(n.targetCenter[0]-a),g=v+t*(n.targetCenter[1]-v);this.targetCenter_=[d,g]}if(n.sourceResolution&&n.targetResolution&&(e=1===t?n.targetResolution:n.sourceResolution+t*(n.targetResolution-n.sourceResolution),n.anchor&&(y=this.getSizeFromViewport_(this.getRotation()),p=this.constraints_.resolution(e,0,y,!0),this.targetCenter_=this.calculateCenterZoom(p,n.anchor)),this.targetResolution_=e,this.applyTargetState_(!0)),void 0!==n.sourceRotation&&void 0!==n.targetRotation&&(o=1===t?pu(n.targetRotation+Math.PI,2*Math.PI)-Math.PI:n.sourceRotation+t*(n.targetRotation-n.sourceRotation),n.anchor&&(w=this.constraints_.rotation(o,!0),this.targetCenter_=this.calculateCenterRotate(w,n.anchor)),this.targetRotation_=o),this.applyTargetState_(!0),h=!0,!n.complete)break}c&&(this.animations_[i]=null,this.setHint(lr,-1),s=u[0].callback,s&&hy(s,!0))}this.animations_=this.animations_.filter(Boolean);h&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},t.prototype.calculateCenterRotate=function(n,t){var i,r=this.getCenterInternal();return void 0!==r&&(uy(i=[r[0]-t[0],r[1]-t[1]],n-this.getRotation()),pb(i,t)),i},t.prototype.calculateCenterZoom=function(n,t){var u,i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r&&(u=[t[0]-n*(t[0]-i[0])/r,t[1]-n*(t[1]-i[1])/r]),u},t.prototype.getSizeFromViewport_=function(n){var t=[100,100],e='.ol-viewport[data-view="'+v(this)+'"]',f=document.querySelector(e),i,r,u;return f&&(i=getComputedStyle(f),t[0]=parseInt(i.width,10),t[1]=parseInt(i.height,10)),n&&(r=t[0],u=t[1],t[0]=Math.abs(r*Math.cos(n))+Math.abs(u*Math.sin(n)),t[1]=Math.abs(r*Math.sin(n))+Math.abs(u*Math.cos(n))),t},t.prototype.getCenter=function(){var n=this.getCenterInternal();return n?el(n,this.getProjection()):n},t.prototype.getCenterInternal=function(){return this.get(ty)},t.prototype.getConstraints=function(){return this.constraints_},t.prototype.getHints=function(n){return void 0!==n?(n[0]=this.hints_[0],n[1]=this.hints_[1],n):this.hints_.slice()},t.prototype.calculateExtent=function(n){return ol(this.calculateExtentInternal(n),this.getProjection())},t.prototype.calculateExtentInternal=function(n){var u=n||this.getSizeFromViewport_(),r=this.getCenterInternal(),t,i;return p(r,1),t=this.getResolution(),p(void 0!==t,2),i=this.getRotation(),p(void 0!==i,3),tl(r,t,i,u)},t.prototype.getMaxResolution=function(){return this.maxResolution_},t.prototype.getMinResolution=function(){return this.minResolution_},t.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},t.prototype.setMaxZoom=function(n){this.applyOptions_(this.getUpdatedOptions_({maxZoom:n}))},t.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},t.prototype.setMinZoom=function(n){this.applyOptions_(this.getUpdatedOptions_({minZoom:n}))},t.prototype.setConstrainResolution=function(n){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:n}))},t.prototype.getProjection=function(){return this.projection_},t.prototype.getResolution=function(){return this.get(yb)},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getResolutionForExtent=function(n,t){return this.getResolutionForExtentInternal(uf(n,this.getProjection()),t)},t.prototype.getResolutionForExtentInternal=function(n,t){var i=t||this.getSizeFromViewport_(),r=vt(n)/i[0],u=ni(n)/i[1];return Math.max(r,u)},t.prototype.getResolutionForValueFunction=function(n){var t=n||2,i=this.maxResolution_,r=this.minResolution_,u=Math.log(i/r)/Math.log(t);return function(n){return i/Math.pow(t,n*u)}},t.prototype.getRotation=function(){return this.get(vl)},t.prototype.getValueForResolutionFunction=function(n){var t=n||2,i=this.maxResolution_,r=this.minResolution_,u=Math.log(i/r)/Math.log(t);return function(n){return Math.log(i/n)/Math.log(t)/u}},t.prototype.getState=function(){var t=this.getCenterInternal(),n=this.getProjection(),i=this.getResolution(),r=this.getRotation();return{center:t.slice(0),projection:void 0!==n?n:null,resolution:i,rotation:r,zoom:this.getZoom()}},t.prototype.getZoom=function(){var n,t=this.getResolution();return void 0!==t&&(n=this.getZoomForResolution(t)),n},t.prototype.getZoomForResolution=function(n){var i,r,u=this.minZoom_||0,t;return this.resolutions_?(t=rv(this.resolutions_,n,1),u=t,i=this.resolutions_[t],r=t==this.resolutions_.length-1?2:i/this.resolutions_[t+1]):(i=this.maxResolution_,r=this.zoomFactor_),u+Math.log(i/n)/Math.log(r)},t.prototype.getResolutionForZoom=function(n){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var t=kt(Math.floor(n),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,kt(n-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,n-this.minZoom_)},t.prototype.fit=function(n,t){var i,e=d({size:this.getSizeFromViewport_()},t||{}),r,u;(p(Array.isArray(n)||"function"==typeof n.getSimplifiedGeometry,24),Array.isArray(n))?(p(!ts(n),25),i=es(r=uf(n,this.getProjection()))):n.getType()===f.CIRCLE?(i=es(r=uf(n.getExtent(),this.getProjection()))).rotate(this.getRotation(),vr(r)):(u=yv(),i=u?i.clone().transform(u,this.getProjection()):n);this.fitInternal(i,e)},t.prototype.fitInternal=function(n,t){var i=t||{},s=i.size,y,u,b,p,w,r;s||(s=this.getSizeFromViewport_());u=void 0!==i.padding?i.padding:[0,0,0,0];b=void 0!==i.nearest&&i.nearest;y=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;for(var o=n.getFlatCoordinates(),k=this.getRotation(),h=Math.cos(-k),f=Math.sin(-k),c=1/0,l=1/0,a=-1/0,v=-1/0,it=n.getStride(),e=0,rt=o.length;e<rt;e+=it)p=o[e]*h-o[e+1]*f,w=o[e]*f+o[e+1]*h,c=Math.min(c,p),l=Math.min(l,w),a=Math.max(a,p),v=Math.max(v,w);r=this.getResolutionForExtentInternal([c,l,a,v],[s[0]-u[1]-u[3],s[1]-u[0]-u[2]]);r=isNaN(r)?y:Math.max(r,y);r=this.getConstrainedResolution(r,b?0:1);f=-f;var d=(c+a)/2,g=(l+v)/2,nt=[(d+=(u[1]-u[3])/2*r)*h-(g+=(u[0]-u[2])/2*r)*f,g*h+d*f],tt=i.callback?i.callback:gf;void 0!==i.duration?this.animateInternal({resolution:r,center:this.getConstrainedCenter(nt,r),duration:i.duration,easing:i.easing},tt):(this.targetResolution_=r,this.targetCenter_=nt,this.applyTargetState_(!1,!0),hy(tt,!0))},t.prototype.centerOn=function(n,t,i){this.centerOnInternal(pi(n,this.getProjection()),t,i)},t.prototype.centerOnInternal=function(n,t,i){var f=this.getRotation(),u=Math.cos(-f),r=Math.sin(-f),e=n[0]*u-n[1]*r,o=n[1]*u+n[0]*r,s=this.getResolution(),h=(e+=(t[0]/2-i[0])*s)*u-(o+=(i[1]-t[1]/2)*s)*(r=-r),c=o*u+e*r;this.setCenterInternal([h,c])},t.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},t.prototype.adjustCenter=function(n){var t=el(this.targetCenter_,this.getProjection());this.setCenter([t[0]+n[0],t[1]+n[1]])},t.prototype.adjustCenterInternal=function(n){var t=this.targetCenter_;this.setCenterInternal([t[0]+n[0],t[1]+n[1]])},t.prototype.adjustResolution=function(n,t){var i=t&&pi(t,this.getProjection());this.adjustResolutionInternal(n,i)},t.prototype.adjustResolutionInternal=function(n,t){var i=this.getAnimating()||this.getInteracting(),r=this.getSizeFromViewport_(this.getRotation()),u=this.constraints_.resolution(this.targetResolution_*n,0,r,i);void 0!==t&&(this.targetCenter_=this.calculateCenterZoom(u,t));this.targetResolution_*=n;this.applyTargetState_()},t.prototype.adjustZoom=function(n,t){this.adjustResolution(Math.pow(this.zoomFactor_,-n),t)},t.prototype.adjustRotation=function(n,t){t&&(t=pi(t,this.getProjection()));this.adjustRotationInternal(n,t)},t.prototype.adjustRotationInternal=function(n,t){var i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+n,i);void 0!==t&&(this.targetCenter_=this.calculateCenterRotate(r,t));this.targetRotation_+=n;this.applyTargetState_()},t.prototype.setCenter=function(n){this.setCenterInternal(pi(n,this.getProjection()))},t.prototype.setCenterInternal=function(n){this.targetCenter_=n;this.applyTargetState_()},t.prototype.setHint=function(n,t){return this.hints_[n]+=t,this.changed(),this.hints_[n]},t.prototype.setResolution=function(n){this.targetResolution_=n;this.applyTargetState_()},t.prototype.setRotation=function(n){this.targetRotation_=n;this.applyTargetState_()},t.prototype.setZoom=function(n){this.setResolution(this.getResolutionForZoom(n))},t.prototype.applyTargetState_=function(n,t){var i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),f=this.getSizeFromViewport_(r),u=this.constraints_.resolution(this.targetResolution_,0,f,i),e=this.constraints_.center(this.targetCenter_,u,f,i);this.get(vl)!==r&&this.set(vl,r);this.get(yb)!==u&&this.set(yb,u);this.get(ty)&&ef(this.get(ty),e)||this.set(ty,e);this.getAnimating()&&!n&&this.cancelAnimations()},t.prototype.resolveConstraints=function(n,t,i){var e=void 0!==n?n:200,s=t||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getSizeFromViewport_(r),u=this.constraints_.resolution(this.targetResolution_,s,o),f=this.constraints_.center(this.targetCenter_,u,o);if(0===e)return this.targetResolution_=u,this.targetRotation_=r,this.targetCenter_=f,void this.applyTargetState_();this.getResolution()===u&&this.getRotation()===r&&this.getCenterInternal()&&ef(this.getCenterInternal(),f)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:f,resolution:u,duration:e,easing:uo,anchor:i}))},t.prototype.beginInteraction=function(){this.resolveConstraints(0);this.setHint(fu,1)},t.prototype.endInteraction=function(n,t,i){var r=i&&pi(i,this.getProjection());this.endInteractionInternal(n,t,r)},t.prototype.endInteractionInternal=function(n,t,i){this.setHint(fu,-1);this.resolveConstraints(n,t,i)},t.prototype.getConstrainedCenter=function(n,t){var i=this.getSizeFromViewport_(this.getRotation());return this.constraints_.center(n,t||this.getResolution(),i)},t.prototype.getConstrainedZoom=function(n,t){var i=this.getResolutionForZoom(n);return this.getZoomForResolution(this.getConstrainedResolution(i,t))},t.prototype.getConstrainedResolution=function(n,t){var i=t||0,r=this.getSizeFromViewport_(this.getRotation());return this.constraints_.resolution(n,i,r)},t}(hu);var dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},lkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kb=function(n){function t(t){var r=n.call(this)||this,i=d({},t);return i[dt.OPACITY]=void 0!==t.opacity?t.opacity:1,p("number"==typeof i[dt.OPACITY],64),i[dt.VISIBLE]=void 0===t.visible||t.visible,i[dt.Z_INDEX]=t.zIndex,i[dt.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,i[dt.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,i[dt.MIN_ZOOM]=void 0!==t.minZoom?t.minZoom:-1/0,i[dt.MAX_ZOOM]=void 0!==t.maxZoom?t.maxZoom:1/0,r.className_=void 0!==i.className?t.className:"ol-layer",delete i.className,r.setProperties(i),r.state_=null,r}return lkt(t,n),t.prototype.getClassName=function(){return this.className_},t.prototype.getLayerState=function(n){var t=this.state_||{layer:this,managed:void 0===n||n},i=this.getZIndex();return t.opacity=kt(Math.round(100*this.getOpacity())/100,0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==i?i:!1===t.managed?1/0:0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t},t.prototype.getLayersArray=function(){return w()},t.prototype.getLayerStatesArray=function(){return w()},t.prototype.getExtent=function(){return this.get(dt.EXTENT)},t.prototype.getMaxResolution=function(){return this.get(dt.MAX_RESOLUTION)},t.prototype.getMinResolution=function(){return this.get(dt.MIN_RESOLUTION)},t.prototype.getMinZoom=function(){return this.get(dt.MIN_ZOOM)},t.prototype.getMaxZoom=function(){return this.get(dt.MAX_ZOOM)},t.prototype.getOpacity=function(){return this.get(dt.OPACITY)},t.prototype.getSourceState=function(){return w()},t.prototype.getVisible=function(){return this.get(dt.VISIBLE)},t.prototype.getZIndex=function(){return this.get(dt.Z_INDEX)},t.prototype.setExtent=function(n){this.set(dt.EXTENT,n)},t.prototype.setMaxResolution=function(n){this.set(dt.MAX_RESOLUTION,n)},t.prototype.setMinResolution=function(n){this.set(dt.MIN_RESOLUTION,n)},t.prototype.setMaxZoom=function(n){this.set(dt.MAX_ZOOM,n)},t.prototype.setMinZoom=function(n){this.set(dt.MIN_ZOOM,n)},t.prototype.setOpacity=function(n){p("number"==typeof n,64);this.set(dt.OPACITY,n)},t.prototype.setVisible=function(n){this.set(dt.VISIBLE,n)},t.prototype.setZIndex=function(n){this.set(dt.Z_INDEX,n)},t.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null);n.prototype.disposeInternal.call(this)},t}(hu),li={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},akt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),db={LAYERS:"layers"},hut=function(n){function t(t){var r=this,u=t||{},f=d({},u),i;return delete f.layers,i=u.layers,(r=n.call(this,f)||this).layersListenerKeys_=[],r.listenerKeys_={},r.addEventListener(ri(db.LAYERS),r.handleLayersChanged_),i?Array.isArray(i)?i=new gi(i.slice(),{unique:!0}):p("function"==typeof i.getArray,43):i=new gi(void 0,{unique:!0}),r.setLayers(i),r}return akt(t,n),t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){var n,r,t;this.layersListenerKeys_.forEach(ct);this.layersListenerKeys_.length=0;n=this.getLayers();for(r in this.layersListenerKeys_.push(nt(n,yi.ADD,this.handleLayersAdd_,this),nt(n,yi.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[r].forEach(ct);pe(this.listenerKeys_);for(var u=n.getArray(),i=0,f=u.length;i<f;i++)t=u[i],this.listenerKeys_[v(t)]=[nt(t,wo,this.handleLayerChange_,this),nt(t,a.CHANGE,this.handleLayerChange_,this)];this.changed()},t.prototype.handleLayersAdd_=function(n){var t=n.element;this.listenerKeys_[v(t)]=[nt(t,wo,this.handleLayerChange_,this),nt(t,a.CHANGE,this.handleLayerChange_,this)];this.changed()},t.prototype.handleLayersRemove_=function(n){var t=v(n.element);this.listenerKeys_[t].forEach(ct);delete this.listenerKeys_[t];this.changed()},t.prototype.getLayers=function(){return this.get(db.LAYERS)},t.prototype.setLayers=function(n){this.set(db.LAYERS,n)},t.prototype.getLayersArray=function(n){var t=void 0!==n?n:[];return this.getLayers().forEach(function(n){n.getLayersArray(t)}),t},t.prototype.getLayerStatesArray=function(n){var r=void 0!==n?n:[],f=r.length,t;this.getLayers().forEach(function(n){n.getLayerStatesArray(r)});for(var i=this.getLayerState(),u=f,e=r.length;u<e;u++)t=r[u],t.opacity*=i.opacity,t.visible=t.visible&&i.visible,t.maxResolution=Math.min(t.maxResolution,i.maxResolution),t.minResolution=Math.max(t.minResolution,i.minResolution),t.minZoom=Math.max(t.minZoom,i.minZoom),t.maxZoom=Math.min(t.maxZoom,i.maxZoom),void 0!==i.extent&&(t.extent=void 0!==t.extent?vu(t.extent,i.extent):i.extent);return r},t.prototype.getSourceState=function(){return li.READY},t}(kb);lut=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var ss,ly,tk=function(n){function t(t){var i=n.call(this)||this,r=function(n){var f=null,r,u,i,t,e;return void 0!==n.keyboardEventTarget&&(f="string"==typeof n.keyboardEventTarget?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget),t={},e=n.layers&&"function"==typeof n.layers.getLayers?n.layers:new hut({layers:n.layers}),t[sr.LAYERGROUP]=e,t[sr.TARGET]=n.target,t[sr.VIEW]=void 0!==n.view?n.view:new bb,void 0!==n.controls&&(Array.isArray(n.controls)?r=new gi(n.controls.slice()):(p("function"==typeof n.controls.getArray,47),r=n.controls)),void 0!==n.interactions&&(Array.isArray(n.interactions)?u=new gi(n.interactions.slice()):(p("function"==typeof n.interactions.getArray,48),u=n.interactions)),void 0!==n.overlays?Array.isArray(n.overlays)?i=new gi(n.overlays.slice()):(p("function"==typeof n.overlays.getArray,49),i=n.overlays):i=new gi,{controls:r,interactions:u,keyboardEventTarget:f,overlays:i,values:t}}(t),f,e,u;i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i);i.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16;i.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:dh;i.postRenderTimeoutHandle_;i.animationDelayKey_;i.animationDelay_=function(){this.animationDelayKey_=void 0;this.renderFrame_(Date.now())}.bind(i);i.coordinateToPixelTransform_=[1,0,0,1,0,0];i.pixelToCoordinateTransform_=[1,0,0,1,0,0];i.frameIndex_=0;i.frameState_=null;i.previousExtent_=null;i.viewPropertyListenerKey_=null;i.viewChangeListenerKey_=null;i.layerGroupPropertyListenerKeys_=null;i.viewport_=document.createElement("div");i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":"");i.viewport_.style.position="relative";i.viewport_.style.overflow="hidden";i.viewport_.style.width="100%";i.viewport_.style.height="100%";i.overlayContainer_=document.createElement("div");i.overlayContainer_.style.position="absolute";i.overlayContainer_.style.zIndex="0";i.overlayContainer_.style.width="100%";i.overlayContainer_.style.height="100%";i.overlayContainer_.className="ol-overlaycontainer";i.viewport_.appendChild(i.overlayContainer_);i.overlayContainerStopEvent_=document.createElement("div");i.overlayContainerStopEvent_.style.position="absolute";i.overlayContainerStopEvent_.style.zIndex="0";i.overlayContainerStopEvent_.style.width="100%";i.overlayContainerStopEvent_.style.height="100%";i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";i.viewport_.appendChild(i.overlayContainerStopEvent_);i.mapBrowserEventHandler_=new dbt(i,t.moveTolerance);f=i.handleMapBrowserEvent.bind(i);for(e in st)i.mapBrowserEventHandler_.addEventListener(st[e],f);return i.keyboardEventTarget_=r.keyboardEventTarget,i.keyHandlerKeys_=null,i.focusHandlerKeys_=null,u=i.handleBrowserEvent.bind(i),i.viewport_.addEventListener(a.CONTEXTMENU,u,!1),i.viewport_.addEventListener(a.WHEEL,u,!1),i.controls=r.controls||new gi,i.interactions=r.interactions||new gi,i.overlays_=r.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new drt(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addEventListener(ri(sr.LAYERGROUP),i.handleLayerGroupChanged_),i.addEventListener(ri(sr.VIEW),i.handleViewChanged_),i.addEventListener(ri(sr.SIZE),i.handleSizeChanged_),i.addEventListener(ri(sr.TARGET),i.handleTargetChanged_),i.setProperties(r.values),i.controls.forEach(function(n){n.setMap(this)}.bind(i)),i.controls.addEventListener(yi.ADD,function(n){n.element.setMap(this)}.bind(i)),i.controls.addEventListener(yi.REMOVE,function(n){n.element.setMap(null)}.bind(i)),i.interactions.forEach(function(n){n.setMap(this)}.bind(i)),i.interactions.addEventListener(yi.ADD,function(n){n.element.setMap(this)}.bind(i)),i.interactions.addEventListener(yi.REMOVE,function(n){n.element.setMap(null)}.bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i.overlays_.addEventListener(yi.ADD,function(n){this.addOverlayInternal_(n.element)}.bind(i)),i.overlays_.addEventListener(yi.REMOVE,function(n){var t=n.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()];n.element.setMap(null)}.bind(i)),i}return lut(t,n),t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method");},t.prototype.addControl=function(n){this.getControls().push(n)},t.prototype.addInteraction=function(n){this.getInteractions().push(n)},t.prototype.addLayer=function(n){this.getLayerGroup().getLayers().push(n)},t.prototype.addOverlay=function(n){this.getOverlays().push(n)},t.prototype.addOverlayInternal_=function(n){var t=n.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=n);n.setMap(this)},t.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose();this.viewport_.removeEventListener(a.CONTEXTMENU,this.boundHandleBrowserEvent_);this.viewport_.removeEventListener(a.WHEEL,this.boundHandleBrowserEvent_);void 0!==this.handleResize_&&(removeEventListener(a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.setTarget(null);n.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(n,t,i){if(this.frameState_){var r=this.getCoordinateFromPixelInternal(n),u=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,f=void 0!==i.layerFilter?i.layerFilter:tu,e=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,u,e,t,null,f,null)}},t.prototype.getFeaturesAtPixel=function(n,t){var i=[];return this.forEachFeatureAtPixel(n,function(n){i.push(n)},t),i},t.prototype.forEachLayerAtPixel=function(n,t,i){if(this.frameState_){var r=i||{},u=void 0!==r.hitTolerance?r.hitTolerance*this.frameState_.pixelRatio:0,f=r.layerFilter||tu;return this.renderer_.forEachLayerAtPixel(n,this.frameState_,u,t,f)}},t.prototype.hasFeatureAtPixel=function(n,t){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixelInternal(n),r=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:tu,u=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0,f=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,u,f,r,null)},t.prototype.getEventCoordinate=function(n){return this.getCoordinateFromPixel(this.getEventPixel(n))},t.prototype.getEventCoordinateInternal=function(n){return this.getCoordinateFromPixelInternal(this.getEventPixel(n))},t.prototype.getEventPixel=function(n){var t=this.viewport_.getBoundingClientRect(),i="changedTouches"in n?n.changedTouches[0]:n;return[i.clientX-t.left,i.clientY-t.top]},t.prototype.getTarget=function(){return this.get(sr.TARGET)},t.prototype.getTargetElement=function(){var n=this.getTarget();return void 0!==n?"string"==typeof n?document.getElementById(n):n:null},t.prototype.getCoordinateFromPixel=function(n){return el(this.getCoordinateFromPixelInternal(n),this.getView().getProjection())},t.prototype.getCoordinateFromPixelInternal=function(n){var t=this.frameState_;return t?bt(t.pixelToCoordinateTransform,n.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(n){var t=this.overlayIdIndex_[n.toString()];return void 0!==t?t:null},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(sr.LAYERGROUP)},t.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},t.prototype.getLoading=function(){for(var t,i=this.getLayerGroup().getLayerStatesArray(),n=0,r=i.length;n<r;++n)if(t=i[n].layer.getSource(),t&&t.loading)return!0;return!1},t.prototype.getPixelFromCoordinate=function(n){var t=pi(n,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)},t.prototype.getPixelFromCoordinateInternal=function(n){var t=this.frameState_;return t?bt(t.coordinateToPixelTransform,n.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(sr.SIZE)},t.prototype.getView=function(){return this.get(sr.VIEW)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getTilePriority=function(n,t,i,r){var u=this.frameState_;if(!(u&&t in u.wantedTiles)||!u.wantedTiles[t][n.getKey()])return 1/0;var f=u.viewState.center,e=i[0]-f[0],o=i[1]-f[1];return 65536*Math.log(r)+Math.sqrt(e*e+o*o)/r},t.prototype.handleBrowserEvent=function(n,t){var i=t||n.type,r=new yrt(i,this,n);this.handleMapBrowserEvent(r)},t.prototype.handleMapBrowserEvent=function(n){var t,r,i,u;if(this.frameState_){for(t=n.originalEvent.target;t instanceof HTMLElement;){if(t.parentElement===this.overlayContainerStopEvent_)return;t=t.parentElement}if(n.frameState=this.frameState_,r=this.getInteractions().getArray(),!1!==this.dispatchEvent(n))for(i=r.length-1;i>=0;i--)if(u=r[i],u.getActive()&&!u.handleEvent(n))break}},t.prototype.handlePostRender=function(){var n=this.frameState_,i=this.tileQueue_,t,r,u,f;i.isEmpty()||(t=this.maxTilesLoading_,r=t,n&&(u=n.viewHints,(u[lr]||u[fu])&&(f=!wrt&&Date.now()-n.time>8,t=f?0:8,r=f?0:2)),i.getTilesLoading()<t&&(i.reprioritize(),i.loadMoreTiles(t,r)));!n||!this.hasListener(krt)||n.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(krt,n);for(var e=this.postRenderFunctions_,o=0,s=e.length;o<s;++o)e[o](this,n);e.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0);this.render()},t.prototype.handleTargetChanged_=function(){var n,t,i,r,u;if(this.getTarget()&&(n=this.getTargetElement()),this.focusHandlerKeys_){for(t=0,i=this.focusHandlerKeys_.length;t<i;++t)ct(this.focusHandlerKeys_[t]);this.focusHandlerKeys_=null}if(this.keyHandlerKeys_){for(t=0,i=this.keyHandlerKeys_.length;t<i;++t)ct(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}n?(n.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),r=!0,n.hasAttribute("tabindex")&&(r=document.activeElement===n,this.focusHandlerKeys_=[nt(n,a.FOCUS,nk.bind(this,this.viewport_,"none")),nt(n,a.BLUR,nk.bind(this,this.viewport_,"auto"))]),nk(this.viewport_,r?"none":"auto"),u=this.keyboardEventTarget_?this.keyboardEventTarget_:n,this.keyHandlerKeys_=[nt(u,a.KEYDOWN,this.handleBrowserEvent,this),nt(u,a.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(a.RESIZE,this.handleResize_,!1))):(this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),cy(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0));this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(ct(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null);this.viewChangeListenerKey_&&(ct(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var n=this.getView();n&&(this.viewport_.setAttribute("data-view",v(n)),this.viewPropertyListenerKey_=nt(n,wo,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(n,a.CHANGE,this.handleViewPropertyChanged_,this),n.resolveConstraints(0));this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ct),this.layerGroupPropertyListenerKeys_=null);var n=this.getLayerGroup();n&&(this.layerGroupPropertyListenerKeys_=[nt(n,wo,this.render,this),nt(n,a.CHANGE,this.render,this)]);this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_);this.animationDelay_()},t.prototype.redrawText=function(){for(var t,i=this.getLayerGroup().getLayerStatesArray(),n=0,r=i.length;n<r;++n)t=i[n].layer,t.hasRenderer()&&t.getRenderer().handleFontsChanged()},t.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(n){return this.getControls().remove(n)},t.prototype.removeInteraction=function(n){return this.getInteractions().remove(n)},t.prototype.removeLayer=function(n){return this.getLayerGroup().getLayers().remove(n)},t.prototype.removeOverlay=function(n){return this.getOverlays().remove(n)},t.prototype.renderFrame_=function(n){var r=this.getSize(),u=this.getView(),f=this.frameState_,t=null,e,i;void 0!==r&&function(n){return n[0]>0&&n[1]>0}(r)&&u&&u.isDef()&&(e=u.getHints(this.frameState_?this.frameState_.viewHints:void 0),i=u.getState(),t={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:f?f.declutterItems:[],extent:tl(i.center,i.resolution,i.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:n,usedTiles:{},viewState:i,viewHints:e,wantedTiles:{}});(this.frameState_=t,this.renderer_.renderFrame(t),t)&&((t.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,t.postRenderFunctions),f)&&(this.previousExtent_&&(ts(this.previousExtent_)||uu(t.extent,this.previousExtent_))||(this.dispatchEvent(new gv(gbt,this,f)),this.previousExtent_=oh(this.previousExtent_))),!this.previousExtent_||t.viewHints[lr]||t.viewHints[fu]||uu(t.extent,this.previousExtent_)||(this.dispatchEvent(new gv(nkt,this,t)),nit(t.extent,this.previousExtent_)));this.dispatchEvent(new gv(ny,this,t));this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},t.prototype.setLayerGroup=function(n){this.set(sr.LAYERGROUP,n)},t.prototype.setSize=function(n){this.set(sr.SIZE,n)},t.prototype.setTarget=function(n){this.set(sr.TARGET,n)},t.prototype.setView=function(n){this.set(sr.VIEW,n)},t.prototype.updateSize=function(){var t=this.getTargetElement(),n;t?(n=getComputedStyle(t),this.setSize([t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth)])):this.setSize(void 0)},t}(hu),vkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),of=function(n){function t(t){var i=n.call(this)||this;return i.element=t.element?t.element:null,i.target_=null,i.map_=null,i.listenerKeys=[],i.render=t.render?t.render:gf,t.target&&i.setTarget(t.target),i}return vkt(t,n),t.prototype.disposeInternal=function(){cy(this.element);n.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(n){this.map_&&cy(this.element);for(var t=0,i=this.listenerKeys.length;t<i;++t)ct(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=n,this.map_)&&((this.target_?this.target_:n.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==gf&&this.listenerKeys.push(nt(n,ny,this.render,this)),n.render())},t.prototype.setTarget=function(n){this.target_="string"==typeof n?document.getElementById(n):n},t}(hu),ay="ol-hidden",ykt="ol-selectable",sf="ol-unselectable",pkt="ol-unsupported",hs="ol-control",vy="ol-collapsed",wkt=(ly={},function(n){var i;if(ss||(ss=document.createElement("div").style),!(n in ly)){ss.font=n;var t=ss.fontFamily,r=ss.fontWeight,u=ss.fontStyle;if(ss.font="",!t)return null;i=t.split(/,\s?/);ly[n]={families:i,weight:r,style:u}}return ly[n]}),bkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();yl=function(n){function t(t){var i=this,r=d({},t),u;return delete r.source,(i=n.call(this,r)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,t.render&&(i.render=t.render),t.map&&i.setMap(t.map),i.addEventListener(ri(dt.SOURCE),i.handleSourcePropertyChange_),u=t.source?t.source:null,i.setSource(u),i}return bkt(t,n),t.prototype.getLayersArray=function(n){var t=n||[];return t.push(this),t},t.prototype.getLayerStatesArray=function(n){var t=n||[];return t.push(this.getLayerState()),t},t.prototype.getSource=function(){return this.get(dt.SOURCE)||null},t.prototype.getSourceState=function(){var n=this.getSource();return n?n.getState():li.UNDEFINED},t.prototype.handleSourceChange_=function(){this.changed()},t.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(ct(this.sourceChangeKey_),this.sourceChangeKey_=null);var n=this.getSource();n&&(this.sourceChangeKey_=nt(n,a.CHANGE,this.handleSourceChange_,this));this.changed()},t.prototype.getFeatures=function(n){return this.renderer_.getFeatures(n)},t.prototype.render=function(n,t){var i=this.getRenderer();if(i.prepareFrame(n))return i.renderFrame(n,t)},t.prototype.setMap=function(n){this.mapPrecomposeKey_&&(ct(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null);n||this.changed();this.mapRenderKey_&&(ct(this.mapRenderKey_),this.mapRenderKey_=null);n&&(this.mapPrecomposeKey_=nt(n,brt,function(n){n.frameState.layerStatesArray.push(this.getLayerState(!1))},this),this.mapRenderKey_=nt(this,a.CHANGE,n.render,n),this.changed())},t.prototype.setSource=function(n){this.set(dt.SOURCE,n)},t.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},t.prototype.hasRenderer=function(){return!!this.renderer_},t.prototype.createRenderer=function(){return null},t.prototype.disposeInternal=function(){this.setSource(null);n.prototype.disposeInternal.call(this)},t}(kb);aut=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();ik=function(n){function t(t){var i=this,r=t||{},f,s,u,h,e;(i=n.call(this,{element:document.createElement("div"),render:r.render||vut,target:r.target})||this).ulElement_=document.createElement("ul");i.collapsed_=void 0===r.collapsed||r.collapsed;i.overrideCollapsible_=void 0!==r.collapsible;i.collapsible_=void 0===r.collapsible||r.collapsible;i.collapsible_||(i.collapsed_=!1);var c=void 0!==r.className?r.className:"ol-attribution",l=void 0!==r.tipLabel?r.tipLabel:"Attributions",o=void 0!==r.collapseLabel?r.collapseLabel:"";return"string"==typeof o?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=o):i.collapseLabel_=o,f=void 0!==r.label?r.label:"i","string"==typeof f?(i.label_=document.createElement("span"),i.label_.textContent=f):i.label_=f,s=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,u=document.createElement("button"),u.setAttribute("type","button"),u.title=l,u.appendChild(s),u.addEventListener(a.CLICK,i.handleClick_.bind(i),!1),h=c+" "+sf+" "+hs+(i.collapsed_&&i.collapsible_?" "+vy:"")+(i.collapsible_?"":" ol-uncollapsible"),e=i.element,e.className=h,e.appendChild(i.ulElement_),e.appendChild(u),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return aut(t,n),t.prototype.collectSourceAttributions_=function(n){for(var o,u,s,t,i,c,r={},f=[],h=n.layerStatesArray,e=0,l=h.length;e<l;++e)if(o=h[e],yy(o,n.viewState)&&(u=o.layer.getSource(),u&&(s=u.getAttributions(),s&&(t=s(n),t))))if(this.overrideCollapsible_||!1!==u.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(t))for(i=0,c=t.length;i<c;++i)t[i]in r||(f.push(t[i]),r[t[i]]=!0);else t in r||(f.push(t),r[t]=!0);return f},t.prototype.updateElement_=function(n){var t,i,r,f,u;if(n){if(t=this.collectSourceAttributions_(n),i=t.length>0,this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!be(t,this.renderedAttributions_)){for(sut(this.ulElement_),r=0,f=t.length;r<f;++r)u=document.createElement("li"),u.innerHTML=t[r],this.ulElement_.appendChild(u);this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.handleClick_=function(n){n.preventDefault();this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(vy);this.collapsed_?nc(this.collapseLabel_,this.label_):nc(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(n){this.collapsible_!==n&&(this.collapsible_=n,this.element.classList.toggle("ol-uncollapsible"),!n&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(n){this.collapsible_&&this.collapsed_!==n&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t}(of);yut=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var wut=function(n){function t(t){var i=this,r=t||{},e,f,s,u,h,o;return i=n.call(this,{element:document.createElement("div"),render:r.render||put,target:r.target})||this,e=void 0!==r.className?r.className:"ol-rotate",f=void 0!==r.label?r.label:"",i.label_=null,"string"==typeof f?(i.label_=document.createElement("span"),i.label_.className="ol-compass",i.label_.textContent=f):(i.label_=f,i.label_.classList.add("ol-compass")),s=r.tipLabel?r.tipLabel:"Reset rotation",u=document.createElement("button"),u.className=e+"-reset",u.setAttribute("type","button"),u.title=s,u.appendChild(i.label_),u.addEventListener(a.CLICK,i.handleClick_.bind(i),!1),h=e+" "+sf+" "+hs,o=i.element,o.className=h,o.appendChild(u),i.callResetNorth_=r.resetNorth?r.resetNorth:void 0,i.duration_=void 0!==r.duration?r.duration:250,i.autoHide_=void 0===r.autoHide||r.autoHide,i.rotation_=void 0,i.autoHide_&&i.element.classList.add(ay),i}return yut(t,n),t.prototype.handleClick_=function(n){n.preventDefault();void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},t.prototype.resetNorth_=function(){var n=this.getMap().getView();n&&void 0!==n.getRotation()&&(this.duration_>0?n.animate({rotation:0,duration:this.duration_,easing:uo}):n.setRotation(0))},t}(of),kkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),but=function(n){function t(t){var r=this,i=t||{},u,l,e;r=n.call(this,{element:document.createElement("div"),target:i.target})||this;var o=void 0!==i.className?i.className:"ol-zoom",c=void 0!==i.delta?i.delta:1,s=void 0!==i.zoomInLabel?i.zoomInLabel:"+",h=void 0!==i.zoomOutLabel?i.zoomOutLabel:"",v=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",y=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",f=document.createElement("button");return f.className=o+"-in",f.setAttribute("type","button"),f.title=v,f.appendChild("string"==typeof s?document.createTextNode(s):s),f.addEventListener(a.CLICK,r.handleClick_.bind(r,c),!1),u=document.createElement("button"),u.className=o+"-out",u.setAttribute("type","button"),u.title=y,u.appendChild("string"==typeof h?document.createTextNode(h):h),u.addEventListener(a.CLICK,r.handleClick_.bind(r,-c),!1),l=o+" "+sf+" "+hs,e=r.element,e.className=l,e.appendChild(f),e.appendChild(u),r.duration_=void 0!==i.duration?i.duration:250,r}return kkt(t,n),t.prototype.handleClick_=function(n,t){t.preventDefault();this.zoomByDelta_(n)},t.prototype.zoomByDelta_=function(n){var t=this.getMap().getView(),i,r;t&&(i=t.getZoom(),void 0!==i&&(r=t.getConstrainedZoom(i+n),this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:uo})):t.setZoom(r)))},t}(of);pl={ACTIVE:"active"};dut=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();ie=function(n){function t(t){var i=n.call(this)||this;return t.handleEvent&&(i.handleEvent=t.handleEvent),i.map_=null,i.setActive(!0),i}return dut(t,n),t.prototype.getActive=function(){return this.get(pl.ACTIVE)},t.prototype.getMap=function(){return this.map_},t.prototype.handleEvent=function(){return!0},t.prototype.setActive=function(n){this.set(pl.ACTIVE,n)},t.prototype.setMap=function(n){this.map_=n},t}(hu);gut=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var nft=function(n){function t(t){var r=n.call(this,{handleEvent:dkt})||this,i=t||{};return r.delta_=i.delta?i.delta:1,r.duration_=void 0!==i.duration?i.duration:250,r}return gut(t,n),t}(ie),tft=function(n){var t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},ift=function(n){var t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},uk=function(n){return n.target.getTargetElement()===document.activeElement},wl=tu,rft=function(n){var t=n.originalEvent;return 0==t.button&&!(wbt&&prt&&t.ctrlKey)},fk=go,ek=function(n){return n.type==st.SINGLECLICK},py=function(n){var t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},bl=function(n){var t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},ok=function(n){var t=n.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},hf=function(n){var t=n.pointerEvent;return p(void 0!==t,56),"mouse"==t.pointerType},sk=function(n){var t=n.pointerEvent;return p(void 0!==t,56),t.isPrimary&&0===t.button},gkt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();ou=function(n){function t(t){var r=this,i=t||{};return r=n.call(this,i)||this,i.handleDownEvent&&(r.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(r.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(r.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(r.handleUpEvent=i.handleUpEvent),i.stopDown&&(r.stopDown=i.stopDown),r.handlingDownUpSequence=!1,r.trackedPointers_={},r.targetPointers=[],r}return gkt(t,n),t.prototype.handleDownEvent=function(){return!1},t.prototype.handleDragEvent=function(){},t.prototype.handleEvent=function(n){var i,r,t;return n.pointerEvent?(i=!1,(this.updateTrackedPointers_(n),this.handlingDownUpSequence)?n.type==st.POINTERDRAG?this.handleDragEvent(n):n.type==st.POINTERUP&&(r=this.handleUpEvent(n),this.handlingDownUpSequence=r&&this.targetPointers.length>0):n.type==st.POINTERDOWN?(t=this.handleDownEvent(n),t&&n.preventDefault(),this.handlingDownUpSequence=t,i=this.stopDown(t)):n.type==st.POINTERMOVE&&this.handleMoveEvent(n),!i):!0},t.prototype.handleMoveEvent=function(){},t.prototype.handleUpEvent=function(){return!1},t.prototype.stopDown=function(n){return n},t.prototype.updateTrackedPointers_=function(n){if(function(n){var t=n.type;return t===st.POINTERDOWN||t===st.POINTERDRAG||t===st.POINTERUP}(n)){var i=n.pointerEvent,t=i.pointerId.toString();n.type==st.POINTERUP?delete this.trackedPointers_[t]:n.type==st.POINTERDOWN?this.trackedPointers_[t]=i:t in this.trackedPointers_&&(this.trackedPointers_[t]=i);this.targetPointers=iv(this.trackedPointers_)}},t}(ie);uft=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var fft=function(n){function t(t){var i=n.call(this,{stopDown:go})||this,r=t||{};return i.kinetic_=r.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1,i.condition_=r.condition?r.condition:ndt,i.noKinetic_=!1,i}return uft(t,n),t.prototype.handleDragEvent=function(n){var i,t,r,u;this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());i=this.targetPointers;t=hk(i);i.length==this.lastPointersCount_?(this.kinetic_&&this.kinetic_.update(t[0],t[1]),this.lastCentroid)&&(r=[this.lastCentroid[0]-t[0],t[1]-this.lastCentroid[1]],u=n.map.getView(),uut(r,u.getResolution()),uy(r,u.getRotation()),u.adjustCenterInternal(r)):this.kinetic_&&this.kinetic_.begin();this.lastCentroid=t;this.lastPointersCount_=i.length},t.prototype.handleUpEvent=function(n){var i=n.map,t=i.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),u=this.kinetic_.getAngle(),e=t.getCenterInternal(),f=i.getPixelFromCoordinateInternal(e),o=i.getCoordinateFromPixelInternal([f[0]-r*Math.cos(u),f[1]-r*Math.sin(u)]);t.animateInternal({center:t.getConstrainedCenter(o),duration:500,easing:uo})}return this.panning_&&(this.panning_=!1,t.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},t.prototype.handleDownEvent=function(n){if(this.targetPointers.length>0&&this.condition_(n)){var t=n.map.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},t}(ou),tdt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eft=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,{stopDown:go})||this).condition_=r.condition?r.condition:ift,i.lastAngle_=void 0,i.duration_=void 0!==r.duration?r.duration:250,i}return tdt(t,n),t.prototype.handleDragEvent=function(n){var t,i,e;if(hf(n)&&(t=n.map,i=t.getView(),i.getConstraints().rotation!==vb)){var r=t.getSize(),u=n.pixel,f=Math.atan2(r[1]/2-u[1],u[0]-r[0]/2);void 0!==this.lastAngle_&&(e=f-this.lastAngle_,i.adjustRotationInternal(-e));this.lastAngle_=f}},t.prototype.handleUpEvent=function(n){return!hf(n)||(n.map.getView().endInteraction(this.duration_),!1)},t.prototype.handleDownEvent=function(n){return!!hf(n)&&!(!rft(n)||!this.condition_(n))&&(n.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)},t}(ou),idt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rdt=function(n){function t(t){var i=n.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.className="ol-box "+t,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return idt(t,n),t.prototype.disposeInternal=function(){this.setMap(null)},t.prototype.render_=function(){var n=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(n[0],t[0])+"px";i.top=Math.min(n[1],t[1])+"px";i.width=Math.abs(t[0]-n[0])+"px";i.height=Math.abs(t[1]-n[1])+"px"},t.prototype.setMap=function(n){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left="inherit";t.top="inherit";t.width="inherit";t.height="inherit"}this.map_=n;this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},t.prototype.setPixels=function(n,t){this.startPixel_=n;this.endPixel_=t;this.createOrUpdateGeometry();this.render_()},t.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,i=this.endPixel_,n=[t,[t[0],i[1]],i,[i[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice();this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new fr([n])},t.prototype.getGeometry=function(){return this.geometry_},t}(ko),oft=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),udt="boxstart",fdt="boxdrag",edt="boxend",ck=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.coordinate=i,u.mapBrowserEvent=r,u}return oft(t,n),t}(ur),sft=function(n){function t(t){var r=n.call(this)||this,i=t||{};return r.box_=new rdt(i.className||"ol-dragbox"),r.minArea_=void 0!==i.minArea?i.minArea:64,r.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:gf,r.startPixel_=null,r.condition_=i.condition?i.condition:wl,r.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:r.defaultBoxEndCondition,r}return oft(t,n),t.prototype.defaultBoxEndCondition=function(n,t,i){var r=i[0]-t[0],u=i[1]-t[1];return r*r+u*u>=this.minArea_},t.prototype.getGeometry=function(){return this.box_.getGeometry()},t.prototype.handleDragEvent=function(n){hf(n)&&(this.box_.setPixels(this.startPixel_,n.pixel),this.dispatchEvent(new ck(fdt,n.coordinate,n)))},t.prototype.handleUpEvent=function(n){return!hf(n)||(this.box_.setMap(null),this.boxEndCondition_(n,this.startPixel_,n.pixel)&&(this.onBoxEnd_(n),this.dispatchEvent(new ck(edt,n.coordinate,n))),!1)},t.prototype.handleDownEvent=function(n){return!!hf(n)&&!(!rft(n)||!this.condition_(n))&&(this.startPixel_=n.pixel,this.box_.setMap(n.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ck(udt,n.coordinate,n)),!0)},t}(ou),odt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var hft=function(n){function t(t){var r=this,i=t||{},u=i.condition?i.condition:bl;return(r=n.call(this,{condition:u,className:i.className||"ol-dragzoom",minArea:i.minArea,onBoxEnd:sdt})||this).duration_=void 0!==i.duration?i.duration:200,r.out_=void 0!==i.out&&i.out,r}return odt(t,n),t}(sft),cs={LEFT:37,UP:38,RIGHT:39,DOWN:40},hdt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();lk=function(n){function t(t){var i=n.call(this,{handleEvent:cdt})||this,r=t||{};return i.defaultCondition_=function(n){return py(n)&&ok(n)},i.condition_=void 0!==r.condition?r.condition:i.defaultCondition_,i.duration_=void 0!==r.duration?r.duration:100,i.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,i}return hdt(t,n),t}(ie);cft=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var lft=function(n){function t(t){var r=n.call(this,{handleEvent:ldt})||this,i=t||{};return r.condition_=i.condition?i.condition:ok,r.delta_=i.delta?i.delta:1,r.duration_=void 0!==i.duration?i.duration:100,r}return cft(t,n),t}(ie),adt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aft="trackpad",vdt="wheel",vft=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,r)||this).totalDelta_=0,i.lastDelta_=0,i.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,i.duration_=void 0!==r.duration?r.duration:250,i.timeout_=void 0!==r.timeout?r.timeout:80,i.useAnchor_=void 0===r.useAnchor||r.useAnchor,i.condition_=r.condition?r.condition:wl,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.trackpadDeltaPerZoom_=300,i}return adt(t,n),t.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},t.prototype.handleEvent=function(n){var t,u,r,i,f,e;return this.condition_(n)?n.type!==a.WHEEL?!0:(n.preventDefault(),u=n.map,r=n.originalEvent,this.useAnchor_&&(this.lastAnchor_=n.coordinate),n.type==a.WHEEL&&(t=r.deltaY,pbt&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(t/=dh),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(t*=40)),0===t)?!1:(this.lastDelta_=t,i=Date.now(),void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(t)<4?aft:vdt),this.mode_===aft)?(f=u.getView(),this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):f.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),f.adjustZoom(-t/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1):(this.totalDelta_+=t,e=Math.max(this.timeout_-(i-this.startTime_),0),clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,u),e),!1):!0},t.prototype.handleWheelZoom_=function(n){var t=n.getView();t.getAnimating()&&t.cancelAnimations();rk(t,-kt(this.totalDelta_,-this.maxDelta_,this.maxDelta_),this.lastAnchor_,this.duration_);this.mode_=void 0;this.totalDelta_=0;this.lastAnchor_=null;this.startTime_=void 0;this.timeoutId_=void 0},t.prototype.setMouseAnchor=function(n){this.useAnchor_=n;n||(this.lastAnchor_=null)},t}(ie),ydt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yft=function(n){function t(t){var i=this,r=t||{},u=r;return u.stopDown||(u.stopDown=go),(i=n.call(this,u)||this).anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=void 0!==r.threshold?r.threshold:.3,i.duration_=void 0!==r.duration?r.duration:250,i}return ydt(t,n),t.prototype.handleDragEvent=function(n){var e=0,o=this.targetPointers[0],s=this.targetPointers[1],h=Math.atan2(s.clientY-o.clientY,s.clientX-o.clientX),r,t,u,f,i;void 0!==this.lastAngle_&&(r=h-this.lastAngle_,this.rotationDelta_+=r,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=r);this.lastAngle_=h;t=n.map;u=t.getView();u.getConstraints().rotation!==vb&&(f=t.getViewport().getBoundingClientRect(),i=hk(this.targetPointers),i[0]-=f.left,i[1]-=f.top,this.anchor_=t.getCoordinateFromPixelInternal(i),this.rotating_&&(t.render(),u.adjustRotationInternal(e,this.anchor_)))},t.prototype.handleUpEvent=function(n){return!(this.targetPointers.length<2)||(n.map.getView().endInteraction(this.duration_),!1)},t.prototype.handleDownEvent=function(n){if(this.targetPointers.length>=2){var t=n.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1},t}(ou),pdt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pft=function(n){function t(t){var i=this,r=t||{},u=r;return u.stopDown||(u.stopDown=go),(i=n.call(this,u)||this).anchor_=null,i.duration_=void 0!==r.duration?r.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return pdt(t,n),t.prototype.handleDragEvent=function(n){var i=1,f=this.targetPointers[0],e=this.targetPointers[1],o=f.clientX-e.clientX,s=f.clientY-e.clientY,h=Math.sqrt(o*o+s*s),t,c,u,r;void 0!==this.lastDistance_&&(i=this.lastDistance_/h);this.lastDistance_=h;t=n.map;c=t.getView();1!=i&&(this.lastScaleDelta_=i);u=t.getViewport().getBoundingClientRect();r=hk(this.targetPointers);r[0]-=u.left;r[1]-=u.top;this.anchor_=t.getCoordinateFromPixelInternal(r);t.render();c.adjustResolutionInternal(i,this.anchor_)},t.prototype.handleUpEvent=function(n){if(this.targetPointers.length<2){var t=n.map.getView(),i=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,i),!1}return!0},t.prototype.handleDownEvent=function(n){if(this.targetPointers.length>=2){var t=n.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1},t}(ou);var wdt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bft=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.inversePixelTransform=i,f.frameState=r,f.context=u,f}return wdt(t,n),t}(ur),bdt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,kdt=/^([a-z]*)$|^hsla?\(.*\)$/i;dft=function(){var n={},t=0;return function(i){var r,u,f;if(n.hasOwnProperty(i))r=n[i];else{if(t>=1024){u=0;for(f in n)0==(3&u++)&&(delete n[f],--t)}r=function(n){var i,r,u,f,e,o,t,s;return kdt.exec(n)&&(n=ddt(n)),bdt.exec(n)?(o=n.length-1,t=void 0,t=o<=4?1:2,s=4===o||8===o,i=parseInt(n.substr(1+0*t,t),16),r=parseInt(n.substr(1+1*t,t),16),u=parseInt(n.substr(1+2*t,t),16),f=s?parseInt(n.substr(1+3*t,t),16):255,1==t&&(i=(i<<4)+i,r=(r<<4)+r,u=(u<<4)+u,s&&(f=(f<<4)+f)),e=[i,r,u,f/255]):0==n.indexOf("rgba(")?gft(e=n.slice(5,-1).split(",").map(Number)):0==n.indexOf("rgb(")?((e=n.slice(4,-1).split(",").map(Number)).push(1),gft(e)):p(!1,14),e}(i);n[i]=r;++t}return r}}();tet=function(){function n(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32}return n.prototype.clear=function(){this.cache_={};this.cacheSize_=0},n.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},n.prototype.expire=function(){var t,n,i;if(this.canExpireCache()){t=0;for(n in this.cache_)i=this.cache_[n],0!=(3&t++)||i.hasListener()||(delete this.cache_[n],--this.cacheSize_)}},n.prototype.get=function(n,t,i){var r=iet(n,t,i);return r in this.cache_?this.cache_[r]:null},n.prototype.set=function(n,t,i,r){var u=iet(n,t,i);this.cache_[u]=r;++this.cacheSize_},n.prototype.setSize=function(n){this.maxCacheSize_=n;this.expire()},n}();tc=new tet;var ak,vk=function(){function n(){}return n.prototype.drawCustom=function(){},n.prototype.drawGeometry=function(){},n.prototype.setStyle=function(){},n.prototype.drawCircle=function(){},n.prototype.drawFeature=function(){},n.prototype.drawGeometryCollection=function(){},n.prototype.drawLineString=function(){},n.prototype.drawMultiLineString=function(){},n.prototype.drawMultiPoint=function(){},n.prototype.drawMultiPolygon=function(){},n.prototype.drawPoint=function(){},n.prototype.drawPolygon=function(){},n.prototype.drawText=function(){},n.prototype.setFillStrokeStyle=function(){},n.prototype.setImageStyle=function(){},n.prototype.setTextStyle=function(){},n}(),gdt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ret=function(n){function t(t){var i=n.call(this)||this;return i.highWaterMark=void 0!==t?t:2048,i.count_=0,i.entries_={},i.oldest_=null,i.newest_=null,i}return gdt(t,n),t.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null;this.dispatchEvent(a.CLEAR)},t.prototype.containsKey=function(n){return this.entries_.hasOwnProperty(n)},t.prototype.forEach=function(n){for(var t=this.oldest_;t;)n(t.value_,t.key_,this),t=t.newer},t.prototype.get=function(n){var t=this.entries_[n];return p(void 0!==t,15),t===this.newest_?t.value_:(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t,t.value_)},t.prototype.remove=function(n){var t=this.entries_[n];return p(void 0!==t,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[n],--this.count_,t.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){for(var t=new Array(this.count_),i=0,n=this.newest_;n;n=n.older)t[i++]=n.key_;return t},t.prototype.getValues=function(){for(var t=new Array(this.count_),i=0,n=this.newest_;n;n=n.older)t[i++]=n.value_;return t},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var n=this.oldest_;return delete this.entries_[n.key_],n.newer&&(n.newer.older=null),this.oldest_=n.newer,this.oldest_||(this.newest_=null),--this.count_,n.value_},t.prototype.replace=function(n,t){this.get(n);this.entries_[n].value_=t},t.prototype.set=function(n,t){p(!(n in this.entries_),16);var i={key_:n,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i;this.newest_=i;this.entries_[n]=i;++this.count_},t.prototype.setSize=function(n){this.highWaterMark=n},t}(eh),ngt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tgt=function(n){function t(t){var i=n.call(this,t)||this;return i.consumers={},i}return ngt(t,n),t.prototype.clear=function(){this.consumers={};n.prototype.clear.call(this)},t.prototype.get=function(t,i){var u=n.prototype.get.call(this,t),r=v(i);return r in this.consumers||(this.consumers[r]={}),this.consumers[r][t]=!0,u},t.prototype.prune=function(){var t,i,n;n:for(;this.canExpireCache();){t=this.peekLastKey();for(n in this.consumers)if(t in this.consumers[n])break n;i=this.pop();for(n in i.width=0,i.height=0,this.consumers)delete this.consumers[n][t]}},t.prototype.release=function(n){delete this.consumers[v(n)]},t}(ret),by=[],ic=[0,0,0,0],re=new tgt,igt={},ky=null,uet={},rgt=function(){function o(n,t,i){for(var h,a,o=fet(),c=!0,l=0;l<s;++l)h=f[l],(o.font=n+" "+t+" "+u+h,r=o.measureText(e).width,i!=h)&&(o.font=n+" "+t+" "+u+i+","+h,a=o.measureText(e).width,c=c&&a!=r);return!!c}function h(){var u=!0;for(var r in n)n[r]<i&&(o.apply(this,r.split("\n"))?(n[r]=i,pe(uet),ky=null,ak=void 0,re.getCount()&&re.clear()):(++n[r],u=!1));u&&(clearInterval(t),t=void 0)}var t,r,i=100,n=igt,u="32px ",f=["monospace","serif"],s=f.length,e="wmytzilWMYTZIL@#/&?$%10";return function(r){var u=wkt(r),s,f;if(u)for(var c=u.families,e=0,l=c.length;e<l;++e)s=c[e],f=u.style+"\n"+u.weight+"\n"+s,f in n||(n[f]=i,o(u.style,u.weight,s)||(n[f]=0,void 0===t&&(t=setInterval(h,32))))}}();eet=(yk=uet,function(n){var t=yk[n];return null==t&&(cf||((cf=document.createElement("div")).innerHTML="M",cf.style.margin="0 !important",cf.style.padding="0 !important",cf.style.position="absolute !important",cf.style.left="-99999px !important"),cf.style.font=n,document.body.appendChild(cf),t=cf.offsetHeight,yk[n]=t,document.body.removeChild(cf)),t});cet=[1,0,0,1,0,0];var ugt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pk=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this)||this;return s.context_=t,s.pixelRatio_=i,s.extent_=r,s.transform_=u,s.viewRotation_=f,s.squaredTolerance_=e,s.userTransform_=o,s.contextFillState_=null,s.contextStrokeState_=null,s.contextTextState_=null,s.fillState_=null,s.strokeState_=null,s.image_=null,s.imageAnchorX_=0,s.imageAnchorY_=0,s.imageHeight_=0,s.imageOpacity_=0,s.imageOriginX_=0,s.imageOriginY_=0,s.imageRotateWithView_=!1,s.imageRotation_=0,s.imageScale_=0,s.imageWidth_=0,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=!1,s.textRotation_=0,s.textScale_=0,s.textFillState_=null,s.textStrokeState_=null,s.textState_=null,s.pixelCoordinates_=[],s.tmpLocalTransform_=[1,0,0,1,0,0],s}return ugt(t,n),t.prototype.drawImages_=function(n,t,i){var u,f,v,o,s,h,c;if(this.image_){var e=ge(n,t,i,2,this.transform_,this.pixelCoordinates_),r=this.context_,l=this.tmpLocalTransform_,a=r.globalAlpha;for(1!=this.imageOpacity_&&(r.globalAlpha=a*this.imageOpacity_),u=this.imageRotation_,this.imageRotateWithView_&&(u+=this.viewRotation_),f=0,v=e.length;f<v;f+=2)o=e[f]-this.imageAnchorX_,s=e[f+1]-this.imageAnchorY_,(0!==u||1!=this.imageScale_)&&(h=o+this.imageAnchorX_,c=s+this.imageAnchorY_,wr(l,h,c,this.imageScale_,this.imageScale_,u,-h,-c),r.setTransform.apply(r,l)),r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,o,s,this.imageWidth_,this.imageHeight_);0===u&&1==this.imageScale_||r.setTransform(1,0,0,1,0,0);1!=this.imageOpacity_&&(r.globalAlpha=a)}},t.prototype.drawText_=function(n,t,i,r){var f,e,h;if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_);this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_);this.setContextTextState_(this.textState_);var s=ge(n,t,i,r,this.transform_,this.pixelCoordinates_),u=this.context_,o=this.textRotation_;for(this.textRotateWithView_&&(o+=this.viewRotation_);t<i;t+=r)f=s[t]+this.textOffsetX_,e=s[t+1]+this.textOffsetY_,(0!==o||1!=this.textScale_)&&(h=wr(this.tmpLocalTransform_,f,e,this.textScale_,this.textScale_,o,-f,-e),u.setTransform.apply(u,h)),this.textStrokeState_&&u.strokeText(this.text_,f,e),this.textFillState_&&u.fillText(this.text_,f,e);0===o&&1==this.textScale_||u.setTransform(1,0,0,1,0,0)}},t.prototype.moveToLineTo_=function(n,t,i,r,u){var o=this.context_,f=ge(n,t,i,r,this.transform_,this.pixelCoordinates_),s,e;for(o.moveTo(f[0],f[1]),s=f.length,u&&(s-=2),e=2;e<s;e+=2)o.lineTo(f[e],f[e+1]);return u&&o.closePath(),i},t.prototype.drawRings_=function(n,t,i,r){for(var u=0,f=i.length;u<f;++u)t=this.moveToLineTo_(n,t,i[u],r,!0);return t},t.prototype.drawCircle=function(n){if(fi(this.extent_,n.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t=function(n,t,i){var r=n.getFlatCoordinates(),u;return r?(u=n.getStride(),ge(r,0,r.length,u,t,i)):null}(n,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],u=t[3]-t[1],f=Math.sqrt(r*r+u*u),i=this.context_;i.beginPath();i.arc(t[0],t[1],f,0,2*Math.PI);this.fillState_&&i.fill();this.strokeState_&&i.stroke()}""!==this.text_&&this.drawText_(n.getCenter(),0,2,2)}},t.prototype.setStyle=function(n){this.setFillStrokeStyle(n.getFill(),n.getStroke());this.setImageStyle(n.getImage());this.setTextStyle(n.getText())},t.prototype.setTransform=function(n){this.transform_=n},t.prototype.drawGeometry=function(n){switch(n.getType()){case f.POINT:this.drawPoint(n);break;case f.LINE_STRING:this.drawLineString(n);break;case f.POLYGON:this.drawPolygon(n);break;case f.MULTI_POINT:this.drawMultiPoint(n);break;case f.MULTI_LINE_STRING:this.drawMultiLineString(n);break;case f.MULTI_POLYGON:this.drawMultiPolygon(n);break;case f.GEOMETRY_COLLECTION:this.drawGeometryCollection(n);break;case f.CIRCLE:this.drawCircle(n)}},t.prototype.drawFeature=function(n,t){var i=t.getGeometryFunction()(n);i&&fi(this.extent_,i.getExtent())&&(this.setStyle(t),this.drawGeometry(i))},t.prototype.drawGeometryCollection=function(n){for(var i=n.getGeometriesArray(),t=0,r=i.length;t<r;++t)this.drawGeometry(i[t])},t.prototype.drawPoint=function(n){this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var t=n.getFlatCoordinates(),i=n.getStride();this.image_&&this.drawImages_(t,0,t.length,i);""!==this.text_&&this.drawText_(t,0,t.length,i)},t.prototype.drawMultiPoint=function(n){this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var t=n.getFlatCoordinates(),i=n.getStride();this.image_&&this.drawImages_(t,0,t.length,i);""!==this.text_&&this.drawText_(t,0,t.length,i)},t.prototype.drawLineString=function(n){var t,i,r;(this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fi(this.extent_,n.getExtent()))&&(this.strokeState_&&(this.setContextStrokeState_(this.strokeState_),t=this.context_,i=n.getFlatCoordinates(),t.beginPath(),this.moveToLineTo_(i,0,i.length,n.getStride(),!1),t.stroke()),""!==this.text_&&(r=n.getFlatMidpoint(),this.drawText_(r,0,2,2)))},t.prototype.drawMultiLineString=function(n){var r,t,o,i;if(this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),r=n.getExtent(),fi(this.extent_,r)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var u=this.context_,s=n.getFlatCoordinates(),f=0,e=n.getEnds(),h=n.getStride();for(u.beginPath(),t=0,o=e.length;t<o;++t)f=this.moveToLineTo_(s,f,e[t],h,!1);u.stroke()}""!==this.text_&&(i=n.getFlatMidpoints(),this.drawText_(i,0,i.length,2))}},t.prototype.drawPolygon=function(n){var t,i;(this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fi(this.extent_,n.getExtent()))&&((this.strokeState_||this.fillState_)&&(this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_),t=this.context_,t.beginPath(),this.drawRings_(n.getOrientedFlatCoordinates(),0,n.getEnds(),n.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()),""!==this.text_&&(i=n.getFlatInteriorPoint(),this.drawText_(i,0,2,2)))},t.prototype.drawMultiPolygon=function(n){var t,e,o,r;if(this.squaredTolerance_&&(n=n.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fi(this.extent_,n.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_,s=n.getOrientedFlatCoordinates(),u=0,f=n.getEndss(),h=n.getStride();for(i.beginPath(),t=0,e=f.length;t<e;++t)o=f[t],u=this.drawRings_(s,u,o,h);this.fillState_&&i.fill();this.strokeState_&&i.stroke()}""!==this.text_&&(r=n.getFlatInteriorPoints(),this.drawText_(r,0,r.length,2))}},t.prototype.setContextFillState_=function(n){var i=this.context_,t=this.contextFillState_;t?t.fillStyle!=n.fillStyle&&(t.fillStyle=n.fillStyle,i.fillStyle=n.fillStyle):(i.fillStyle=n.fillStyle,this.contextFillState_={fillStyle:n.fillStyle})},t.prototype.setContextStrokeState_=function(n){var t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=n.lineCap&&(i.lineCap=n.lineCap,t.lineCap=n.lineCap),t.setLineDash&&(be(i.lineDash,n.lineDash)||t.setLineDash(i.lineDash=n.lineDash),i.lineDashOffset!=n.lineDashOffset&&(i.lineDashOffset=n.lineDashOffset,t.lineDashOffset=n.lineDashOffset)),i.lineJoin!=n.lineJoin&&(i.lineJoin=n.lineJoin,t.lineJoin=n.lineJoin),i.lineWidth!=n.lineWidth&&(i.lineWidth=n.lineWidth,t.lineWidth=n.lineWidth),i.miterLimit!=n.miterLimit&&(i.miterLimit=n.miterLimit,t.miterLimit=n.miterLimit),i.strokeStyle!=n.strokeStyle&&(i.strokeStyle=n.strokeStyle,t.strokeStyle=n.strokeStyle)):(t.lineCap=n.lineCap,t.setLineDash&&(t.setLineDash(n.lineDash),t.lineDashOffset=n.lineDashOffset),t.lineJoin=n.lineJoin,t.lineWidth=n.lineWidth,t.miterLimit=n.miterLimit,t.strokeStyle=n.strokeStyle,this.contextStrokeState_={lineCap:n.lineCap,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset,lineJoin:n.lineJoin,lineWidth:n.lineWidth,miterLimit:n.miterLimit,strokeStyle:n.strokeStyle})},t.prototype.setContextTextState_=function(n){var i=this.context_,t=this.contextTextState_,r=n.textAlign?n.textAlign:"center";t?(t.font!=n.font&&(t.font=n.font,i.font=n.font),t.textAlign!=r&&(t.textAlign=r,i.textAlign=r),t.textBaseline!=n.textBaseline&&(t.textBaseline=n.textBaseline,i.textBaseline=n.textBaseline)):(i.font=n.font,i.textAlign=r,i.textBaseline=n.textBaseline,this.contextTextState_={font:n.font,textAlign:r,textBaseline:n.textBaseline})},t.prototype.setFillStrokeStyle=function(n,t){var i;if(n?(i=n.getColor(),this.fillState_={fillStyle:bu(i||"#000")}):this.fillState_=null,t){var o=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),h=t.getLineDashOffset(),u=t.getLineJoin(),f=t.getWidth(),e=t.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:"round",lineDash:s||by,lineDashOffset:h||0,lineJoin:void 0!==u?u:"round",lineWidth:this.pixelRatio_*(void 0!==f?f:1),miterLimit:void 0!==e?e:10,strokeStyle:bu(o||"#000")}}else this.strokeState_=null},t.prototype.setImageStyle=function(n){if(n){var t=n.getAnchor(),u=n.getImage(1),i=n.getOrigin(),r=n.getSize();this.imageAnchorX_=t[0];this.imageAnchorY_=t[1];this.imageHeight_=r[1];this.image_=u;this.imageOpacity_=n.getOpacity();this.imageOriginX_=i[0];this.imageOriginY_=i[1];this.imageRotateWithView_=n.getRotateWithView();this.imageRotation_=n.getRotation();this.imageScale_=n.getScale()*this.pixelRatio_;this.imageWidth_=r[0]}else this.image_=null},t.prototype.setTextStyle=function(n){var i,r,t;if(n){if(i=n.getFill(),i?(r=i.getColor(),this.textFillState_={fillStyle:bu(r||"#000")}):this.textFillState_=null,t=n.getStroke(),t){var b=t.getColor(),u=t.getLineCap(),k=t.getLineDash(),d=t.getLineDashOffset(),f=t.getLineJoin(),e=t.getWidth(),o=t.getMiterLimit();this.textStrokeState_={lineCap:void 0!==u?u:"round",lineDash:k||by,lineDashOffset:d||0,lineJoin:void 0!==f?f:"round",lineWidth:void 0!==e?e:1,miterLimit:void 0!==o?o:10,strokeStyle:bu(b||"#000")}}else this.textStrokeState_=null;var s=n.getFont(),h=n.getOffsetX(),c=n.getOffsetY(),l=n.getRotateWithView(),a=n.getRotation(),v=n.getScale(),y=n.getText(),p=n.getTextAlign(),w=n.getTextBaseline();this.textState_={font:void 0!==s?s:"10px sans-serif",textAlign:void 0!==p?p:"center",textBaseline:void 0!==w?w:"middle"};this.text_=void 0!==y?y:"";this.textOffsetX_=void 0!==h?this.pixelRatio_*h:0;this.textOffsetY_=void 0!==c?this.pixelRatio_*c:0;this.textRotateWithView_=void 0!==l&&l;this.textRotation_=void 0!==a?a:0;this.textScale_=this.pixelRatio_*(void 0!==v?v:1)}else this.text_=""},t}(vk),et={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},lt={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},fgt=.5,vet={Point:function(n,t,i,r){var u=i.getImage(),f,e,o;if(u){if(u.getImageState()!=et.LOADED)return;f=n.getBuilder(i.getZIndex(),lt.IMAGE);f.setImageStyle(u,n.addDeclutter(!1));f.drawPoint(t,r)}e=i.getText();e&&(o=n.getBuilder(i.getZIndex(),lt.TEXT),o.setTextStyle(e,n.addDeclutter(!!u)),o.drawText(t,r))},LineString:function(n,t,i,r){var o=i.getStroke(),u,f,e;o&&(u=n.getBuilder(i.getZIndex(),lt.LINE_STRING),u.setFillStrokeStyle(null,o),u.drawLineString(t,r));f=i.getText();f&&(e=n.getBuilder(i.getZIndex(),lt.TEXT),e.setTextStyle(f,n.addDeclutter(!1)),e.drawText(t,r))},Polygon:function(n,t,i,r){var o=i.getFill(),s=i.getStroke(),u,f,e;(o||s)&&(u=n.getBuilder(i.getZIndex(),lt.POLYGON),u.setFillStrokeStyle(o,s),u.drawPolygon(t,r));f=i.getText();f&&(e=n.getBuilder(i.getZIndex(),lt.TEXT),e.setTextStyle(f,n.addDeclutter(!1)),e.drawText(t,r))},MultiPoint:function(n,t,i,r){var u=i.getImage(),f,e,o;if(u){if(u.getImageState()!=et.LOADED)return;f=n.getBuilder(i.getZIndex(),lt.IMAGE);f.setImageStyle(u,n.addDeclutter(!1));f.drawMultiPoint(t,r)}e=i.getText();e&&(o=n.getBuilder(i.getZIndex(),lt.TEXT),o.setTextStyle(e,n.addDeclutter(!!u)),o.drawText(t,r))},MultiLineString:function(n,t,i,r){var o=i.getStroke(),u,f,e;o&&(u=n.getBuilder(i.getZIndex(),lt.LINE_STRING),u.setFillStrokeStyle(null,o),u.drawMultiLineString(t,r));f=i.getText();f&&(e=n.getBuilder(i.getZIndex(),lt.TEXT),e.setTextStyle(f,n.addDeclutter(!1)),e.drawText(t,r))},MultiPolygon:function(n,t,i,r){var o=i.getFill(),s=i.getStroke(),u,f,e;(s||o)&&(u=n.getBuilder(i.getZIndex(),lt.POLYGON),u.setFillStrokeStyle(o,s),u.drawMultiPolygon(t,r));f=i.getText();f&&(e=n.getBuilder(i.getZIndex(),lt.TEXT),e.setTextStyle(f,n.addDeclutter(!1)),e.drawText(t,r))},GeometryCollection:function(n,t,i,r){for(var f=t.getGeometriesArray(),u=0,e=f.length;u<e;++u)vet[f[u].getType()](n,f[u],i,r)},Circle:function(n,t,i,r){var o=i.getFill(),s=i.getStroke(),u,f,e;(o||s)&&(u=n.getBuilder(i.getZIndex(),lt.CIRCLE),u.setFillStrokeStyle(o,s),u.drawCircle(t,r));f=i.getText();f&&(e=n.getBuilder(i.getZIndex(),lt.TEXT),e.setTextStyle(f,n.addDeclutter(!1)),e.drawText(t,r))}};wet=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var sgt=function(n){function t(t){var i=n.call(this)||this;return i.map_=t,i.declutterTree_=null,i}return wet(t,n),t.prototype.dispatchRenderEvent=function(){w()},t.prototype.calculateMatrices2D=function(n){var t=n.viewState,i=n.coordinateToPixelTransform,r=n.pixelToCoordinateTransform;wr(i,n.size[0]/2,n.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]);ll(r,i)},t.prototype.forEachFeatureAtCoordinate=function(n,t,i,r,u,f,e,o){function ot(n,t,i){return u.call(f,t,n?i:null)}var b,tt=t.viewState,it=tt.projection,rt=n,c=[[0,0]],ut,k,ft,y,s,p,w,h,d,g,nt,et;if(it.canWrapX()){var l=it.getExtent(),a=vt(l),v=n[0];(v<l[0]||v>l[2])&&(rt=[v+a*Math.ceil((l[0]-v)/a),n[1]]);r&&c.push([-a,0],[a,0])}for(k=t.layerStatesArray,ft=k.length,this.declutterTree_&&(ut=this.declutterTree_.all().map(function(n){return n.value})),y=[],s=0;s<c.length;s++)for(p=ft-1;p>=0;--p)if(w=k[p],h=w.layer,h.hasRenderer()&&yy(w,tt)&&e.call(o,h)&&(d=h.getRenderer(),g=h.getSource(),d&&g&&(nt=g.getWrapX()?rt:n,et=ot.bind(null,w.managed),y[0]=nt[0]+c[s][0],y[1]=nt[1]+c[s][1],b=d.forEachFeatureAtCoordinate(y,t,i,et,ut)),b))return b},t.prototype.forEachLayerAtPixel=function(){return w()},t.prototype.hasFeatureAtCoordinate=function(n,t,i,r,u,f){return void 0!==this.forEachFeatureAtCoordinate(n,t,i,r,tu,this,u,f)},t.prototype.getMap=function(){return this.map_},t.prototype.renderFrame=function(n){this.declutterTree_=pet(n,this.declutterTree_)},t.prototype.scheduleExpireIconCache=function(n){tc.canExpireCache()&&n.postRenderFunctions.push(ogt)},t}(ko),hgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bk=function(n){function t(t){var i=n.call(this,t)||this,r,u;return i.labelCacheKey_=nt(re,a.CLEAR,t.redrawText.bind(t)),i.element_=document.createElement("div"),r=i.element_.style,r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",i.element_.className=sf+" ol-layers",u=t.getViewport(),u.insertBefore(i.element_,u.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return hgt(t,n),t.prototype.dispatchRenderEvent=function(n,t){var i=this.getMap(),r;i.hasListener(n)&&(r=new bft(n,void 0,t),i.dispatchEvent(r))},t.prototype.disposeInternal=function(){ct(this.labelCacheKey_);n.prototype.disposeInternal.call(this)},t.prototype.renderFrame=function(t){var f,o,i,r;if(t){this.calculateMatrices2D(t);this.dispatchRenderEvent(brt,t);f=t.layerStatesArray.sort(function(n,t){return n.zIndex-t.zIndex});o=t.viewState;this.children_.length=0;for(var e=null,u=0,s=f.length;u<s;++u)i=f[u],(t.layerIndex=u,yy(i,o)&&(i.sourceState==li.READY||i.sourceState==li.UNDEFINED))&&(r=i.layer.render(t,e),r&&r!==e&&(this.children_.push(r),e=r));n.prototype.renderFrame.call(this,t),function(n,t){for(var i,r,f=n.childNodes,u=0;;++u){if(i=f[u],r=t[u],!i&&!r)break;i!==r&&(i?r?n.insertBefore(r,i):(n.removeChild(i),--u):n.appendChild(r))}}(this.element_,this.children_);this.dispatchRenderEvent(rkt,t);this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0);this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},t.prototype.forEachLayerAtPixel=function(n,t,i,r,u){for(var o,f,s,h,l=t.viewState,c=t.layerStatesArray,e=c.length-1;e>=0;--e)if(o=c[e],f=o.layer,f.hasRenderer()&&yy(o,l)&&u(f)&&(s=f.getRenderer().getDataAtPixel(n,t,i),s&&(h=r(f,s),h)))return h},t}(sgt),cgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lgt=function(n){function t(t){return(t=d({},t)).controls||(t.controls=kut()),t.interactions||(t.interactions=wft()),n.call(this,t)||this}return cgt(t,n),t.prototype.createRenderer=function(){return new bk(this)},t}(tk),br={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},agt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cr={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},bet=function(n){function t(t){var i=n.call(this)||this;return i.options=t,i.id=t.id,i.insertFirst=void 0===t.insertFirst||t.insertFirst,i.stopEvent=void 0===t.stopEvent||t.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==t.className?t.className:"ol-overlay-container "+ykt,i.element.style.position="absolute",i.autoPan=void 0!==t.autoPan&&t.autoPan,i.autoPanAnimation=t.autoPanAnimation||{},i.autoPanMargin=void 0!==t.autoPanMargin?t.autoPanMargin:20,i.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(ri(cr.ELEMENT),i.handleElementChanged),i.addEventListener(ri(cr.MAP),i.handleMapChanged),i.addEventListener(ri(cr.OFFSET),i.handleOffsetChanged),i.addEventListener(ri(cr.POSITION),i.handlePositionChanged),i.addEventListener(ri(cr.POSITIONING),i.handlePositioningChanged),void 0!==t.element&&i.setElement(t.element),i.setOffset(void 0!==t.offset?t.offset:[0,0]),i.setPositioning(void 0!==t.positioning?t.positioning:br.TOP_LEFT),void 0!==t.position&&i.setPosition(t.position),i}return agt(t,n),t.prototype.getElement=function(){return this.get(cr.ELEMENT)},t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.get(cr.MAP)},t.prototype.getOffset=function(){return this.get(cr.OFFSET)},t.prototype.getPosition=function(){return this.get(cr.POSITION)},t.prototype.getPositioning=function(){return this.get(cr.POSITIONING)},t.prototype.handleElementChanged=function(){sut(this.element);var n=this.getElement();n&&this.element.appendChild(n)},t.prototype.handleMapChanged=function(){var n,t;this.mapPostrenderListenerKey&&(cy(this.element),ct(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);n=this.getMap();n&&(this.mapPostrenderListenerKey=nt(n,ny,this.render,this),this.updatePixelPosition(),t=this.stopEvent?n.getOverlayContainerStopEvent():n.getOverlayContainer(),this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element))},t.prototype.render=function(){this.updatePixelPosition()},t.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},t.prototype.handlePositionChanged=function(){this.updatePixelPosition();this.get(cr.POSITION)&&this.autoPan&&this.panIntoView()},t.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},t.prototype.setElement=function(n){this.set(cr.ELEMENT,n)},t.prototype.setMap=function(n){this.set(cr.MAP,n)},t.prototype.setOffset=function(n){this.set(cr.OFFSET,n)},t.prototype.setPosition=function(n){this.set(cr.POSITION,n)},t.prototype.panIntoView=function(){var n=this.getMap();if(n&&n.getTargetElement()){var i=this.getRect(n.getTargetElement(),n.getSize()),f=this.getElement(),r=this.getRect(f,[hkt(f),ckt(f)]),u=this.autoPanMargin;if(!tr(i,r)){var e=r[0]-i[0],o=i[2]-r[2],s=r[1]-i[1],h=i[3]-r[3],t=[0,0];if(e<0?t[0]=e-u:o<0&&(t[0]=Math.abs(o)+u),s<0?t[1]=s-u:h<0&&(t[1]=Math.abs(h)+u),0!==t[0]||0!==t[1]){var l=n.getView().getCenterInternal(),c=n.getPixelFromCoordinateInternal(l),a=[c[0]+t[0],c[1]+t[1]];n.getView().animateInternal({center:n.getCoordinateFromPixelInternal(a),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},t.prototype.getRect=function(n,t){var i=n.getBoundingClientRect(),r=i.left+window.pageXOffset,u=i.top+window.pageYOffset;return[r,u,r+t[0],u+t[1]]},t.prototype.setPositioning=function(n){this.set(cr.POSITIONING,n)},t.prototype.setVisible=function(n){this.rendered.visible!==n&&(this.element.style.display=n?"":"none",this.rendered.visible=n)},t.prototype.updatePixelPosition=function(){var n=this.getMap(),t=this.getPosition(),i,r;n&&n.isRendered()&&t?(i=n.getPixelFromCoordinate(t),r=n.getSize(),this.updateRenderedPosition(i,r)):this.setVisible(!1)},t.prototype.updateRenderedPosition=function(n,t){var r=this.element.style,c=this.getOffset(),i=this.getPositioning(),u,f,e,o,s,h;this.setVisible(!0);u=c[0];f=c[1];i==br.BOTTOM_RIGHT||i==br.CENTER_RIGHT||i==br.TOP_RIGHT?(""!==this.rendered.left_&&(this.rendered.left_="",r.left=""),e=Math.round(t[0]-n[0]-u)+"px",this.rendered.right_!=e&&(this.rendered.right_=e,r.right=e)):(""!==this.rendered.right_&&(this.rendered.right_="",r.right=""),i!=br.BOTTOM_CENTER&&i!=br.CENTER_CENTER&&i!=br.TOP_CENTER||(u-=this.element.offsetWidth/2),o=Math.round(n[0]+u)+"px",this.rendered.left_!=o&&(this.rendered.left_=o,r.left=o));i==br.BOTTOM_LEFT||i==br.BOTTOM_CENTER||i==br.BOTTOM_RIGHT?(""!==this.rendered.top_&&(this.rendered.top_="",r.top=""),s=Math.round(t[1]-n[1]-f)+"px",this.rendered.bottom_!=s&&(this.rendered.bottom_=s,r.bottom=s)):(""!==this.rendered.bottom_&&(this.rendered.bottom_="",r.bottom=""),i!=br.CENTER_LEFT&&i!=br.CENTER_CENTER&&i!=br.CENTER_RIGHT||(f-=this.element.offsetHeight/2),h=Math.round(n[1]+f)+"px",this.rendered.top_!=h&&(this.rendered.top_="top",r.top=h))},t.prototype.getOptions=function(){return this.options},t}(hu),ue={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},ket=!1;dk=function(){function n(n,t,i,r){this.minX=n;this.maxX=t;this.minY=i;this.maxY=r}return n.prototype.contains=function(n){return this.containsXY(n[1],n[2])},n.prototype.containsTileRange=function(n){return this.minX<=n.minX&&n.maxX<=this.maxX&&this.minY<=n.minY&&n.maxY<=this.maxY},n.prototype.containsXY=function(n,t){return this.minX<=n&&n<=this.maxX&&this.minY<=t&&t<=this.maxY},n.prototype.equals=function(n){return this.minX==n.minX&&this.minY==n.minY&&this.maxX==n.maxX&&this.maxY==n.maxY},n.prototype.extend=function(n){n.minX<this.minX&&(this.minX=n.minX);n.maxX>this.maxX&&(this.maxX=n.maxX);n.minY<this.minY&&(this.minY=n.minY);n.maxY>this.maxY&&(this.maxY=n.maxY)},n.prototype.getHeight=function(){return this.maxY-this.minY+1},n.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},n.prototype.getWidth=function(){return this.maxX-this.minX+1},n.prototype.intersects=function(n){return this.minX<=n.maxX&&this.maxX>=n.minX&&this.minY<=n.maxY&&this.maxY>=n.minY},n}();nd=dk;tot=[0,0,0];ls=function(){function n(n){var u,f,e,r,t,o,i;if(this.minZoom=void 0!==n.minZoom?n.minZoom:0,this.resolutions_=n.resolutions,p((u=this.resolutions_,f=!0,e=function(n,t){return t-n}||we,u.every(function(n,t){if(0===t)return!0;var i=e(u[t-1],n);return!(i>0||f&&0===i)})),17),!n.origins)for(t=0,o=this.resolutions_.length-1;t<o;++t)if(r){if(this.resolutions_[t]/this.resolutions_[t+1]!==r){r=void 0;break}}else r=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=r;this.maxZoom=this.resolutions_.length-1;this.origin_=void 0!==n.origin?n.origin:null;this.origins_=null;void 0!==n.origins&&(this.origins_=n.origins,p(this.origins_.length==this.resolutions_.length,20));i=n.extent;void 0===i||this.origin_||this.origins_||(this.origin_=yr(i));p(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;void 0!==n.tileSizes&&(this.tileSizes_=n.tileSizes,p(this.tileSizes_.length==this.resolutions_.length,19));this.tileSize_=void 0!==n.tileSize?n.tileSize:this.tileSizes_?null:gh;p(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=void 0!==i?i:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];void 0!==n.sizes?this.fullTileRanges_=n.sizes.map(function(n){return new nd(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1))},this):i&&this.calculateTileRanges_(i)}return n.prototype.forEachTileCoord=function(n,t,i){for(var u,e,r=this.getTileRangeForExtentAndZ(n,t),f=r.minX,o=r.maxX;f<=o;++f)for(u=r.minY,e=r.maxY;u<=e;++u)i([t,f,u])},n.prototype.forEachTileCoordParentTileRange=function(n,t,i,r){var u,f,o=null,e=n[0]-1;for(2===this.zoomFactor_?(u=n[1],f=n[2]):o=this.getTileCoordExtent(n,r);e>=this.minZoom;){if(t(e,2===this.zoomFactor_?gk(u=Math.floor(u/2),u,f=Math.floor(f/2),f,i):this.getTileRangeForExtentAndZ(o,e,i)))return!0;--e}return!1},n.prototype.getExtent=function(){return this.extent_},n.prototype.getMaxZoom=function(){return this.maxZoom},n.prototype.getMinZoom=function(){return this.minZoom},n.prototype.getOrigin=function(n){return this.origin_?this.origin_:this.origins_[n]},n.prototype.getResolution=function(n){return this.resolutions_[n]},n.prototype.getResolutions=function(){return this.resolutions_},n.prototype.getTileCoordChildTileRange=function(n,t,i){var r,u,f;return n[0]<this.maxZoom?2===this.zoomFactor_?(r=2*n[1],u=2*n[2],gk(r,r+1,u,u+1,t)):(f=this.getTileCoordExtent(n,i),this.getTileRangeForExtentAndZ(f,n[0]+1,t)):null},n.prototype.getTileRangeExtent=function(n,t,i){var r=this.getOrigin(n),u=this.getResolution(n),f=hr(this.getTileSize(n),this.tmpSize_),e=r[0]+t.minX*f[0]*u,o=r[0]+(t.maxX+1)*f[0]*u;return ru(e,r[1]+t.minY*f[1]*u,o,r[1]+(t.maxY+1)*f[1]*u,i)},n.prototype.getTileRangeForExtentAndZ=function(n,t,i){var r=tot,u,f;return this.getTileCoordForXYAndZ_(n[0],n[3],t,!1,r),u=r[1],f=r[2],this.getTileCoordForXYAndZ_(n[2],n[1],t,!0,r),gk(u,r[1],f,r[2],i)},n.prototype.getTileCoordCenter=function(n){var t=this.getOrigin(n[0]),i=this.getResolution(n[0]),r=hr(this.getTileSize(n[0]),this.tmpSize_);return[t[0]+(n[1]+.5)*r[0]*i,t[1]-(n[2]+.5)*r[1]*i]},n.prototype.getTileCoordExtent=function(n,t){var u=this.getOrigin(n[0]),i=this.getResolution(n[0]),r=hr(this.getTileSize(n[0]),this.tmpSize_),f=u[0]+n[1]*r[0]*i,e=u[1]-(n[2]+1)*r[1]*i;return ru(f,e,f+r[0]*i,e+r[1]*i,t)},n.prototype.getTileCoordForCoordAndResolution=function(n,t,i){return this.getTileCoordForXYAndResolution_(n[0],n[1],t,!1,i)},n.prototype.getTileCoordForXYAndResolution_=function(n,t,i,r,u){var o=this.getZForResolution(i),s=i/this.getResolution(o),h=this.getOrigin(o),c=hr(this.getTileSize(o),this.tmpSize_),l=r?.5:0,a=r?.5:0,v=Math.floor((n-h[0])/i+l),y=Math.floor((h[1]-t)/i+a),f=s*v/c[0],e=s*y/c[1];return r?(f=Math.ceil(f)-1,e=Math.ceil(e)-1):(f=Math.floor(f),e=Math.floor(e)),td(o,f,e,u)},n.prototype.getTileCoordForXYAndZ_=function(n,t,i,r,u){var o=this.getOrigin(i),s=this.getResolution(i),h=hr(this.getTileSize(i),this.tmpSize_),c=r?.5:0,l=r?.5:0,a=Math.floor((n-o[0])/s+c),v=Math.floor((o[1]-t)/s+l),f=a/h[0],e=v/h[1];return r?(f=Math.ceil(f)-1,e=Math.ceil(e)-1):(f=Math.floor(f),e=Math.floor(e)),td(i,f,e,u)},n.prototype.getTileCoordForCoordAndZ=function(n,t,i){return this.getTileCoordForXYAndZ_(n[0],n[1],t,!1,i)},n.prototype.getTileCoordResolution=function(n){return this.resolutions_[n[0]]},n.prototype.getTileSize=function(n){return this.tileSize_?this.tileSize_:this.tileSizes_[n]},n.prototype.getFullTileRange=function(n){return this.fullTileRanges_?this.fullTileRanges_[n]:null},n.prototype.getZForResolution=function(n,t){return kt(rv(this.resolutions_,n,t||0),this.minZoom,this.maxZoom)},n.prototype.calculateTileRanges_=function(n){for(var i=this.resolutions_.length,r=new Array(i),t=this.minZoom;t<i;++t)r[t]=this.getTileRangeForExtentAndZ(n,t);this.fullTileRanges_=r},n}();var rd,kl=34962,np=34963,dl=35048,fot=["experimental-webgl","webgl","webkit-3d","moz-webgl"];vs=document.implementation.createDocument("","",null);eo="http://www.w3.org/2001/XMLSchema-instance";ir=gt();cot={STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:dl};gl=function(){function n(n,t){this.array=null;this.type=n;p(n===kl||n===np,62);this.usage=void 0!==t?t:cot.STATIC_DRAW}return n.prototype.ofSize=function(n){this.array=new(ud(this.type))(n)},n.prototype.fromArray=function(n){this.array=ud(this.type).from(n)},n.prototype.fromArrayBuffer=function(n){this.array=new(ud(this.type))(n)},n.prototype.getType=function(){return this.type},n.prototype.getArray=function(){return this.array},n.prototype.getUsage=function(){return this.usage},n.prototype.getSize=function(){return this.array?this.array.length:0},n}();na={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var vgt="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",ygt="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n",ed=function(){function n(n){var t,i,r;this.gl_=n.webGlContext;t=this.gl_;this.scaleRatio_=n.scaleRatio||1;this.renderTargetTexture_=t.createTexture();this.renderTargetTextureSize_=null;this.frameBuffer_=t.createFramebuffer();i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,n.vertexShader||vgt);t.compileShader(i);r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,n.fragmentShader||ygt);t.compileShader(r);this.renderTargetProgram_=t.createProgram();t.attachShader(this.renderTargetProgram_,i);t.attachShader(this.renderTargetProgram_,r);t.linkProgram(this.renderTargetProgram_);this.renderTargetVerticesBuffer_=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_);t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW);this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position");this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize");this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image");this.uniforms_=[];n.uniforms&&Object.keys(n.uniforms).forEach(function(i){this.uniforms_.push({value:n.uniforms[i],location:t.getUniformLocation(this.renderTargetProgram_,i)})}.bind(this))}return n.prototype.getGL=function(){return this.gl_},n.prototype.init=function(n){var t=this.getGL(),i=t.canvas,r=n.size;if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,i.width*this.scaleRatio_,i.height*this.scaleRatio_),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var u=t.RGBA,f=t.RGBA,e=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_);t.texImage2D(t.TEXTURE_2D,0,u,i.width*this.scaleRatio_,i.height*this.scaleRatio_,0,f,e,null);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},n.prototype.apply=function(n,t){var i=this.getGL(),r=i.canvas;i.bindFramebuffer(i.FRAMEBUFFER,t?t.getFrameBuffer():null);i.activeTexture(i.TEXTURE0);i.bindTexture(i.TEXTURE_2D,this.renderTargetTexture_);i.clearColor(0,0,0,0);i.clear(i.COLOR_BUFFER_BIT);i.enable(i.BLEND);i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA);i.viewport(0,0,r.width,r.height);i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_);i.useProgram(this.renderTargetProgram_);i.enableVertexAttribArray(this.renderTargetAttribLocation_);i.vertexAttribPointer(this.renderTargetAttribLocation_,2,i.FLOAT,!1,0,0);i.uniform2f(this.renderTargetUniformLocation_,r.width,r.height);i.uniform1i(this.renderTargetTextureLocation_,0);this.applyUniforms(n);i.drawArrays(i.TRIANGLES,0,6)},n.prototype.getFrameBuffer=function(){return this.frameBuffer_},n.prototype.applyUniforms=function(n){var i,t=this.getGL(),r=1;this.uniforms_.forEach(function(u){if((i="function"==typeof u.value?u.value(n):u.value)instanceof HTMLCanvasElement||i instanceof ImageData)u.texture||(u.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,u.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,i.width,i.height,0,t.UNSIGNED_BYTE,new Uint8Array(i.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.uniform1i(u.location,r++);else if(Array.isArray(i))switch(i.length){case 2:return void t.uniform2f(u.location,i[0],i[1]);case 3:return void t.uniform3f(u.location,i[0],i[1],i[2]);case 4:return void t.uniform4f(u.location,i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&t.uniform1f(u.location,i)})},n}(),pgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uc={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},du={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};var vot=function(n){function t(t){var i=n.call(this)||this,r=t||{},u,f;if(i.boundHandleWebGLContextLost_=i.handleWebGLContextLost.bind(i),i.boundHandleWebGLContextRestored_=i.handleWebGLContextRestored.bind(i),i.canvas_=document.createElement("canvas"),i.canvas_.style.position="absolute",i.canvas_.style.left="0",i.gl_=eot(i.canvas_),u=i.getGL(),i.bufferCache_={},i.currentProgram_=null,p(di(function(){if(!rd){var n=eot(document.createElement("canvas"));n&&(rd=n.getSupportedExtensions())}return rd}(),"OES_element_index_uint"),63),u.getExtension("OES_element_index_uint"),i.canvas_.addEventListener(na.LOST,i.boundHandleWebGLContextLost_),i.canvas_.addEventListener(na.RESTORED,i.boundHandleWebGLContextRestored_),i.offsetRotateMatrix_=[1,0,0,1,0,0],i.offsetScaleMatrix_=[1,0,0,1,0,0],i.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.uniformLocations_={},i.attribLocations_={},i.uniforms_=[],r.uniforms)for(f in r.uniforms)i.uniforms_.push({name:f,value:r.uniforms[f]});return i.postProcessPasses_=r.postProcesses?r.postProcesses.map(function(n){return new ed({webGlContext:u,scaleRatio:n.scaleRatio,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms})}):[new ed({webGlContext:u})],i.shaderCompileErrors_=null,i.startTime_=Date.now(),i}return pgt(t,n),t.prototype.bindBuffer=function(n){var i=this.getGL(),r=v(n),t=this.bufferCache_[r];t||(t={buffer:n,webGlBuffer:i.createBuffer()},this.bufferCache_[r]=t);i.bindBuffer(n.getType(),t.webGlBuffer)},t.prototype.flushBufferData=function(n){var t=this.getGL();this.bindBuffer(n);t.bufferData(n.getType(),n.getArray(),n.getUsage())},t.prototype.deleteBuffer=function(n){var t=this.getGL(),i=v(n),r=this.bufferCache_[i];t.isContextLost()||t.deleteBuffer(r.buffer);delete this.bufferCache_[i]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(na.LOST,this.boundHandleWebGLContextLost_);this.canvas_.removeEventListener(na.RESTORED,this.boundHandleWebGLContextRestored_)},t.prototype.prepareDraw=function(n){var t=this.getGL(),i=this.getCanvas(),r=n.size,f=n.pixelRatio,u;for(i.width=r[0]*f,i.height=r[1]*f,i.style.width=r[0]+"px",i.style.height=r[1]+"px",t.useProgram(this.currentProgram_),u=this.postProcessPasses_.length-1;u>=0;u--)this.postProcessPasses_[u].init(n);t.bindTexture(t.TEXTURE_2D,null);t.clearColor(0,0,0,0);t.clear(t.COLOR_BUFFER_BIT);t.enable(t.BLEND);t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA);t.useProgram(this.currentProgram_);this.applyFrameState(n);this.applyUniforms(n)},t.prototype.prepareDrawToRenderTarget=function(n,t,i){var r=this.getGL(),u=t.getSize();r.bindFramebuffer(r.FRAMEBUFFER,t.getFramebuffer());r.viewport(0,0,u[0],u[1]);r.bindTexture(r.TEXTURE_2D,t.getTexture());r.clearColor(0,0,0,0);r.clear(r.COLOR_BUFFER_BIT);r.enable(r.BLEND);r.blendFunc(r.ONE,i?r.ZERO:r.ONE_MINUS_SRC_ALPHA);r.useProgram(this.currentProgram_);this.applyFrameState(n);this.applyUniforms(n)},t.prototype.drawElements=function(n,t){var i=this.getGL(),r=i.UNSIGNED_INT,u=t-n,f=4*n;i.drawElements(i.TRIANGLES,u,r,f)},t.prototype.finalizeDraw=function(n){for(var t=0;t<this.postProcessPasses_.length;t++)this.postProcessPasses_[t].apply(n,this.postProcessPasses_[t+1]||null)},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(n){var f=n.size,e=n.viewState.rotation,o=sl(this.offsetScaleMatrix_),s,t,i,r,u;cl(o,2/f[0],2/f[1]);u=sl(this.offsetRotateMatrix_);0!==e&&(s=u,t=-e,i=Math.cos(t),r=Math.sin(t),ph(s,hl(pv,i,r,-r,i,0,0)));this.setUniformMatrixValue(uc.OFFSET_SCALE_MATRIX,fd(this.tmpMat4_,o));this.setUniformMatrixValue(uc.OFFSET_ROTATION_MATRIX,fd(this.tmpMat4_,u));this.setUniformFloatValue(uc.TIME,.001*(Date.now()-this.startTime_));this.setUniformFloatValue(uc.ZOOM,n.viewState.zoom);this.setUniformFloatValue(uc.RESOLUTION,n.viewState.resolution)},t.prototype.applyUniforms=function(n){var i,t=this.getGL(),r=0;this.uniforms_.forEach(function(u){if((i="function"==typeof u.value?u.value(n):u.value)instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData)u.texture||(u.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,u.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(!(i instanceof HTMLImageElement)||i.complete)&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.uniform1i(this.getUniformLocation(u.name),r++);else if(Array.isArray(i)&&6===i.length)this.setUniformMatrixValue(u.name,fd(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:return void t.uniform2f(this.getUniformLocation(u.name),i[0],i[1]);case 3:return void t.uniform3f(this.getUniformLocation(u.name),i[0],i[1],i[2]);case 4:return void t.uniform4f(this.getUniformLocation(u.name),i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&t.uniform1f(this.getUniformLocation(u.name),i)}.bind(this))},t.prototype.useProgram=function(n){return n!=this.currentProgram_&&(this.getGL().useProgram(n),this.currentProgram_=n,this.uniformLocations_={},this.attribLocations_={},!0)},t.prototype.compileShader=function(n,t){var i=this.getGL(),r=i.createShader(t);return i.shaderSource(r,n),i.compileShader(r),r},t.prototype.getProgram=function(n,t){var i=this.getGL(),u=this.compileShader(n,i.FRAGMENT_SHADER),f=this.compileShader(t,i.VERTEX_SHADER),r;return this.shaderCompileErrors_=null,i.getShaderInfoLog(u)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+i.getShaderInfoLog(u)),i.getShaderInfoLog(f)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+i.getShaderInfoLog(f)),r=i.createProgram(),i.attachShader(r,u),i.attachShader(r,f),i.linkProgram(r),r},t.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},t.prototype.getUniformLocation=function(n){return void 0===this.uniformLocations_[n]&&(this.uniformLocations_[n]=this.getGL().getUniformLocation(this.currentProgram_,n)),this.uniformLocations_[n]},t.prototype.getAttributeLocation=function(n){return void 0===this.attribLocations_[n]&&(this.attribLocations_[n]=this.getGL().getAttribLocation(this.currentProgram_,n)),this.attribLocations_[n]},t.prototype.makeProjectionTransform=function(n,t){var i=n.size,f=n.viewState.rotation,r=n.viewState.resolution,u=n.viewState.center;return sl(t),wr(t,0,0,2/(r*i[0]),2/(r*i[1]),-f,-u[0],-u[1]),t},t.prototype.setUniformFloatValue=function(n,t){this.getGL().uniform1f(this.getUniformLocation(n),t)},t.prototype.setUniformMatrixValue=function(n,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(n),!1,t)},t.prototype.enableAttributeArray_=function(n,t,i,r,u){var f=this.getAttributeLocation(n);f<0||(this.getGL().enableVertexAttribArray(f),this.getGL().vertexAttribPointer(f,t,i,!1,r,u))},t.prototype.enableAttributes=function(n){for(var t,u=lot(n),r=0,i=0;i<n.length;i++)t=n[i],this.enableAttributeArray_(t.name,t.size,t.type||5126,u,r),r+=t.size*aot(t.type)},t.prototype.handleWebGLContextLost=function(){pe(this.bufferCache_);this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(n,t,i){var r=this.getGL(),u=i||r.createTexture(),f=r.RGBA,e=r.RGBA,o=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,u),t?r.texImage2D(r.TEXTURE_2D,0,f,e,o,t):r.texImage2D(r.TEXTURE_2D,0,f,n[0],n[1],0,e,o,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),u},t}(ko),af=new Uint8Array(4),yot=function(){function n(n,t){this.helper_=n;var i=n.getGL();this.texture_=i.createTexture();this.framebuffer_=i.createFramebuffer();this.size_=t||[1,1];this.data_=new Uint8Array(0);this.dataCacheDirty_=!0;this.updateSize_()}return n.prototype.setSize=function(n){be(n,this.size_)||(this.size_[0]=n[0],this.size_[1]=n[1],this.updateSize_())},n.prototype.getSize=function(){return this.size_},n.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},n.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_);n.readPixels(0,0,t[0],t[1],n.RGBA,n.UNSIGNED_BYTE,this.data_);this.dataCacheDirty_=!1}return this.data_},n.prototype.readPixel=function(n,t){if(n<0||t<0||n>this.size_[0]||t>=this.size_[1])return af[0]=0,af[1]=0,af[2]=0,af[3]=0,af;this.readAll();var i=Math.floor(n)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return af[0]=this.data_[4*i],af[1]=this.data_[4*i+1],af[2]=this.data_[4*i+2],af[3]=this.data_[4*i+3],af},n.prototype.getTexture=function(){return this.texture_},n.prototype.getFramebuffer=function(){return this.framebuffer_},n.prototype.updateSize_=function(){var t=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_);n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_);n.viewport(0,0,t[0],t[1]);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0);this.data_=new Uint8Array(t[0]*t[1]*4)},n}(),wgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pot=function(n){function t(t){var i=n.call(this,{extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes})||this;return i.matrixIds_=t.matrixIds,i}return wgt(t,n),t.prototype.getMatrixId=function(n){return this.matrixIds_[n]},t.prototype.getMatrixIds=function(){return this.matrixIds_},t}(ls),bgt=pot;var od=function(){function n(n){this.opacity_=n.opacity;this.rotateWithView_=n.rotateWithView;this.rotation_=n.rotation;this.scale_=n.scale}return n.prototype.clone=function(){return new n({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},n.prototype.getOpacity=function(){return this.opacity_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getAnchor=function(){return w()},n.prototype.getImage=function(){return w()},n.prototype.getHitDetectionImage=function(){return w()},n.prototype.getImageState=function(){return w()},n.prototype.getImageSize=function(){return w()},n.prototype.getHitDetectionImageSize=function(){return w()},n.prototype.getOrigin=function(){return w()},n.prototype.getSize=function(){return w()},n.prototype.setOpacity=function(n){this.opacity_=n},n.prototype.setRotateWithView=function(n){this.rotateWithView_=n},n.prototype.setRotation=function(n){this.rotation_=n},n.prototype.setScale=function(n){this.scale_=n},n.prototype.listenImageChange=function(){w()},n.prototype.load=function(){w()},n.prototype.unlistenImageChange=function(){w()},n}(),kgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bot=function(n){function t(t){var i=this,r=void 0!==t.rotateWithView&&t.rotateWithView;return(i=n.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==t.rotation?t.rotation:0,scale:1})||this).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==t.fill?t.fill:null,i.origin_=[0,0],i.points_=t.points,i.radius_=void 0!==t.radius?t.radius:t.radius1,i.radius2_=t.radius2,i.angle_=void 0!==t.angle?t.angle:0,i.stroke_=void 0!==t.stroke?t.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return kgt(t,n),t.prototype.clone=function(){var n=new t({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return n.setOpacity(this.getOpacity()),n.setScale(this.getScale()),n},t.prototype.getAnchor=function(){return this.anchor_},t.prototype.getAngle=function(){return this.angle_},t.prototype.getFill=function(){return this.fill_},t.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_},t.prototype.getImage=function(){return this.canvas_},t.prototype.getImageSize=function(){return this.imageSize_},t.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},t.prototype.getImageState=function(){return et.LOADED},t.prototype.getOrigin=function(){return this.origin_},t.prototype.getPoints=function(){return this.points_},t.prototype.getRadius=function(){return this.radius_},t.prototype.getRadius2=function(){return this.radius2_},t.prototype.getSize=function(){return this.size_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.listenImageChange=function(){},t.prototype.load=function(){},t.prototype.unlistenImageChange=function(){},t.prototype.render=function(){var t,r="round",u="round",f=0,o=null,s=0,i=0,e;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=bu(t),void 0===(i=this.stroke_.getWidth())&&(i=1),o=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset(),void 0===(u=this.stroke_.getLineJoin())&&(u="round"),void 0===(r=this.stroke_.getLineCap())&&(r="round"),void 0===(f=this.stroke_.getMiterLimit())&&(f=10));var n=2*(this.radius_+i)+1,h={strokeStyle:t,strokeWidth:i,size:n,lineCap:r,lineDash:o,lineDashOffset:s,lineJoin:u,miterLimit:f},c=ci(n,n);this.canvas_=c.canvas;e=n=this.canvas_.width;this.draw_(h,c,0,0);this.createHitDetectionCanvas_(h);this.anchor_=[n/2,n/2];this.size_=[n,n];this.imageSize_=[e,e]},t.prototype.draw_=function(n,t,i,r){var u,o,s,f,h,e;if(t.setTransform(1,0,0,1,0,0),t.translate(i,r),t.beginPath(),f=this.points_,f===1/0)t.arc(n.size/2,n.size/2,this.radius_,0,2*Math.PI,!0);else for(h=void 0!==this.radius2_?this.radius2_:this.radius_,h!==this.radius_&&(f*=2),u=0;u<=f;u++)o=2*u*Math.PI/f-Math.PI/2+this.angle_,s=u%2==0?this.radius_:h,t.lineTo(n.size/2+s*Math.cos(o),n.size/2+s*Math.sin(o));this.fill_&&(e=this.fill_.getColor(),null===e&&(e="#000"),t.fillStyle=bu(e),t.fill());this.stroke_&&(t.strokeStyle=n.strokeStyle,t.lineWidth=n.strokeWidth,t.setLineDash&&n.lineDash&&(t.setLineDash(n.lineDash),t.lineDashOffset=n.lineDashOffset),t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.miterLimit=n.miterLimit,t.stroke());t.closePath()},t.prototype.createHitDetectionCanvas_=function(n){var t,i,r;(this.hitDetectionImageSize_=[n.size,n.size],this.hitDetectionCanvas_=this.canvas_,this.fill_)&&(t=this.fill_.getColor(),i=0,("string"==typeof t&&(t=wy(t)),null===t?i=1:Array.isArray(t)&&(i=4===t.length?t[3]:1),0===i)&&(r=ci(n.size,n.size),this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(n,r,0,0)))},t.prototype.drawHitDetectionCanvas_=function(n,t,i,r){var u,e;if(t.setTransform(1,0,0,1,0,0),t.translate(i,r),t.beginPath(),u=this.points_,u===1/0)t.arc(n.size/2,n.size/2,this.radius_,0,2*Math.PI,!0);else{e=void 0!==this.radius2_?this.radius2_:this.radius_;e!==this.radius_&&(u*=2);for(var f=void 0,o=void 0,s=void 0,f=0;f<=u;f++)s=2*f*Math.PI/u-Math.PI/2+this.angle_,o=f%2==0?this.radius_:e,t.lineTo(n.size/2+o*Math.cos(s),n.size/2+o*Math.sin(s))}t.fillStyle="#000";t.fill();this.stroke_&&(t.strokeStyle=n.strokeStyle,t.lineWidth=n.strokeWidth,n.lineDash&&(t.setLineDash(n.lineDash),t.lineDashOffset=n.lineDashOffset),t.stroke());t.closePath()},t}(od),dgt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sd=function(n){function t(t){var i=t||{};return n.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke})||this}return dgt(t,n),t.prototype.clone=function(){var n=new t({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius()});return n.setOpacity(this.getOpacity()),n.setScale(this.getScale()),n},t.prototype.setRadius=function(n){this.radius_=n;this.render()},t}(bot),vf=function(){function n(n){var t=n||{};this.color_=void 0!==t.color?t.color:null}return n.prototype.clone=function(){var t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0})},n.prototype.getColor=function(){return this.color_},n.prototype.setColor=function(n){this.color_=n},n}(),er={FRACTION:"fraction",PIXELS:"pixels"},ggt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hd=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.extent=t,f.pixelRatio_=r,f.resolution=i,f.state=u,f}return ggt(t,n),t.prototype.changed=function(){this.dispatchEvent(a.CHANGE)},t.prototype.getExtent=function(){return this.extent},t.prototype.getImage=function(){return w()},t.prototype.getPixelRatio=function(){return this.pixelRatio_},t.prototype.getResolution=function(){return this.resolution},t.prototype.getState=function(){return this.state},t.prototype.load=function(){w()},t}(eh),nnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var tp=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i,r,et.IDLE)||this;return o.src_=u,o.image_=new Image,null!==f&&(o.image_.crossOrigin=f),o.unlisten_=null,o.state=et.IDLE,o.imageLoadFunction_=e,o}return nnt(t,n),t.prototype.getImage=function(){return this.image_},t.prototype.handleImageError_=function(){this.state=et.ERROR;this.unlistenImage_();this.changed()},t.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=ni(this.extent)/this.image_.height);this.state=et.LOADED;this.unlistenImage_();this.changed()},t.prototype.load=function(){this.state!=et.IDLE&&this.state!=et.ERROR||(this.state=et.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=cd(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.setImage=function(n){this.image_=n},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(hd),tnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),int=function(n){function t(t,i,r,u,f,e){var o=n.call(this)||this;return o.hitDetectionImage_=null,o.image_=t||new Image,null!==u&&(o.image_.crossOrigin=u),o.canvas_=e?document.createElement("canvas"):null,o.color_=e,o.unlisten_=null,o.imageState_=f,o.size_=r,o.src_=i,o.tainted_,o}return tnt(t,n),t.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===et.LOADED){this.tainted_=!1;var n=ci(1,1);try{n.drawImage(this.image_,0,0);n.getImageData(0,0,1,1)}catch(n){this.tainted_=!0}}return!0===this.tainted_},t.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(a.CHANGE)},t.prototype.handleImageError_=function(){this.imageState_=et.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()},t.prototype.handleImageLoad_=function(){this.imageState_=et.LOADED;this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]);this.size_=[this.image_.width,this.image_.height];this.unlistenImage_();this.replaceColor_();this.dispatchChangeEvent_()},t.prototype.getImage=function(){return this.canvas_?this.canvas_:this.image_},t.prototype.getImageState=function(){return this.imageState_},t.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var n=this.size_[0],t=this.size_[1],i=ci(n,t);i.fillRect(0,0,n,t);this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},t.prototype.getSize=function(){return this.size_},t.prototype.getSrc=function(){return this.src_},t.prototype.load=function(){if(this.imageState_==et.IDLE){this.imageState_=et.LOADING;try{this.image_.src=this.src_}catch(n){this.handleImageError_()}this.unlisten_=cd(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},t.prototype.replaceColor_=function(){var t;if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width;this.canvas_.height=this.image_.height;t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var r=t.getImageData(0,0,this.image_.width,this.image_.height),i=r.data,u=this.color_[0]/255,f=this.color_[1]/255,e=this.color_[2]/255,n=0,o=i.length;n<o;n+=4)i[n]*=u,i[n+1]*=f,i[n+2]*=e;t.putImageData(r,0,0)}},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(eh),ki={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},rnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ip=function(n){function t(t){var r=this,i=t||{},s=void 0!==i.opacity?i.opacity:1,h=void 0!==i.rotation?i.rotation:0,c=void 0!==i.scale?i.scale:1,l=void 0!==i.rotateWithView&&i.rotateWithView,o;(r=n.call(this,{opacity:s,rotation:h,scale:c,rotateWithView:l})||this).anchor_=void 0!==i.anchor?i.anchor:[.5,.5];r.normalizedAnchor_=null;r.anchorOrigin_=void 0!==i.anchorOrigin?i.anchorOrigin:ki.TOP_LEFT;r.anchorXUnits_=void 0!==i.anchorXUnits?i.anchorXUnits:er.FRACTION;r.anchorYUnits_=void 0!==i.anchorYUnits?i.anchorYUnits:er.FRACTION;r.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null;var u=void 0!==i.img?i.img:null,e=void 0!==i.imgSize?i.imgSize:null,f=i.src;return p(!(void 0!==f&&u),4),p(!u||u&&e,5),void 0!==f&&0!==f.length||!u||(f=u.src||v(u)),p(void 0!==f&&f.length>0,6),o=void 0!==i.src?et.IDLE:et.LOADED,r.color_=void 0!==i.color?wy(i.color):null,r.iconImage_=function(n,t,i,r,u,f){var e=tc.get(t,r,f);return e||(e=new int(n,t,i,r,u,f),tc.set(t,r,f,e)),e}(u,f,e,r.crossOrigin_,o,r.color_),r.offset_=void 0!==i.offset?i.offset:[0,0],r.offsetOrigin_=void 0!==i.offsetOrigin?i.offsetOrigin:ki.TOP_LEFT,r.origin_=null,r.size_=void 0!==i.size?i.size:null,r}return rnt(t,n),t.prototype.clone=function(){return new t({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var n=this.anchor_,t=this.getSize();if(this.anchorXUnits_==er.FRACTION||this.anchorYUnits_==er.FRACTION){if(!t)return null;n=this.anchor_.slice();this.anchorXUnits_==er.FRACTION&&(n[0]*=t[0]);this.anchorYUnits_==er.FRACTION&&(n[1]*=t[1])}if(this.anchorOrigin_!=ki.TOP_LEFT){if(!t)return null;n===this.anchor_&&(n=this.anchor_.slice());this.anchorOrigin_!=ki.TOP_RIGHT&&this.anchorOrigin_!=ki.BOTTOM_RIGHT||(n[0]=-n[0]+t[0]);this.anchorOrigin_!=ki.BOTTOM_LEFT&&this.anchorOrigin_!=ki.BOTTOM_RIGHT||(n[1]=-n[1]+t[1])}return this.normalizedAnchor_=n,this.normalizedAnchor_},t.prototype.setAnchor=function(n){this.anchor_=n;this.normalizedAnchor_=null},t.prototype.getColor=function(){return this.color_},t.prototype.getImage=function(n){return this.iconImage_.getImage(n)},t.prototype.getImageSize=function(){return this.iconImage_.getSize()},t.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},t.prototype.getImageState=function(){return this.iconImage_.getImageState()},t.prototype.getHitDetectionImage=function(n){return this.iconImage_.getHitDetectionImage(n)},t.prototype.getOrigin=function(){var n,t,i;if(this.origin_)return this.origin_;if(n=this.offset_,this.offsetOrigin_!=ki.TOP_LEFT){if(t=this.getSize(),i=this.iconImage_.getSize(),!t||!i)return null;n=n.slice();this.offsetOrigin_!=ki.TOP_RIGHT&&this.offsetOrigin_!=ki.BOTTOM_RIGHT||(n[0]=i[0]-t[0]-n[0]);this.offsetOrigin_!=ki.BOTTOM_LEFT&&this.offsetOrigin_!=ki.BOTTOM_RIGHT||(n[1]=i[1]-t[1]-n[1])}return this.origin_=n,this.origin_},t.prototype.getSrc=function(){return this.iconImage_.getSrc()},t.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},t.prototype.listenImageChange=function(n){this.iconImage_.addEventListener(a.CHANGE,n)},t.prototype.load=function(){this.iconImage_.load()},t.prototype.unlistenImageChange=function(n){this.iconImage_.removeEventListener(a.CHANGE,n)},t}(od),gu=function(){function n(n){var t=n||{};this.color_=void 0!==t.color?t.color:null;this.lineCap_=t.lineCap;this.lineDash_=void 0!==t.lineDash?t.lineDash:null;this.lineDashOffset_=t.lineDashOffset;this.lineJoin_=t.lineJoin;this.miterLimit_=t.miterLimit;this.width_=t.width}return n.prototype.clone=function(){var t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},n.prototype.getColor=function(){return this.color_},n.prototype.getLineCap=function(){return this.lineCap_},n.prototype.getLineDash=function(){return this.lineDash_},n.prototype.getLineDashOffset=function(){return this.lineDashOffset_},n.prototype.getLineJoin=function(){return this.lineJoin_},n.prototype.getMiterLimit=function(){return this.miterLimit_},n.prototype.getWidth=function(){return this.width_},n.prototype.setColor=function(n){this.color_=n},n.prototype.setLineCap=function(n){this.lineCap_=n},n.prototype.setLineDash=function(n){this.lineDash_=n},n.prototype.setLineDashOffset=function(n){this.lineDashOffset_=n},n.prototype.setLineJoin=function(n){this.lineJoin_=n},n.prototype.setMiterLimit=function(n){this.miterLimit_=n},n.prototype.setWidth=function(n){this.width_=n},n}(),fc=function(){function n(n){var t=n||{};this.geometry_=null;this.geometryFunction_=kot;void 0!==t.geometry&&this.setGeometry(t.geometry);this.fill_=void 0!==t.fill?t.fill:null;this.image_=void 0!==t.image?t.image:null;this.renderer_=void 0!==t.renderer?t.renderer:null;this.stroke_=void 0!==t.stroke?t.stroke:null;this.text_=void 0!==t.text?t.text:null;this.zIndex_=t.zIndex}return n.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new n({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},n.prototype.getRenderer=function(){return this.renderer_},n.prototype.setRenderer=function(n){this.renderer_=n},n.prototype.getGeometry=function(){return this.geometry_},n.prototype.getGeometryFunction=function(){return this.geometryFunction_},n.prototype.getFill=function(){return this.fill_},n.prototype.setFill=function(n){this.fill_=n},n.prototype.getImage=function(){return this.image_},n.prototype.setImage=function(n){this.image_=n},n.prototype.getStroke=function(){return this.stroke_},n.prototype.setStroke=function(n){this.stroke_=n},n.prototype.getText=function(){return this.text_},n.prototype.setText=function(n){this.text_=n},n.prototype.getZIndex=function(){return this.zIndex_},n.prototype.setGeometry=function(n){"function"==typeof n?this.geometryFunction_=n:"string"==typeof n?this.geometryFunction_=function(t){return t.get(n)}:n?void 0!==n&&(this.geometryFunction_=function(){return n}):this.geometryFunction_=kot;this.geometry_=n},n.prototype.setZIndex=function(n){this.zIndex_=n},n}(),ld=null;var ys=fc,dot={POINT:"point",LINE:"line"},fnt="#333",ia=function(){function n(n){var t=n||{};this.font_=t.font;this.rotation_=t.rotation;this.rotateWithView_=t.rotateWithView;this.scale_=t.scale;this.text_=t.text;this.textAlign_=t.textAlign;this.textBaseline_=t.textBaseline;this.fill_=void 0!==t.fill?t.fill:new vf({color:fnt});this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4;this.placement_=void 0!==t.placement?t.placement:dot.POINT;this.overflow_=!!t.overflow;this.stroke_=void 0!==t.stroke?t.stroke:null;this.offsetX_=void 0!==t.offsetX?t.offsetX:0;this.offsetY_=void 0!==t.offsetY?t.offsetY:0;this.backgroundFill_=t.backgroundFill?t.backgroundFill:null;this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null;this.padding_=void 0===t.padding?null:t.padding}return n.prototype.clone=function(){return new n({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},n.prototype.getOverflow=function(){return this.overflow_},n.prototype.getFont=function(){return this.font_},n.prototype.getMaxAngle=function(){return this.maxAngle_},n.prototype.getPlacement=function(){return this.placement_},n.prototype.getOffsetX=function(){return this.offsetX_},n.prototype.getOffsetY=function(){return this.offsetY_},n.prototype.getFill=function(){return this.fill_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getStroke=function(){return this.stroke_},n.prototype.getText=function(){return this.text_},n.prototype.getTextAlign=function(){return this.textAlign_},n.prototype.getTextBaseline=function(){return this.textBaseline_},n.prototype.getBackgroundFill=function(){return this.backgroundFill_},n.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},n.prototype.getPadding=function(){return this.padding_},n.prototype.setOverflow=function(n){this.overflow_=n},n.prototype.setFont=function(n){this.font_=n},n.prototype.setMaxAngle=function(n){this.maxAngle_=n},n.prototype.setOffsetX=function(n){this.offsetX_=n},n.prototype.setOffsetY=function(n){this.offsetY_=n},n.prototype.setPlacement=function(n){this.placement_=n},n.prototype.setRotateWithView=function(n){this.rotateWithView_=n},n.prototype.setFill=function(n){this.fill_=n},n.prototype.setRotation=function(n){this.rotation_=n},n.prototype.setScale=function(n){this.scale_=n},n.prototype.setStroke=function(n){this.stroke_=n},n.prototype.setText=function(n){this.text_=n},n.prototype.setTextAlign=function(n){this.textAlign_=n},n.prototype.setTextBaseline=function(n){this.textBaseline_=n},n.prototype.setBackgroundFill=function(n){this.backgroundFill_=n},n.prototype.setBackgroundStroke=function(n){this.backgroundStroke_=n},n.prototype.setPadding=function(n){this.padding_=n},n}();var got=.5,ont=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ec=function(n){function t(t,i,r){var u=n.call(this)||this,f=r||{};return u.tileCoord=t,u.state=i,u.interimTile=null,u.hifi=!0,u.key="",u.transition_=void 0===f.transition?250:f.transition,u.transitionStarts_={},u}return ont(t,n),t.prototype.changed=function(){this.dispatchEvent(a.CHANGE)},t.prototype.disposeInternal=function(){this.setState(c.ABORT)},t.prototype.getKey=function(){return this.key+"/"+this.tileCoord},t.prototype.getInterimTile=function(){if(!this.interimTile)return this;var n=this.interimTile;do{if(n.getState()==c.LOADED)return this.transition_=0,n;n=n.interimTile}while(n);return this},t.prototype.refreshInterimChain=function(){if(this.interimTile){var n=this.interimTile,t=this;do{if(n.getState()==c.LOADED){n.interimTile=null;break}n.getState()==c.LOADING?t=n:n.getState()==c.IDLE?t.interimTile=n.interimTile:t=n;n=t.interimTile}while(n)}},t.prototype.getTileCoord=function(){return this.tileCoord},t.prototype.getState=function(){return this.state},t.prototype.setState=function(n){if(this.state!==c.ERROR&&this.state>n)throw new Error("Tile load sequence violation");this.state=n;this.changed()},t.prototype.load=function(){w()},t.prototype.getAlpha=function(n,t){var i,r;if(!this.transition_)return 1;if(i=this.transitionStarts_[n],i){if(-1===i)return 1}else i=t,this.transitionStarts_[n]=i;return r=t-i+1e3/60,r>=this.transition_?1:wb(r/this.transition_)},t.prototype.inTransition=function(n){return!!this.transition_&&-1!==this.transitionStarts_[n]},t.prototype.endTransition=function(n){this.transition_&&(this.transitionStarts_[n]=-1)},t}(eh),snt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var tst=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i,e)||this;return o.crossOrigin_=u,o.src_=r,o.image_=new Image,null!==u&&(o.image_.crossOrigin=u),o.unlisten_=null,o.tileLoadFunction_=f,o}return snt(t,n),t.prototype.disposeInternal=function(){this.state==c.LOADING&&(this.unlistenImage_(),this.image_=nst());this.interimTile&&this.interimTile.dispose();n.prototype.disposeInternal.call(this)},t.prototype.getImage=function(){return this.image_},t.prototype.getKey=function(){return this.src_},t.prototype.handleImageError_=function(){this.state=c.ERROR;this.unlistenImage_();this.image_=nst();this.changed()},t.prototype.handleImageLoad_=function(){var n=this.image_;this.state=n.naturalWidth&&n.naturalHeight?c.LOADED:c.EMPTY;this.unlistenImage_();this.changed()},t.prototype.load=function(){this.state==c.ERROR&&(this.state=c.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_));this.state==c.IDLE&&(this.state=c.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=cd(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(ec),hnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ist=function(n){function t(t){return n.call(this,t)||this}return hnt(t,n),t.prototype.expireCache=function(n){for(;this.canExpireCache();){if(this.peekLast().getKey()in n)break;this.pop().dispose()}},t.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var n=function(n){return n.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(t){t.tileCoord[0]!==n&&(this.remove(gy(t.tileCoord)),t.dispose())}.bind(this))}},t}(ret);var cnt=10,ust=function(){function n(n,t,i,r,u){var e,o,f;this.sourceProj_=n;this.targetProj_=t;e={};o=tf(this.targetProj_,this.sourceProj_);this.transformInv_=function(n){var t=n[0]+"/"+n[1];return e[t]||(e[t]=o(n)),e[t]};this.maxSourceExtent_=r;this.errorThresholdSquared_=u*u;this.triangles_=[];this.wrapsXInSource_=!1;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&vt(r)==vt(this.sourceProj_.getExtent());this.sourceWorldWidth_=this.sourceProj_.getExtent()?vt(this.sourceProj_.getExtent()):null;this.targetWorldWidth_=this.targetProj_.getExtent()?vt(this.targetProj_.getExtent()):null;var s=yr(i),h=de(i),c=ke(i),l=ne(i),a=this.transformInv_(s),v=this.transformInv_(h),y=this.transformInv_(c),p=this.transformInv_(l);(this.addQuad_(s,h,c,l,a,v,y,p,cnt),this.wrapsXInSource_)&&(f=1/0,this.triangles_.forEach(function(n){f=Math.min(f,n.source[0][0],n.source[1][0],n.source[2][0])}),this.triangles_.forEach(function(n){var t,i;Math.max(n.source[0][0],n.source[1][0],n.source[2][0])-f>this.sourceWorldWidth_/2&&(t=[[n.source[0][0],n.source[0][1]],[n.source[1][0],n.source[1][1]],[n.source[2][0],n.source[2][1]]],t[0][0]-f>this.sourceWorldWidth_/2&&(t[0][0]-=this.sourceWorldWidth_),t[1][0]-f>this.sourceWorldWidth_/2&&(t[1][0]-=this.sourceWorldWidth_),t[2][0]-f>this.sourceWorldWidth_/2&&(t[2][0]-=this.sourceWorldWidth_),i=Math.min(t[0][0],t[1][0],t[2][0]),Math.max(t[0][0],t[1][0],t[2][0])-i<this.sourceWorldWidth_/2&&(n.source=t))}.bind(this)));e={}}return n.prototype.addTriangle_=function(n,t,i,r,u,f){this.triangles_.push({source:[r,u,f],target:[n,t,i]})},n.prototype.addQuad_=function(n,t,i,r,u,f,e,o,s){var g=oi([u,f,e,o]),c=this.sourceWorldWidth_?vt(g)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,a=this.sourceProj_.canWrapX()&&c>.5&&c<1,h=!1,p;if(s>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(h=vt(oi([n,t,i,r]))/this.targetWorldWidth_>.25||h),!a&&this.sourceProj_.isGlobal()&&c&&(h=c>.25||h)),h||!this.maxSourceExtent_||fi(g,this.maxSourceExtent_)){if(!(h||isFinite(u[0])&&isFinite(u[1])&&isFinite(f[0])&&isFinite(f[1])&&isFinite(e[0])&&isFinite(e[1])&&isFinite(o[0])&&isFinite(o[1]))){if(!(s>0))return;h=!0}if(s>0){if(!h){var ut=[(n[0]+i[0])/2,(n[1]+i[1])/2],v=this.transformInv_(ut),y=void 0;y=a?(pu(u[0],l)+pu(e[0],l))/2-pu(v[0],l):(u[0]+e[0])/2-v[0];p=(u[1]+e[1])/2-v[1];h=y*y+p*p>this.errorThresholdSquared_}if(h){if(Math.abs(n[0]-i[0])<=Math.abs(n[1]-i[1])){var w=[(t[0]+i[0])/2,(t[1]+i[1])/2],nt=this.transformInv_(w),b=[(r[0]+n[0])/2,(r[1]+n[1])/2],tt=this.transformInv_(b);this.addQuad_(n,t,w,b,u,f,nt,tt,s-1);this.addQuad_(b,w,i,r,tt,nt,e,o,s-1)}else{var k=[(n[0]+t[0])/2,(n[1]+t[1])/2],it=this.transformInv_(k),d=[(i[0]+r[0])/2,(i[1]+r[1])/2],rt=this.transformInv_(d);this.addQuad_(n,k,d,r,u,it,rt,o,s-1);this.addQuad_(k,t,i,d,it,f,e,rt,s-1)}return}}if(a){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(n,i,r,u,e,o);this.addTriangle_(n,t,i,u,f,e)}},n.prototype.calculateSourceExtent=function(){var n=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(t){var i=t.source;hh(n,i[0]);hh(n,i[1]);hh(n,i[2])}),n},n.prototype.getTriangles=function(){return this.triangles_},n}(),lnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ant=function(n){function t(t,i,r,u,f,e,o,s,h,l,a){var v=n.call(this,f,c.IDLE)||this,k,ut,w,ft,p,b,d,g,tt;v.renderEdges_=void 0!==a&&a;v.pixelRatio_=o;v.gutter_=s;v.canvas_=null;v.sourceTileGrid_=i;v.targetTileGrid_=u;v.wrappedTileCoord_=e||f;v.sourceTiles_=[];v.sourcesListenerKeys_=null;v.sourceZ_=0;var it=u.getTileCoordExtent(v.wrappedTileCoord_),rt=v.targetTileGrid_.getExtent(),y=v.sourceTileGrid_.getExtent(),nt=rt?vu(it,rt):it;if(0===sv(nt)||(k=t.getExtent(),k&&(y=y?vu(y,k):k),ut=u.getResolution(v.wrappedTileCoord_[0]),w=up(t,r,vr(nt),ut),!isFinite(w)||w<=0)||(ft=void 0!==l?l:got,v.triangulation_=new ust(t,r,nt,y,w*ft),0===v.triangulation_.getTriangles().length))return v.state=c.EMPTY,v;if(v.sourceZ_=i.getZForResolution(w),p=v.triangulation_.calculateSourceExtent(),y&&(t.canWrapX()?(p[1]=kt(p[1],y[1],y[3]),p[3]=kt(p[3],y[1],y[3])):p=vu(p,y)),sv(p)){for(b=i.getTileRangeForExtentAndZ(p,v.sourceZ_),d=b.minX;d<=b.maxX;d++)for(g=b.minY;g<=b.maxY;g++)tt=h(v.sourceZ_,d,g,o),tt&&v.sourceTiles_.push(tt);0===v.sourceTiles_.length&&(v.state=c.EMPTY)}else v.state=c.EMPTY;return v}return lnt(t,n),t.prototype.disposeInternal=function(){this.state==c.LOADING&&this.unlistenSources_();n.prototype.disposeInternal.call(this)},t.prototype.getImage=function(){return this.canvas_},t.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(n){n&&n.getState()==c.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(n.tileCoord),image:n.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=c.ERROR;else{var i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),r="number"==typeof n?n:n[0],u="number"==typeof n?n:n[1],f=this.targetTileGrid_.getResolution(i),e=this.sourceTileGrid_.getResolution(this.sourceZ_),o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=rst(r,u,this.pixelRatio_,e,this.sourceTileGrid_.getExtent(),f,o,this.triangulation_,t,this.gutter_,this.renderEdges_);this.state=c.LOADED}this.changed()},t.prototype.load=function(){if(this.state==c.IDLE){this.state=c.LOADING;this.changed();var n=0;this.sourcesListenerKeys_=[];this.sourceTiles_.forEach(function(t){var r=t.getState(),i;(r==c.IDLE||r==c.LOADING)&&(n++,i=nt(t,a.CHANGE,function(){var r=t.getState();r!=c.LOADED&&r!=c.ERROR&&r!=c.EMPTY||(ct(i),0==--n&&(this.unlistenSources_(),this.reproject_()))},this),this.sourcesListenerKeys_.push(i))}.bind(this));this.sourceTiles_.forEach(function(n){n.getState()==c.IDLE&&n.load()});0===n&&setTimeout(this.reproject_.bind(this),0)}},t.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(ct);this.sourcesListenerKeys_=null},t}(ec),vnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var oc=function(n){function t(t){var i=n.call(this)||this;return i.projection_=y(t.projection),i.attributions_=fst(t.attributions),i.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,i.loading=!1,i.state_=void 0!==t.state?t.state:li.READY,i.wrapX_=void 0!==t.wrapX&&t.wrapX,i}return vnt(t,n),t.prototype.getAttributions=function(){return this.attributions_},t.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},t.prototype.getProjection=function(){return this.projection_},t.prototype.getResolutions=function(){return w()},t.prototype.getState=function(){return this.state_},t.prototype.getWrapX=function(){return this.wrapX_},t.prototype.refresh=function(){this.changed()},t.prototype.setAttributions=function(n){this.attributions_=fst(n);this.changed()},t.prototype.setState=function(n){this.state_=n;this.changed()},t}(hu),est=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ynt=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this,r,u,f;if(i.opaque_=void 0!==t.opaque&&t.opaque,i.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,i.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,r=t.cacheSize,void 0===r){u=[256,256];f=t.tileGrid;f&&hr(f.getTileSize(f.getMinZoom()),u);var e="undefined"!=typeof screen,o=e?screen.availWidth||screen.width:1920,s=e?screen.availHeight||screen.height:1080;r=4*Math.ceil(o/u[0])*Math.ceil(s/u[1])}return i.tileCache=new ist(r),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition},i.zDirection=t.zDirection?t.zDirection:0,i}return est(t,n),t.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},t.prototype.expireCache=function(n,t){var i=this.getTileCacheForProjection(n);i&&i.expireCache(t)},t.prototype.forEachLoadedTile=function(n,t,i,r){var o=this.getTileCacheForProjection(n),l,s,u,h,f,e;if(!o)return!1;for(h=!0,f=i.minX;f<=i.maxX;++f)for(e=i.minY;e<=i.maxY;++e)s=fo(t,f,e),u=!1,o.containsKey(s)&&(u=(l=o.get(s)).getState()===c.LOADED)&&(u=!1!==r(l)),u||(h=!1);return h},t.prototype.getGutterForProjection=function(){return 0},t.prototype.getKey=function(){return this.key_},t.prototype.setKey=function(n){this.key_!==n&&(this.key_=n,this.changed())},t.prototype.getOpaque=function(){return this.opaque_},t.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},t.prototype.getTile=function(){return w()},t.prototype.getTileGrid=function(){return this.tileGrid},t.prototype.getTileGridForProjection=function(n){return this.tileGrid?this.tileGrid:iot(n)},t.prototype.getTileCacheForProjection=function(n){var t=this.getProjection();return t&&!pr(t,n)?null:this.tileCache},t.prototype.getTilePixelRatio=function(){return this.tilePixelRatio_},t.prototype.getTilePixelSize=function(n,t,i){var f=this.getTileGridForProjection(i),r=this.getTilePixelRatio(t),u=hr(f.getTileSize(n),this.tmpSize);return 1==r?u:gb(u,r,this.tmpSize)},t.prototype.getTileCoordForTileUrlFunction=function(n,t){var i=void 0!==t?t:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(n=function(n,t,i){var o=t[0],r=n.getTileCoordCenter(t),u=as(i),f,e;return fv(u,r)?t:(f=vt(u),e=Math.ceil((u[0]-r[0])/f),r[0]+=f*e,n.getTileCoordForCoordAndZ(r,o))}(r,n,i)),function(n,t){var i=n[0],f=n[1],e=n[2],u,r;return t.getMinZoom()>i||i>t.getMaxZoom()?!1:(r=t.getExtent(),!(u=r?t.getTileRangeForExtentAndZ(r,i):t.getFullTileRange(i))||u.containsXY(f,e))}(n,r)?n:null},t.prototype.clear=function(){this.tileCache.clear()},t.prototype.refresh=function(){this.clear();n.prototype.refresh.call(this)},t.prototype.useTile=function(){},t}(oc),pnt=function(n){function t(t,i){var r=n.call(this,t)||this;return r.tile=i,r}return est(t,n),t}(ur),fp=ynt,wnt="tileloadstart",bnt="tileloadend",knt="tileloaderror",dnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ost=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return i.generateTileUrlFunction_=!t.tileUrlFunction,i.tileLoadFunction=t.tileLoadFunction,i.tileUrlFunction=t.tileUrlFunction?t.tileUrlFunction.bind(i):vd,i.urls=null,t.urls?i.setUrls(t.urls):t.url&&i.setUrl(t.url),i.tileLoadingKeys_={},i}return dnt(t,n),t.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},t.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},t.prototype.getUrls=function(){return this.urls},t.prototype.handleTileChange=function(n){var t,r=n.target,u=v(r),i=r.getState();i==c.LOADING?(this.tileLoadingKeys_[u]=!0,t=wnt):u in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[u],t=i==c.ERROR?knt:i==c.LOADED||i==c.ABORT?bnt:void 0);null!=t&&this.dispatchEvent(new pnt(t,r))},t.prototype.setTileLoadFunction=function(n){this.tileCache.clear();this.tileLoadFunction=n;this.changed()},t.prototype.setTileUrlFunction=function(n,t){this.tileUrlFunction=n;this.tileCache.pruneExceptNewestZ();void 0!==t?this.setKey(t):this.changed()},t.prototype.setUrl=function(n){var t=yd(n);this.urls=t;this.setUrls(t)},t.prototype.setUrls=function(n){this.urls=n;var t=n.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(ad(n,this.tileGrid),t):this.setKey(t)},t.prototype.useTile=function(n,t,i){var r=fo(n,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},t}(fp),gnt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var fe=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:nti,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return i.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,i.tileClass=void 0!==t.tileClass?t.tileClass:tst,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return gnt(t,n),t.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var n in this.tileCacheForProjection)if(this.tileCacheForProjection[n].canExpireCache())return!0;return!1},t.prototype.expireCache=function(n,t){var r=this.getTileCacheForProjection(n),u,i;for(u in this.tileCache.expireCache(this.tileCache==r?t:{}),this.tileCacheForProjection)i=this.tileCacheForProjection[u],i.expireCache(i==r?t:{})},t.prototype.getGutterForProjection=function(n){return this.getProjection()&&n&&!pr(this.getProjection(),n)?0:this.getGutter()},t.prototype.getGutter=function(){return 0},t.prototype.getOpaque=function(t){return!(this.getProjection()&&t&&!pr(this.getProjection(),t))&&n.prototype.getOpaque.call(this,t)},t.prototype.getTileGridForProjection=function(n){var i=this.getProjection(),t;return!this.tileGrid||i&&!pr(i,n)?(t=v(n),t in this.tileGridForProjection||(this.tileGridForProjection[t]=iot(n)),this.tileGridForProjection[t]):this.tileGrid},t.prototype.getTileCacheForProjection=function(n){var i=this.getProjection(),t;return!i||pr(i,n)?this.tileCache:(t=v(n),t in this.tileCacheForProjection||(this.tileCacheForProjection[t]=new ist(this.tileCache.highWaterMark)),this.tileCacheForProjection[t])},t.prototype.createTile_=function(n,t,i,r,u,f){var s=[n,t,i],h=this.getTileCoordForTileUrlFunction(s,u),e=h?this.tileUrlFunction(h,r,u):void 0,o=new this.tileClass(s,void 0!==e?c.IDLE:c.EMPTY,void 0!==e?e:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return o.key=f,o.addEventListener(a.CHANGE,this.handleTileChange.bind(this)),o},t.prototype.getTile=function(n,t,i,r,u){var f=this.getProjection(),l;if(f&&u&&!pr(f,u)){var s=this.getTileCacheForProjection(u),c=[n,t,i],e=void 0,h=gy(c);if(s.containsKey(h)&&(e=s.get(h)),l=this.getKey(),e&&e.key==l)return e;var a=this.getTileGridForProjection(f),v=this.getTileGridForProjection(u),y=this.getTileCoordForTileUrlFunction(c,u),o=new ant(f,a,u,v,c,y,this.getTilePixelRatio(r),this.getGutter(),function(n,t,i,r){return this.getTileInternal(n,t,i,r,f)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return o.key=l,e?(o.interimTile=e,o.refreshInterimChain(),s.replace(h,o)):s.set(h,o),o}return this.getTileInternal(n,t,i,r,f||u)},t.prototype.getTileInternal=function(n,t,i,r,u){var f=null,e=fo(n,t,i),s=this.getKey(),o;return this.tileCache.containsKey(e)?(f=this.tileCache.get(e)).key!=s&&(o=f,f=this.createTile_(n,t,i,r,u,s),f.interimTile=o.getState()==c.IDLE?o.interimTile:o,f.refreshInterimChain(),this.tileCache.replace(e,f)):(f=this.createTile_(n,t,i,r,u,s),this.tileCache.set(e,f)),f},t.prototype.setRenderReprojectionEdges=function(n){if(this.renderReprojectionEdges_!=n){for(var t in this.renderReprojectionEdges_=n,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}},t.prototype.setTileGridForProjection=function(n,t){var r=y(n),i;r&&(i=v(r),i in this.tileGridForProjection||(this.tileGridForProjection[i]=t))},t}(ost),tti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iti=function(n){function t(t){var i=this,r=void 0!==t.hidpi&&t.hidpi;return(i=n.call(this,{cacheSize:t.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:y("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:li.LOADING,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:r?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this).hidpi_=r,i.culture_=void 0!==t.culture?t.culture:"en-us",i.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,i.apiKey_=t.key,i.imagerySet_=t.imagerySet,rp("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+i.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+i.apiKey_+"&c="+i.culture_,i.handleImageryMetadataResponse.bind(i),void 0,"jsonp"),i}return tti(t,n),t.prototype.getApiKey=function(){return this.apiKey_},t.prototype.getImagerySet=function(){return this.imagerySet_},t.prototype.handleImageryMetadataResponse=function(n){var r,u,f;if(200==n.statusCode&&"OK"==n.statusDescription&&"ValidCredentials"==n.authenticationResultCode&&1==n.resourceSets.length&&1==n.resourceSets[0].resources.length){var t=n.resourceSets[0].resources[0],e=-1==this.maxZoom_?t.zoomMax:this.maxZoom_,o=as(this.getProjection()),i=this.hidpi_?2:1,s=t.imageWidth==t.imageHeight?t.imageWidth/i:[t.imageWidth/i,t.imageHeight/i],h=rc({extent:o,minZoom:t.zoomMin,maxZoom:e,tileSize:s});this.tileGrid=h;r=this.culture_;u=this.hidpi_;(this.tileUrlFunction=ra(t.imageUrlSubdomains.map(function(n){var i=[0,0,0],f=t.imageUrl.replace("{subdomain}",n).replace("{culture}",r);return function(n){if(n){td(n[0],n[1],n[2],i);var t=f;return u&&(t+="&dpi=d1&device=mobile"),t.replace("{quadkey}",function(n){for(var i,r=n[0],f=new Array(r),u=1<<r-1,t=0;t<r;++t)i=48,n[1]&u&&(i+=1),n[2]&u&&(i+=2),f[t]=String.fromCharCode(i),u>>=1;return f.join("")}(i))}}})),t.imageryProviders)&&(f=wu(y("EPSG:4326"),this.getProjection()),this.setAttributions(function(n){var i=[],r=n.viewState,u=this.getTileGrid(),o=u.getZForResolution(r.resolution,this.zDirection),e=u.getTileCoordForCoordAndZ(r.center,o)[0];return t.imageryProviders.map(function(t){for(var u,r,s=!1,h=t.coverageAreas,o=0,c=h.length;o<c;++o)if(u=h[o],e>=u.zoomMin&&e<=u.zoomMax&&(r=u.bbox,fi(rl([r[1],r[0],r[3],r[2]],f),n.extent))){s=!0;break}s&&i.push(t.attribution)}),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use<\/a>'),i}.bind(this)));this.setState(li.READY)}else this.setState(li.ERROR)},t}(fe),rti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ua=function(n){function t(t){var i=t||{},r=void 0!==i.projection?i.projection:"EPSG:3857",u=void 0!==i.tileGrid?i.tileGrid:rc({extent:as(r),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});return n.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:r,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:u,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this}return rti(t,n),t}(fe),uti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fti=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:void 0!==t.maxZoom?t.maxZoom:18,minZoom:t.minZoom,projection:t.projection,wrapX:t.wrapX})||this;return i.account_=t.account,i.mapId_=t.map||"",i.config_=t.config||{},i.templateCache_={},i.initializeMap_(),i}return uti(t,n),t.prototype.getConfig=function(){return this.config_},t.prototype.updateConfig=function(n){d(this.config_,n);this.initializeMap_()},t.prototype.setConfig=function(n){this.config_=n||{};this.initializeMap_()},t.prototype.initializeMap_=function(){var t=JSON.stringify(this.config_),i,n;this.templateCache_[t]?this.applyTemplate_(this.templateCache_[t]):(i="https://"+this.account_+".carto.com/api/v1/map",this.mapId_&&(i+="/named/"+this.mapId_),n=new XMLHttpRequest,n.addEventListener("load",this.handleInitResponse_.bind(this,t)),n.addEventListener("error",this.handleInitError_.bind(this)),n.open("POST",i),n.setRequestHeader("Content-type","application/json"),n.send(JSON.stringify(this.config_)))},t.prototype.handleInitResponse_=function(n,t){var i=t.target,r;if(!i.status||i.status>=200&&i.status<300){r=void 0;try{r=JSON.parse(i.responseText)}catch(n){return void this.setState(li.ERROR)}this.applyTemplate_(r);this.templateCache_[n]=r;this.setState(li.READY)}else this.setState(li.ERROR)},t.prototype.handleInitError_=function(){this.setState(li.ERROR)},t.prototype.applyTemplate_=function(n){var t="https://"+n.cdn_url.https+"/"+this.account_+"/api/v1/map/"+n.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(t)},t}(ua),dr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"},eti=i(0),sst=i.n(eti),ep=function(){function n(n){this.rbush_=new sst.a(n);this.items_={}}return n.prototype.insert=function(n,t){var i={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],value:t};this.rbush_.insert(i);this.items_[v(t)]=i},n.prototype.load=function(n,t){for(var u=new Array(t.length),i=0,o=t.length;i<o;i++){var r=n[i],f=t[i],e={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:f};u[i]=e;this.items_[v(f)]=e}this.rbush_.load(u)},n.prototype.remove=function(n){var t=v(n),i=this.items_[t];return delete this.items_[t],null!==this.rbush_.remove(i)},n.prototype.update=function(n,t){var i=this.items_[v(t)];uu([i.minX,i.minY,i.maxX,i.maxY],n)||(this.remove(t),this.insert(n,t))},n.prototype.getAll=function(){return this.rbush_.all().map(function(n){return n.value})},n.prototype.getInExtent=function(n){var t={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]};return this.rbush_.search(t).map(function(n){return n.value})},n.prototype.forEach=function(n){return this.forEach_(this.getAll(),n)},n.prototype.forEachInExtent=function(n,t){return this.forEach_(this.getInExtent(n),t)},n.prototype.forEach_=function(n,t){for(var i,r=0,u=n.length;r<u;r++)if(i=t(n[r]))return i;return i},n.prototype.isEmpty=function(){return bo(this.items_)},n.prototype.clear=function(){this.rbush_.clear();this.items_={}},n.prototype.getExtent=function(n){var t=this.rbush_.toJSON();return ru(t.minX,t.minY,t.maxX,t.maxY,n)},n.prototype.concat=function(n){for(var t in this.rbush_.load(n.rbush_.all()),n.items_)this.items_[t]=n.items_[t]},n}(),hst=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fa=function(n){function t(t,i){var r=n.call(this,t)||this;return r.feature=i,r}return hst(t,n),t}(ur),ps=function(n){function t(t){var i=this,r=t||{},u,f,e;return(i=n.call(this,{attributions:r.attributions,projection:void 0,state:li.READY,wrapX:void 0===r.wrapX||r.wrapX})||this).loader_=gf,i.format_=r.format,i.overlaps_=null==r.overlaps||r.overlaps,i.url_=r.url,void 0!==r.loader?i.loader_=r.loader:void 0!==i.url_&&(p(i.format_,7),i.loader_=kk(i.url_,i.format_)),i.strategy_=void 0!==r.strategy?r.strategy:get,e=void 0===r.useSpatialIndex||r.useSpatialIndex,i.featuresRtree_=e?new ep:null,i.loadedExtentsRtree_=new ep,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(r.features)?f=r.features:r.features&&(f=(u=r.features).getArray()),e||void 0!==u||(u=new gi(f)),void 0!==f&&i.addFeaturesInternal(f),void 0!==u&&i.bindFeaturesCollection_(u),i}return hst(t,n),t.prototype.addFeature=function(n){this.addFeatureInternal(n);this.changed()},t.prototype.addFeatureInternal=function(n){var t=v(n),i,r;this.addToIndex_(t,n)?(this.setupChangeEvents_(t,n),i=n.getGeometry(),i?(r=i.getExtent(),this.featuresRtree_&&this.featuresRtree_.insert(r,n)):this.nullGeometryFeatures_[t]=n,this.dispatchEvent(new fa(dr.ADDFEATURE,n))):this.featuresCollection_&&this.featuresCollection_.remove(n)},t.prototype.setupChangeEvents_=function(n,t){this.featureChangeKeys_[n]=[nt(t,a.CHANGE,this.handleFeatureChange_,this),nt(t,wo,this.handleFeatureChange_,this)]},t.prototype.addToIndex_=function(n,t){var i=!0,r=t.getId();return void 0!==r&&(r.toString()in this.idIndex_?i=!1:this.idIndex_[r.toString()]=t),i&&(p(!(n in this.uidIndex_),30),this.uidIndex_[n]=t),i},t.prototype.addFeatures=function(n){this.addFeaturesInternal(n);this.changed()},t.prototype.addFeaturesInternal=function(n){for(var u,s,i,f,h,c,e=[],r=[],o=[],t=0,l=n.length;t<l;t++)u=v(i=n[t]),this.addToIndex_(u,i)&&r.push(i);for(t=0,s=r.length;t<s;t++)u=v(i=r[t]),this.setupChangeEvents_(u,i),f=i.getGeometry(),f?(h=f.getExtent(),e.push(h),o.push(i)):this.nullGeometryFeatures_[u]=i;for(this.featuresRtree_&&this.featuresRtree_.load(e,o),t=0,c=r.length;t<c;t++)this.dispatchEvent(new fa(dr.ADDFEATURE,r[t]))},t.prototype.bindFeaturesCollection_=function(n){var t=!1;this.addEventListener(dr.ADDFEATURE,function(i){t||(t=!0,n.push(i.feature),t=!1)});this.addEventListener(dr.REMOVEFEATURE,function(i){t||(t=!0,n.remove(i.feature),t=!1)});n.addEventListener(yi.ADD,function(n){t||(t=!0,this.addFeature(n.element),t=!1)}.bind(this));n.addEventListener(yi.REMOVE,function(n){t||(t=!0,this.removeFeature(n.element),t=!1)}.bind(this));this.featuresCollection_=n},t.prototype.clear=function(n){var t,i,r;if(n){for(t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(ct);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(i in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear();this.featuresRtree_&&this.featuresRtree_.clear();this.nullGeometryFeatures_={};r=new fa(dr.CLEAR);this.dispatchEvent(r);this.changed()},t.prototype.forEachFeature=function(n){if(this.featuresRtree_)return this.featuresRtree_.forEach(n);this.featuresCollection_&&this.featuresCollection_.forEach(n)},t.prototype.forEachFeatureAtCoordinateDirect=function(n,t){var i=[n[0],n[1],n[0],n[1]];return this.forEachFeatureInExtent(i,function(i){if(i.getGeometry().intersectsCoordinate(n))return t(i)})},t.prototype.forEachFeatureInExtent=function(n,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(n,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},t.prototype.forEachFeatureIntersectingExtent=function(n,t){return this.forEachFeatureInExtent(n,function(i){if(i.getGeometry().intersectsExtent(n)){var r=t(i);if(r)return r}})},t.prototype.getFeaturesCollection=function(){return this.featuresCollection_},t.prototype.getFeatures=function(){var n;return this.featuresCollection_?n=this.featuresCollection_.getArray():this.featuresRtree_&&(n=this.featuresRtree_.getAll(),bo(this.nullGeometryFeatures_)||pt(n,iv(this.nullGeometryFeatures_))),n},t.prototype.getFeaturesAtCoordinate=function(n){var t=[];return this.forEachFeatureAtCoordinateDirect(n,function(n){t.push(n)}),t},t.prototype.getFeaturesInExtent=function(n){return this.featuresRtree_?this.featuresRtree_.getInExtent(n):this.featuresCollection_?this.featuresCollection_.getArray():[]},t.prototype.getClosestFeatureToCoordinate=function(n,t){var u=n[0],f=n[1],e=null,o=[NaN,NaN],r=1/0,i=[-1/0,-1/0,1/0,1/0],s=t||tu;return this.featuresRtree_.forEachInExtent(i,function(n){var h,c,t;s(n)&&(h=n.getGeometry(),c=r,(r=h.closestPointXY(u,f,o,r))<c&&(e=n,t=Math.sqrt(r),i[0]=u-t,i[1]=f-t,i[2]=u+t,i[3]=f+t))}),e},t.prototype.getExtent=function(n){return this.featuresRtree_.getExtent(n)},t.prototype.getFeatureById=function(n){var t=this.idIndex_[n.toString()];return void 0!==t?t:null},t.prototype.getFeatureByUid=function(n){var t=this.uidIndex_[n];return void 0!==t?t:null},t.prototype.getFormat=function(){return this.format_},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.getUrl=function(){return this.url_},t.prototype.handleFeatureChange_=function(n){var t=n.target,i=v(t),e=t.getGeometry(),r,u,f;e?(r=e.getExtent(),i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,t)):this.featuresRtree_&&this.featuresRtree_.update(r,t)):i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);u=t.getId();void 0!==u?(f=u.toString(),this.idIndex_[f]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[f]=t)):(this.removeFromIdIndex_(t),this.uidIndex_[i]=t);this.changed();this.dispatchEvent(new fa(dr.CHANGEFEATURE,t))},t.prototype.hasFeature=function(n){var t=n.getId();return void 0!==t?t in this.idIndex_:v(n)in this.uidIndex_},t.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&bo(this.nullGeometryFeatures_)},t.prototype.loadFeatures=function(n,t,i){var f=this.loadedExtentsRtree_,e=this.strategy_(n,t);this.loading=!1;for(var o=function(n){var u=e[n];f.forEachInExtent(u,function(n){return tr(n.extent,u)})||(r.loader_.call(r,u,t,i),f.insert(u,{extent:u.slice()}),r.loading=r.loader_!==gf)},r=this,u=0,s=e.length;u<s;++u)o(u)},t.prototype.refresh=function(){this.clear(!0);this.loadedExtentsRtree_.clear();n.prototype.refresh.call(this)},t.prototype.removeLoadedExtent=function(n){var t,i=this.loadedExtentsRtree_;i.forEachInExtent(n,function(i){if(uu(i.extent,n))return t=i,!0});t&&i.remove(t)},t.prototype.removeFeature=function(n){var t=v(n);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(n);this.removeFeatureInternal(n);this.changed()},t.prototype.removeFeatureInternal=function(n){var t=v(n),i;this.featureChangeKeys_[t].forEach(ct);delete this.featureChangeKeys_[t];i=n.getId();void 0!==i&&delete this.idIndex_[i.toString()];delete this.uidIndex_[t];this.dispatchEvent(new fa(dr.REMOVEFEATURE,n))},t.prototype.removeFromIdIndex_=function(n){var t=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===n){delete this.idIndex_[i];t=!0;break}return t},t.prototype.setLoader=function(n){this.loader_=n},t.prototype.setUrl=function(n){p(this.format_,7);this.setLoader(kk(n,this.format_))},t}(oc),oti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sti=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return i.resolution=void 0,i.distance=void 0!==t.distance?t.distance:20,i.features=[],i.geometryFunction=t.geometryFunction||function(n){var t=n.getGeometry();return p(t.getType()==f.POINT,10),t},i.source=t.source,i.source.addEventListener(a.CHANGE,i.refresh.bind(i)),i}return oti(t,n),t.prototype.getDistance=function(){return this.distance},t.prototype.getSource=function(){return this.source},t.prototype.loadFeatures=function(n,t,i){this.source.loadFeatures(n,t,i);t!==this.resolution&&(this.clear(),this.resolution=t,this.cluster(),this.addFeatures(this.features))},t.prototype.setDistance=function(n){this.distance=n;this.refresh()},t.prototype.refresh=function(){this.clear();this.cluster();this.addFeatures(this.features)},t.prototype.cluster=function(){var u,f,t;if(void 0!==this.resolution){this.features.length=0;for(var n=[1/0,1/0,-1/0,-1/0],o=this.distance*this.resolution,e=this.source.getFeatures(),i={},r=0,s=e.length;r<s;r++)u=e[r],v(u)in i||(f=this.geometryFunction(u),f&&(sh(f.getCoordinates(),n),iu(n,o,n),t=this.source.getFeaturesInExtent(n),t=t.filter(function(n){var t=v(n);return!(t in i)&&(i[t]=!0,!0)}),this.features.push(this.createCluster(t))))}},t.prototype.createCluster=function(n){for(var r,u,i=[0,0],t=n.length-1;t>=0;--t)r=this.geometryFunction(n[t]),r?pb(i,r.getCoordinates()):n.splice(t,1);return uut(i,1/n.length),u=new ui(new si(i)),u.set("features",n),u},t}(ps),cst=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wd={DEFAULT:"default",TRUNCATED:"truncated"},lst=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,r,u,f,e,o,s)||this;return h.zoomifyImage_=null,h.tileSize_=hr(i.getTileSize(r[0])).map(function(n){return n*t}),h}return cst(t,n),t.prototype.getImage=function(){var t,i,r;return this.zoomifyImage_?this.zoomifyImage_:(t=n.prototype.getImage.call(this),this.state==c.LOADED)?(i=this.tileSize_,t.width==i[0]&&t.height==i[1])?(this.zoomifyImage_=t,t):(r=ci(i[0],i[1]),r.drawImage(t,0,0),this.zoomifyImage_=r.canvas,r.canvas):t},t}(tst),hti=function(n){function t(t){var w=this,i=t||{},o=i.size,tt=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:wd.DEFAULT,l=o[0],a=o[1],b=i.extent||[0,-o[1],o[0],0],u=[],k=i.tileSize||gh,d=i.tilePixelRatio||1,r=k,s,h,c,e,g,nt;switch(tt){case wd.DEFAULT:for(;l>r||a>r;)u.push([Math.ceil(l/r),Math.ceil(a/r)]),r+=r;break;case wd.TRUNCATED:for(s=l,h=a;s>r||h>r;)u.push([Math.ceil(s/r),Math.ceil(h/r)]),s>>=1,h>>=1;break;default:p(!1,53)}u.push([1,1]);u.reverse();for(var v=[1],y=[0],f=1,it=u.length;f<it;f++)v.push(1<<f),y.push(u[f-1][0]*u[f-1][1]+y[f-1]);return v.reverse(),c=new ls({tileSize:k,extent:b,origin:yr(b),resolutions:v}),e=i.url,e&&-1==e.indexOf("{TileGroup}")&&-1==e.indexOf("{tileIndex}")&&(e+="{TileGroup}/{z}-{x}-{y}.jpg"),g=ra(yd(e).map(function(n){return function(t){if(t){var i=t[0],f=t[1],e=t[2],o=f+e*u[i][0],r=c.getTileSize(i),s=Array.isArray(r)?r[0]:r,h={z:i,x:f,y:e,tileIndex:o,TileGroup:"TileGroup"+((o+y[i])/s|0)};return n.replace(/\{(\w+?)\}/g,function(n,t){return h[t]})}}})),nt=lst.bind(null,d,c),(w=n.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,tilePixelRatio:d,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:nt,tileGrid:c,tileUrlFunction:g,transition:i.transition})||this).zDirection=i.zDirection,w}return cst(t,n),t}(fe),wi={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"},ws={};ws[wi.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}};ws[wi.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}};ws[wi.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}};ws.none={none:{supports:[],formats:[],qualities:[]}};var cti=new RegExp("^https?://library.stanford.edu/iiif/image-api/(1.1/)?compliance.html#level[0-2]$"),ast=new RegExp("^https?://iiif.io/api/image/2/level[0-2](.json)?$"),lti=new RegExp("(^https?://iiif.io/api/image/3/level[0-2](.json)?$)|(^level[0-2]$)"),op={};op[wi.VERSION1]=function(n){var t=n.getComplianceLevelSupportedFeatures();return void 0===t&&(t=ws[wi.VERSION1].level0),{url:void 0===n.imageInfo["@id"]?void 0:n.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),supports:t.supports,formats:t.formats.concat([void 0===n.imageInfo.formats?[]:n.imageInfo.formats]),qualities:t.qualities.concat([void 0===n.imageInfo.qualities?[]:n.imageInfo.qualities]),resolutions:n.imageInfo.scale_factors,tileSize:void 0!==n.imageInfo.tile_width?void 0!==n.imageInfo.tile_height?[n.imageInfo.tile_width,n.imageInfo.tile_height]:[n.imageInfo.tile_width,n.imageInfo.tile_width]:null!=n.imageInfo.tile_height?[n.imageInfo.tile_height,n.imageInfo.tile_height]:void 0}};op[wi.VERSION2]=function(n){var t=n.getComplianceLevelSupportedFeatures(),i=Array.isArray(n.imageInfo.profile)&&n.imageInfo.profile.length>1,r=i&&n.imageInfo.profile[1].supports?n.imageInfo.profile[1].supports:[],u=i&&n.imageInfo.profile[1].formats?n.imageInfo.profile[1].formats:[],f=i&&n.imageInfo.profile[1].qualities?n.imageInfo.profile[1].qualities:[];return{url:n.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),sizes:void 0===n.imageInfo.sizes?void 0:n.imageInfo.sizes.map(function(n){return[n.width,n.height]}),tileSize:void 0===n.imageInfo.tiles?void 0:[n.imageInfo.tiles.map(function(n){return n.width})[0],n.imageInfo.tiles.map(function(n){return void 0===n.height?n.width:n.height})[0]],resolutions:void 0===n.imageInfo.tiles?void 0:n.imageInfo.tiles.map(function(n){return n.scaleFactors})[0],supports:t.supports.concat(r),formats:t.formats.concat(u),qualities:t.qualities.concat(f)}};op[wi.VERSION3]=function(n){var t=n.getComplianceLevelSupportedFeatures(),i=void 0===n.imageInfo.extraFormats?t.formats:t.formats.concat(n.imageInfo.extraFormats),r=void 0!==n.imageInfo.preferredFormats&&Array.isArray(n.imageInfo.preferredFormats)&&n.imageInfo.preferredFormats.length>0?n.imageInfo.preferredFormats.filter(function(n){return["jpg","png","gif"].includes(n)}).reduce(function(n,t){return void 0===n&&i.includes(t)?t:n},void 0):void 0;return{url:n.imageInfo.id,sizes:void 0===n.imageInfo.sizes?void 0:n.imageInfo.sizes.map(function(n){return[n.width,n.height]}),tileSize:void 0===n.imageInfo.tiles?void 0:[n.imageInfo.tiles.map(function(n){return n.width})[0],n.imageInfo.tiles.map(function(n){return n.height})[0]],resolutions:void 0===n.imageInfo.tiles?void 0:n.imageInfo.tiles.map(function(n){return n.scaleFactors})[0],supports:void 0===n.imageInfo.extraFeatures?t.supports:t.supports.concat(n.imageInfo.extraFeatures),formats:i,qualities:void 0===n.imageInfo.extraQualities?t.qualities:t.qualities.concat(n.imageInfo.extraQualities),preferredFormat:r}};vst=function(){function n(n){this.setImageInfo(n)}return n.prototype.setImageInfo=function(n){this.imageInfo="string"==typeof n?JSON.parse(n):n},n.prototype.getImageApiVersion=function(){var n,t;if(void 0!==this.imageInfo){for(n=this.imageInfo["@context"]||"ol-no-context","string"==typeof n&&(n=[n]),t=0;t<n.length;t++)switch(n[t]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return wi.VERSION1;case"http://iiif.io/api/image/2/context.json":return wi.VERSION2;case"http://iiif.io/api/image/3/context.json":return wi.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(wi.VERSION1)&&this.imageInfo.identifier)return wi.VERSION1}p(!1,61)}},n.prototype.getComplianceLevelEntryFromProfile=function(n){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===n&&(n=this.getImageApiVersion()),n){case wi.VERSION1:if(cti.test(this.imageInfo.profile))return this.imageInfo.profile;break;case wi.VERSION3:if(lti.test(this.imageInfo.profile))return this.imageInfo.profile;break;case wi.VERSION2:if("string"==typeof this.imageInfo.profile&&ast.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&"string"==typeof this.imageInfo.profile[0]&&ast.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}},n.prototype.getComplianceLevelFromProfile=function(n){var i=this.getComplianceLevelEntryFromProfile(n),t;if(void 0!==i)return t=i.match(/level[0-2](\.json)?$/g),Array.isArray(t)?t[0].replace(".json",""):void 0},n.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var n=this.getImageApiVersion(),t=this.getComplianceLevelFromProfile(n);return void 0===t?ws.none.none:ws[n][t]}},n.prototype.getTileSourceOptions=function(n){var i=n||{},r=this.getImageApiVersion(),t;if(void 0!==r&&(t=void 0===r?void 0:op[r](this),void 0!==t))return{url:t.url,version:r,size:[this.imageInfo.width,this.imageInfo.height],sizes:t.sizes,format:void 0!==i.format&&t.formats.includes(i.format)?i.format:void 0!==t.preferredFormat?t.preferredFormat:"jpg",supports:t.supports,quality:i.quality&&t.qualities.includes(i.quality)?i.quality:t.qualities.includes("native")?"native":"default",resolutions:Array.isArray(t.resolutions)?t.resolutions.sort(function(n,t){return t-n}):void 0,tileSize:t.tileSize}},n}();yst=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var ati=function(n){function t(t){var nt=this,r=t||{},y=r.url||"",s,ut,b,d,g,ft;y+=y.lastIndexOf("/")===y.length-1||""===y?"":"/";var k=r.version||wi.VERSION2,l=r.sizes||[],a=r.size;p(null!=a&&Array.isArray(a)&&2==a.length&&!isNaN(a[0])&&a[0]>0&&!isNaN(a[1])&&a[1]>0,60);var e,o,v,u=a[0],h=a[1],i=r.tileSize,et=r.tilePixelRatio||1,ot=r.format||"jpg",st=r.quality||(r.version==wi.VERSION1?"native":"default"),c=r.resolutions||[],f=r.supports||[],tt=r.extent||[0,-h,u,0],it=null!=l&&Array.isArray(l)&&l.length>0,rt=null!=i&&("number"==typeof i&&Number.isInteger(i)&&i>0||Array.isArray(i)&&i.length>0),w=null!=f&&Array.isArray(f)&&(f.includes("regionByPx")||f.includes("regionByPct"))&&(f.includes("sizeByWh")||f.includes("sizeByH")||f.includes("sizeByW")||f.includes("sizeByPct"));if(c.sort(function(n,t){return t-n}),rt||w)if(null!=i&&("number"==typeof i&&Number.isInteger(i)&&i>0?(e=i,o=i):Array.isArray(i)&&i.length>0&&((1==i.length||null==i[1]&&Number.isInteger(i[0]))&&(e=i[0],o=i[0]),2==i.length&&(Number.isInteger(i[0])&&Number.isInteger(i[1])?(e=i[0],o=i[1]):null==i[0]&&Number.isInteger(i[1])&&(e=i[1],o=i[1])))),void 0!==e&&void 0!==o||(e=gh,o=gh),0==c.length)for(s=v=Math.max(Math.ceil(Math.log(u/e)/Math.LN2),Math.ceil(Math.log(h/o)/Math.LN2));s>=0;s--)c.push(Math.pow(2,s));else ut=Math.max.apply(Math,c),v=Math.round(Math.log(ut)/Math.LN2);else if(e=u,o=h,c=[],it){for(l.sort(function(n,t){return n[0]-t[0]}),v=-1,b=[],s=0;s<l.length;s++)d=u/l[s][0],c.length>0&&c[c.length-1]==d?b.push(s):(c.push(d),v++);if(b.length>0)for(s=0;s<b.length;s++)l.splice(b[s]-s,1)}else c.push(1),l.push([u,h]),v=0;return g=new ls({tileSize:[e,o],extent:tt,origin:yr(tt),resolutions:c}),ft=lst.bind(null,et,g),(nt=n.call(this,{attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,state:r.state,tileClass:ft,tileGrid:g,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:function(n){var a,i,g=n[0],d,et;if(!(g>v)){var nt=n[1],tt=n[2],t=c[g];if(!(void 0===nt||void 0===tt||void 0===t||nt<0||Math.ceil(u/t/e)<=nt||tt<0||Math.ceil(h/t/o)<=tt)){if(w||rt){var r=nt*e*t,s=tt*o*t,p=e*t,b=o*t,ut=e,ft=o;(r+p>u&&(p=u-r),s+b>h&&(b=h-s),r+e*t>u&&(ut=Math.floor((u-r+t-1)/t)),s+o*t>h&&(ft=Math.floor((h-s+t-1)/t)),0==r&&p==u&&0==s&&b==h)?a="full":!w||f.includes("regionByPx")?a=r+","+s+","+p+","+b:f.includes("regionByPct")&&(a="pct:"+ea(r/u*100)+","+ea(s/h*100)+","+ea(p/u*100)+","+ea(b/h*100));k!=wi.VERSION3||w&&!f.includes("sizeByWh")?!w||f.includes("sizeByW")?i=ut+",":f.includes("sizeByH")?i=","+ft:f.includes("sizeByWh")?i=ut+","+ft:f.includes("sizeByPct")&&(i="pct:"+ea(100/t)):i=ut+","+ft}else(a="full",it)?(d=l[g][0],et=l[g][1],i=k==wi.VERSION3?d==u&&et==h?"max":d+","+et:d==u?"full":d+","):i=k==wi.VERSION3?"max":"full";return y+a+"/"+i+"/0/"+st+"."+ot}}},transition:r.transition})||this).zDirection=r.zDirection,nt}return yst(t,n),t}(fe),vti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yti=function(n){function t(t,i,r,u,f,e){var o=this,h=t.getExtent(),c=i.getExtent(),l=c?vu(r,c):r,a=up(t,i,vr(l),u),v=new ust(t,i,l,h,a*got),s=e(v.calculateSourceExtent(),a,f),p=s?et.IDLE:et.EMPTY,y=s?s.getPixelRatio():1;return(o=n.call(this,r,u,y,p)||this).targetProj_=i,o.maxSourceExtent_=h,o.triangulation_=v,o.targetResolution_=u,o.targetExtent_=r,o.sourceImage_=s,o.sourcePixelRatio_=y,o.canvas_=null,o.sourceListenerKey_=null,o}return vti(t,n),t.prototype.disposeInternal=function(){this.state==et.LOADING&&this.unlistenSource_();n.prototype.disposeInternal.call(this)},t.prototype.getImage=function(){return this.canvas_},t.prototype.getProjection=function(){return this.targetProj_},t.prototype.reproject_=function(){var n=this.sourceImage_.getState(),t,i;n==et.LOADED&&(t=vt(this.targetExtent_)/this.targetResolution_,i=ni(this.targetExtent_)/this.targetResolution_,this.canvas_=rst(t,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0));this.state=n;this.changed()},t.prototype.load=function(){if(this.state==et.IDLE){this.state=et.LOADING;this.changed();var n=this.sourceImage_.getState();n==et.LOADED||n==et.ERROR?this.reproject_():(this.sourceListenerKey_=nt(this.sourceImage_,a.CHANGE,function(){var n=this.sourceImage_.getState();n!=et.LOADED&&n!=et.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},t.prototype.unlistenSource_=function(){ct(this.sourceListenerKey_);this.sourceListenerKey_=null},t}(hd),pst=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pti="imageloadstart",wti="imageloadend",bti="imageloaderror",bd=function(n){function t(t,i){var r=n.call(this,t)||this;return r.image=i,r}return pst(t,n),t}(ur);ee=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,projection:t.projection,state:t.state})||this;return i.resolutions_=void 0!==t.resolutions?t.resolutions:null,i.reprojectedImage_=null,i.reprojectedRevision_=0,i}return pst(t,n),t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.findNearestResolution=function(n){if(this.resolutions_){var t=rv(this.resolutions_,n,0);n=this.resolutions_[t]}return n},t.prototype.getImage=function(n,t,i,r){var u=this.getProjection();if(u&&r&&!pr(u,r)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&pr(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&uu(this.reprojectedImage_.getExtent(),n))return this.reprojectedImage_;this.reprojectedImage_.dispose();this.reprojectedImage_=null}return this.reprojectedImage_=new yti(u,r,n,t,i,function(n,t,i){return this.getImageInternal(n,t,i,u)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return u&&(r=u),this.getImageInternal(n,t,i,r)},t.prototype.getImageInternal=function(){return w()},t.prototype.handleImageChange=function(n){var t=n.target;switch(t.getState()){case et.LOADING:this.loading=!0;this.dispatchEvent(new bd(pti,t));break;case et.LOADED:this.loading=!1;this.dispatchEvent(new bd(wti,t));break;case et.ERROR:this.loading=!1;this.dispatchEvent(new bd(bti,t))}},t}(oc);var kti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dti=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,r.hidpi_=void 0===i.hidpi||i.hidpi,r.url_=i.url,r.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:sp,r.params_=i.params||{},r.image_=null,r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==i.ratio?i.ratio:1.5,r}return kti(t,n),t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(n,t,i,r){var u,s,e,o,h,c,y;if(void 0===this.url_)return null;if(t=this.findNearestResolution(t),i=this.hidpi_?i:1,u=this.image_,u&&this.renderedRevision_==this.getRevision()&&u.getResolution()==t&&u.getPixelRatio()==i&&tr(u.getExtent(),n))return u;s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};d(s,this.params_);e=((n=n.slice())[0]+n[2])/2;o=(n[1]+n[3])/2;1!=this.ratio_&&(h=this.ratio_*vt(n)/2,c=this.ratio_*ni(n)/2,n[0]=e-h,n[1]=o-c,n[2]=e+h,n[3]=o+c);var f=t/i,l=Math.ceil(vt(n)/f),v=Math.ceil(ni(n)/f);return n[0]=e-f*l/2,n[2]=e+f*l/2,n[1]=o-f*v/2,n[3]=o+f*v/2,this.imageSize_[0]=l,this.imageSize_[1]=v,y=this.getRequestUrl_(n,this.imageSize_,i,r,s),this.image_=new tp(n,t,i,y,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(a.CHANGE,this.handleImageChange.bind(this)),this.image_},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.getRequestUrl_=function(n,t,i,r,u){var o=r.getCode().split(":").pop(),f,e;return u.SIZE=t[0]+","+t[1],u.BBOX=n.join(","),u.BBOXSR=o,u.IMAGESR=o,u.DPI=Math.round(90*i),f=this.url_,e=f.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),e==f&&p(!1,50),oe(e,u)},t.prototype.getUrl=function(){return this.url_},t.prototype.setImageLoadFunction=function(n){this.image_=null;this.imageLoadFunction_=n;this.changed()},t.prototype.setUrl=function(n){n!=this.url_&&(this.url_=n,this.image_=null,this.changed())},t.prototype.updateParams=function(n){d(this.params_,n);this.image_=null;this.changed()},t}(ee),gti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kd=function(n){function t(t,i,r,u,f){var e=this,o=void 0!==f?et.IDLE:et.LOADED;return(e=n.call(this,t,i,r,o)||this).loader_=void 0!==f?f:null,e.canvas_=u,e.error_=null,e}return gti(t,n),t.prototype.getError=function(){return this.error_},t.prototype.handleLoad_=function(n){n?(this.error_=n,this.state=et.ERROR):this.state=et.LOADED;this.changed()},t.prototype.load=function(){this.state==et.IDLE&&(this.state=et.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},t.prototype.getImage=function(){return this.canvas_},t}(hd),nii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tii=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions,state:i.state})||this).canvasFunction_=i.canvasFunction,r.canvas_=null,r.renderedRevision_=0,r.ratio_=void 0!==i.ratio?i.ratio:1.5,r}return nii(t,n),t.prototype.getImageInternal=function(n,t,i,r){var u,e,f;return(t=this.findNearestResolution(t),u=this.canvas_,u&&this.renderedRevision_==this.getRevision()&&u.getResolution()==t&&u.getPixelRatio()==i&&tr(u.getExtent(),n))?u:(il(n=n.slice(),this.ratio_),e=[vt(n)/t*i,ni(n)/t*i],f=this.canvasFunction_.call(this,n,t,i,e,r),f&&(u=new kd(n,t,i,f)),this.canvas_=u,this.renderedRevision_=this.getRevision(),u)},t}(ee),iii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rii=function(n){function t(t){var i=n.call(this,{projection:t.projection,resolutions:t.resolutions})||this;return i.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,i.displayDpi_=void 0!==t.displayDpi?t.displayDpi:96,i.params_=t.params||{},i.url_=t.url,i.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:sp,i.hidpi_=void 0===t.hidpi||t.hidpi,i.metersPerUnit_=void 0!==t.metersPerUnit?t.metersPerUnit:1,i.ratio_=void 0!==t.ratio?t.ratio:1,i.useOverlay_=void 0!==t.useOverlay&&t.useOverlay,i.image_=null,i.renderedRevision_=0,i}return iii(t,n),t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(n,t,i,r){var u,f,e;return(t=this.findNearestResolution(t),i=this.hidpi_?i:1,u=this.image_,u&&this.renderedRevision_==this.getRevision()&&u.getResolution()==t&&u.getPixelRatio()==i&&tr(u.getExtent(),n))?u:(1!=this.ratio_&&il(n=n.slice(),this.ratio_),f=[vt(n)/t*i,ni(n)/t*i],void 0!==this.url_?(e=this.getUrl(this.url_,this.params_,n,f,r),(u=new tp(n,t,i,e,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(a.CHANGE,this.handleImageChange.bind(this))):u=null,this.image_=u,this.renderedRevision_=this.getRevision(),u)},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.updateParams=function(n){d(this.params_,n);this.changed()},t.prototype.getUrl=function(n,t,i,r){var e=function(n,t,i,r){var u=vt(n),f=ni(n),e=t[0],o=t[1],s=.0254/r;return o*u>e*f?u*i/(e*s):f*i/(o*s)}(i,r,this.metersPerUnit_,this.displayDpi_),u=vr(i),f={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:e,SETVIEWCENTERX:u[0],SETVIEWCENTERY:u[1]};return d(f,t),oe(n,f)},t.prototype.setImageLoadFunction=function(n){this.image_=null;this.imageLoadFunction_=n;this.changed()},t}(ee),uii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fii=function(n){function t(t){var i=this,r=void 0!==t.crossOrigin?t.crossOrigin:null,u=void 0!==t.imageLoadFunction?t.imageLoadFunction:sp;return(i=n.call(this,{attributions:t.attributions,projection:y(t.projection)})||this).url_=t.url,i.imageExtent_=t.imageExtent,i.image_=new tp(i.imageExtent_,void 0,1,i.url_,r,u),i.imageSize_=t.imageSize?t.imageSize:null,i.image_.addEventListener(a.CHANGE,i.handleImageChange.bind(i)),i}return uii(t,n),t.prototype.getImageExtent=function(){return this.imageExtent_},t.prototype.getImageInternal=function(n){return fi(n,this.image_.getExtent())?this.image_:null},t.prototype.getUrl=function(){return this.url_},t.prototype.handleImageChange=function(t){var h,e,o,u;if(this.image_.getState()==et.LOADED){var s=this.image_.getExtent(),f=this.image_.getImage(),r=void 0,i=void 0;this.imageSize_?(r=this.imageSize_[0],i=this.imageSize_[1]):(r=f.width,i=f.height);h=ni(s)/i;e=Math.ceil(vt(s)/h);e!=r&&(o=ci(e,i),u=o.canvas,o.drawImage(f,0,0,r,i,0,0,u.width,u.height),this.image_.setImage(u))}n.prototype.handleImageChange.call(this,t)},t}(ee),oo="1.3.0",wst="carmentaserver",bst="geoserver",kst="mapserver",dst="qgis",eii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gst=[101,101],oii=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,r.url_=i.url,r.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:sp,r.params_=i.params||{},r.v13_=!0,r.updateV13_(),r.serverType_=i.serverType,r.hidpi_=void 0===i.hidpi||i.hidpi,r.image_=null,r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==i.ratio?i.ratio:1.5,r}return eii(t,n),t.prototype.getFeatureInfoUrl=function(n,t,i,r){var f,u,o,e,s,h;if(void 0!==this.url_)return f=y(i),u=this.getProjection(),u&&u!==f&&(t=up(u,f,n,t),n=to(n,f,u)),o=tl(n,t,0,gst),e={SERVICE:"WMS",VERSION:oo,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS},d(e,this.params_,r),s=Math.floor((n[0]-o[0])/t),h=Math.floor((o[3]-n[1])/t),e[this.v13_?"I":"X"]=s,e[this.v13_?"J":"Y"]=h,this.getRequestUrl_(o,gst,1,u||f,e)},t.prototype.getLegendUrl=function(n,t){var i,r,u;if(void 0!==this.url_){if(i={SERVICE:"WMS",VERSION:oo,REQUEST:"GetLegendGraphic",FORMAT:"image/png"},void 0===t||void 0===t.LAYER){if(r=this.params_.LAYERS,!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}return void 0!==n&&(u=this.getProjection()?this.getProjection().getMetersPerUnit():1,i.SCALE=n*u*39.37*(25.4/.28)),d(i,t),oe(this.url_,i)}},t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(n,t,i,r){var o,h;if(void 0===this.url_)return null;t=this.findNearestResolution(t);1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);var u=t/i,s=vr(n),c=tl(s,u,0,[Math.ceil(vt(n)/u),Math.ceil(ni(n)/u)]),e=tl(s,u,0,[Math.ceil(this.ratio_*vt(n)/u),Math.ceil(this.ratio_*ni(n)/u)]),f=this.image_;return f&&this.renderedRevision_==this.getRevision()&&f.getResolution()==t&&f.getPixelRatio()==i&&tr(f.getExtent(),c)?f:(o={SERVICE:"WMS",VERSION:oo,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},d(o,this.params_),this.imageSize_[0]=Math.round(vt(e)/u),this.imageSize_[1]=Math.round(ni(e)/u),h=this.getRequestUrl_(e,this.imageSize_,i,r,o),this.image_=new tp(e,t,i,h,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(a.CHANGE,this.handleImageChange.bind(this)),this.image_)},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.getRequestUrl_=function(n,t,i,r,u){var f,e,o;if(p(void 0!==this.url_,9),u[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(u.STYLES=""),1!=i)switch(this.serverType_){case bst:f=90*i+.5|0;"FORMAT_OPTIONS"in u?u.FORMAT_OPTIONS+=";dpi:"+f:u.FORMAT_OPTIONS="dpi:"+f;break;case kst:u.MAP_RESOLUTION=90*i;break;case wst:case dst:u.DPI=90*i;break;default:p(!1,8)}return u.WIDTH=t[0],u.HEIGHT=t[1],o=r.getAxisOrientation(),e=this.v13_&&"ne"==o.substr(0,2)?[n[1],n[0],n[3],n[2]]:n,u.BBOX=e.join(","),oe(this.url_,u)},t.prototype.getUrl=function(){return this.url_},t.prototype.setImageLoadFunction=function(n){this.image_=null;this.imageLoadFunction_=n;this.changed()},t.prototype.setUrl=function(n){n!=this.url_&&(this.url_=n,this.image_=null,this.changed())},t.prototype.updateParams=function(n){d(this.params_,n);this.updateV13_();this.image_=null;this.changed()},t.prototype.updateV13_=function(){var n=this.params_.VERSION||oo;this.v13_=iut(n,"1.3")>=0},t}(ee),sii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dd='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap<\/a> contributors.',hii=function(n){function t(t){var r,i=t||{},u,f;return r=void 0!==i.attributions?i.attributions:[dd],u=void 0!==i.crossOrigin?i.crossOrigin:"anonymous",f=void 0!==i.url?i.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",n.call(this,{attributions:r,cacheSize:i.cacheSize,crossOrigin:u,opaque:void 0===i.opaque||i.opaque,maxZoom:void 0!==i.maxZoom?i.maxZoom:19,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileLoadFunction:i.tileLoadFunction,url:f,wrapX:i.wrapX,attributionsCollapsible:!1})||this}return sii(t,n),t}(ua),cii=i(3),lii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nht=function(n){function t(t){var i=t||{};return n.call(this,i)||this}return lii(t,n),t}(yl),aii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tht=function(n){function t(t){var i=n.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=t,i}return aii(t,n),t.prototype.getFeatures=function(){return w()},t.prototype.prepareFrame=function(){return w()},t.prototype.renderFrame=function(){return w()},t.prototype.loadedTileCallback=function(n,t,i){n[t]||(n[t]={});n[t][i.tileCoord.toString()]=i},t.prototype.createLoadedTileFinder=function(n,t,i){return function(r,u){var f=this.loadedTileCallback.bind(this,i,r);return n.forEachLoadedTile(t,r,u,f)}.bind(this)},t.prototype.forEachFeatureAtCoordinate=function(){},t.prototype.getDataAtPixel=function(){return w()},t.prototype.getLayer=function(){return this.layer_},t.prototype.handleFontsChanged=function(){},t.prototype.handleImageChange_=function(n){n.target.getState()===et.LOADED&&this.renderIfReadyAndVisible()},t.prototype.loadImage=function(n){var t=n.getState();return t!=et.LOADED&&t!=et.ERROR&&n.addEventListener(a.CHANGE,this.boundHandleImageChange_),t==et.IDLE&&(n.load(),t=n.getState()),t==et.LOADED},t.prototype.renderIfReadyAndVisible=function(){var n=this.getLayer();n.getVisible()&&n.getSourceState()==li.READY&&n.changed()},t}(cw),vii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gd=function(n){function t(t){var i=n.call(this,t)||this;return i.container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i.createTransformStringCanvas_=ci(1,1).canvas,i}return vii(t,n),t.prototype.useContainer=function(n,t){var f,r,e=this.getLayer().getClassName(),i,u;n&&""===n.style.opacity&&n.className===e&&(u=n.firstElementChild)instanceof HTMLCanvasElement&&(r=u.getContext("2d"));(r&&r.canvas.style.transform===t?(this.container=n,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),this.container)||((f=document.createElement("div")).className=e,i=f.style,i.position="absolute",i.width="100%",i.height="100%",u=(r=ci()).canvas,f.appendChild(u),(i=u.style).position="absolute",i.left="0",i.transformOrigin="top left",this.container=f,this.context=r)},t.prototype.clip=function(n,t,i){var r=t.pixelRatio,s=t.size[0]*r/2,h=t.size[1]*r/2,c=t.viewState.rotation,u=yr(i),f=de(i),e=ke(i),o=ne(i);bt(t.coordinateToPixelTransform,u);bt(t.coordinateToPixelTransform,f);bt(t.coordinateToPixelTransform,e);bt(t.coordinateToPixelTransform,o);n.save();het(n,-c,s,h);n.beginPath();n.moveTo(u[0]*r,u[1]*r);n.lineTo(f[0]*r,f[1]*r);n.lineTo(e[0]*r,e[1]*r);n.lineTo(o[0]*r,o[1]*r);n.clip();het(n,c,s,h)},t.prototype.clipUnrotated=function(n,t,i){var u=yr(i),f=de(i),e=ke(i),o=ne(i),r;bt(t.coordinateToPixelTransform,u);bt(t.coordinateToPixelTransform,f);bt(t.coordinateToPixelTransform,e);bt(t.coordinateToPixelTransform,o);r=this.inversePixelTransform;bt(r,u);bt(r,f);bt(r,e);bt(r,o);n.save();n.beginPath();n.moveTo(Math.round(u[0]),Math.round(u[1]));n.lineTo(Math.round(f[0]),Math.round(f[1]));n.lineTo(Math.round(e[0]),Math.round(e[1]));n.lineTo(Math.round(o[0]),Math.round(o[1]));n.clip()},t.prototype.dispatchRenderEvent_=function(n,t,i){var r=this.getLayer(),u;r.hasListener(n)&&(u=new bft(n,this.inversePixelTransform,i,t),r.dispatchEvent(u))},t.prototype.preRender=function(n,t){this.dispatchRenderEvent_(tkt,n,t)},t.prototype.postRender=function(n,t){this.dispatchRenderEvent_(ikt,n,t)},t.prototype.getRenderTransform=function(n,t,i,r,u,f,e){var s=u/2,h=f/2,o=r/t,c=-o,l=-n[0]+e,a=-n[1];return wr(this.tempTransform_,s,h,o,c,-i,l,a)},t.prototype.getDataAtPixel=function(n){var t,i=bt(this.inversePixelTransform,n.slice()),r=this.context;try{t=r.getImageData(Math.round(i[0]),Math.round(i[1]),1,1).data}catch(n){return"SecurityError"===n.name?new Uint8Array:t}return 0===t[3]?null:t},t.prototype.createTransformString=function(n){return this.createTransformStringCanvas_.style.transform=kit(n),this.createTransformStringCanvas_.style.transform},t}(tht),yii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ng=function(n){function t(t){var i=n.call(this,t)||this;return i.image_=null,i}return yii(t,n),t.prototype.getImage=function(){return this.image_?this.image_.getImage():null},t.prototype.prepareFrame=function(n){var u=n.layerStatesArray[n.layerIndex],o=n.pixelRatio,r=n.viewState,s=r.resolution,h=this.getLayer().getSource(),f=n.viewHints,t=n.extent,e,i;return(void 0!==u.extent&&(t=vu(t,uf(u.extent,r.projection))),f[lr]||f[fu]||ts(t))||(e=r.projection,i=h.getImage(t,s,o,e),i&&this.loadImage(i)&&(this.image_=i)),!!this.image_},t.prototype.renderFrame=function(n,t){var h=this.image_,g=h.getExtent(),c=h.getResolution(),l=h.getPixelRatio(),a=n.layerStatesArray[n.layerIndex],e=n.pixelRatio,v=n.viewState,nt=v.center,et=v.resolution,tt=n.size,it=e*c/(et*l),i=Math.round(tt[0]*e),r=Math.round(tt[1]*e),rt=v.rotation,b,y,u,f,k,p,o,s,w,d;rt&&(b=Math.round(Math.sqrt(i*i+r*r)),i=b,r=b);wr(this.pixelTransform,n.size[0]/2,n.size[1]/2,1/e,1/e,rt,-i/2,-r/2);ll(this.inversePixelTransform,this.pixelTransform);y=this.createTransformString(this.pixelTransform);this.useContainer(t,y,a.opacity);u=this.context;f=u.canvas;f.width!=i||f.height!=r?(f.width=i,f.height=r):this.containerReused||u.clearRect(0,0,i,r);k=!1;a.extent&&(p=uf(a.extent,v.projection),(k=!tr(p,n.extent)&&fi(p,n.extent))&&this.clipUnrotated(u,n,p));o=h.getImage();s=wr(this.tempTransform_,i/2,r/2,it,it,0,l*(g[0]-nt[0])/c,l*(nt[1]-g[3])/c);this.renderedResolution=c*e/l;var ot=s[4],st=s[5],ut=o.width*s[0],ft=o.height*s[3];return(this.preRender(u,n),ut>=.5&&ft>=.5)&&(w=a.opacity,d=void 0,1!==w&&(d=this.context.globalAlpha,this.context.globalAlpha=w),this.context.drawImage(o,0,0,+o.width,+o.height,Math.round(ot),Math.round(st),Math.round(ut),Math.round(ft)),1!==w&&(this.context.globalAlpha=d)),this.postRender(u,n),k&&u.restore(),y!==f.style.transform&&(f.style.transform=y),this.container},t}(gd),pii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iht=function(n){function t(t){return n.call(this,t)||this}return pii(t,n),t.prototype.createRenderer=function(){return new ng(this)},t}(nht),hp="preload",cp="useInterimTilesOnError",wii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rht=function(n){function t(t){var r=this,i=t||{},u=d({},i);return delete u.preload,delete u.useInterimTilesOnError,(r=n.call(this,u)||this).setPreload(void 0!==i.preload?i.preload:0),r.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),r}return wii(t,n),t.prototype.getPreload=function(){return this.get(hp)},t.prototype.setPreload=function(n){this.set(hp,n)},t.prototype.getUseInterimTilesOnError=function(){return this.get(cp)},t.prototype.setUseInterimTilesOnError=function(n){this.set(cp,n)},t}(yl),bii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uht=function(n){function t(t){var i=n.call(this,t)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.tmpTileRange_=new nd(0,0,0,0),i}return bii(t,n),t.prototype.isDrawableTile=function(n){var i=this.getLayer(),t=n.getState(),r=i.getUseInterimTilesOnError();return t==c.LOADED||t==c.EMPTY||t==c.ERROR&&!r},t.prototype.getTile=function(n,t,i,r){var e=r.pixelRatio,o=r.viewState.projection,f=this.getLayer(),u=f.getSource().getTile(n,t,i,e,o);return u.getState()==c.ERROR&&(f.getUseInterimTilesOnError()?f.getPreload()>0&&(this.newTiles_=!0):u.setState(c.LOADED)),this.isDrawableTile(u)||(u=u.getInterimTile()),u},t.prototype.loadedTileCallback=function(t,i,r){return!!this.isDrawableTile(r)&&n.prototype.loadedTileCallback.call(this,t,i,r)},t.prototype.prepareFrame=function(){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(n,t){var k=n.layerStatesArray[n.layerIndex],et=n.viewState,w=et.projection,ri=et.resolution,ot=et.center,ui=et.rotation,st=n.pixelRatio,fi=this.getLayer(),u=fi.getSource(),rr=u.getRevision(),l=u.getTileGridForProjection(w),a=l.getZForResolution(ri,u.zDirection),d=l.getResolution(a),ht=n.extent,wt=k.extent&&uf(k.extent,w),kt,f,e,r,dt,lt,gt,ni,ut,at,i,g,nt,ti,h,tt,vt,ki,ft,ir,p;wt&&(ht=vu(ht,uf(k.extent,w)));var y=u.getTilePixelRatio(st),o=Math.round(n.size[0]*y),s=Math.round(n.size[1]*y);ui&&(kt=Math.round(Math.sqrt(o*o+s*s)),o=kt,s=kt);var ei=d*o/2/y,oi=d*s/2/y,it=[ot[0]-ei,ot[1]-oi,ot[0]+ei,ot[1]+oi],ct=l.getTileRangeForExtentAndZ(ht,a),rt={};rt[a]={};var si=this.createLoadedTileFinder(u,w,rt),hi=this.tmpExtent,ci=this.tmpTileRange_;for(this.newTiles_=!1,f=ct.minX;f<=ct.maxX;++f)for(e=ct.minY;e<=ct.maxY;++e)(r=this.getTile(a,f,e,n),this.isDrawableTile(r)&&(dt=v(this),r.getState()==c.LOADED&&(rt[a][r.tileCoord.toString()]=r,lt=r.inTransition(dt),this.newTiles_||!lt&&-1!==this.renderedTiles.indexOf(r)||(this.newTiles_=!0)),1===r.getAlpha(dt,n.time)))||(gt=l.getTileCoordChildTileRange(r.tileCoord,ci,hi),ni=!1,gt&&(ni=si(a+1,gt)),ni||l.forEachTileCoordParentTileRange(r.tileCoord,si,ci,hi));for(ut=d/ri,wr(this.pixelTransform,n.size[0]/2,n.size[1]/2,1/y,1/y,ui,-o/2,-s/2),at=this.createTransformString(this.pixelTransform),this.useContainer(t,at,k.opacity),i=this.context,g=i.canvas,ll(this.inversePixelTransform,this.pixelTransform),wr(this.tempTransform_,o/2,s/2,ut,ut,0,-o/2,-s/2),g.width!=o||g.height!=s?(g.width=o,g.height=s):this.containerReused||i.clearRect(0,0,o,s),wt&&this.clipUnrotated(i,n,wt),this.preRender(i,n),this.renderedTiles.length=0,tt=Object.keys(rt).map(Number),tt.sort(we),1!==k.opacity||this.containerReused&&!u.getOpaque(n.viewState.projection)?(nt=[],ti=[]):tt=tt.reverse(),vt=tt.length-1;vt>=0;--vt){var b=tt[vt],li=u.getTilePixelSize(b,st,w),ai=l.getResolution(b)/d,vi=li[0]*ai*ut,yi=li[1]*ai*ut,ii=l.getTileCoordForCoordAndZ(yr(it),b),pi=l.getTileCoordExtent(ii),wi=bt(this.tempTransform_,[y*(pi[0]-it[0])/d,y*(it[3]-pi[3])/d]),ur=y*u.getGutterForProjection(w),bi=rt[b];for(ki in bi){var di=(r=bi[ki]).tileCoord,gi=wi[0]-(ii[1]-di[1])*vi,fr=Math.round(gi+vi),nr=wi[1]-(ii[2]-di[2])*yi,er=Math.round(nr+yi),yt=fr-(f=Math.round(gi)),pt=er-(e=Math.round(nr)),tr=a===b;if(!(lt=tr&&1!==r.getAlpha(v(this),n.time)))if(nt){for(i.save(),h=[f,e,f+yt,e,f+yt,e+pt,f,e+pt],ft=0,ir=nt.length;ft<ir;++ft)a!==b&&b<ti[ft]&&(p=nt[ft],i.beginPath(),i.moveTo(h[0],h[1]),i.lineTo(h[2],h[3]),i.lineTo(h[4],h[5]),i.lineTo(h[6],h[7]),i.moveTo(p[6],p[7]),i.lineTo(p[4],p[5]),i.lineTo(p[2],p[3]),i.lineTo(p[0],p[1]),i.clip());nt.push(h);ti.push(b)}else i.clearRect(f,e,yt,pt);this.drawTileImage(r,n,f,e,yt,pt,ur,tr,k.opacity);nt&&!lt&&i.restore();this.renderedTiles.push(r);this.updateUsedTiles(n.usedTiles,u,r)}}return this.renderedRevision=rr,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!uu(this.renderedExtent_,it),this.renderedExtent_=it,this.renderedPixelRatio=st,this.renderedProjection=w,this.manageTilePyramid(n,u,l,st,w,ht,a,fi.getPreload()),this.updateCacheSize_(n,u),this.scheduleExpireCache(n,u),this.postRender(i,n),k.extent&&i.restore(),at!==g.style.transform&&(g.style.transform=at),this.container},t.prototype.drawTileImage=function(n,t,i,r,u,f,e,o,s){var h=this.getTileImage(n);if(h){var c=v(this),l=o?n.getAlpha(c,t.time):1,a=s*l,y=a!==this.context.globalAlpha;y&&(this.context.save(),this.context.globalAlpha=a);this.context.drawImage(h,e,e,h.width-2*e,h.height-2*e,i,r,u,f);y&&this.context.restore();1!==l?t.animate=!0:o&&n.endTransition(c)}},t.prototype.getImage=function(){var n=this.context;return n?n.canvas:null},t.prototype.getTileImage=function(n){return n.getImage()},t.prototype.scheduleExpireCache=function(n,t){if(t.canExpireCache()){var i=function(n,t,i){var r=v(n);r in i.usedTiles&&n.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,t);n.postRenderFunctions.push(i)}},t.prototype.updateUsedTiles=function(n,t,i){var r=v(t);r in n||(n[r]={});n[r][i.getKey()]=!0},t.prototype.updateCacheSize_=function(n,t){var i=v(t),r=0,u;i in n.usedTiles&&(r+=Object.keys(n.usedTiles[i]).length);i in n.wantedTiles&&(r+=Object.keys(n.wantedTiles[i]).length);u=t.tileCache;u.highWaterMark<r&&(u.highWaterMark=r)},t.prototype.manageTilePyramid=function(n,t,i,r,u,f,e,o,s){var w=v(t),l,a,k,y,p,h,d,b;for((w in n.wantedTiles)||(n.wantedTiles[w]={}),d=n.wantedTiles[w],b=n.tileQueue,h=i.getMinZoom();h<=e;++h)for(a=i.getTileRangeForExtentAndZ(f,h,a),k=i.getResolution(h),y=a.minX;y<=a.maxX;++y)for(p=a.minY;p<=a.maxY;++p)e-h<=o?((l=t.getTile(h,y,p,r,u)).getState()==c.IDLE&&(d[l.getKey()]=!0,b.isKeyQueued(l.getKey())||b.enqueue([l,w,i.getTileCoordCenter(l.tileCoord),k])),void 0!==s&&s(l)):t.useTile(h,y,p,u)},t}(gd);uht.prototype.getLayer;var tg=uht,kii=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fht=function(n){function t(t){return n.call(this,t)||this}return kii(t,n),t.prototype.createRenderer=function(){return new tg(this)},t}(rht),eht=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dii="beforeoperations",gii="afteroperations",oht={PIXEL:"pixel",IMAGE:"image"},sht=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.extent=i.extent,u.resolution=i.viewState.resolution/i.pixelRatio,u.data=r,u}return eht(t,n),t}(ur),nri=function(n){function t(t){var i=n.call(this,{projection:null})||this;i.worker_=null;i.operationType_=void 0!==t.operationType?t.operationType:oht.PIXEL;i.threads_=void 0!==t.threads?t.threads:1;i.layers_=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;++t)r[t]=iri(n[t]);return r}(t.sources);for(var u,f=i.changed.bind(i),r=0,e=i.layers_.length;r<e;++r)i.layers_[r].addEventListener(a.CHANGE,f);return i.tileQueue_=new drt(function(){return 1},i.changed.bind(i)),i.requestedFrameState_,i.renderedImageCanvas_=null,i.renderedRevision_,i.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],extent:null,index:0,layerIndex:0,layerStatesArray:(u=i.layers_,u.map(function(n){return n.getLayerState()})),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:i.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},i.setAttributions(function(n){for(var r,f,e,i=[],u=0,o=t.sources.length;u<o;++u)r=t.sources[u],f=(r instanceof oc?r:r.getSource()).getAttributions(),"function"==typeof f&&(e=f(n),i.push.apply(i,e));return 0!==i.length?i:null}),void 0!==t.operation&&i.setOperation(t.operation,t.lib),i}return eht(t,n),t.prototype.setOperation=function(n,t){this.worker_=new cii.Processor({operation:n,imageOps:this.operationType_===oht.IMAGE,queue:1,lib:t,threads:this.threads_});this.changed()},t.prototype.updateFrameState_=function(n,t,i){var r=d({},this.frameState_),f,u;return r.viewState=d({},r.viewState),f=vr(n),r.extent=n.slice(),r.size[0]=Math.round(vt(n)/t),r.size[1]=Math.round(ni(n)/t),r.time=1/0,u=r.viewState,u.center=f,u.projection=i,u.resolution=t,r},t.prototype.allSourcesReady_=function(){for(var t=!0,n=0,i=this.layers_.length;n<i;++n)if(this.layers_[n].getSource().getState()!==li.READY){t=!1;break}return t},t.prototype.getImage=function(n,t,i,r){var u,f,e;return this.allSourcesReady_()?(u=this.updateFrameState_(n,t,r),(this.requestedFrameState_=u,this.renderedImageCanvas_)&&(f=this.renderedImageCanvas_.getResolution(),e=this.renderedImageCanvas_.getExtent(),t===f&&uu(n,e)||(this.renderedImageCanvas_=null)),this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),u.tileQueue.loadMoreTiles(16,16),u.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_):null},t.prototype.processSources_=function(){for(var i,r,t=this.requestedFrameState_,u=this.layers_.length,f=new Array(u),n=0;n<u;++n){if(t.layerIndex=n,i=tri(this.layers_[n],t),!i)return;f[n]=i}r={};this.dispatchEvent(new sht(dii,t,r));this.worker_.process(f,r,this.onWorkerComplete_.bind(this,t))},t.prototype.onWorkerComplete_=function(n,t,i,r){var u,f,e;!t&&i&&(u=n.extent,f=n.viewState.resolution,f===this.requestedFrameState_.viewState.resolution&&uu(u,this.requestedFrameState_.extent)&&(this.renderedImageCanvas_?e=this.renderedImageCanvas_.getImage().getContext("2d"):(e=ci(Math.round(vt(u)/f),Math.round(ni(u)/f)),this.renderedImageCanvas_=new kd(u,f,1,e.canvas)),e.putImageData(i,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new sht(gii,n,r))))},t.prototype.getImageInternal=function(){return null},t}(ee),bs=null;var rri=nri,uri=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fri=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design<\/a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0<\/a>.',dd],eri={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},ori={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},sri=function(n){function t(t){var i=t.layer.indexOf("-"),f=-1==i?t.layer:t.layer.slice(0,i),r=ori[f],u=eri[t.layer],e=void 0!==t.url?t.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+t.layer+"/{z}/{x}/{y}."+u.extension;return n.call(this,{attributions:fri,cacheSize:t.cacheSize,crossOrigin:"anonymous",maxZoom:null!=t.maxZoom?t.maxZoom:r.maxZoom,minZoom:null!=t.minZoom?t.minZoom:r.minZoom,opaque:u.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:e,wrapX:t.wrapX})||this}return uri(t,n),t}(ua),hri=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var lri=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:cri,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).params_=i.params||{},r.hidpi_=void 0===i.hidpi||i.hidpi,r.tmpExtent_=[1/0,1/0,-1/0,-1/0],r.setKey(r.getKeyForParams_()),r}return hri(t,n),t.prototype.getKeyForParams_=function(){var i=0,n=[];for(var t in this.params_)n[i++]=t+"-"+this.params_[t];return n.join("/")},t.prototype.getParams=function(){return this.params_},t.prototype.getRequestUrl_=function(n,t,i,r,u,f){var e=this.urls,s,o;if(e)return o=u.getCode().split(":").pop(),s=(f.SIZE=t[0]+","+t[1],f.BBOX=i.join(","),f.BBOXSR=o,f.IMAGESR=o,f.DPI=Math.round(f.DPI?f.DPI*r:90*r),1==e.length)?e[0]:e[pu(id(n),e.length)],oe(s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),f)},t.prototype.getTilePixelRatio=function(n){return this.hidpi_?n:1},t.prototype.updateParams=function(n){d(this.params_,n);this.setKey(this.getKeyForParams_())},t}(fe),hht=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ari=function(n){function t(t,i,r){var u=n.call(this,t,c.LOADED)||this;return u.tileSize_=i,u.text_=r,u.canvas_=null,u}return hht(t,n),t.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var t=this.tileSize_,n=ci(t[0],t[1]);return n.strokeStyle="grey",n.strokeRect(.5,.5,t[0]+.5,t[1]+.5),n.fillStyle="grey",n.strokeStyle="white",n.textAlign="center",n.textBaseline="middle",n.font="24px sans-serif",n.lineWidth=4,n.strokeText(this.text_,t[0]/2,t[1]/2,t[0]),n.fillText(this.text_,t[0]/2,t[1]/2,t[0]),this.canvas_=n.canvas,n.canvas},t.prototype.load=function(){},t}(ec),vri=function(n){function t(t){var i=t||{};return n.call(this,{opaque:!1,projection:i.projection,tileGrid:i.tileGrid,wrapX:void 0===i.wrapX||i.wrapX,zDirection:i.zDirection})||this}return hht(t,n),t.prototype.getTile=function(n,t,i){var u=fo(n,t,i),f;if(this.tileCache.containsKey(u))return this.tileCache.get(u);var s=hr(this.tileGrid.getTileSize(n)),e=[n,t,i],r=this.getTileCoordForTileUrlFunction(e),o=void 0;return o=r?"z:"+r[0]+" x:"+r[1]+" y:"+r[2]:"none",f=new ari(e,s,o),this.tileCache.set(u,f),f},t}(ua),yri=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pri=function(n){function t(t){var i=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:y("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:li.LOADING,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this,r;return(i.tileJSON_=null,i.tileSize_=t.tileSize,t.url)?t.jsonp?rp(t.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i)):(r=new XMLHttpRequest,r.addEventListener("load",i.onXHRLoad_.bind(i)),r.addEventListener("error",i.onXHRError_.bind(i)),r.open("GET",t.url),r.send()):t.tileJSON?i.handleTileJSONResponse(t.tileJSON):p(!1,51),i}return yri(t,n),t.prototype.onXHRLoad_=function(n){var t=n.target,i;if(!t.status||t.status>=200&&t.status<300){i=void 0;try{i=JSON.parse(t.responseText)}catch(n){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},t.prototype.onXHRError_=function(){this.handleTileJSONError()},t.prototype.getTileJSON=function(){return this.tileJSON_},t.prototype.handleTileJSONResponse=function(n){var t,i=y("EPSG:4326"),r=this.getProjection(),u,e;void 0!==n.bounds&&(u=wu(i,r),t=rl(n.bounds,u));var o=n.minzoom||0,s=n.maxzoom||22,f=rc({extent:as(r),maxZoom:s,minZoom:o,tileSize:this.tileSize_});(this.tileGrid=f,this.tileUrlFunction=ad(n.tiles,f),void 0===n.attribution||this.getAttributions())||(e=void 0!==t?t:i.getExtent(),this.setAttributions(function(t){return fi(e,t.extent)?[n.attribution]:null}));this.tileJSON_=n;this.setState(li.READY)},t.prototype.handleTileJSONError=function(){this.setState(li.ERROR)},t}(fe),wri=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var kri=function(n){function t(t){var r=this,i=t||{},u=i.params||{},f=!("TRANSPARENT"in u)||u.TRANSPARENT;return(r=n.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:!f,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:i.tileClass,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:bri,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).gutter_=void 0!==i.gutter?i.gutter:0,r.params_=u,r.v13_=!0,r.serverType_=i.serverType,r.hidpi_=void 0===i.hidpi||i.hidpi,r.tmpExtent_=[1/0,1/0,-1/0,-1/0],r.updateV13_(),r.setKey(r.getKeyForParams_()),r}return wri(t,n),t.prototype.getFeatureInfoUrl=function(n,t,i,r){var e=y(i),o=this.getProjection(),u=this.getTileGrid(),v,s,c,p,w;if(u||(u=this.getTileGridForProjection(e)),v=u.getZForResolution(t,this.zDirection),s=u.getTileCoordForCoordAndZ(n,v),!(u.getResolutions().length<=s[0])){var h=u.getResolution(s[0]),f=u.getTileCoordExtent(s,this.tmpExtent_),l=hr(u.getTileSize(s[0]),this.tmpSize),a=this.gutter_;return 0!==a&&(l=cut(l,a,this.tmpSize),f=iu(f,h*a,f)),o&&o!==e&&(h=up(o,e,n,h),f=io(f,e,o),n=to(n,e,o)),c={SERVICE:"WMS",VERSION:oo,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS},d(c,this.params_,r),p=Math.floor((n[0]-f[0])/h),w=Math.floor((f[3]-n[1])/h),c[this.v13_?"I":"X"]=p,c[this.v13_?"J":"Y"]=w,this.getRequestUrl_(s,l,f,1,o||e,c)}},t.prototype.getLegendUrl=function(n,t){var i,r,u;if(void 0!==this.urls[0]){if(i={SERVICE:"WMS",VERSION:oo,REQUEST:"GetLegendGraphic",FORMAT:"image/png"},void 0===t||void 0===t.LAYER){if(r=this.params_.LAYERS,!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}return void 0!==n&&(u=this.getProjection()?this.getProjection().getMetersPerUnit():1,i.SCALE=n*u*39.37*(25.4/.28)),d(i,t),oe(this.urls[0],i)}},t.prototype.getGutter=function(){return this.gutter_},t.prototype.getParams=function(){return this.params_},t.prototype.getRequestUrl_=function(n,t,i,r,u,f){var o=this.urls,h,c,l,e,s;if(o){if(f.WIDTH=t[0],f.HEIGHT=t[1],f[this.v13_?"CRS":"SRS"]=u.getCode(),"STYLES"in this.params_||(f.STYLES=""),1!=r)switch(this.serverType_){case bst:h=90*r+.5|0;"FORMAT_OPTIONS"in f?f.FORMAT_OPTIONS+=";dpi:"+h:f.FORMAT_OPTIONS="dpi:"+h;break;case kst:f.MAP_RESOLUTION=90*r;break;case wst:case dst:f.DPI=90*r;break;default:p(!1,52)}return l=u.getAxisOrientation(),e=i,this.v13_&&"ne"==l.substr(0,2)&&(s=void 0,s=i[0],e[0]=i[1],e[1]=s,s=i[2],e[2]=i[3],e[3]=s),c=(f.BBOX=e.join(","),1==o.length)?o[0]:o[pu(id(n),o.length)],oe(c,f)}},t.prototype.getTilePixelRatio=function(n){return this.hidpi_&&void 0!==this.serverType_?n:1},t.prototype.getKeyForParams_=function(){var i=0,n=[];for(var t in this.params_)n[i++]=t+"-"+this.params_[t];return n.join("/")},t.prototype.updateParams=function(n){d(this.params_,n);this.updateV13_();this.setKey(this.getKeyForParams_())},t.prototype.updateV13_=function(){var n=this.params_.VERSION||oo;this.v13_=iut(n,"1.3")>=0},t}(fe),cht=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dri=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i)||this;return o.src_=r,o.extent_=u,o.preemptive_=f,o.grid_=null,o.keys_=null,o.data_=null,o.jsonp_=e,o}return cht(t,n),t.prototype.getImage=function(){return null},t.prototype.getData=function(n){var t,u,i;if(!this.grid_||!this.keys_)return null;var f=(n[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),e=(n[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-e)*this.grid_.length)];return"string"!=typeof r?null:(t=r.charCodeAt(Math.floor(f*r.length)),t>=93&&t--,t>=35&&t--,u=null,(t-=32)in this.keys_&&(i=this.keys_[t],u=this.data_&&i in this.data_?this.data_[i]:i),u)},t.prototype.forDataAtCoordinate=function(n,t,i){this.state==c.IDLE&&!0===i?(fh(this,a.CHANGE,function(){t(this.getData(n))},this),this.loadInternal_()):!0===i?setTimeout(function(){t(this.getData(n))}.bind(this),0):t(this.getData(n))},t.prototype.getKey=function(){return this.src_},t.prototype.handleError_=function(){this.state=c.ERROR;this.changed()},t.prototype.handleLoad_=function(n){this.grid_=n.grid;this.keys_=n.keys;this.data_=n.data;this.state=c.EMPTY;this.changed()},t.prototype.loadInternal_=function(){if(this.state==c.IDLE)if(this.state=c.LOADING,this.jsonp_)rp(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var n=new XMLHttpRequest;n.addEventListener("load",this.onXHRLoad_.bind(this));n.addEventListener("error",this.onXHRError_.bind(this));n.open("GET",this.src_);n.send()}},t.prototype.onXHRLoad_=function(n){var t=n.target,i;if(!t.status||t.status>=200&&t.status<300){i=void 0;try{i=JSON.parse(t.responseText)}catch(n){return void this.handleError_()}this.handleLoad_(i)}else this.handleError_()},t.prototype.onXHRError_=function(){this.handleError_()},t.prototype.load=function(){this.preemptive_&&this.loadInternal_()},t}(ec),gri=function(n){function t(t){var i=n.call(this,{projection:y("EPSG:3857"),state:li.LOADING})||this,r;return(i.preemptive_=void 0===t.preemptive||t.preemptive,i.tileUrlFunction_=vd,i.template_=void 0,i.jsonp_=t.jsonp||!1,t.url)?i.jsonp_?rp(t.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i)):(r=new XMLHttpRequest,r.addEventListener("load",i.onXHRLoad_.bind(i)),r.addEventListener("error",i.onXHRError_.bind(i)),r.open("GET",t.url),r.send()):t.tileJSON?i.handleTileJSONResponse(t.tileJSON):p(!1,51),i}return cht(t,n),t.prototype.onXHRLoad_=function(n){var t=n.target,i;if(!t.status||t.status>=200&&t.status<300){i=void 0;try{i=JSON.parse(t.responseText)}catch(n){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},t.prototype.onXHRError_=function(){this.handleTileJSONError()},t.prototype.getTemplate=function(){return this.template_},t.prototype.forDataAtCoordinateAndResolution=function(n,t,i,r){if(this.tileGrid){var f=this.tileGrid.getZForResolution(t,this.zDirection),u=this.tileGrid.getTileCoordForCoordAndZ(n,f);this.getTile(u[0],u[1],u[2],1,this.getProjection()).forDataAtCoordinate(n,i,r)}else!0===r?setTimeout(function(){i(null)},0):i(null)},t.prototype.handleTileJSONError=function(){this.setState(li.ERROR)},t.prototype.handleTileJSONResponse=function(n){var t,r=y("EPSG:4326"),u=this.getProjection(),f,i,o;void 0!==n.bounds&&(f=wu(r,u),t=rl(n.bounds,f));var s=n.minzoom||0,h=n.maxzoom||22,e=rc({extent:as(u),maxZoom:h,minZoom:s});this.tileGrid=e;this.template_=n.template;i=n.grids;i?((this.tileUrlFunction_=ad(i,e),void 0!==n.attribution)&&(o=void 0!==t?t:r.getExtent(),this.setAttributions(function(t){return fi(o,t.extent)?[n.attribution]:null})),this.setState(li.READY)):this.setState(li.ERROR)},t.prototype.getTile=function(n,t,i,r,u){var f=fo(n,t,i);if(this.tileCache.containsKey(f))return this.tileCache.get(f);var e=[n,t,i],h=this.getTileCoordForTileUrlFunction(e,u),o=this.tileUrlFunction_(h,r,u),s=new dri(e,void 0!==o?c.IDLE:c.EMPTY,void 0!==o?o:"",this.tileGrid.getTileCoordExtent(e),this.preemptive_,this.jsonp_);return this.tileCache.set(f,s),s},t.prototype.useTile=function(n,t,i){var r=fo(n,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},t}(fp),nui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tui=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i,{transition:0})||this;return o.context_={},o.executorGroups={},o.loadingSourceTiles=0,o.errorSourceTileKeys={},o.hitDetectionImageData=null,o.replayState_={},o.wantedResolution,o.getSourceTiles=f.bind(o,o),o.removeSourceTiles_=e,o.sourceTileGrid_=u,o.sourceTileListenerKeys=[],o.sourceZ=-1,o.hifi=!1,o.wrappedTileCoord=r,o}return nui(t,n),t.prototype.disposeInternal=function(){var i;for(var t in this.sourceTileListenerKeys.forEach(ct),this.sourceTileListenerKeys.length=0,this.removeSourceTiles_(this),this.context_)i=this.context_[t].canvas,i.width=0,i.height=0;for(t in this.executorGroups)for(var u=this.executorGroups[t],r=0,f=u.length;r<f;++r)u[r].disposeInternal();n.prototype.disposeInternal.call(this)},t.prototype.getContext=function(n){var t=v(n);return t in this.context_||(this.context_[t]=ci()),this.context_[t]},t.prototype.hasContext=function(n){return v(n)in this.context_},t.prototype.getImage=function(n){return this.hasContext(n)?this.getContext(n).canvas:null},t.prototype.getReplayState=function(n){var t=v(n);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[t]},t.prototype.load=function(){this.getSourceTiles()},t}(ec),iui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rui=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i,e)||this;return o.consumers=0,o.extent=null,o.format_=u,o.features_=null,o.loader_,o.projection=null,o.resolution,o.tileLoadFunction_=f,o.url_=r,o}return iui(t,n),t.prototype.getFormat=function(){return this.format_},t.prototype.getFeatures=function(){return this.features_},t.prototype.getKey=function(){return this.url_},t.prototype.load=function(){this.state==c.IDLE&&(this.setState(c.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(this.extent,this.resolution,this.projection))},t.prototype.onLoad=function(n){this.setFeatures(n)},t.prototype.onError=function(){this.setState(c.ERROR)},t.prototype.setFeatures=function(n){this.features_=n;this.setState(c.LOADED)},t.prototype.setLoader=function(n){this.loader_=n},t}(ec),uui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fui=function(n){function t(t){var i=this,r=t.projection||"EPSG:3857",u=t.extent||as(r),f=t.tileGrid||rc({extent:u,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});return(i=n.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,opaque:!1,projection:r,state:t.state,tileGrid:f,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:eui,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection})||this).format_=t.format?t.format:null,i.loadingTiles_={},i.sourceTileByCoordKey_={},i.sourceTilesByTileKey_={},i.overlaps_=null==t.overlaps||t.overlaps,i.tileClass=t.tileClass?t.tileClass:rui,i.tileGrids_={},i}return uui(t,n),t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.clear=function(){this.tileCache.clear();this.sourceTileByCoordKey_={};this.sourceTilesByTileKey_={}},t.prototype.getSourceTiles=function(n,t,i){var v=i.wrappedTileCoord,y=this.getTileGridForProjection(t),h=y.getTileCoordExtent(v),w=v[0],p=y.getResolution(w),u,l;iu(h,-p,h);u=this.tileGrid;l=u.getExtent();l&&vu(h,l,h);var f,e,r,o=u.getZForResolution(p,1),b=u.getMinZoom(),s=this.sourceTilesByTileKey_[i.getKey()];if(s&&s.length>0&&s[0].tileCoord[0]===o)f=s,e=!0,r=o;else{f=[];r=o+1;do--r,e=!0,u.forEachTileCoord(h,r,function(s){var h,y=gy(s),l,p,v;if(y in this.sourceTileByCoordKey_){if(l=(h=this.sourceTileByCoordKey_[y]).getState(),l===c.LOADED||l===c.ERROR||l===c.EMPTY)return void f.push(h)}else r===o&&(p=this.tileUrlFunction(s,n,t),void 0!==p&&((h=new this.tileClass(s,c.IDLE,p,this.format_,this.tileLoadFunction)).extent=u.getTileCoordExtent(s),h.projection=t,h.resolution=u.getResolution(s[0]),this.sourceTileByCoordKey_[y]=h,h.addEventListener(a.CHANGE,this.handleTileChange.bind(this)),h.load()));(e=!1,h&&h.getState()!==c.EMPTY&&i.getState()===c.IDLE)&&(i.loadingSourceTiles++,v=nt(h,a.CHANGE,function(){var t,f,r,n=h.getState(),e=h.getKey(),u;(n===c.LOADED||n===c.ERROR)&&(n===c.LOADED?(t=i.sourceTileListenerKeys,f=v,r=t.indexOf(f),r>-1&&t.splice(r,1),ct(v),i.loadingSourceTiles--,delete i.errorSourceTileKeys[e]):n===c.ERROR&&(i.errorSourceTileKeys[e]=!0),u=Object.keys(i.errorSourceTileKeys).length,i.loadingSourceTiles-u==0&&(i.hifi=0===u,i.sourceZ=o,i.setState(c.LOADED)))}),i.sourceTileListenerKeys.push(v))}.bind(this)),e||(f.length=0);while(!e&&r>b)}return i.getState()===c.IDLE&&i.setState(c.LOADING),e&&(i.hifi=o===r,i.sourceZ=r,i.getState()<c.LOADED?i.setState(c.LOADED):s&&be(f,s)||(this.removeSourceTiles(i),this.addSourceTiles(i,f))),f},t.prototype.addSourceTiles=function(n,t){this.sourceTilesByTileKey_[n.getKey()]=t;for(var i=0,r=t.length;i<r;++i)t[i].consumers++},t.prototype.removeSourceTiles=function(n){var i=n.getKey(),t;if(i in this.sourceTilesByTileKey_)for(var u=this.sourceTilesByTileKey_[i],r=0,f=u.length;r<f;++r)t=u[r],t.consumers--,0===t.consumers&&(t.dispose(),delete this.sourceTileByCoordKey_[gy(t.tileCoord)]);delete this.sourceTilesByTileKey_[i]},t.prototype.getTile=function(n,t,i,r,u){var o,s=fo(n,t,i),y=this.getKey(),l,a,f;if(this.tileCache.containsKey(s)&&(o=this.tileCache.get(s)).key===y)return o;var p=[n,t,i],e=this.getTileCoordForTileUrlFunction(p,u),w=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(u);if(e&&w&&(l=h.getTileCoordExtent(e),iu(l,-h.getResolution(n),l),fi(w,l)||(e=null)),a=!0,null!==e){var b=this.tileGrid,k=h.getResolution(n),d=b.getZForResolution(k,1),v=h.getTileCoordExtent(e);iu(v,-k,v);b.forEachTileCoord(v,d,function(n){a=a&&!this.tileUrlFunction(n,r,u)}.bind(this))}return f=new tui(p,a?c.EMPTY:c.IDLE,e,this.tileGrid,this.getSourceTiles.bind(this,r,u),this.removeSourceTiles.bind(this)),f.key=y,o?(f.interimTile=o,f.refreshInterimChain(),this.tileCache.replace(s,f)):this.tileCache.set(s,f),f},t.prototype.getTileGridForProjection=function(n){var r=n.getCode(),t=this.tileGrids_[r],i;return t||(i=this.tileGrid,t=uot(n,void 0,i?i.getTileSize(i.getMinZoom()):void 0),this.tileGrids_[r]=t),t},t.prototype.getTilePixelRatio=function(n){return n},t.prototype.getTilePixelSize=function(n,t,i){var r=hr(this.getTileGridForProjection(i).getTileSize(n),this.tmpSize);return[Math.round(r[0]*t),Math.round(r[1]*t)]},t}(ost);var so={KVP:"KVP",REST:"REST"},oui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sui=function(n){function t(t){var i=this,u=void 0!==t.requestEncoding?t.requestEncoding:so.KVP,f=t.tileGrid,r=t.urls;return void 0===r&&void 0!==t.url&&(r=yd(t.url)),(i=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:f,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:vd,urls:r,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition})||this).version_=void 0!==t.version?t.version:"1.0.0",i.format_=void 0!==t.format?t.format:"image/jpeg",i.dimensions_=void 0!==t.dimensions?t.dimensions:{},i.layer_=t.layer,i.matrixSet_=t.matrixSet,i.style_=t.style,i.requestEncoding_=u,i.setKey(i.getKeyForDimensions_()),r&&r.length>0&&(i.tileUrlFunction=ra(r.map(lht.bind(i)))),i}return oui(t,n),t.prototype.setUrls=function(n){this.urls=n;var t=n.join("\n");this.setTileUrlFunction(ra(n.map(lht.bind(this))),t)},t.prototype.getDimensions=function(){return this.dimensions_},t.prototype.getFormat=function(){return this.format_},t.prototype.getLayer=function(){return this.layer_},t.prototype.getMatrixSet=function(){return this.matrixSet_},t.prototype.getRequestEncoding=function(){return this.requestEncoding_},t.prototype.getStyle=function(){return this.style_},t.prototype.getVersion=function(){return this.version_},t.prototype.getKeyForDimensions_=function(){var i=0,n=[];for(var t in this.dimensions_)n[i++]=t+"-"+this.dimensions_[t];return n.join("/")},t.prototype.updateDimensions=function(n){d(this.dimensions_,n);this.setKey(this.getKeyForDimensions_())},t}(fe);var hui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ig={GENERATE_BUFFERS:"GENERATE_BUFFERS"},cui=function(n){function t(t,i){var r=n.call(this,t)||this,u=i||{};return r.helper=new vot({postProcesses:u.postProcesses,uniforms:u.uniforms}),r}return hui(t,n),t.prototype.disposeInternal=function(){this.helper.dispose();n.prototype.disposeInternal.call(this)},t.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},t}(tht),lui=cui,aui=new Blob(['var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};'],{type:"application/javascript"}),vui=URL.createObjectURL(aui),yui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aht="renderOrder",oa=function(n){function t(t){var r=this,i=t||{},u=d({},i);return delete u.style,delete u.renderBuffer,delete u.updateWhileAnimating,delete u.updateWhileInteracting,(r=n.call(this,u)||this).declutter_=void 0!==i.declutter&&i.declutter,r.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(i.style),r.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,r.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,r}return yui(t,n),t.prototype.getDeclutter=function(){return this.declutter_},t.prototype.getFeatures=function(t){return n.prototype.getFeatures.call(this,t)},t.prototype.getRenderBuffer=function(){return this.renderBuffer_},t.prototype.getRenderOrder=function(){return this.get(aht)},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},t.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},t.prototype.setRenderOrder=function(n){this.set(aht,n)},t.prototype.setStyle=function(n){this.style_=void 0!==n?n:unt;this.styleFunction_=null===n?void 0:function(n){var t,i;return"function"==typeof n?t=n:(Array.isArray(n)?i=n:(p("function"==typeof n.getZIndex,41),i=[n]),t=function(){return i}),t}(this.style_);this.changed()},t}(yl),pui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vht=function(n){function t(t,i){var r=this,e=i.uniforms||{},o=[1,0,0,1,0,0],f,u;if(e[uc.PROJECTION_MATRIX]=o,(r=n.call(this,t,{uniforms:e,postProcesses:i.postProcesses})||this).sourceRevision_=-1,r.verticesBuffer_=new gl(kl,dl),r.hitVerticesBuffer_=new gl(kl,dl),r.indicesBuffer_=new gl(np,dl),r.program_=r.helper.getProgram(i.fragmentShader,i.vertexShader),r.getShaderCompileErrors())throw new Error(r.getShaderCompileErrors());if(r.hitDetectionEnabled_=!(!i.hitFragmentShader||!i.hitVertexShader),r.hitProgram_=r.hitDetectionEnabled_&&r.helper.getProgram(i.hitFragmentShader,i.hitVertexShader),r.getShaderCompileErrors())throw new Error(r.getShaderCompileErrors());return f=i.attributes?i.attributes.map(function(n){return{name:"a_"+n.name,size:1,type:du.FLOAT}}):[],r.attributes=[{name:"a_position",size:2,type:du.FLOAT},{name:"a_index",size:1,type:du.FLOAT}].concat(f),r.hitDetectionAttributes=[{name:"a_position",size:2,type:du.FLOAT},{name:"a_index",size:1,type:du.FLOAT},{name:"a_hitColor",size:4,type:du.FLOAT},{name:"a_featureUid",size:1,type:du.FLOAT}].concat(f),r.customAttributes=i.attributes?i.attributes:[],r.previousExtent_=[1/0,1/0,-1/0,-1/0],r.currentTransform_=o,r.renderTransform_=[1,0,0,1,0,0],r.invertRenderTransform_=[1,0,0,1,0,0],r.renderInstructions_=new Float32Array(0),r.hitRenderInstructions_=new Float32Array(0),r.hitRenderTarget_=r.hitDetectionEnabled_&&new yot(r.helper),r.worker_=new Worker(vui),r.worker_.addEventListener("message",function(n){var t=n.data,i;t.type===ig.GENERATE_BUFFERS&&(i=t.projectionTransform,t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=i,ll(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(n.data.renderInstructions):this.renderInstructions_=new Float32Array(n.data.renderInstructions),this.getLayer().changed())}.bind(r)),r.featureCache_={},r.featureCount_=0,u=r.getLayer().getSource(),r.sourceListenKeys_=[nt(u,dr.ADDFEATURE,r.handleSourceFeatureAdded_,r),nt(u,dr.CHANGEFEATURE,r.handleSourceFeatureChanged_,r),nt(u,dr.REMOVEFEATURE,r.handleSourceFeatureDelete_,r)],u.forEachFeature(function(n){this.featureCache_[v(n)]={feature:n,properties:n.getProperties(),geometry:n.getGeometry()};this.featureCount_++}.bind(r)),r}return pui(t,n),t.prototype.handleSourceFeatureAdded_=function(n){var t=n.feature;this.featureCache_[v(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()};this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(n){var t=n.feature;this.featureCache_[v(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(n){var t=n.feature;delete this.featureCache_[v(t)];this.featureCount_--},t.prototype.renderFrame=function(n){var r=this.indicesBuffer_.getSize(),t,i;return this.helper.drawElements(0,r),this.helper.finalizeDraw(n),t=this.helper.getCanvas(),i=n.layerStatesArray[n.layerIndex].opacity,i!==parseFloat(t.style.opacity)&&(t.style.opacity=i),this.hitDetectionEnabled_&&(this.renderHitDetection(n),this.hitRenderTarget_.clearCachedData()),t},t.prototype.prepareFrame=function(n){var t=this.getLayer(),i=t.getSource(),r=n.viewState,e=!n.viewHints[lr]&&!n.viewHints[fu],o=!uu(this.previousExtent_,n.extent),u=this.sourceRevision_<i.getRevision();if(u&&(this.sourceRevision_=i.getRevision()),e&&(o||u)){var s=r.projection,f=r.resolution,h=t instanceof oa?t.getRenderBuffer():0,c=iu(n.extent,h*f);i.loadFeatures(c,f,s);this.rebuildBuffers_(n);this.previousExtent_=n.extent.slice()}return this.helper.makeProjectionTransform(n,this.currentTransform_),ph(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(n),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(n){var o=[1,0,0,1,0,0],a,s,v,y,w,h,c,b,l;this.helper.makeProjectionTransform(n,o);v=(2+this.customAttributes.length)*this.featureCount_;(this.renderInstructions_&&this.renderInstructions_.length===v||(this.renderInstructions_=new Float32Array(v)),this.hitDetectionEnabled_)&&(y=(7+this.customAttributes.length)*this.featureCount_,this.hitRenderInstructions_&&this.hitRenderInstructions_.length===y||(this.hitRenderInstructions_=new Float32Array(y)));var u,e,r,i=[],k=[],p=0,t=0;for(w in this.featureCache_)if((s=(a=this.featureCache_[w]).geometry)&&s.getType()===f.POINT)for(i[0]=s.getFlatCoordinates()[0],i[1]=s.getFlatCoordinates()[1],bt(o,i),e=t+6,r=void 0,(r=k||[])[0]=Math.floor(e/16777216)/255,r[1]=Math.floor(e/65536)%256/255,r[2]=Math.floor(e/256)%256/255,r[3]=e%256/255,u=r,this.renderInstructions_[p++]=i[0],this.renderInstructions_[p++]=i[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[t++]=i[0],this.hitRenderInstructions_[t++]=i[1],this.hitRenderInstructions_[t++]=u[0],this.hitRenderInstructions_[t++]=u[1],this.hitRenderInstructions_[t++]=u[2],this.hitRenderInstructions_[t++]=u[3],this.hitRenderInstructions_[t++]=Number(w)),h=void 0,c=0;c<this.customAttributes.length;c++)h=this.customAttributes[c].callback(a.feature,a.properties),this.renderInstructions_[p++]=h,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[t++]=h);b={type:ig.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};(b.projectionTransform=o,this.worker_.postMessage(b,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_)&&(l={type:ig.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length},l.projectionTransform=o,l.hitDetection=!0,this.worker_.postMessage(l,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null)},t.prototype.forEachFeatureAtCoordinate=function(n,t,i,r){if(p(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var f=bt(t.coordinateToPixelTransform,n.slice()),u=this.hitRenderTarget_.readPixel(f[0]/2,f[1]/2),o=function(n){var t=0;return t+=Math.round(4278190080*n[0]),t+=Math.round(16711680*n[1]),t+=Math.round(65280*n[2]),t+Math.round(255*n[3])}([u[0]/255,u[1]/255,u[2]/255,u[3]/255]),s=this.hitRenderInstructions_[o],h=Math.floor(s).toString(),e=this.getLayer().getSource().getFeatureByUid(h);return e?r(e,this.getLayer()):void 0}},t.prototype.renderHitDetection=function(n){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(n.size[0]/2),Math.floor(n.size[1]/2)]);this.helper.useProgram(this.hitProgram_);this.helper.prepareDrawToRenderTarget(n,this.hitRenderTarget_,!0);this.helper.bindBuffer(this.hitVerticesBuffer_);this.helper.bindBuffer(this.indicesBuffer_);this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate();this.layer_=null;this.sourceListenKeys_.forEach(function(n){ct(n)});this.sourceListenKeys_=null;n.prototype.disposeInternal.call(this)},t}(lui),sa={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},lp=[sa.FILL],ho=[sa.STROKE],ks=[sa.BEGIN_PATH],yht=[sa.CLOSE_PATH],ot=sa,wui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ha=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.tolerance=t,f.maxExtent=i,f.pixelRatio=u,f.maxLineWidth=0,f.resolution=r,f.beginGeometryInstruction1_=null,f.beginGeometryInstruction2_=null,f.bufferedMaxExtent_=null,f.instructions=[],f.coordinates=[],f.tmpCoordinate_=[],f.hitDetectionInstructions=[],f.state={},f}return wui(t,n),t.prototype.applyPixelRatio=function(n){var t=this.pixelRatio;return 1==t?n:n.map(function(n){return n*t})},t.prototype.appendFlatCoordinates=function(n,t,i,r,u,f){var e=this.coordinates.length,y=this.getBufferedMaxExtent();f&&(t+=r);for(var v,c,l=n[t],a=n[t+1],o=this.tmpCoordinate_,h=!0,s=t+r;s<i;s+=r)o[0]=n[s],o[1]=n[s+1],(c=aw(y,o))!==v?(h&&(this.coordinates[e++]=l,this.coordinates[e++]=a),this.coordinates[e++]=o[0],this.coordinates[e++]=o[1],h=!1):c===nr.INTERSECTING?(this.coordinates[e++]=o[0],this.coordinates[e++]=o[1],h=!1):h=!0,l=o[0],a=o[1],v=c;return(u&&h||s===t+r)&&(this.coordinates[e++]=l,this.coordinates[e++]=a),e},t.prototype.drawCustomCoordinates_=function(n,t,i,r,u){for(var e,s,f=0,o=i.length;f<o;++f)e=i[f],s=this.appendFlatCoordinates(n,t,e,r,!1,!1),u.push(s),t=e;return t},t.prototype.drawCustom=function(n,t,i){var v,h,p,y;this.beginGeometry(n,t);var r,e,c,l,o,u=n.getType(),a=n.getStride(),s=this.coordinates.length;if(u==f.MULTI_POLYGON){for(r=(n=n).getOrientedFlatCoordinates(),l=[],v=n.getEndss(),o=0,h=0,p=v.length;h<p;++h)y=[],o=this.drawCustomCoordinates_(r,o,v[h],a,y),l.push(y);this.instructions.push([ot.CUSTOM,s,l,n,i,rrt])}else u==f.POLYGON||u==f.MULTI_LINE_STRING?(c=[],r=u==f.POLYGON?n.getOrientedFlatCoordinates():n.getFlatCoordinates(),o=this.drawCustomCoordinates_(r,0,n.getEnds(),a,c),this.instructions.push([ot.CUSTOM,s,c,n,i,wv])):u==f.LINE_STRING||u==f.MULTI_POINT?(r=n.getFlatCoordinates(),e=this.appendFlatCoordinates(r,0,r.length,a,!1,!1),this.instructions.push([ot.CUSTOM,s,e,n,i,wh])):u==f.POINT&&(r=n.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),e=this.coordinates.length,this.instructions.push([ot.CUSTOM,s,e,n,i]));this.endGeometry(t)},t.prototype.beginGeometry=function(n,t){var i=n.getExtent();this.beginGeometryInstruction1_=[ot.BEGIN_GEOMETRY,t,0,i];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[ot.BEGIN_GEOMETRY,t,0,i];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},t.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},t.prototype.reverseHitDetectionInstructions=function(){var n,i=this.hitDetectionInstructions,r,u,f,t;for(i.reverse(),f=i.length,t=-1,n=0;n<f;++n)(u=(r=i[n])[0])==ot.END_GEOMETRY?t=n:u==ot.BEGIN_GEOMETRY&&(r[2]=n,ewt(this.hitDetectionInstructions,t,n),t=-1)},t.prototype.setFillStrokeStyle=function(n,t){var i=this.state,s,h,r,u,c,f,e,o;n?(s=n.getColor(),i.fillStyle=bu(s||"#000")):i.fillStyle=void 0;t?(h=t.getColor(),i.strokeStyle=bu(h||"#000"),r=t.getLineCap(),i.lineCap=void 0!==r?r:"round",u=t.getLineDash(),i.lineDash=u?u.slice():by,c=t.getLineDashOffset(),i.lineDashOffset=c||0,f=t.getLineJoin(),i.lineJoin=void 0!==f?f:"round",e=t.getWidth(),i.lineWidth=void 0!==e?e:1,o=t.getMiterLimit(),i.miterLimit=void 0!==o?o:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)):(i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0)},t.prototype.createFill=function(n){var t=n.fillStyle,i=[ot.SET_FILL_STYLE,t];return"string"!=typeof t&&i.push(!0),i},t.prototype.applyStroke=function(n){this.instructions.push(this.createStroke(n))},t.prototype.createStroke=function(n){return[ot.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth*this.pixelRatio,n.lineCap,n.lineJoin,n.miterLimit,this.applyPixelRatio(n.lineDash),n.lineDashOffset*this.pixelRatio]},t.prototype.updateFillStyle=function(n,t){var i=n.fillStyle;"string"==typeof i&&n.currentFillStyle==i||(void 0!==i&&this.instructions.push(t.call(this,n)),n.currentFillStyle=i)},t.prototype.updateStrokeStyle=function(n,t){var i=n.strokeStyle,u=n.lineCap,r=n.lineDash,f=n.lineDashOffset,e=n.lineJoin,o=n.lineWidth,s=n.miterLimit;n.currentStrokeStyle==i&&n.currentLineCap==u&&(r==n.currentLineDash||be(n.currentLineDash,r))&&n.currentLineDashOffset==f&&n.currentLineJoin==e&&n.currentLineWidth==o&&n.currentMiterLimit==s||(void 0!==i&&t.call(this,n),n.currentStrokeStyle=i,n.currentLineCap=u,n.currentLineDash=r,n.currentLineDashOffset=f,n.currentLineJoin=e,n.currentLineWidth=o,n.currentMiterLimit=s)},t.prototype.endGeometry=function(n){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=null;var t=[ot.END_GEOMETRY,n];this.instructions.push(t);this.hitDetectionInstructions.push(t)},t.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=nit(this.maxExtent),this.maxLineWidth>0)){var n=this.resolution*(this.maxLineWidth+1)/2;iu(this.bufferedMaxExtent_,n,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},t}(vk),bui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kui=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.declutterGroups_=null,f.hitDetectionImage_=null,f.image_=null,f.anchorX_=void 0,f.anchorY_=void 0,f.height_=void 0,f.opacity_=void 0,f.originX_=void 0,f.originY_=void 0,f.rotateWithView_=void 0,f.rotation_=void 0,f.scale_=void 0,f.width_=void 0,f}return bui(t,n),t.prototype.drawCoordinates_=function(n,t,i,r){return this.appendFlatCoordinates(n,t,i,r,!1,!1)},t.prototype.drawPoint=function(n,t){if(this.image_){this.beginGeometry(n,t);var i=n.getFlatCoordinates(),f=n.getStride(),r=this.coordinates.length,u=this.drawCoordinates_(i,0,i.length,f);this.instructions.push([ot.DRAW_IMAGE,r,u,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]);this.hitDetectionInstructions.push([ot.DRAW_IMAGE,r,u,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]);this.endGeometry(t)}},t.prototype.drawMultiPoint=function(n,t){if(this.image_){this.beginGeometry(n,t);var i=n.getFlatCoordinates(),f=n.getStride(),r=this.coordinates.length,u=this.drawCoordinates_(i,0,i.length,f);this.instructions.push([ot.DRAW_IMAGE,r,u,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]);this.hitDetectionInstructions.push([ot.DRAW_IMAGE,r,u,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]);this.endGeometry(t)}},t.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,n.prototype.finish.call(this)},t.prototype.setImageStyle=function(n,t){var i=n.getAnchor(),r=n.getSize(),f=n.getHitDetectionImage(1),e=n.getImage(1),u=n.getOrigin();this.anchorX_=i[0];this.anchorY_=i[1];this.declutterGroups_=t;this.hitDetectionImage_=f;this.image_=e;this.height_=r[1];this.opacity_=n.getOpacity();this.originX_=u[0];this.originY_=u[1];this.rotateWithView_=n.getRotateWithView();this.rotation_=n.getRotation();this.scale_=n.getScale();this.width_=r[0]},t}(ha),dui=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gui=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return dui(t,n),t.prototype.drawFlatCoordinates_=function(n,t,i,r){var f=this.coordinates.length,e=this.appendFlatCoordinates(n,t,i,r,!1,!1),u=[ot.MOVE_TO_LINE_TO,f,e];return this.instructions.push(u),this.hitDetectionInstructions.push(u),i},t.prototype.drawLineString=function(n,t){var i=this.state,f=i.strokeStyle,e=i.lineWidth,r,u;void 0!==f&&void 0!==e&&(this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(n,t),this.hitDetectionInstructions.push([ot.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],ks),r=n.getFlatCoordinates(),u=n.getStride(),this.drawFlatCoordinates_(r,0,r.length,u),this.hitDetectionInstructions.push(ho),this.endGeometry(t))},t.prototype.drawMultiLineString=function(n,t){var i=this.state,e=i.strokeStyle,o=i.lineWidth;if(void 0!==e&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke);this.beginGeometry(n,t);this.hitDetectionInstructions.push([ot.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],ks);for(var u=n.getEnds(),s=n.getFlatCoordinates(),h=n.getStride(),f=0,r=0,c=u.length;r<c;++r)f=this.drawFlatCoordinates_(s,f,u[r],h);this.hitDetectionInstructions.push(ho);this.endGeometry(t)}},t.prototype.finish=function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ho),this.reverseHitDetectionInstructions(),this.state=null,n.prototype.finish.call(this)},t.prototype.applyStroke=function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ho),t.lastStroke=this.coordinates.length);t.lastStroke=0;n.prototype.applyStroke.call(this,t);this.instructions.push(ks)},t}(ha),nfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pht=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return nfi(t,n),t.prototype.drawFlatCoordinatess_=function(n,t,i,r){var e=this.state,h=void 0!==e.fillStyle,f=void 0!==e.strokeStyle,c=i.length,u;for(this.instructions.push(ks),this.hitDetectionInstructions.push(ks),u=0;u<c;++u){var o=i[u],l=this.coordinates.length,a=this.appendFlatCoordinates(n,t,o,r,!0,!f),s=[ot.MOVE_TO_LINE_TO,l,a];this.instructions.push(s);this.hitDetectionInstructions.push(s);f&&(this.instructions.push(yht),this.hitDetectionInstructions.push(yht));t=o}return h&&(this.instructions.push(lp),this.hitDetectionInstructions.push(lp)),f&&(this.instructions.push(ho),this.hitDetectionInstructions.push(ho)),t},t.prototype.drawCircle=function(n,t){var i=this.state,f=i.fillStyle,e=i.strokeStyle,r;if(void 0!==f||void 0!==e){this.setFillStrokeStyles_();this.beginGeometry(n,t);void 0!==i.fillStyle&&this.hitDetectionInstructions.push([ot.SET_FILL_STYLE,"#000"]);void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([ot.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var u=n.getFlatCoordinates(),o=n.getStride(),s=this.coordinates.length;this.appendFlatCoordinates(u,0,u.length,o,!1,!1);r=[ot.CIRCLE,s];this.instructions.push(ks,r);this.hitDetectionInstructions.push(ks,r);void 0!==i.fillStyle&&(this.instructions.push(lp),this.hitDetectionInstructions.push(lp));void 0!==i.strokeStyle&&(this.instructions.push(ho),this.hitDetectionInstructions.push(ho));this.endGeometry(t)}},t.prototype.drawPolygon=function(n,t){var i=this.state,r=i.fillStyle,u=i.strokeStyle;if(void 0!==r||void 0!==u){this.setFillStrokeStyles_();this.beginGeometry(n,t);void 0!==i.fillStyle&&this.hitDetectionInstructions.push([ot.SET_FILL_STYLE,"#000"]);void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([ot.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var f=n.getEnds(),e=n.getOrientedFlatCoordinates(),o=n.getStride();this.drawFlatCoordinatess_(e,0,f,o);this.endGeometry(t)}},t.prototype.drawMultiPolygon=function(n,t){var i=this.state,e=i.fillStyle,o=i.strokeStyle;if(void 0!==e||void 0!==o){this.setFillStrokeStyles_();this.beginGeometry(n,t);void 0!==i.fillStyle&&this.hitDetectionInstructions.push([ot.SET_FILL_STYLE,"#000"]);void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([ot.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var u=n.getEndss(),s=n.getOrientedFlatCoordinates(),h=n.getStride(),f=0,r=0,c=u.length;r<c;++r)f=this.drawFlatCoordinatess_(s,f,u[r],h);this.endGeometry(t)}},t.prototype.finish=function(){var i;if(this.reverseHitDetectionInstructions(),this.state=null,i=this.tolerance,0!==i)for(var r=this.coordinates,t=0,u=r.length;t<u;++t)r[t]=us(r[t],i);return n.prototype.finish.call(this)},t.prototype.setFillStrokeStyles_=function(){var n=this.state;void 0!==n.fillStyle&&this.updateFillStyle(n,this.createFill);void 0!==n.strokeStyle&&this.updateStrokeStyle(n,this.applyStroke)},t}(ha);var ifi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ca={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},rfi={Circle:pht,Default:ha,Image:kui,LineString:gui,Polygon:pht,Text:function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.declutterGroups_,f.labels_=null,f.text_="",f.textOffsetX_=0,f.textOffsetY_=0,f.textRotateWithView_=void 0,f.textRotation_=0,f.textFillState_=null,f.fillStates={},f.textStrokeState_=null,f.strokeStates={},f.textState_={},f.textStates={},f.textKey_="",f.fillKey_="",f.strokeKey_="",re.prune(),f}return ifi(t,n),t.prototype.finish=function(){var t=n.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},t.prototype.drawText=function(n,t){var nt=this.textFillState_,tt=this.textStrokeState_,i=this.textState_,o,w,k,d,h,a,g;if(""!==this.text_&&i&&(nt||tt)){var r,v,y=this.coordinates.length,c=n.getType(),u=null,e=2,l=2;if(i.placement===dot.LINE){if(!fi(this.getBufferedMaxExtent(),n.getExtent()))return;if(o=void 0,u=n.getFlatCoordinates(),l=n.getStride(),c==f.LINE_STRING)o=[u.length];else if(c==f.MULTI_LINE_STRING)o=n.getEnds();else if(c==f.POLYGON)o=n.getEnds().slice(0,1);else if(c==f.MULTI_POLYGON)for(w=n.getEndss(),o=[],r=0,v=w.length;r<v;++r)o.push(w[r][0]);this.beginGeometry(n,t);for(var it=i.textAlign,p=0,b=void 0,s=0,rt=o.length;s<rt;++s){for(null==it?(k=tfi(i.maxAngle,u,p,o[s],l),p=k[0],b=k[1]):b=o[s],r=p;r<b;r+=l)this.coordinates.push(u[r],u[r+1]);e=this.coordinates.length;p=o[s];d=this.declutterGroups_?0===s?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(y,e,d);y=e}this.endGeometry(t)}else{h=null;switch(i.overflow||(h=[]),c){case f.POINT:case f.MULTI_POINT:e=(u=n.getFlatCoordinates()).length;break;case f.LINE_STRING:u=n.getFlatMidpoint();break;case f.CIRCLE:u=n.getCenter();break;case f.MULTI_LINE_STRING:e=(u=n.getFlatMidpoints()).length;break;case f.POLYGON:u=n.getFlatInteriorPoint();i.overflow||h.push(u[2]/this.resolution);l=3;break;case f.MULTI_POLYGON:for(a=n.getFlatInteriorPoints(),u=[],r=0,v=a.length;r<v;r+=3)i.overflow||h.push(a[r+2]/this.resolution),u.push(a[r],a[r+1]);if(0==(e=u.length))return}e=this.appendFlatCoordinates(u,0,e,l,!1,!1);this.saveTextStates_();(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state))));this.beginGeometry(n,t);g=this.pixelRatio;this.instructions.push([ot.DRAW_IMAGE,y,e,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,i.padding==ic?ic:i.padding.map(function(n){return n*g}),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);this.hitDetectionInstructions.push([ot.DRAW_IMAGE,y,e,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,i.padding,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);this.endGeometry(t)}}},t.prototype.saveTextStates_=function(){var n=this.textStrokeState_,t=this.textState_,u=this.textFillState_,f=this.strokeKey_,i,r;n&&(f in this.strokeStates||(this.strokeStates[f]={strokeStyle:n.strokeStyle,lineCap:n.lineCap,lineDashOffset:n.lineDashOffset,lineWidth:n.lineWidth,lineJoin:n.lineJoin,miterLimit:n.miterLimit,lineDash:n.lineDash}));i=this.textKey_;i in this.textStates||(this.textStates[i]={font:t.font,textAlign:t.textAlign||"center",textBaseline:t.textBaseline||"middle",scale:t.scale});r=this.fillKey_;u&&(r in this.fillStates||(this.fillStates[r]={fillStyle:u.fillStyle}))},t.prototype.drawChars_=function(n,t,i){var f=this.textStrokeState_,r=this.textState_,e=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio,h=ca[r.textBaseline],c=this.textOffsetY_*u,l=this.text_,v=r.scale,a=f?f.lineWidth*v/2:0;this.instructions.push([ot.DRAW_CHARS,n,t,h,i,r.overflow,s,r.maxAngle,u,c,e,a*u,l,o,1]);this.hitDetectionInstructions.push([ot.DRAW_CHARS,n,t,h,i,r.overflow,s,r.maxAngle,1,c,e,a,l,o,1/u])},t.prototype.setTextStyle=function(n,t){var r,u,i,e,f,o,s;if(n){if(this.declutterGroups_=t,e=n.getFill(),e?((u=this.textFillState_)||(u={},this.textFillState_=u),u.fillStyle=bu(e.getColor()||"#000")):(u=null,this.textFillState_=u),f=n.getStroke(),f){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var h=f.getLineDash(),c=f.getLineDashOffset(),l=f.getWidth(),a=f.getMiterLimit();i.lineCap=f.getLineCap()||"round";i.lineDash=h?h.slice():by;i.lineDashOffset=void 0===c?0:c;i.lineJoin=f.getLineJoin()||"round";i.lineWidth=void 0===l?1:l;i.miterLimit=void 0===a?10:a;i.strokeStyle=bu(f.getColor()||"#000")}else i=null,this.textStrokeState_=i;r=this.textState_;o=n.getFont()||"10px sans-serif";rgt(o);s=n.getScale();r.overflow=n.getOverflow();r.font=o;r.maxAngle=n.getMaxAngle();r.placement=n.getPlacement();r.textAlign=n.getTextAlign();r.textBaseline=n.getTextBaseline()||"middle";r.backgroundFill=n.getBackgroundFill();r.backgroundStroke=n.getBackgroundStroke();r.padding=n.getPadding()||ic;r.scale=void 0===s?1:s;var y=n.getOffsetX(),p=n.getOffsetY(),w=n.getRotateWithView(),b=n.getRotation();this.text_=n.getText()||"";this.textOffsetX_=void 0===y?0:y;this.textOffsetY_=void 0===p?0:p;this.textRotateWithView_=void 0!==w&&w;this.textRotation_=void 0===b?0:b;this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:v(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"";this.textKey_=r.font+r.scale+(r.textAlign||"?");this.fillKey_=u?"string"==typeof u.fillStyle?u.fillStyle:"|"+v(u.fillStyle):""}else this.text_=""},t}(ha)},wht=function(){function n(n,t,i,r,u){this.declutter_=u;this.declutterGroups_=null;this.tolerance_=n;this.maxExtent_=t;this.pixelRatio_=r;this.resolution_=i;this.buildersByZIndex_={}}return n.prototype.addDeclutter=function(n){var t=null;return this.declutter_&&(n?(t=this.declutterGroups_)[0][4]++:(t=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=t,t[0].push(1))),t},n.prototype.finish=function(){var t={},n,i,r,u;for(n in this.buildersByZIndex_){t[n]=t[n]||{};i=this.buildersByZIndex_[n];for(r in i)u=i[r].finish(),t[n][r]=u}return t},n.prototype.getBuilder=function(n,t){var u=void 0!==n?n.toString():"0",i=this.buildersByZIndex_[u],r;return void 0===i&&(i={},this.buildersByZIndex_[u]=i),r=i[t],void 0===r&&(r=new rfi[t](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=r),r},n}();var ffi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ds=[1/0,1/0,-1/0,-1/0],la=[1,0,0,1,0,0],se=[],yf=[],pf=[],he=[],efi=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.overlaps=r,f.pixelRatio=i,f.resolution=t,f.alignFill_,f.declutterItems=[],f.instructions=u.instructions,f.coordinates=u.coordinates,f.coordinateCache_={},f.renderedTransform_=[1,0,0,1,0,0],f.hitDetectionInstructions=u.hitDetectionInstructions,f.pixelCoordinates_=null,f.viewRotation_=0,f.fillStates=u.fillStates||{},f.strokeStates=u.strokeStates||{},f.textStates=u.textStates||{},f.widths_={},f}return ffi(t,n),t.prototype.disposeInternal=function(){re.release(this);n.prototype.disposeInternal.call(this)},t.prototype.getTextImage=function(n,t,i,r){var w,a=r+t+n+i+this.pixelRatio;if(!re.containsKey(a)){var e=r?this.strokeStates[r]:null,g=i?this.fillStates[i]:null,s=this.textStates[t],nt=this.pixelRatio,h=s.scale*nt,b=ca[s.textAlign||"center"],o=r&&e.lineWidth?e.lineWidth:0,l=n.split("\n"),v=l.length,y=[],tt=function(n,t,i){for(var f,e=t.length,r=0,u=0;u<e;++u)f=oet(n,t[u]),r=Math.max(r,f),i.push(f);return r}(s.font,l,y),c=eet(s.font),it=c*v,k=tt+o,u=ci(Math.ceil((k+2)*h),Math.ceil((it+o)*h));w=u.canvas;re.set(a,w);1!=h&&u.scale(h,h);u.font=s.font;r&&(u.strokeStyle=e.strokeStyle,u.lineWidth=o,u.lineCap=e.lineCap,u.lineJoin=e.lineJoin,u.miterLimit=e.miterLimit,u.setLineDash&&e.lineDash.length&&(u.setLineDash(e.lineDash),u.lineDashOffset=e.lineDashOffset));i&&(u.fillStyle=g.fillStyle);u.textBaseline="middle";u.textAlign="center";var p=.5-b,d=b*k+p*o,f=void 0;if(r)for(f=0;f<v;++f)u.strokeText(l[f],d+p*y[f],.5*(o+c)+f*c);if(i)for(f=0;f<v;++f)u.fillText(l[f],d+p*y[f],.5*(o+c)+f*c)}return re.get(a,this)},t.prototype.replayTextBackground_=function(n,t,i,r,u,f,e){n.beginPath();n.moveTo.apply(n,t);n.lineTo.apply(n,i);n.lineTo.apply(n,r);n.lineTo.apply(n,u);n.lineTo.apply(n,t);f&&(this.alignFill_=f[2],this.fill_(n));e&&(this.setStrokeStyle_(n,e),n.stroke())},t.prototype.replayImage_=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var it=w||b,g,ft,et,tt;t-=u*=a;i-=f*=a;var rt=y+h>r.width?r.width-h:y,ut=o+c>r.height?r.height-c:o,st=p[3]+rt*a+p[1],ht=p[0]+ut*a+p[2],k=t-p[3],d=i-p[0];(it||0!==l)&&(se[0]=k,he[0]=k,se[1]=d,yf[1]=d,yf[0]=k+st,pf[0]=yf[0],pf[1]=d+ht,he[1]=pf[1]);g=null;0!==l?(ft=t+u,et=i+f,g=wr(la,ft,et,1,1,l,-ft,-et),bt(la,se),bt(la,yf),bt(la,pf),bt(la,he),ru(Math.min(se[0],yf[0],pf[0],he[0]),Math.min(se[1],yf[1],pf[1],he[1]),Math.max(se[0],yf[0],pf[0],he[0]),Math.max(se[1],yf[1],pf[1],he[1]),ds)):ru(k,d,k+st,d+ht,ds);var ct=n.canvas,nt=b?b[2]*a/2:0,ot=ds[0]-nt<=ct.width&&ds[2]+nt>=0&&ds[1]-nt<=ct.height&&ds[3]+nt>=0;if(v&&(t=Math.round(t),i=Math.round(i)),e){if(!ot&&1==e[4])return;ov(e,ds);tt=ot?[n,g?g.slice(0):null,s,r,h,c,rt,ut,t,i,a]:null;tt&&(it&&tt.push(w,b,se,yf,pf,he),e.push(tt))}else ot&&(it&&this.replayTextBackground_(n,se,yf,pf,he,w,b),aet(n,g,s,r,h,c,rt,ut,t,i,a))},t.prototype.fill_=function(n){if(this.alignFill_){var t=bt(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;n.save();n.translate(t[0]%i,t[1]%i);n.rotate(this.viewRotation_)}n.fill();this.alignFill_&&n.restore()},t.prototype.setStrokeStyle_=function(n,t){n.strokeStyle=t[1];n.lineWidth=t[2];n.lineCap=t[3];n.lineJoin=t[4];n.miterLimit=t[5];n.setLineDash&&(n.lineDashOffset=t[7],n.setLineDash(t[6]))},t.prototype.renderDeclutter=function(n,t,i,r){var e,o,f,c;if(n&&n.length>5&&(e=n[4],1==e||e==n.length-5)){if(o={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],value:t},r||(r=new sst.a(9)),!r.collides(o))for(r.insert(o),f=5,c=n.length;f<c;++f){var u=n[f],s=u[0],h=s.globalAlpha;h!==i&&(s.globalAlpha=i);u.length>11&&this.replayTextBackground_(u[0],u[13],u[14],u[15],u[16],u[11],u[12]);aet.apply(void 0,u);h!==i&&(s.globalAlpha=h)}n.length=5;oh(n)}return r},t.prototype.drawTextImageWithPointPlacement_=function(n,t,i,r){var u=this.textStates[t],f=this.getTextImage(n,t,r,i),e=this.strokeStates[i],o=this.pixelRatio,s=ca[u.textAlign||"center"],h=ca[u.textBaseline||"middle"],c=e&&e.lineWidth?e.lineWidth:0;return{label:f,anchorX:s*(f.width/o-2*u.scale)+2*(.5-s)*c,anchorY:h*f.height/o+2*(.5-h)*c}},t.prototype.execute_=function(n,t,i,r,u,f){var h,b,k,e,ut,ni,sr,hr,ti,cr,pt,pi,vr,bi,ki,di,kr,ft,gi;this.declutterItems.length=0;this.pixelCoordinates_&&be(t,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=ge(this.coordinates,0,this.coordinates.length,2,t,this.pixelCoordinates_),b=this.renderedTransform_,k=t,b[0]=k[0],b[1]=k[1],b[2]=k[2],b[3]=k[3],b[4]=k[4],b[5]=k[5]);for(var d,y,p,et,st,ht,it,c,rt,g,ct,nt,lt,at,vt,yt,kt,s=0,dr=i.length,o=0,tt=0,v=0,nr=null,tr=null,ui=this.coordinateCache_,ei=this.viewRotation_,ir=Math.round(1e12*Math.atan2(-t[1],t[0]))/1e12,oi={context:n,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ei},dt=this.instructions!=i||this.overlaps?0:200;s<dr;){e=i[s];switch(e[0]){case ot.BEGIN_GEOMETRY:(vt=e[1]).getGeometry()?void 0===f||fi(f,e[3])?++s:s=e[2]+1:s=e[2];break;case ot.BEGIN_PATH:tt>dt&&(this.fill_(n),tt=0);v>dt&&(n.stroke(),v=0);tt||v||(n.beginPath(),et=NaN,st=NaN);++s;break;case ot.CIRCLE:var si=h[o=e[1]],hi=h[o+1],rr=h[o+2]-si,ur=h[o+3]-hi,fr=Math.sqrt(rr*rr+ur*ur);n.moveTo(si+fr,hi);n.arc(si,hi,fr,0,2*Math.PI,!0);++s;break;case ot.CLOSE_PATH:n.closePath();++s;break;case ot.CUSTOM:o=e[1];d=e[2];var gr=e[3],nu=e[4],er=6==e.length?e[5]:void 0;oi.geometry=gr;oi.feature=vt;s in ui||(ui[s]=[]);ut=ui[s];er?er(h,o,d,2,ut):(ut[0]=h[o],ut[1]=h[o+1],ut.length=2);nu(ut,oi);++s;break;case ot.DRAW_IMAGE:o=e[1];d=e[2];g=e[3];y=e[4];p=e[5];rt=u?null:e[6];var ci=e[7],tu=e[8],iu=e[9],ru=e[10],or=e[11],li=e[12],uu=e[13],gt=e[14];!g&&e.length>=19&&(ct=e[18],nt=e[19],lt=e[20],at=e[21],ni=this.drawTextImageWithPointPlacement_(ct,nt,lt,at),g=ni.label,e[3]=g,sr=e[22],y=(ni.anchorX-sr)*this.pixelRatio,e[4]=y,hr=e[23],p=(ni.anchorY-hr)*this.pixelRatio,e[5]=p,ci=g.height,e[7]=ci,gt=g.width,e[14]=gt);ti=void 0;e.length>24&&(ti=e[24]);var ai=void 0,vi=void 0,yi=void 0;for(e.length>16?(ai=e[15],vi=e[16],yi=e[17]):(ai=ic,vi=!1,yi=!1),or&&ir?li+=ei:or||ir||(li-=ei),cr=0,pt=0;o<d;o+=2)ti&&ti[cr++]<gt/this.pixelRatio||(rt&&(pi=Math.floor(pt),rt.length<pi+1&&((c=[1/0,1/0,-1/0,-1/0]).push(rt[0][4]),rt.push(c)),c=rt[pi]),this.replayImage_(n,h[o],h[o+1],g,y,p,c,ci,tu,iu,ru,li,uu,r,gt,ai,vi?nr:null,yi?tr:null),c&&(pt===Math.floor(pt)&&this.declutterItems.push(this,c,vt),pt+=1/c[4]));++s;break;case ot.DRAW_CHARS:var lr=e[1],ar=e[2],wi=e[3];c=u?null:e[4];vr=e[5];at=e[6];var fu=e[7],eu=e[8],yr=e[9];lt=e[10];bi=e[11];ct=e[12];nt=e[13];var pr=e[14],wr=this.textStates[nt],wt=wr.font,br=wr.scale*eu,bt=void 0;if(wt in this.widths_?bt=this.widths_[wt]:(bt={},this.widths_[wt]=bt),ki=bht(h,lr,ar,2),di=br*set(wt,ct,bt),(vr||di<=ki)&&(kr=this.textStates[nt].textAlign,ft=ufi(h,lr,ar,2,ct,(ki-di)*ca[kr],fu,br,set,wt,bt),ft)){var w=void 0,ii=void 0,ri=void 0,l=void 0,a=void 0;if(lt)for(w=0,ii=ft.length;w<ii;++w)ri=(a=ft[w])[4],l=this.getTextImage(ri,nt,"",lt),y=a[2]+bi,p=wi*l.height+2*(.5-wi)*bi-yr,this.replayImage_(n,a[0],a[1],l,y,p,c,l.height,1,0,0,a[3],pr,!1,l.width,ic,null,null);if(at)for(w=0,ii=ft.length;w<ii;++w)ri=(a=ft[w])[4],l=this.getTextImage(ri,nt,at,""),y=a[2],p=wi*l.height-yr,this.replayImage_(n,a[0],a[1],l,y,p,c,l.height,1,0,0,a[3],pr,!1,l.width,ic,null,null)}this.declutterItems.push(this,c,vt);++s;break;case ot.END_GEOMETRY:if(void 0!==u&&(gi=u(vt=e[1]),gi))return gi;++s;break;case ot.FILL:dt?tt++:this.fill_(n);++s;break;case ot.MOVE_TO_LINE_TO:for(o=e[1],d=e[2],yt=h[o],it=(kt=h[o+1])+.5|0,(ht=yt+.5|0)===et&&it===st||(n.moveTo(yt,kt),et=ht,st=it),o+=2;o<d;o+=2)ht=(yt=h[o])+.5|0,it=(kt=h[o+1])+.5|0,o!=d-2&&ht===et&&it===st||(n.lineTo(yt,kt),et=ht,st=it);++s;break;case ot.SET_FILL_STYLE:nr=e;this.alignFill_=e[2];tt&&(this.fill_(n),tt=0,v&&(n.stroke(),v=0));n.fillStyle=e[1];++s;break;case ot.SET_STROKE_STYLE:tr=e;v&&(n.stroke(),v=0);this.setStrokeStyle_(n,e);++s;break;case ot.STROKE:dt?v++:n.stroke();++s;break;default:++s}}tt&&this.fill_(n);v&&n.stroke()},t.prototype.execute=function(n,t,i,r){this.viewRotation_=i;this.execute_(n,t,this.instructions,r,void 0,void 0)},t.prototype.executeHitDetection=function(n,t,i,r,u){return this.viewRotation_=i,this.execute_(n,t,this.hitDetectionInstructions,!0,r,u)},t}(ko),ofi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rg=[lt.POLYGON,lt.CIRCLE,lt.LINE_STRING,lt.IMAGE,lt.TEXT,lt.DEFAULT],sfi=function(n){function t(t,i,r,u,f,e){var o=n.call(this)||this;return o.maxExtent_=t,o.overlaps_=u,o.pixelRatio_=r,o.resolution_=i,o.renderBuffer_=e,o.executorsByZIndex_={},o.hitDetectionContext_=null,o.hitDetectionTransform_=[1,0,0,1,0,0],o.createExecutors_(f),o}return ofi(t,n),t.prototype.clip=function(n,t){var i=this.getClipCoords(t);n.beginPath();n.moveTo(i[0],i[1]);n.lineTo(i[2],i[3]);n.lineTo(i[4],i[5]);n.lineTo(i[6],i[7]);n.clip()},t.prototype.createExecutors_=function(n){var i,t,r,u,f;for(i in n){t=this.executorsByZIndex_[i];void 0===t&&(t={},this.executorsByZIndex_[i]=t);r=n[i];for(u in r)f=r[u],t[u]=new efi(this.resolution_,this.pixelRatio_,this.overlaps_,f)}},t.prototype.disposeInternal=function(){var r,t,u,i;for(r in this.executorsByZIndex_){t=this.executorsByZIndex_[r];for(u in t)t[u].disposeInternal()}this.hitDetectionContext_&&(i=this.hitDetectionContext_.canvas,i.width=0,i.height=0);n.prototype.disposeInternal.call(this)},t.prototype.hasExecutors=function(n){for(var i in this.executorsByZIndex_)for(var r=this.executorsByZIndex_[i],t=0,u=n.length;t<u;++t)if(n[t]in r)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(n,t,i,r,u,f){function d(n){for(var i,r,s=o.getImageData(0,0,e,e).data,t=0;t<e;t++)for(i=0;i<e;i++)if(v[t][i]&&s[4*(i*e+t)+3]>0)return r=void 0,(!f||a!=lt.IMAGE&&a!=lt.TEXT||-1!==f.indexOf(n))&&(r=u(n)),r||void o.clearRect(0,0,e,e)}var e=2*(r=Math.round(r))+1,k=wr(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-n[0],-n[1]),s,o,a,v,h,c,y,p,w,l,b;for(this.hitDetectionContext_||(this.hitDetectionContext_=ci(e,e)),o=this.hitDetectionContext_,o.canvas.width!==e||o.canvas.height!==e?(o.canvas.width=e,o.canvas.height=e):o.clearRect(0,0,e,e),void 0!==this.renderBuffer_&&(hh(s=[1/0,1/0,-1/0,-1/0],n),iu(s,t*(this.renderBuffer_+r),s)),v=function(n){if(void 0!==ug[n])return ug[n];for(var u=2*n+1,t=new Array(u),f=0;f<u;f++)t[f]=new Array(u);for(var i=n,r=0,e=0;i>=r;)co(t,n+i,n+r),co(t,n+r,n+i),co(t,n-r,n+i),co(t,n-i,n+r),co(t,n-i,n-r),co(t,n-r,n-i),co(t,n+r,n-i),co(t,n+i,n-r),2*((e+=1+2*++r)-i)+1>0&&(e+=1-2*(i-=1));return ug[n]=t,t}(r),l=Object.keys(this.executorsByZIndex_).map(Number),l.sort(we),h=l.length-1;h>=0;--h)for(b=l[h].toString(),y=this.executorsByZIndex_[b],c=rg.length-1;c>=0;--c)if(void 0!==(p=y[a=rg[c]])&&(w=p.executeHitDetection(o,k,i,d,s)))return w},t.prototype.getClipCoords=function(n){var t=this.maxExtent_;if(!t)return null;var r=t[0],u=t[1],f=t[2],e=t[3],i=[r,u,r,e,f,e,f,u];return ge(i,0,8,2,n,i),i},t.prototype.isEmpty=function(){return bo(this.executorsByZIndex_)},t.prototype.execute=function(n,t,i,r,u,f){var l=Object.keys(this.executorsByZIndex_).map(Number),e,y,o,p,w,s,a,h,c,v;for(l.sort(we),this.maxExtent_&&(n.save(),this.clip(n,t)),a=u||rg,e=0,y=l.length;e<y;++e)for(h=l[e].toString(),w=this.executorsByZIndex_[h],o=0,p=a.length;o<p;++o)c=a[o],void 0!==(s=w[c])&&(f&&(c==lt.IMAGE||c==lt.TEXT)?(v=f[h],v?v.push(s,t.slice(0)):f[h]=[s,t.slice(0)]):s.execute(n,t,i,r));this.maxExtent_&&n.restore()},t}(ko),ug={0:[[!0]]};fg=sfi;var hfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eg=function(n){function t(t){var i=n.call(this,t)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i}return hfi(t,n),t.prototype.useContainer=function(t,i,r){r<1&&(t=null);n.prototype.useContainer.call(this,t,i,r)},t.prototype.renderFrame=function(n,t){var u=n.pixelRatio,l=n.layerStatesArray[n.layerIndex],a,f,e,p,st,ht,ut,k,ft;!function(n,t,i){hl(n,t,0,0,i,0,0)}(this.pixelTransform,1/u,1/u);ll(this.inversePixelTransform,this.pixelTransform);a=kit(this.pixelTransform);this.useContainer(t,a,l.opacity);var i=this.context,r=i.canvas,s=this.replayGroup_;if(!s||s.isEmpty())return!this.containerReused&&r.width>0&&(r.width=0),this.container;f=Math.round(n.size[0]*u);e=Math.round(n.size[1]*u);r.width!=f||r.height!=e?(r.width=f,r.height=e,r.style.transform!==a&&(r.style.transform=a)):this.containerReused||i.clearRect(0,0,f,e);this.preRender(i,n);var d=n.extent,v=n.viewState,g=v.center,nt=v.resolution,tt=v.projection,o=v.rotation,y=tt.getExtent(),ct=this.getLayer().getSource(),et=!1;l.extent&&(p=uf(l.extent,tt),(et=!tr(p,n.extent)&&fi(p,n.extent))&&this.clip(i,n,p));var ot=n.viewHints,it=!(ot[lr]||ot[fu]),lt=this.getRenderTransform(g,nt,o,u,f,e,0),h=this.getLayer().getDeclutter()?{}:null;if(s.execute(i,lt,o,it,void 0,h),ct.getWrapX()&&tt.canWrapX()&&!tr(y,d)){for(var c=d[0],w=vt(y),rt=0,b=void 0;c<y[0];)b=w*--rt,st=this.getRenderTransform(g,nt,o,u,f,e,b),s.execute(i,st,o,it,void 0,h),c+=w;for(rt=0,c=d[2];c>y[2];)b=w*++rt,ht=this.getRenderTransform(g,nt,o,u,f,e,b),s.execute(i,ht,o,it,void 0,h),c-=w}return h&&(ut=n.viewHints,kht(h,i,o,1,!(ut[lr]||ut[fu]),n.declutterItems)),et&&i.restore(),this.postRender(i,n),k=l.opacity,ft=this.container,k!==parseFloat(ft.style.opacity)&&(ft.style.opacity=1===k?"":k),this.container},t.prototype.getFeatures=function(n){return new Promise(function(t){this.hitDetectionImageData_||this.animatingOrInteracting_?t(ap(n,this.renderedFeatures_,this.hitDetectionImageData_)):requestAnimationFrame(function(){var u=[this.context.canvas.width,this.context.canvas.height],b,i;bt(this.pixelTransform,u);var l=this.renderedCenter_,f=this.renderedResolution_,e=this.renderedRotation_,p=this.renderedProjection_,o=this.renderedExtent_,w=this.getLayer(),s=[],a=u[0]/2,v=u[1]/2;if(s.push(this.getRenderTransform(l,f,e,.5,a,v,0).slice()),b=w.getSource(),i=p.getExtent(),b.getWrapX()&&p.canWrapX()&&!tr(i,o)){for(var r=o[0],h=vt(i),y=0,c=void 0;r<i[0];)c=h*--y,s.push(this.getRenderTransform(l,f,e,.5,a,v,c).slice()),r+=h;for(y=0,r=o[2];r>i[2];)c=h*++y,s.push(this.getRenderTransform(l,f,e,.5,a,v,c).slice()),r-=h}this.hitDetectionImageData_=dht(u,s,this.renderedFeatures_,w.getStyleFunction(),o,f,e);t(ap(n,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(n,t,i,r,u){if(this.replayGroup_){var o=t.viewState.resolution,s=t.viewState.rotation,f=this.getLayer(),e={};return this.replayGroup_.forEachFeatureAtCoordinate(n,o,s,i,function(n){var t=v(n);if(!(t in e))return e[t]=!0,r(n,f)},f.getDeclutter()?u:null)}},t.prototype.handleFontsChanged=function(){var n=this.getLayer();n.getVisible()&&this.replayGroup_&&n.changed()},t.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(n){var r=this.getLayer(),e=r.getSource(),it=n.viewHints[lr],rt=n.viewHints[fu],ut=r.getUpdateWhileAnimating(),ft=r.getUpdateWhileInteracting(),c,p,k,d,w,l,v,g,nt,tt;if(!this.dirty_&&!ut&&it||!ft&&rt)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var et=n.extent,u=n.viewState,o=u.projection,t=u.resolution,h=n.pixelRatio,b=r.getRevision(),ot=r.getRenderBuffer(),f=r.getRenderOrder();void 0===f&&(f=egt);var y=u.center.slice(),i=iu(et,ot*t),s=u.projection.getExtent();if(e.getWrapX()&&u.projection.canWrapX()&&!tr(s,n.extent)&&(c=vt(s),p=Math.max(vt(i)/2,c),i[0]=s[0]-p,i[2]=s[2]+p,k=Math.floor((y[0]-s[0])/c),y[0]-=k*c),!this.dirty_&&this.renderedResolution_==t&&this.renderedRevision_==b&&this.renderedRenderOrder_==f&&tr(this.renderedExtent_,i))return this.replayGroupChanged=!1,!0;this.replayGroup_&&this.replayGroup_.dispose();this.replayGroup_=null;this.dirty_=!1;w=new wht(yet(t,h),i,t,h,r.getDeclutter());l=yv();l?(e.loadFeatures(ol(i,o),t,l),d=wu(l,o)):e.loadFeatures(i,t,o);var st=wk(t,h),ht=function(n){var i,u=n.getStyleFunction()||r.getStyleFunction(),f;(u&&(i=u(n,t)),i)&&(f=this.renderFeature(n,st,i,w,d),this.dirty_=this.dirty_||f)}.bind(this),ct=ol(i,o),a=e.getFeaturesInExtent(ct);for(f&&a.sort(f),v=0,g=a.length;v<g;++v)ht(a[v]);return this.renderedFeatures_=a,nt=w.finish(),tt=new fg(i,t,h,e.getOverlaps(),nt,r.getRenderBuffer()),this.renderedResolution_=t,this.renderedRevision_=b,this.renderedRenderOrder_=f,this.renderedExtent_=i,this.renderedRotation_=u.rotation,this.renderedCenter_=y,this.renderedProjection_=o,this.replayGroup_=tt,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(n,t,i,r,u){var f,e,o;if(!i)return!1;if(f=!1,Array.isArray(i))for(e=0,o=i.length;e<o;++e)f=dy(r,n,i[e],t,this.boundHandleStyleImageChange_,u)||f;else f=dy(r,n,i,t,this.boundHandleStyleImageChange_,u);return f},t}(gd),cfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ght=function(n){function t(t){var i=n.call(this,t)||this;return i.vectorRenderer_=new eg(t),i.layerImageRatio_=t.getImageRatio(),i.coordinateToVectorPixelTransform_=[1,0,0,1,0,0],i.renderedPixelToCoordinateTransform_=null,i}return cfi(t,n),t.prototype.disposeInternal=function(){this.vectorRenderer_.dispose();n.prototype.disposeInternal.call(this)},t.prototype.getFeatures=function(n){if(this.vectorRenderer_){var t=bt(this.coordinateToVectorPixelTransform_,bt(this.renderedPixelToCoordinateTransform_,n.slice()));return this.vectorRenderer_.getFeatures(t)}return new Promise(function(n){n([])})},t.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},t.prototype.prepareFrame=function(n){var l=n.pixelRatio,f=n.viewState,e=f.resolution,v=n.viewHints,i=this.vectorRenderer_,t=n.extent,o,s,c,u;if(1!==this.layerImageRatio_&&il(t=t.slice(0),this.layerImageRatio_),o=vt(t)/e,s=ni(t)/e,!v[lr]&&!v[fu]&&!ts(t)){i.useContainer(null,null,1);var y=i.context,h=d({},n,{declutterItems:[],size:[o,s],viewState:d({},n.viewState,{rotation:0})}),r=new kd(t,e,l,y.canvas,function(n){i.prepareFrame(h)&&i.replayGroupChanged&&(i.renderFrame(h,null),pet(h,null),n())});r.addEventListener(a.CHANGE,function(){r.getState()===et.LOADED&&(this.image_=r)}.bind(this));r.load()}return this.image_&&(c=this.image_,u=c.getResolution()*l/c.getPixelRatio(),this.renderedResolution=u,this.renderedPixelToCoordinateTransform_=n.pixelToCoordinateTransform.slice(),this.coordinateToVectorPixelTransform_=wr(this.coordinateToVectorPixelTransform_,o/2,s/2,1/u,-1/u,0,-f.center[0],-f.center[1])),!!this.image_},t.prototype.preRender=function(){},t.prototype.postRender=function(){},t.prototype.forEachFeatureAtCoordinate=function(t,i,r,u,f){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(t,i,r,u,f):n.prototype.forEachFeatureAtCoordinate.call(this,t,i,r,u,f)},t}(ng),vp={IMAGE:"image",HYBRID:"hybrid"},lfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),afi={image:[lt.POLYGON,lt.CIRCLE,lt.LINE_STRING,lt.IMAGE,lt.TEXT],hybrid:[lt.POLYGON,lt.LINE_STRING]},vfi={image:[lt.DEFAULT],hybrid:[lt.IMAGE,lt.TEXT,lt.DEFAULT]},nct=function(n){function t(t){var i=n.call(this,t)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.dirty_=!1,i.renderedLayerRevision_,i.renderedPixelToCoordinateTransform_=null,i.renderedRotation_,i.renderTileImageQueue_={},i.tileListenerKeys_={},i.tmpTransform_=[1,0,0,1,0,0],i}return lfi(t,n),t.prototype.prepareTile=function(n,t,i,r){var e,f=v(n),u=n.getState();return(u===c.LOADED&&n.hifi||u===c.ERROR||u===c.ABORT)&&f in this.tileListenerKeys_&&(ct(this.tileListenerKeys_[f]),delete this.tileListenerKeys_[f]),u!==c.LOADED&&u!==c.ERROR||(this.updateExecutorGroup_(n,t,i),this.tileImageNeedsRender_(n,t,i)&&(e=!0,r&&(this.renderTileImageQueue_[f]=n))),e},t.prototype.getTile=function(t,i,r,u){var f=n.prototype.getTile.call(this,t,i,r,u),s=u.pixelRatio,h=u.viewState,l=h.resolution,y=h.projection,e,p,o;return f.getState()<c.LOADED?(f.wantedResolution=l,e=v(f),e in this.tileListenerKeys_||(p=nt(f,a.CHANGE,this.prepareTile.bind(this,f,s,y,!0)),this.tileListenerKeys_[e]=p)):(o=u.viewHints,!!(o[lr]||o[fu])&&f.wantedResolution||(f.wantedResolution=l),this.prepareTile(f,s,y,!1)&&this.renderTileImage_(f,u)),f},t.prototype.isDrawableTile=function(t){return n.prototype.isDrawableTile.call(this,t)&&t.hasContext(this.getLayer())},t.prototype.getTileImage=function(n){return n.getImage(this.getLayer())},t.prototype.prepareFrame=function(t){var i=this.getLayer().getRevision();return this.renderedLayerRevision_!=i&&(this.renderedTiles.length=0),this.renderedLayerRevision_=i,n.prototype.prepareFrame.call(this,t)},t.prototype.updateExecutorGroup_=function(n,t,i){var u=this.getLayer(),p=u.getRevision(),e=u.getRenderOrder()||null,f=n.wantedResolution,r=n.getReplayState(u),s,w;if(r.dirty||r.renderedResolution!==f||r.renderedRevision!=p||r.renderedRenderOrder!=e||r.renderedZ!==n.sourceZ){var o=u.getSource(),k=o.getTileGrid(),d=o.getTileGridForProjection(i).getTileCoordExtent(n.wrappedTileCoord),h=o.getSourceTiles(t,i,n),l=v(u),a=n.executorGroups[l];if(a)for(s=0,w=a.length;s<w;++s)a[s].dispose();n.hitDetectionImageData=null;n.executorGroups[l]=[];for(var g=function(i){var v=h[i],a,tt,p;if(v.getState()!=c.LOADED)return"continue";var it=v.tileCoord,w=k.getTileCoordExtent(it),s=vu(d,w),g=uu(w,s)?null:iu(s,u.getRenderBuffer()*f,b.tmpExtent);r.dirty=!1;var nt=new wht(0,s,f,t,u.getDeclutter()),rt=wk(f,t),ut=function(n){var t,e=n.getStyleFunction()||u.getStyleFunction(),i;(e&&(t=e(n,f)),t)&&(i=this.renderFeature(n,rt,t,nt),this.dirty_=this.dirty_||i,r.dirty=r.dirty||i)},y=v.getFeatures();for(e&&e!==r.renderedRenderOrder&&y.sort(e),a=0,tt=y.length;a<tt;++a)p=y[a],g&&!fi(g,p.getGeometry().getExtent())||ut.call(b,p);var ft=nt.finish(),et=u.getDeclutter()&&1===h.length?null:s,ot=new fg(et,f,t,o.getOverlaps(),ft,u.getRenderBuffer());n.executorGroups[l].push(ot)},b=this,y=0,nt=h.length;y<nt;++y)g(y);r.renderedRevision=p;r.renderedZ=n.sourceZ;r.renderedRenderOrder=e;r.renderedResolution=f}},t.prototype.forEachFeatureAtCoordinate=function(n,t,i,r,u){var l=t.viewState.resolution,a=t.viewState.rotation;i=null==i?0:i;for(var o,f=this.getLayer(),y=f.getDeclutter(),p=f.getSource().getTileGridForProjection(t.viewState.projection),h={},c=this.renderedTiles,w=function(){var s=c[e],w=fv(p.getTileCoordExtent(s.wrappedTileCoord),n),k;if(!y&&!w)return"continue";for(var b=s.executorGroups[v(f)],t=0,d=b.length;t<d;++t)k=b[t],o=o||k.forEachFeatureAtCoordinate(n,l,a,i,function(n){if(w||u&&-1!==u.indexOf(n)){var t=n.getId();if(void 0===t&&(t=v(n)),!(t in h))return h[t]=!0,r(n,f)}},f.getDeclutter()?u:null)},e=0,s=c.length;e<s;++e)w();return o},t.prototype.getFeatures=function(n){return new Promise(function(t){for(var p,l,w,i,o=this.getLayer(),y=o.getSource(),s=this.renderedProjection,h=s.getExtent(),u=this.renderedResolution,r=y.getTileGridForProjection(s),f=bt(this.renderedPixelToCoordinateTransform_,n.slice()),g=r.getTileCoordForCoordAndResolution(f,u),e=0,nt=this.renderedTiles.length;e<nt;++e)if(g.toString()===this.renderedTiles[e].tileCoord.toString()){if((i=this.renderedTiles[e]).getState()===c.LOADED&&i.hifi){p=r.getTileCoordExtent(i.tileCoord);y.getWrapX()&&s.canWrapX()&&!tr(h,p)&&(l=vt(h),w=Math.floor((f[0]-h[0])/l),f[0]-=w*l);break}i=void 0}if(i){var b=yr(r.getTileCoordExtent(i.wrappedTileCoord)),k=[(f[0]-b[0])/u,(b[1]-f[1])/u],a=i.getSourceTiles().reduce(function(n,t){return n.concat(t.getFeatures())},[]);if(i.hitDetectionImageData)t(ap(k,a,i.hitDetectionImageData));else{var v=hr(r.getTileSize(r.getZForResolution(u))),d=[v[0]/2,v[1]/2],tt=this.renderedRotation_,it=[this.getRenderTransform(r.getTileCoordCenter(i.wrappedTileCoord),u,0,.5,d[0],d[1],0)];requestAnimationFrame(function(){i.hitDetectionImageData=dht(v,it,a,o.getStyleFunction(),r.getTileCoordExtent(i.wrappedTileCoord),i.getReplayState(o).renderedResolution,tt);t(ap(k,a,i.hitDetectionImageData))})}}else t([])}.bind(this))},t.prototype.handleFontsChanged=function(){pe(this.renderTileImageQueue_);var n=this.getLayer();n.getVisible()&&void 0!==this.renderedLayerRevision_&&n.changed()},t.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},t.prototype.renderFrame=function(t,i){var ft=t.viewHints,y=!(ft[lr]||ft[fu]),o,p,w,b,k,e,a,ut,u,l,vt,f;if(this.renderQueuedTileImages_(y,t),n.prototype.renderFrame.call(this,t,i),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,o=this.getLayer(),p=o.getRenderMode(),p===vp.IMAGE)return this.container;w=o.getSource();b=t.usedTiles[v(w)];for(k in this.renderTileImageQueue_)b&&k in b||delete this.renderTileImageQueue_[k];for(var r=this.context,s=o.getDeclutter()?{}:null,et=vfi[p],h=t.pixelRatio,d=t.viewState,yt=d.center,pt=d.resolution,g=d.rotation,ot=t.size,wt=Math.round(ot[0]*h),bt=Math.round(ot[1]*h),st=this.renderedTiles,ht=w.getTileGridForProjection(t.viewState.projection),nt=[],ct=[],tt=st.length-1;tt>=0;--tt)if(e=st[tt],e.getState()!=c.ABORT)for(var kt=e.tileCoord,dt=ht.getTileCoordExtent(e.wrappedTileCoord),gt=ht.getTileCoordExtent(kt,this.tmpExtent)[0]-dt[0],lt=ph(cl(this.inversePixelTransform.slice(),1/h,1/h),this.getRenderTransform(yt,pt,g,h,wt,bt,gt)),at=e.executorGroups[v(o)],it=!1,rt=0,ni=at.length;rt<ni;++rt)if(a=at[rt],a.hasExecutors(et)){if(ut=e.tileCoord[0],u=void 0,!s&&!it)for(u=a.getClipCoords(lt),r.save(),l=0,vt=nt.length;l<vt;++l)f=nt[l],ut<ct[l]&&(r.beginPath(),r.moveTo(u[0],u[1]),r.lineTo(u[2],u[3]),r.lineTo(u[4],u[5]),r.lineTo(u[6],u[7]),r.moveTo(f[6],f[7]),r.lineTo(f[4],f[5]),r.lineTo(f[2],f[3]),r.lineTo(f[0],f[1]),r.clip());a.execute(r,lt,g,y,et,s);s||it||(r.restore(),nt.push(u),ct.push(ut),it=!0)}return s&&kht(s,r,g,t.layerStatesArray[t.layerIndex].opacity,y,t.declutterItems),this.container},t.prototype.renderQueuedTileImages_=function(n,t){var i,r;for(i in this.renderTileImageQueue_){if(!n&&Date.now()-t.time>8){t.animate=!0;break}r=this.renderTileImageQueue_[i];delete this.renderTileImageQueue_[i];this.renderTileImage_(r,t)}},t.prototype.renderFeature=function(n,t,i,r){var u,f,e;if(!i)return!1;if(u=!1,Array.isArray(i))for(f=0,e=i.length;f<e;++f)u=dy(r,n,i[f],t,this.boundHandleStyleImageChange_)||u;else u=dy(r,n,i,t,this.boundHandleStyleImageChange_);return u},t.prototype.tileImageNeedsRender_=function(n){var i=this.getLayer(),t=n.getReplayState(i),r=i.getRevision(),u=n.sourceZ,f=n.wantedResolution;return t.renderedTileResolution!==f||t.renderedTileRevision!==r||t.renderedTileZ!==u},t.prototype.renderTileImage_=function(n,t){var i=this.getLayer(),o=n.getReplayState(i),tt=i.getRevision(),y=n.executorGroups[v(i)],c,f,l,e,nt;o.renderedTileRevision=tt;o.renderedTileZ=n.sourceZ;var p=n.wrappedTileCoord,w=p[0],b=i.getSource(),r=t.pixelRatio,k=t.viewState.projection,s=b.getTileGridForProjection(k),it=s.getResolution(n.tileCoord[0]),h=t.pixelRatio/n.wantedResolution*it,rt=s.getResolution(w),u=n.getContext(i);r=Math.max(r,h/r);c=b.getTilePixelSize(w,r,k);u.canvas.width=c[0];u.canvas.height=c[1];f=r/h;1!==f&&(l=sl(this.tmpTransform_),cl(l,f,f),u.setTransform.apply(u,l));var d=s.getTileCoordExtent(p,this.tmpExtent),g=h/rt,a=sl(this.tmpTransform_);for(cl(a,g,-g),function(n,t,i){ph(n,hl(pv,1,0,0,1,t,i))}(a,-d[0],-d[3]),e=0,nt=y.length;e<nt;++e)y[e].execute(u,a,0,!0,afi[i.getRenderMode()]);o.renderedTileResolution=n.wantedResolution},t}(tg),yfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gs=function(n){function t(t){return n.call(this,t)||this}return yfi(t,n),t.prototype.createRenderer=function(){return new eg(this)},t}(oa);tct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();ai=function(n){function t(t,i){var r=n.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return tct(t,n),t.prototype.appendCoordinate=function(n){this.flatCoordinates?pt(this.flatCoordinates,n):this.flatCoordinates=n.slice();this.changed()},t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(n,t,i,r){return r<ns(this.getExtent(),n,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,n,t,i,r))},t.prototype.forEachSegment=function(n){return ert(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n)},t.prototype.getCoordinateAtM=function(n,t){if(this.layout!=l.XYM&&this.layout!=l.XYZM)return null;var i=void 0!==t&&t;return og(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n,i)},t.prototype.getCoordinates=function(){return wh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getCoordinateAt=function(n,t){return yp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n,t)},t.prototype.getLength=function(){return bht(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},t.prototype.getSimplifiedGeometryInternal=function(n){var i=[];return i.length=eb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n,i,0),new t(i,l.XY)},t.prototype.getType=function(){return f.LINE_STRING},t.prototype.intersectsExtent=function(n){return bv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,n)},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=al(this.flatCoordinates,0,n,this.stride);this.changed()},t}(ff);var pfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wfi=new gu({color:"rgba(0,0,0,0.2)"}),bfi=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],kfi=function(n){function t(t){var i=this,r=t||{},u=d({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},r);return delete u.maxLines,delete u.strokeStyle,delete u.targetSize,delete u.showLabels,delete u.lonLabelFormatter,delete u.latLabelFormatter,delete u.lonLabelPosition,delete u.latLabelPosition,delete u.lonLabelStyle,delete u.latLabelStyle,delete u.intervals,(i=n.call(this,u)||this).projection_=null,i.maxLat_=1/0,i.maxLon_=1/0,i.minLat_=-1/0,i.minLon_=-1/0,i.maxLatP_=1/0,i.maxLonP_=1/0,i.minLatP_=-1/0,i.minLonP_=-1/0,i.targetSize_=void 0!==r.targetSize?r.targetSize:100,i.maxLines_=void 0!==r.maxLines?r.maxLines:100,i.meridians_=[],i.parallels_=[],i.strokeStyle_=void 0!==r.strokeStyle?r.strokeStyle:wfi,i.fromLonLatTransform_=void 0,i.toLonLatTransform_=void 0,i.projectionCenterLonLat_=null,i.meridiansLabels_=null,i.parallelsLabels_=null,r.showLabels&&(i.lonLabelFormatter_=null==r.lonLabelFormatter?ry.bind(i,"EW"):r.lonLabelFormatter,i.latLabelFormatter_=null==r.latLabelFormatter?ry.bind(i,"NS"):r.latLabelFormatter,i.lonLabelPosition_=null==r.lonLabelPosition?0:r.lonLabelPosition,i.latLabelPosition_=null==r.latLabelPosition?1:r.latLabelPosition,i.lonLabelStyleBase_=new ys({text:void 0!==r.lonLabelStyle?r.lonLabelStyle.clone():new ia({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new vf({color:"rgba(0,0,0,1)"}),stroke:new gu({color:"rgba(255,255,255,1)",width:3})})}),i.lonLabelStyle_=function(n){var t=n.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(t),this.lonLabelStyleBase_}.bind(i),i.latLabelStyleBase_=new ys({text:void 0!==r.latLabelStyle?r.latLabelStyle.clone():new ia({font:"12px Calibri,sans-serif",textAlign:"right",fill:new vf({color:"rgba(0,0,0,1)"}),stroke:new gu({color:"rgba(255,255,255,1)",width:3})})}),i.latLabelStyle_=function(n){var t=n.get("graticule_label");return this.latLabelStyleBase_.getText().setText(t),this.latLabelStyleBase_}.bind(i),i.meridiansLabels_=[],i.parallelsLabels_=[]),i.intervals_=void 0!==r.intervals?r.intervals:bfi,i.setSource(new ps({loader:i.loaderFunction.bind(i),strategy:not,features:new gi,overlaps:!1,useSpatialIndex:!1,wrapX:r.wrapX})),i.featurePool_=[],i.lineStyle_=new ys({stroke:i.strokeStyle_}),i.renderedExtent_=null,i.setRenderOrder(null),i.tmpExtent_=null,i}return pfi(t,n),t.prototype.loaderFunction=function(n,t,i){var l=this.getSource(),s=vu(this.getExtent()||[-1/0,-1/0,1/0,1/0],n,this.tmpExtent_),a,v,r,c,e,u,f,o,h;if(setTimeout(function(){l.removeLoadedExtent(n)},0),!(this.renderedExtent_&&uu(this.renderedExtent_,s)||(this.renderedExtent_=s,ts(s)))){for(a=vr(s),v=t*t/4,this.projection_&&pr(this.projection_,i)||this.updateProjectionInfo_(i),this.createGraticule_(s,a,t,v),c=this.meridians_.length+this.parallels_.length,this.meridiansLabels_&&(c+=this.meridiansLabels_.length),this.parallelsLabels_&&(c+=this.parallelsLabels_.length);c>this.featurePool_.length;)r=new ui,this.featurePool_.push(r);for(e=l.getFeaturesCollection(),e.clear(),h=0,u=0,f=this.meridians_.length;u<f;++u)(r=this.featurePool_[h++]).setGeometry(this.meridians_[u]),r.setStyle(this.lineStyle_),e.push(r);for(u=0,f=this.parallels_.length;u<f;++u)(r=this.featurePool_[h++]).setGeometry(this.parallels_[u]),r.setStyle(this.lineStyle_),e.push(r);if(this.meridiansLabels_)for(u=0,f=this.meridiansLabels_.length;u<f;++u)o=this.meridiansLabels_[u],(r=this.featurePool_[h++]).setGeometry(o.geom),r.setStyle(this.lonLabelStyle_),r.set("graticule_label",o.text),e.push(r);if(this.parallelsLabels_)for(u=0,f=this.parallelsLabels_.length;u<f;++u)o=this.parallelsLabels_[u],(r=this.featurePool_[h++]).setGeometry(o.geom),r.setStyle(this.latLabelStyle_),r.set("graticule_label",o.text),e.push(r)}},t.prototype.addMeridian_=function(n,t,i,r,u,f){var e=this.getMeridian_(n,t,i,r,f),o;return fi(e.getExtent(),u)&&(this.meridiansLabels_&&(o=this.getMeridianPoint_(e,u,f),this.meridiansLabels_[f]={geom:o,text:this.lonLabelFormatter_(n)}),this.meridians_[f++]=e),f},t.prototype.addParallel_=function(n,t,i,r,u,f){var e=this.getParallel_(n,t,i,r,f),o;return fi(e.getExtent(),u)&&(this.parallelsLabels_&&(o=this.getParallelPoint_(e,u,f),this.parallelsLabels_[f]={geom:o,text:this.latLabelFormatter_(n)}),this.parallels_[f++]=e),f},t.prototype.createGraticule_=function(n,t,i,r){var o=this.getInterval_(i);if(-1==o)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var s,u,f,e,b=this.toLonLatTransform_(t),l=b[0],a=b[1],c=this.maxLines_,h=[Math.max(n[0],this.minLonP_),Math.max(n[1],this.minLatP_),Math.min(n[2],this.maxLonP_),Math.min(n[3],this.maxLatP_)],v=(h=io(h,this.projection_,"EPSG:4326"))[3],y=h[2],p=h[1],w=h[0];for(e=kt(l=Math.floor(l/o)*o,this.minLon_,this.maxLon_),u=this.addMeridian_(e,p,v,r,n,0),s=0;e!=this.minLon_&&s++<c;)e=Math.max(e-o,this.minLon_),u=this.addMeridian_(e,p,v,r,n,u);for(e=kt(l,this.minLon_,this.maxLon_),s=0;e!=this.maxLon_&&s++<c;)e=Math.min(e+o,this.maxLon_),u=this.addMeridian_(e,p,v,r,n,u);for(this.meridians_.length=u,this.meridiansLabels_&&(this.meridiansLabels_.length=u),f=kt(a=Math.floor(a/o)*o,this.minLat_,this.maxLat_),u=this.addParallel_(f,w,y,r,n,0),s=0;f!=this.minLat_&&s++<c;)f=Math.max(f-o,this.minLat_),u=this.addParallel_(f,w,y,r,n,u);for(f=kt(a,this.minLat_,this.maxLat_),s=0;f!=this.maxLat_&&s++<c;)f=Math.min(f+o,this.maxLat_),u=this.addParallel_(f,w,y,r,n,u);this.parallels_.length=u;this.parallelsLabels_&&(this.parallelsLabels_.length=u)},t.prototype.getInterval_=function(n){for(var r,f=this.projectionCenterLonLat_[0],e=this.projectionCenterLonLat_[1],o=-1,s=Math.pow(this.targetSize_*n,2),t=[],i=[],u=0,h=this.intervals_.length;u<h;++u){if(r=this.intervals_[u]/2,t[0]=f-r,t[1]=e-r,i[0]=f+r,i[1]=e+r,this.fromLonLatTransform_(t,t),this.fromLonLatTransform_(i,i),Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)<=s)break;o=this.intervals_[u]}return o},t.prototype.getMeridian_=function(n,t,i,r,u){var e=function(n,t,i,r,u){return ict(function(r){return[n,t+(i-t)*r]},tf(y("EPSG:4326"),r),u)}(n,t,i,this.projection_,r),f=this.meridians_[u];return f?(f.setFlatCoordinates(l.XY,e),f.changed()):(f=new ai(e,l.XY),this.meridians_[u]=f),f},t.prototype.getMeridianPoint_=function(n,t,i){var u,r=n.getFlatCoordinates(),e=Math.max(t[1],r[1]),o=Math.min(t[3],r[r.length-1]),s=kt(t[1]+Math.abs(t[1]-t[3])*this.lonLabelPosition_,e,o),f=[r[0],s];return i in this.meridiansLabels_?(u=this.meridiansLabels_[i].geom).setCoordinates(f):u=new si(f),u},t.prototype.getMeridians=function(){return this.meridians_},t.prototype.getParallel_=function(n,t,i,r,u){var e=function(n,t,i,r,u){return ict(function(r){return[t+(i-t)*r,n]},tf(y("EPSG:4326"),r),u)}(n,t,i,this.projection_,r),f=this.parallels_[u];return f?(f.setFlatCoordinates(l.XY,e),f.changed()):f=new ai(e,l.XY),f},t.prototype.getParallelPoint_=function(n,t,i){var u,r=n.getFlatCoordinates(),e=Math.max(t[0],r[0]),o=Math.min(t[2],r[r.length-2]),f=[kt(t[0]+Math.abs(t[0]-t[2])*this.latLabelPosition_,e,o),r[1]];return i in this.parallelsLabels_?(u=this.parallelsLabels_[i].geom).setCoordinates(f):u=new si(f),u},t.prototype.getParallels=function(){return this.parallels_},t.prototype.updateProjectionInfo_=function(n){var r=y("EPSG:4326"),t=n.getWorldExtent(),i=io(t,r,n);this.maxLat_=t[3];this.maxLon_=t[2];this.minLat_=t[1];this.minLon_=t[0];this.maxLatP_=i[3];this.maxLonP_=i[2];this.minLatP_=i[1];this.minLonP_=i[0];this.fromLonLatTransform_=tf(r,n);this.toLonLatTransform_=tf(n,r);this.projectionCenterLonLat_=this.toLonLatTransform_(vr(n.getExtent()));this.projection_=n},t}(gs),dfi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nf={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},gfi=["#00f","#0ff","#0f0","#ff0","#f00"],nei=function(n){function t(t){var i=this,r=t||{},u=d({},r),f;return delete u.gradient,delete u.radius,delete u.blur,delete u.weight,(i=n.call(this,u)||this).gradient_=null,i.addEventListener(ri(nf.GRADIENT),i.handleGradientChanged_),i.setGradient(r.gradient?r.gradient:gfi),i.setBlur(void 0!==r.blur?r.blur:15),i.setRadius(void 0!==r.radius?r.radius:8),f=r.weight?r.weight:"weight",i.weightFunction_="string"==typeof f?function(n){return n.get(f)}:f,i.setRenderOrder(null),i}return dfi(t,n),t.prototype.getBlur=function(){return this.get(nf.BLUR)},t.prototype.getGradient=function(){return this.get(nf.GRADIENT)},t.prototype.getRadius=function(){return this.get(nf.RADIUS)},t.prototype.handleGradientChanged_=function(){this.gradient_=function(n){for(var t=ci(1,256),r=t.createLinearGradient(0,0,1,256),u=1/(n.length-1),i=0,f=n.length;i<f;++i)r.addColorStop(i*u,n[i]);return t.fillStyle=r,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())},t.prototype.setBlur=function(n){this.set(nf.BLUR,n)},t.prototype.setGradient=function(n){this.set(nf.GRADIENT,n)},t.prototype.setRadius=function(n){this.set(nf.RADIUS,n)},t.prototype.createRenderer=function(){return new vht(this,{attributes:[{name:"weight",callback:function(n){var t=this.weightFunction_(n);return void 0!==t?kt(t,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(nf.RADIUS)+this.get(nf.BLUR))}.bind(this),u_blurSlope:function(){return this.get(nf.RADIUS)/Math.max(1,this.get(nf.BLUR))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:this.gradient_}}]})},t}(gs),tei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iei=function(n){function t(t){var r=this,i=t||{},u=d({},i);return delete u.imageRatio,(r=n.call(this,u)||this).imageRatio_=void 0!==i.imageRatio?i.imageRatio:1,r}return tei(t,n),t.prototype.getImageRatio=function(){return this.imageRatio_},t.prototype.createRenderer=function(){return new ght(this)},t}(oa),rei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uei=function(n){function t(t){var r=this,i=t||{},f=d({},i),u;return delete f.preload,delete f.useInterimTilesOnError,r=n.call(this,f)||this,u=i.renderMode||vp.HYBRID,p(null==u||u==vp.IMAGE||u==vp.HYBRID,28),r.renderMode_=u,r.setPreload(i.preload?i.preload:0),r.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),r}return rei(t,n),t.prototype.createRenderer=function(){return new nct(this)},t.prototype.getFeatures=function(t){return n.prototype.getFeatures.call(this,t)},t.prototype.getRenderMode=function(){return this.renderMode_},t.prototype.getPreload=function(){return this.get(hp)},t.prototype.getUseInterimTilesOnError=function(){return this.get(cp)},t.prototype.setPreload=function(n){this.set(hp,n)},t.prototype.setUseInterimTilesOnError=function(n){this.set(cp,n)},t}(oa),rct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fei="addfeatures",eei=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.features=r,f.file=i,f.projection=u,f}return rct(t,n),t}(ur);var sei=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,{handleEvent:tu})||this).formatConstructors_=i.formatConstructors?i.formatConstructors:[],r.projection_=i.projection?y(i.projection):null,r.dropListenKeys_=null,r.source_=i.source||null,r.target=i.target?i.target:null,r}return rct(t,n),t.prototype.handleResult_=function(n,t){var o=t.target.result,s=this.getMap(),i=this.projection_,e;i||(i=s.getView().getProjection());for(var f=this.formatConstructors_,r=[],u=0,h=f.length;u<h;++u)if(e=new f[u],(r=this.tryReadFeatures_(e,o,{featureProjection:i}))&&r.length>0)break;this.source_&&(this.source_.clear(),this.source_.addFeatures(r));this.dispatchEvent(new eei(fei,n,r,i))},t.prototype.registerListeners_=function(){var t=this.getMap(),n;t&&(n=this.target?this.target:t.getViewport(),this.dropListenKeys_=[nt(n,a.DROP,oei,this),nt(n,a.DRAGENTER,sg,this),nt(n,a.DRAGOVER,sg,this),nt(n,a.DROP,sg,this)])},t.prototype.setActive=function(t){!this.getActive()&&t&&this.registerListeners_();this.getActive()&&!t&&this.unregisterListeners_();n.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.unregisterListeners_();n.prototype.setMap.call(this,t);this.getActive()&&this.registerListeners_()},t.prototype.tryReadFeatures_=function(n,t,i){try{return n.readFeatures(t,i)}catch(n){return null}},t.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(ct),this.dropListenKeys_=null)},t}(ie),hei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cei=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,r)||this).condition_=r.condition?r.condition:bl,i.lastAngle_=void 0,i.lastMagnitude_=void 0,i.lastScaleDelta_=0,i.duration_=void 0!==r.duration?r.duration:400,i}return hei(t,n),t.prototype.handleDragEvent=function(n){var h;if(hf(n)){var u=n.map,f=u.getSize(),e=n.pixel,t=e[0]-f[0]/2,i=f[1]/2-e[1],o=Math.atan2(i,t),r=Math.sqrt(t*t+i*i),s=u.getView();void 0!==this.lastAngle_&&(h=this.lastAngle_-o,s.adjustRotationInternal(h));this.lastAngle_=o;void 0!==this.lastMagnitude_&&s.adjustResolutionInternal(this.lastMagnitude_/r);void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/r);this.lastMagnitude_=r}},t.prototype.handleUpEvent=function(n){if(!hf(n))return!0;var t=n.map.getView(),i=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,i),this.lastScaleDelta_=0,!1},t.prototype.handleDownEvent=function(n){return!!hf(n)&&!!this.condition_(n)&&(n.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0)},t}(ou),lei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uct=function(n){function t(t,i,r){var u=n.call(this)||this,f;return void 0!==r&&void 0===i?u.setFlatCoordinates(r,t):(f=i||0,u.setCenterAndRadius(t,f,r)),u}return lei(t,n),t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),void 0,this.layout)},t.prototype.closestPointXY=function(n,t,i,r){var f=this.flatCoordinates,o=n-f[0],s=t-f[1],e=o*o+s*s,u,h;if(e<r){if(0===e)for(u=0;u<this.stride;++u)i[u]=f[u];else for(h=this.getRadius()/Math.sqrt(e),i[0]=f[0]+h*o,i[1]=f[1]+h*s,u=2;u<this.stride;++u)i[u]=f[u];return i.length=this.stride,e}return r},t.prototype.containsXY=function(n,t){var i=this.flatCoordinates,r=n-i[0],u=t-i[1];return r*r+u*u<=this.getRadiusSquared_()},t.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.computeExtent=function(n){var t=this.flatCoordinates,i=t[this.stride]-t[0];return ru(t[0]-i,t[1]-i,t[0]+i,t[1]+i,n)},t.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},t.prototype.getRadiusSquared_=function(){var n=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return n*n+t*t},t.prototype.getType=function(){return f.CIRCLE},t.prototype.intersectsExtent=function(n){if(fi(n,this.getExtent())){var t=this.getCenter();return n[0]<=t[0]&&n[2]>=t[0]||n[1]<=t[1]&&n[3]>=t[1]||rit(n,this.intersectsCoordinate.bind(this))}return!1},t.prototype.setCenter=function(n){var i=this.stride,u=this.flatCoordinates[i]-this.flatCoordinates[0],r=n.slice(),t;for(r[i]=r[0]+u,t=1;t<i;++t)r[i+t]=n[t];this.setFlatCoordinates(this.layout,r);this.changed()},t.prototype.setCenterAndRadius=function(n,t,i){var r,u,f,e;for(this.setLayout(i,n,0),this.flatCoordinates||(this.flatCoordinates=[]),r=this.flatCoordinates,u=irt(r,0,n,this.stride),r[u++]=r[0]+t,f=1,e=this.stride;f<e;++f)r[u++]=r[f];r.length=u;this.changed()},t.prototype.getCoordinates=function(){return null},t.prototype.setCoordinates=function(){},t.prototype.setRadius=function(n){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+n;this.changed()},t.prototype.rotate=function(n,t){var i=this.getCenter(),r=this.getStride();this.setCenter(uit(i,0,i.length,r,n,t,i));this.changed()},t.prototype.translate=function(n,t){var i=this.getCenter(),r=this.getStride();this.setCenter(fit(i,0,i.length,r,n,t,i));this.changed()},t}(ff);uct.prototype.transform;var hg=uct,aei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),au=function(n){function t(t,i,r){var u=n.call(this)||this,o;if(u.ends_=[],u.maxDelta_=-1,u.maxDeltaRevision_=-1,Array.isArray(t[0]))u.setCoordinates(t,i);else if(void 0!==i&&r)u.setFlatCoordinates(i,t),u.ends_=r;else{for(var s=u.getLayout(),h=t,e=[],c=[],f=0,l=h.length;f<l;++f)o=h[f],0===f&&(s=o.getLayout()),pt(e,o.getFlatCoordinates()),c.push(e.length);u.setFlatCoordinates(s,e);u.ends_=c}return u}return aei(t,n),t.prototype.appendLineString=function(n){this.flatCoordinates?pt(this.flatCoordinates,n.getFlatCoordinates().slice()):this.flatCoordinates=n.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()},t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},t.prototype.closestPointXY=function(n,t,i,r){return r<ns(this.getExtent(),n,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ib(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ub(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,n,t,i,r))},t.prototype.getCoordinateAtM=function(n,t,i){if(this.layout!=l.XYM&&this.layout!=l.XYZM||0===this.flatCoordinates.length)return null;var r=void 0!==t&&t,u=void 0!==i&&i;return function(n,t,i,r,u,f,e){var s,h,c,o;if(e)return og(n,t,i[i.length-1],r,u,f);if(u<n[r-1])return f?((s=n.slice(0,r))[r-1]=u,s):null;if(n[n.length-1]<u)return f?((s=n.slice(n.length-r))[r-1]=u,s):null;for(h=0,c=i.length;h<c;++h)if(o=i[h],t!=o){if(u<n[t+r-1])return null;if(u<=n[o-1])return og(n,t,o,r,u,!1);t=o}return null}(this.flatCoordinates,0,this.ends_,this.stride,n,r,u)},t.prototype.getCoordinates=function(){return wv(this.flatCoordinates,0,this.ends_,this.stride)},t.prototype.getEnds=function(){return this.ends_},t.prototype.getLineString=function(n){return n<0||this.ends_.length<=n?null:new ai(this.flatCoordinates.slice(0===n?0:this.ends_[n-1],this.ends_[n]),this.layout)},t.prototype.getLineStrings=function(){for(var t,f,e=this.flatCoordinates,i=this.ends_,o=this.layout,r=[],u=0,n=0,s=i.length;n<s;++n)t=i[n],f=new ai(e.slice(u,t),o),r.push(f),u=t;return r},t.prototype.getFlatMidpoints=function(){for(var t,i=[],f=this.flatCoordinates,r=0,u=this.ends_,e=this.stride,n=0,o=u.length;n<o;++n)t=u[n],pt(i,yp(f,r,t,e,.5)),r=t;return i},t.prototype.getSimplifiedGeometryInternal=function(n){var i=[],r=[];return i.length=ubt(this.flatCoordinates,0,this.ends_,this.stride,n,i,0,r),new t(i,l.XY,r)},t.prototype.getType=function(){return f.MULTI_LINE_STRING},t.prototype.intersectsExtent=function(n){return function(n,t,i,r,u){for(var f=0,e=i.length;f<e;++f){if(bv(n,t,i[f],r,u))return!0;t=i[f]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,n)},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,2);this.flatCoordinates||(this.flatCoordinates=[]);var i=fb(this.flatCoordinates,0,n,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1];this.changed()},t}(ff),vei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wf=function(n){function t(t,i){var r=n.call(this)||this;return i&&!Array.isArray(t[0])?r.setFlatCoordinates(i,t):r.setCoordinates(t,i),r}return vei(t,n),t.prototype.appendPoint=function(n){this.flatCoordinates?pt(this.flatCoordinates,n.getFlatCoordinates()):this.flatCoordinates=n.getFlatCoordinates().slice();this.changed()},t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(n,t,i,r){var s,f;if(r<ns(this.getExtent(),n,t))return r;for(var e=this.flatCoordinates,o=this.stride,u=0,h=e.length;u<h;u+=o)if(s=is(n,t,e[u],e[u+1]),s<r){for(r=s,f=0;f<o;++f)i[f]=e[u+f];i.length=o}return r},t.prototype.getCoordinates=function(){return wh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getPoint=function(n){var t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return n<0||t<=n?null:new si(this.flatCoordinates.slice(n*this.stride,(n+1)*this.stride),this.layout)},t.prototype.getPoints=function(){for(var u,t=this.flatCoordinates,f=this.layout,i=this.stride,r=[],n=0,e=t.length;n<e;n+=i)u=new si(t.slice(n,n+i),f),r.push(u);return r},t.prototype.getType=function(){return f.MULTI_POINT},t.prototype.intersectsExtent=function(n){for(var i=this.flatCoordinates,r=this.stride,t=0,u=i.length;t<u;t+=r)if(ev(n,i[t],i[t+1]))return!0;return!1},t.prototype.setCoordinates=function(n,t){this.setLayout(t,n,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=al(this.flatCoordinates,0,n,this.stride);this.changed()},t}(ff);var yei=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bf=function(n){function t(t,i,r){var u=n.call(this)||this,e;if(u.endss_=[],u.flatInteriorPointsRevision_=-1,u.flatInteriorPoints_=null,u.maxDelta_=-1,u.maxDeltaRevision_=-1,u.orientedRevision_=-1,u.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var c=u.getLayout(),l=t,o=[],a=[],f=0,v=l.length;f<v;++f){e=l[f];0===f&&(c=e.getLayout());for(var y=o.length,s=e.getEnds(),h=0,p=s.length;h<p;++h)s[h]+=y;pt(o,e.getFlatCoordinates());a.push(s)}i=c;t=o;r=a}return void 0!==i&&r?(u.setFlatCoordinates(i,t),u.endss_=r):u.setCoordinates(t,i),u}return yei(t,n),t.prototype.appendPolygon=function(n){var t,r,i,u;if(this.flatCoordinates)for(r=this.flatCoordinates.length,pt(this.flatCoordinates,n.getFlatCoordinates()),i=0,u=(t=n.getEnds().slice()).length;i<u;++i)t[i]+=r;else this.flatCoordinates=n.getFlatCoordinates().slice(),t=n.getEnds().slice(),this.endss_.push();this.endss_.push(t);this.changed()},t.prototype.clone=function(){for(var i=this.endss_.length,r=new Array(i),n=0;n<i;++n)r[n]=this.endss_[n].slice();return new t(this.flatCoordinates.slice(),this.layout,r)},t.prototype.closestPointXY=function(n,t,i,r){return r<ns(this.getExtent(),n,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(n,t,i,r,u){for(var e,f=0,o=i.length;f<o;++f)e=i[f],u=ib(n,t,e,r,u),t=e[e.length-1];return u}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(n,t,i,r,u,f,e,o,s,h,c){for(var l,v=c||[NaN,NaN],a=0,y=i.length;a<y;++a)l=i[a],h=ub(n,t,l,r,u,f,e,o,s,h,v),t=l[l.length-1];return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,n,t,i,r))},t.prototype.containsXY=function(n,t){return function(n,t,i,r,u,f){var e,s,o;if(0===i.length)return!1;for(e=0,s=i.length;e<s;++e){if(o=i[e],ob(n,t,o,r,u,f))return!0;t=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,n,t)},t.prototype.getArea=function(){return function(n,t,i,r){for(var u,e=0,f=0,o=i.length;f<o;++f)u=i[f],e+=nrt(n,t,u,r),t=u[u.length-1];return e}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},t.prototype.getCoordinates=function(n){var t;return void 0!==n?hrt(t=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,n):t=this.flatCoordinates,rrt(t,0,this.endss_,this.stride)},t.prototype.getEndss=function(){return this.endss_},t.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var n=fct(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=frt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,n);this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},t.prototype.getInteriorPoints=function(){return new wf(this.getFlatInteriorPoints().slice(),l.XYM)},t.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var n=this.flatCoordinates;(function(n,t,i,r,u){for(var f,e=0,o=i.length;e<o;++e){if(f=i[e],!srt(n,t,f,r,u))return!1;f.length&&(t=f[f.length-1])}return!0})(n,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=n:(this.orientedFlatCoordinates_=n.slice(),this.orientedFlatCoordinates_.length=hrt(this.orientedFlatCoordinates_,0,this.endss_,this.stride));this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},t.prototype.getSimplifiedGeometryInternal=function(n){var i=[],r=[];return i.length=function(n,t,i,r,u,f,e,o){for(var h,c,s=0,l=i.length;s<l;++s)h=i[s],c=[],e=urt(n,t,h,r,u,f,e,c),o.push(c),t=h[h.length-1];return e}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(n),i,0,r),new t(i,l.XY,r)},t.prototype.getPolygon=function(n){var i,u,t,f,r,e;if(n<0||this.endss_.length<=n)return null;if(0===n?i=0:(u=this.endss_[n-1],i=u[u.length-1]),t=this.endss_[n].slice(),f=t[t.length-1],0!==i)for(r=0,e=t.length;r<e;++r)t[r]-=i;return new fr(this.flatCoordinates.slice(i,f),this.layout,t)},t.prototype.getPolygons=function(){for(var n,u,i,o,s,h=this.layout,c=this.flatCoordinates,f=this.endss_,e=[],t=0,r=0,l=f.length;r<l;++r){if(n=f[r].slice(),u=n[n.length-1],0!==t)for(i=0,o=n.length;i<o;++i)n[i]-=t;s=new fr(c.slice(t,u),h,n);e.push(s);t=u}return e},t.prototype.getType=function(){return f.MULTI_POLYGON},t.prototype.intersectsExtent=function(n){return function(n,t,i,r,u){for(var e,f=0,o=i.length;f<o;++f){if(e=i[f],ort(n,t,e,r,u))return!0;t=e[e.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,n)},t.prototype.setCoordinates=function(n,t){var i,r;this.setLayout(t,n,3);this.flatCoordinates||(this.flatCoordinates=[]);i=function(n,t,i,r,u){for(var e,f=u||[],o=0,s=0,h=i.length;s<h;++s)e=fb(n,t,i[s],r,f[o]),f[o++]=e,t=e[e.length-1];return f.length=o,f}(this.flatCoordinates,0,n,this.stride,this.endss_);0===i.length?this.flatCoordinates.length=0:(r=i[i.length-1],this.flatCoordinates.length=0===r.length?0:r[r.length-1]);this.changed()},t}(ff),ect=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ii={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},oct="drawstart",pei="drawend",cg=function(n){function t(t,i){var r=n.call(this,t)||this;return r.feature=i,r}return ect(t,n),t}(ur),wei=function(n){function t(t){var i=this,o=t,s,r,e,u;return o.stopDown||(o.stopDown=go),(i=n.call(this,o)||this).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=t.source?t.source:null,i.features_=t.features?t.features:null,i.snapTolerance_=t.snapTolerance?t.snapTolerance:12,i.type_=t.type,i.mode_=function(n){var t;return n===f.POINT||n===f.MULTI_POINT?t=ii.POINT:n===f.LINE_STRING||n===f.MULTI_LINE_STRING?t=ii.LINE_STRING:n===f.POLYGON||n===f.MULTI_POLYGON?t=ii.POLYGON:n===f.CIRCLE&&(t=ii.CIRCLE),t}(i.type_),i.stopClick_=!!t.stopClick,i.minPoints_=t.minPoints?t.minPoints:i.mode_===ii.POLYGON?3:2,i.maxPoints_=t.maxPoints?t.maxPoints:1/0,i.finishCondition_=t.finishCondition?t.finishCondition:tu,r=t.geometryFunction,r||(i.type_===f.CIRCLE?r=function(n,t){var i=t||new hg([NaN,NaN]),r=eu(n[0],n[1]);return i.setCenterAndRadius(n[0],Math.sqrt(r)),i}:(u=i.mode_,u===ii.POINT?e=si:u===ii.LINE_STRING?e=ai:u===ii.POLYGON&&(e=fr),r=function(n,t){var i=t;return i?u===ii.POLYGON?n[0].length?i.setCoordinates([n[0].concat([n[0][0]])]):i.setCoordinates([]):i.setCoordinates(n):i=new e(n),i})),i.geometryFunction_=r,i.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,i.overlay_=new gs({source:new ps({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(s=ta(),function(n){return s[n.getGeometry().getType()]}),updateWhileInteracting:!0}),i.geometryName_=t.geometryName,i.condition_=t.condition?t.condition:py,i.freehandCondition_,i.freehandCondition_=t.freehand?wl:t.freehandCondition?t.freehandCondition:bl,i.addEventListener(ri(pl.ACTIVE),i.updateState_),i}return ect(t,n),t.prototype.setMap=function(t){n.prototype.setMap.call(this,t);this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===a.CONTEXTMENU&&t.preventDefault();this.freehand_=this.mode_!==ii.POINT&&this.freehandCondition_(t);var r=t.type===st.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===st.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,r=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===st.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),i=!1):this.freehand_&&t.type===st.POINTERDOWN?i=!1:r?(i=t.type===st.POINTERMOVE)&&this.freehand_?i=this.handlePointerMove_(t):("mouse"==t.pointerEvent.pointerType||t.type===st.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===st.DBLCLICK&&(i=!1),n.prototype.handleEvent.call(this,t)&&i},t.prototype.handleDownEvent=function(n){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=n.pixel,this.finishCoordinate_||this.startDrawing_(n),!0):this.condition_(n)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new ro(st.POINTERMOVE,n.map,n.pointerEvent,!1,n.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=n.pixel,!0):(this.lastDragTime_=void 0,!1)},t.prototype.handleUpEvent=function(n){var t=!0,i;return this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(n),i=this.mode_===ii.CIRCLE,this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(n)?this.finishCondition_(n)&&this.finishDrawing():this.addToDrawing_(n):(this.startDrawing_(n),this.mode_===ii.POINT&&this.finishDrawing()),t=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!t&&this.stopClick_&&n.stopPropagation(),t},t.prototype.handlePointerMove_=function(n){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,i=n.pixel,r=t[0]-i[0],u=t[1]-i[1],f=r*r+u*u;if(this.shouldHandle_=this.freehand_?f>this.squaredClickTolerance_:f<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(n):this.createOrUpdateSketchPoint_(n),!0},t.prototype.atFinish_=function(n){var f=!1,i,r,t;if(this.sketchFeature_&&(i=!1,r=[this.finishCoordinate_],this.mode_===ii.LINE_STRING?i=this.sketchCoords_.length>this.minPoints_:this.mode_===ii.POLYGON&&(t=this.sketchCoords_,i=t[0].length>this.minPoints_,r=[t[0][0],t[0][t[0].length-2]]),i))for(var l=n.map,u=0,a=r.length;u<a;u++){var e=r[u],o=l.getPixelFromCoordinate(e),s=n.pixel,h=s[0]-o[0],c=s[1]-o[1],v=this.freehand_?1:this.snapTolerance_;if(f=Math.sqrt(h*h+c*c)<=v){this.finishCoordinate_=e;break}}return f},t.prototype.createOrUpdateSketchPoint_=function(n){var t=n.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new ui(new si(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(n){var t=n.coordinate,i;this.finishCoordinate_=t;this.mode_===ii.POINT?this.sketchCoords_=t.slice():this.mode_===ii.POLYGON?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()];this.sketchLineCoords_&&(this.sketchLine_=new ui(new ai(this.sketchLineCoords_)));i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new ui;this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_);this.sketchFeature_.setGeometry(i);this.updateSketchFeatures_();this.dispatchEvent(new cg(oct,this.sketchFeature_))},t.prototype.modifyDrawing_=function(n){var u,i,t,e=n.coordinate,o=this.sketchFeature_.getGeometry(),r;(this.mode_===ii.POINT?i=this.sketchCoords_:this.mode_===ii.POLYGON?(i=(u=this.sketchCoords_[0])[u.length-1],this.atFinish_(n)&&(e=this.finishCoordinate_.slice())):i=(u=this.sketchCoords_)[u.length-1],i[0]=e[0],i[1]=e[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(e);o.getType()==f.POLYGON&&this.mode_!==ii.POLYGON?(this.sketchLine_||(this.sketchLine_=new ui),r=o.getLinearRing(0),(t=this.sketchLine_.getGeometry())?(t.setFlatCoordinates(r.getLayout(),r.getFlatCoordinates()),t.changed()):(t=new ai(r.getFlatCoordinates(),r.getLayout()),this.sketchLine_.setGeometry(t))):this.sketchLineCoords_&&(t=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(n){var i,t,r=n.coordinate,u=this.sketchFeature_.getGeometry();this.mode_===ii.LINE_STRING?(this.finishCoordinate_=r.slice(),(t=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?t.pop():i=!0),t.push(r.slice()),this.geometryFunction_(t,u)):this.mode_===ii.POLYGON&&((t=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?t.pop():i=!0),t.push(r.slice()),i&&(this.finishCoordinate_=t[0]),this.geometryFunction_(this.sketchCoords_,u));this.updateSketchFeatures_();i&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var n,t=this.sketchFeature_.getGeometry();this.mode_===ii.LINE_STRING?((n=this.sketchCoords_).splice(-2,1),this.geometryFunction_(n,t),n.length>=2&&(this.finishCoordinate_=n[n.length-2].slice())):this.mode_===ii.POLYGON&&((n=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(n),this.geometryFunction_(this.sketchCoords_,t));0===n.length&&(this.finishCoordinate_=null);this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var t=this.abortDrawing_(),n,i;t&&(n=this.sketchCoords_,i=t.getGeometry(),this.mode_===ii.LINE_STRING?(n.pop(),this.geometryFunction_(n,i)):this.mode_===ii.POLYGON&&(n[0].pop(),this.geometryFunction_(n,i),n=i.getCoordinates()),this.type_===f.MULTI_POINT?t.setGeometry(new wf([n])):this.type_===f.MULTI_LINE_STRING?t.setGeometry(new au([n])):this.type_===f.MULTI_POLYGON&&t.setGeometry(new bf([n])),this.dispatchEvent(new cg(pei,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t))},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var n=this.sketchFeature_;return n&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),n},t.prototype.extend=function(n){var i=n.getGeometry(),t;this.sketchFeature_=n;this.sketchCoords_=i.getCoordinates();t=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=t.slice();this.sketchCoords_.push(t.slice());this.updateSketchFeatures_();this.dispatchEvent(new cg(oct,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var n=[],t;this.sketchFeature_&&n.push(this.sketchFeature_);this.sketchLine_&&n.push(this.sketchLine_);this.sketchPoint_&&n.push(this.sketchPoint_);t=this.overlay_.getSource();t.clear(!0);t.addFeatures(n)},t.prototype.updateState_=function(){var n=this.getMap(),t=this.getActive();n&&t||this.abortDrawing_();this.overlay_.setMap(t?n:null)},t}(ou),sct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bei={EXTENTCHANGED:"extentchanged"},kei=function(n){function t(t){var i=n.call(this,bei.EXTENTCHANGED)||this;return i.extent=t,i}return sct(t,n),t}(ur);var noi=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,r)||this).extent_=null,i.pointerHandler_=null,i.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.snappedToVertex_=!1,i.extentFeature_=null,i.vertexFeature_=null,t||(t={}),i.extentOverlay_=new gs({source:new ps({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:dei(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.vertexOverlay_=new gs({source:new ps({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:gei(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&i.setExtent(t.extent),i}return sct(t,n),t.prototype.snapToVertex_=function(n,t){var r=t.getCoordinateFromPixelInternal(n),o=this.getExtentInternal(),u;if(o){u=function(n){return[[[n[0],n[1]],[n[0],n[3]]],[[n[0],n[3]],[n[2],n[3]]],[[n[2],n[3]],[n[2],n[1]]],[[n[2],n[1]],[n[0],n[1]]]]}(o);u.sort(function(n,t){return ey(r,n)-ey(r,t)});var i=u[0],f=iy(r,i),e=t.getPixelFromCoordinateInternal(f);if(fy(n,e)<=this.pixelTolerance_){var c=t.getPixelFromCoordinateInternal(i[0]),l=t.getPixelFromCoordinateInternal(i[1]),s=eu(e,c),h=eu(e,l),a=Math.sqrt(Math.min(s,h));return this.snappedToVertex_=a<=this.pixelTolerance_,this.snappedToVertex_&&(f=s>h?i[1]:i[0]),f}}return null},t.prototype.handlePointerMove_=function(n){var i=n.pixel,r=n.map,t=this.snapToVertex_(i,r);t||(t=r.getCoordinateFromPixelInternal(i));this.createOrUpdatePointerFeature_(t)},t.prototype.createOrUpdateExtentFeature_=function(n){var t=this.extentFeature_;return t?n?t.setGeometry(es(n)):t.setGeometry(void 0):(t=new ui(n?es(n):{}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},t.prototype.createOrUpdatePointerFeature_=function(n){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(n):(t=new ui(new si(n)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(t.type!=st.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),n.prototype.handleEvent.call(this,t),!1)},t.prototype.handleDownEvent=function(n){var e=n.pixel,o=n.map,t=this.getExtentInternal(),i=this.snapToVertex_(e,o),r=function(n){var i=null,r=null;return n[0]==t[0]?i=t[2]:n[0]==t[2]&&(i=t[0]),n[1]==t[1]?r=t[3]:n[1]==t[3]&&(r=t[1]),null!==i&&null!==r?[i,r]:null},u,f;return i&&t?(u=i[0]==t[0]||i[0]==t[2]?i[0]:null,f=i[1]==t[1]||i[1]==t[3]?i[1]:null,null!==u&&null!==f?this.pointerHandler_=hct(r(i)):null!==u?this.pointerHandler_=cct(r([u,t[1]]),r([u,t[3]])):null!==f&&(this.pointerHandler_=cct(r([t[0],f]),r([t[2],f])))):(i=o.getCoordinateFromPixelInternal(e),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=hct(i)),!0},t.prototype.handleDragEvent=function(n){if(this.pointerHandler_){var t=n.coordinate;this.setExtent(this.pointerHandler_(t));this.createOrUpdatePointerFeature_(t)}return!0},t.prototype.handleUpEvent=function(){this.pointerHandler_=null;var n=this.getExtentInternal();return n&&0!==sv(n)||this.setExtent(null),!1},t.prototype.setMap=function(t){this.extentOverlay_.setMap(t);this.vertexOverlay_.setMap(t);n.prototype.setMap.call(this,t)},t.prototype.getExtent=function(){return ol(this.getExtentInternal(),this.getMap().getView().getProjection())},t.prototype.getExtentInternal=function(){return this.extent_},t.prototype.setExtent=function(n){this.extent_=n||null;this.createOrUpdateExtentFeature_(n);this.dispatchEvent(new kei(this.extent_))},t}(ou),lct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aa=1,act=[0,0,0,0],sc=[],toi="modifystart",vct="modifyend",lg=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.features=i,u.mapBrowserEvent=r,u}return lct(t,n),t}(ur);var uoi=function(n){function t(t){var r,i=n.call(this,t)||this;if(i.boundHandleFeatureChange_=i.handleFeatureChange_.bind(i),i.condition_=t.condition?t.condition:sk,i.defaultDeleteCondition_=function(n){return tft(n)&&ek(n)},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:wl,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.modified_=!1,i.rBush_=new ep,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new gs({source:new ps({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:roi(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(i),LineString:i.writeLineStringGeometry_.bind(i),LinearRing:i.writeLineStringGeometry_.bind(i),Polygon:i.writePolygonGeometry_.bind(i),MultiPoint:i.writeMultiPointGeometry_.bind(i),MultiLineString:i.writeMultiLineStringGeometry_.bind(i),MultiPolygon:i.writeMultiPolygonGeometry_.bind(i),Circle:i.writeCircleGeometry_.bind(i),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(i)},i.source_=null,t.source?(i.source_=t.source,r=new gi(i.source_.getFeatures()),i.source_.addEventListener(dr.ADDFEATURE,i.handleSourceAdd_.bind(i)),i.source_.addEventListener(dr.REMOVEFEATURE,i.handleSourceRemove_.bind(i))):r=t.features,!r)throw new Error("The modify interaction requires features or a source");return i.features_=r,i.features_.forEach(i.addFeature_.bind(i)),i.features_.addEventListener(yi.ADD,i.handleFeatureAdd_.bind(i)),i.features_.addEventListener(yi.REMOVE,i.handleFeatureRemove_.bind(i)),i.lastPointerEvent_=null,i}return lct(t,n),t.prototype.addFeature_=function(n){var i=n.getGeometry(),r,t;i&&(r=this.SEGMENT_WRITERS_[i.getType()],r&&r(n,i));t=this.getMap();t&&t.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,t);n.addEventListener(a.CHANGE,this.boundHandleFeatureChange_)},t.prototype.willModifyFeatures_=function(n){this.modified_||(this.modified_=!0,this.dispatchEvent(new lg(toi,this.features_,n)))},t.prototype.removeFeature_=function(n){this.removeFeatureSegmentData_(n);this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);n.removeEventListener(a.CHANGE,this.boundHandleFeatureChange_)},t.prototype.removeFeatureSegmentData_=function(n){var f=this.rBush_,r=[],i,u,t;for(f.forEach(function(t){n===t.feature&&r.push(t)}),i=r.length-1;i>=0;--i){for(u=r[i],t=this.dragSegments_.length-1;t>=0;--t)this.dragSegments_[t][0]===u&&this.dragSegments_.splice(t,1);f.remove(u)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);n.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t);n.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(n){n.feature&&this.features_.push(n.feature)},t.prototype.handleSourceRemove_=function(n){n.feature&&this.features_.remove(n.feature)},t.prototype.handleFeatureAdd_=function(n){this.addFeature_(n.element)},t.prototype.handleFeatureChange_=function(n){if(!this.changingFeature_){var t=n.target;this.removeFeature_(t);this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(n){var t=n.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(n,t){var i=t.getCoordinates(),r={feature:n,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),r)},t.prototype.writeMultiPointGeometry_=function(n,t){for(var r,f,u=t.getCoordinates(),i=0,e=u.length;i<e;++i)r=u[i],f={feature:n,geometry:t,depth:[i],index:i,segment:[r,r]},this.rBush_.insert(t.getExtent(),f)},t.prototype.writeLineStringGeometry_=function(n,t){for(var r,f,u=t.getCoordinates(),i=0,e=u.length-1;i<e;++i)r=u.slice(i,i+2),f={feature:n,geometry:t,index:i,segment:r},this.rBush_.insert(oi(r),f)},t.prototype.writeMultiLineStringGeometry_=function(n,t){for(var u,o,f=t.getCoordinates(),r=0,s=f.length;r<s;++r)for(var e=f[r],i=0,h=e.length-1;i<h;++i)u=e.slice(i,i+2),o={feature:n,geometry:t,depth:[r],index:i,segment:u},this.rBush_.insert(oi(u),o)},t.prototype.writePolygonGeometry_=function(n,t){for(var u,o,f=t.getCoordinates(),r=0,s=f.length;r<s;++r)for(var e=f[r],i=0,h=e.length-1;i<h;++i)u=e.slice(i,i+2),o={feature:n,geometry:t,depth:[r],index:i,segment:u},this.rBush_.insert(oi(u),o)},t.prototype.writeMultiPolygonGeometry_=function(n,t){for(var f,h,e=t.getCoordinates(),r=0,c=e.length;r<c;++r)for(var o=e[r],u=0,l=o.length;u<l;++u)for(var s=o[u],i=0,a=s.length-1;i<a;++i)f=s.slice(i,i+2),h={feature:n,geometry:t,depth:[u,r],index:i,segment:f},this.rBush_.insert(oi(f),h)},t.prototype.writeCircleGeometry_=function(n,t){var i=t.getCenter(),r={feature:n,geometry:t,index:0,segment:[i,i]},u={feature:n,geometry:t,index:aa,segment:[i,i]},f=[r,u];r.featureSegments=f;u.featureSegments=f;this.rBush_.insert(sh(i),r);this.rBush_.insert(t.getExtent(),u)},t.prototype.writeGeometryCollectionGeometry_=function(n,t){for(var u,r=t.getGeometriesArray(),i=0;i<r.length;++i)u=r[i],this.SEGMENT_WRITERS_[u.getType()](n,u)},t.prototype.createOrUpdateVertexFeature_=function(n){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(n):(t=new ui(new si(n)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=st.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(i=!(t.type!=st.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==st.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),n.prototype.handleEvent.call(this,t)&&!i);var i},t.prototype.handleDragEvent=function(n){this.ignoreNextSingleClick_=!1;this.willModifyFeatures_(n);for(var t=n.coordinate,s=0,l=this.dragSegments_.length;s<l;++s){for(var c=this.dragSegments_[s],u=c[0],h=u.depth,i=u.geometry,e=void 0,r=u.segment,o=c[1];t.length<i.getStride();)t.push(r[o][t.length]);switch(i.getType()){case f.POINT:e=t;r[0]=t;r[1]=t;break;case f.MULTI_POINT:(e=i.getCoordinates())[u.index]=t;r[0]=t;r[1]=t;break;case f.LINE_STRING:(e=i.getCoordinates())[u.index+o]=t;r[o]=t;break;case f.MULTI_LINE_STRING:case f.POLYGON:(e=i.getCoordinates())[h[0]][u.index+o]=t;r[o]=t;break;case f.MULTI_POLYGON:(e=i.getCoordinates())[h[1]][h[0]][u.index+o]=t;r[o]=t;break;case f.CIRCLE:r[0]=t;r[1]=t;0===u.index?(this.changingFeature_=!0,i.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,i.setRadius(fy(i.getCenter(),t)),this.changingFeature_=!1)}e&&this.setGeometryCoordinates_(i,e)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(n){var a,h,o,y,s;if(!this.condition_(n))return!1;if(this.handlePointerAtPixel_(n.pixel,n.map),a=n.coordinate,this.dragSegments_.length=0,this.modified_=!1,h=this.vertexFeature_,h){var w=n.map.getView().getProjection(),e=[],u=h.getGeometry().getCoordinates(),b=oi([u]),c=this.rBush_.getInExtent(b),r={};for(c.sort(ioi),o=0,y=c.length;o<y;++o){var t=c[o],l=t.segment,i=v(t.feature),p=t.depth;if(p&&(i+="-"+p.join("-")),r[i]||(r[i]=new Array(2)),t.geometry.getType()!==f.CIRCLE||t.index!==aa)if(!ef(l[0],u)||r[i][0])if(!ef(l[1],u)||r[i][1])v(l)in this.vertexSegments_&&!r[i][0]&&!r[i][1]&&this.insertVertexCondition_(n)&&e.push([t,u]);else{if((t.geometry.getType()===f.LINE_STRING||t.geometry.getType()===f.MULTI_LINE_STRING)&&r[i][0]&&0===r[i][0].index)continue;this.dragSegments_.push([t,1]);r[i][1]=t}else this.dragSegments_.push([t,0]),r[i][0]=t;else ef(pct(a,t,w),u)&&!r[i][0]&&(this.dragSegments_.push([t,0]),r[i][0]=t)}for(e.length&&this.willModifyFeatures_(n),s=e.length-1;s>=0;--s)this.insertVertex_.apply(this,e[s])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(n){for(var t,u,r=this.dragSegments_.length-1;r>=0;--r)if(t=this.dragSegments_[r][0],u=t.geometry,u.getType()===f.CIRCLE){var i=u.getCenter(),e=t.featureSegments[0],o=t.featureSegments[1];e.segment[0]=i;e.segment[1]=i;o.segment[0]=i;o.segment[1]=i;this.rBush_.update(sh(i),e);this.rBush_.update(u.getExtent(),o)}else this.rBush_.update(oi(t.segment),t);return this.modified_&&(this.dispatchEvent(new lg(vct,this.features_,n)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(n){this.lastPixel_=n.pixel;this.handlePointerAtPixel_(n.pixel,n.map)},t.prototype.handlePointerAtPixel_=function(n,t){var o=t.getCoordinateFromPixel(n),u=t.getView().getProjection(),k=ol(iu(uf(sh(o,act),u),t.getView().getResolution()*this.pixelTolerance_,act),u),e=this.rBush_.getInExtent(k),c,l,b,r;if(e.length>0){e.sort(function(n,t){return yct(o,n,u)-yct(o,t,u)});var s=e[0],i=s.segment,h=pct(o,s,u),a=t.getPixelFromCoordinate(h),y=fy(n,a);if(y<=this.pixelTolerance_){if(c={},s.geometry.getType()===f.CIRCLE&&s.index===aa)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h);else{var d=t.getPixelFromCoordinate(i[0]),g=t.getPixelFromCoordinate(i[1]),p=eu(a,d),w=eu(a,g);for(y=Math.sqrt(Math.min(p,w)),this.snappedToVertex_=y<=this.pixelTolerance_,this.snappedToVertex_&&(h=p>w?i[1]:i[0]),this.createOrUpdateVertexFeature_(h),l=1,b=e.length;l<b;++l){if(r=e[l].segment,!(ef(i[0],r[0])&&ef(i[1],r[1])||ef(i[0],r[1])&&ef(i[1],r[0])))break;c[v(r)]=!0}}return c[v(i)]=!0,void(this.vertexSegments_=c)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(n,t){for(var o,s,h,e,c=n.segment,l=n.feature,i=n.geometry,r=n.depth,u=n.index;t.length<i.getStride();)t.push(0);switch(i.getType()){case f.MULTI_LINE_STRING:case f.POLYGON:(e=i.getCoordinates())[r[0]].splice(u+1,0,t);break;case f.MULTI_POLYGON:(e=i.getCoordinates())[r[1]][r[0]].splice(u+1,0,t);break;case f.LINE_STRING:(e=i.getCoordinates()).splice(u+1,0,t);break;default:return}this.setGeometryCoordinates_(i,e);o=this.rBush_;o.remove(n);this.updateSegmentIndices_(i,u,r,1);s={segment:[c[0],t],feature:l,geometry:i,depth:r,index:u};o.insert(oi(s.segment),s);this.dragSegments_.push([s,1]);h={segment:[t,c[1]],feature:l,geometry:i,depth:r,index:u+1};o.insert(oi(h.segment),h);this.dragSegments_.push([h,0]);this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){var n,t;return this.lastPointerEvent_&&this.lastPointerEvent_.type!=st.POINTERDRAG?(n=this.lastPointerEvent_,this.willModifyFeatures_(n),t=this.removeVertex_(),this.dispatchEvent(new lg(vct,this.features_,n)),this.modified_=!1,t):!1},t.prototype.removeVertex_=function(){for(var i,o,p,c,u,e,a,s,n,t,w=this.dragSegments_,r={},h=!1,y,b,l=w.length-1;l>=0;--l)t=v((n=(p=w[l])[0]).feature),n.depth&&(t+="-"+n.depth.join("-")),t in r||(r[t]={}),0===p[1]?(r[t].right=n,r[t].index=n.index):1==p[1]&&(r[t].left=n,r[t].index=n.index+1);for(t in r){switch(s=r[t].right,e=r[t].left,(a=(u=r[t].index)-1)<0&&(a=0),i=o=(c=(n=void 0!==e?e:s).geometry).getCoordinates(),h=!1,c.getType()){case f.MULTI_LINE_STRING:o[n.depth[0]].length>2&&(o[n.depth[0]].splice(u,1),h=!0);break;case f.LINE_STRING:o.length>2&&(o.splice(u,1),h=!0);break;case f.MULTI_POLYGON:i=i[n.depth[1]];case f.POLYGON:(i=i[n.depth[0]]).length>4&&(u==i.length-1&&(u=0),i.splice(u,1),h=!0,0===u&&(i.pop(),i.push(i[0]),a=i.length-1))}h&&(this.setGeometryCoordinates_(c,o),y=[],(void 0!==e&&(this.rBush_.remove(e),y.push(e.segment[0])),void 0!==s&&(this.rBush_.remove(s),y.push(s.segment[1])),void 0!==e&&void 0!==s)&&(b={depth:n.depth,feature:n.feature,geometry:n.geometry,index:a,segment:y},this.rBush_.insert(oi(b.segment),b)),this.updateSegmentIndices_(c,u,n.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),w.length=0)}return h},t.prototype.setGeometryCoordinates_=function(n,t){this.changingFeature_=!0;n.setCoordinates(t);this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(n,t,i,r){this.rBush_.forEachInExtent(n.getExtent(),function(u){u.geometry===n&&(void 0===i||void 0===u.depth||be(u.depth,i))&&u.index>t&&(u.index+=r)})},t}(ou),wct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),foi={SELECT:"select"},eoi=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.selected=i,f.deselected=r,f.mapBrowserEvent=u,f}return wct(t,n),t}(ur);bct=function(n){function t(t){var u,e,r=n.call(this,{handleEvent:ooi})||this,i=t||{},s,o;return(r.condition_=i.condition?i.condition:ek,r.addCondition_=i.addCondition?i.addCondition:fk,r.removeCondition_=i.removeCondition?i.removeCondition:fk,r.toggleCondition_=i.toggleCondition?i.toggleCondition:bl,r.multi_=!!i.multi&&i.multi,r.filter_=i.filter?i.filter:tu,r.hitTolerance_=i.hitTolerance?i.hitTolerance:0,r.style_=void 0!==i.style?i.style:(pt((u=ta())[f.POLYGON],u[f.LINE_STRING]),pt(u[f.GEOMETRY_COLLECTION],u[f.LINE_STRING]),function(n){return n.getGeometry()?u[n.getGeometry().getType()]:null}),r.featureStyleAssociation_={},r.features_=i.features||new gi,i.layers)?"function"==typeof i.layers?e=i.layers:(s=i.layers,e=function(n){return di(s,n)}):e=tu,r.layerFilter_=e,r.featureLayerAssociation_={},o=r.getFeatures(),o.addEventListener(yi.ADD,r.addFeature_.bind(r)),o.addEventListener(yi.REMOVE,r.removeFeature_.bind(r)),r}return wct(t,n),t.prototype.addFeatureLayerAssociation_=function(n,t){this.featureLayerAssociation_[v(n)]=t},t.prototype.getFeatures=function(){return this.features_},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(n){return this.featureLayerAssociation_[v(n)]},t.prototype.setHitTolerance=function(n){this.hitTolerance_=n},t.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.removeSelectedStyle_.bind(this));n.prototype.setMap.call(this,t);t&&this.style_&&this.features_.forEach(this.giveSelectedStyle_.bind(this))},t.prototype.addFeature_=function(n){var t=n.element;this.style_&&this.giveSelectedStyle_(t)},t.prototype.removeFeature_=function(n){var t=n.element;this.style_&&this.removeSelectedStyle_(t)},t.prototype.giveSelectedStyle_=function(n){var t=v(n);this.featureStyleAssociation_[t]=n.getStyle();n.setStyle(this.style_)},t.prototype.removeSelectedStyle_=function(n){var t=v(n);n.setStyle(this.featureStyleAssociation_[t]);delete this.featureStyleAssociation_[t]},t.prototype.removeFeatureLayerAssociation_=function(n){delete this.featureLayerAssociation_[v(n)]},t}(ie);kct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var hc=[],soi=function(n){function t(t){var i=this,r=t||{},u=r;return u.handleDownEvent||(u.handleDownEvent=tu),u.stopDown||(u.stopDown=go),(i=n.call(this,u)||this).source_=r.source?r.source:null,i.vertex_=void 0===r.vertex||r.vertex,i.edge_=void 0===r.edge||r.edge,i.features_=r.features?r.features:null,i.featuresListenerKeys_=[],i.featureChangeListenerKeys_={},i.indexedFeaturesExtents_={},i.pendingFeatures_={},i.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.rBush_=new ep,i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(i),LineString:i.writeLineStringGeometry_.bind(i),LinearRing:i.writeLineStringGeometry_.bind(i),Polygon:i.writePolygonGeometry_.bind(i),MultiPoint:i.writeMultiPointGeometry_.bind(i),MultiLineString:i.writeMultiLineStringGeometry_.bind(i),MultiPolygon:i.writeMultiPolygonGeometry_.bind(i),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(i),Circle:i.writeCircleGeometry_.bind(i)},i}return kct(t,n),t.prototype.addFeature=function(n,t){var f=void 0===t||t,u=v(n),i=n.getGeometry(),r;i&&(r=this.SEGMENT_WRITERS_[i.getType()],r&&(this.indexedFeaturesExtents_[u]=i.getExtent([1/0,1/0,-1/0,-1/0]),r(n,i)));f&&(this.featureChangeListenerKeys_[u]=nt(n,a.CHANGE,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(n){this.addFeature(n)},t.prototype.forEachFeatureRemove_=function(n){this.removeFeature(n)},t.prototype.getFeatures_=function(){var n;return this.features_?n=this.features_:this.source_&&(n=this.source_.getFeatures()),n},t.prototype.handleEvent=function(t){var i=this.snapTo(t.pixel,t.coordinate,t.map);return i.snapped&&(t.coordinate=i.vertex.slice(0,2),t.pixel=i.vertexPixel),n.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(n){var t=dct(n);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(n){var t=dct(n);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(n){var t=n.target,i;this.handlingDownUpSequence?(i=v(t),i in this.pendingFeatures_||(this.pendingFeatures_[i]=t)):this.updateFeature_(t)},t.prototype.handleUpEvent=function(){var n=iv(this.pendingFeatures_);return n.length&&(n.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(n,t){var o=void 0===t||t,u=v(n),e=this.indexedFeaturesExtents_[u],f,i,r;if(e)for(f=this.rBush_,i=[],f.forEachInExtent(e,function(t){n===t.feature&&i.push(t)}),r=i.length-1;r>=0;--r)f.remove(i[r]);o&&(ct(this.featureChangeListenerKeys_[u]),delete this.featureChangeListenerKeys_[u])},t.prototype.setMap=function(t){var u=this.getMap(),i=this.featuresListenerKeys_,r=this.getFeatures_();u&&(i.forEach(ct),i.length=0,r.forEach(this.forEachFeatureRemove_.bind(this)));n.prototype.setMap.call(this,t);t&&(this.features_?i.push(nt(this.features_,yi.ADD,this.handleFeatureAdd_,this),nt(this.features_,yi.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push(nt(this.source_,dr.ADDFEATURE,this.handleFeatureAdd_,this),nt(this.source_,dr.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(n,t,i){var nt=oi([i.getCoordinateFromPixel([n[0]-this.pixelTolerance_,n[1]+this.pixelTolerance_]),i.getCoordinateFromPixel([n[0]+this.pixelTolerance_,n[1]-this.pixelTolerance_])]),s=this.rBush_.getInExtent(nt),v,p,r,k;this.vertex_&&!this.edge_&&(s=s.filter(function(n){return n.feature.getGeometry().getType()!==f.CIRCLE}));var h=!1,e=null,u=null;if(0===s.length)return{snapped:h,vertex:e,vertexPixel:u};for(var a,o=i.getView().getProjection(),d=pi(t,o),g=1/0,y=0;y<s.length;++y)v=s[y],hc[0]=pi(v.segment[0],o),hc[1]=pi(v.segment[1],o),p=ey(d,hc),p<g&&(a=v,g=p);if(r=a.segment,this.vertex_&&!this.edge_){var w=i.getPixelFromCoordinate(r[0]),b=i.getPixelFromCoordinate(r[1]),c=eu(n,w),l=eu(n,b);Math.sqrt(Math.min(c,l))<=this.pixelTolerance_&&(h=!0,e=c>l?r[1]:r[0],u=i.getPixelFromCoordinate(e))}else this.edge_&&(k=a.feature.getGeometry().getType()===f.CIRCLE,(k?e=function(n,t){var f=t.getRadius(),e=t.getCenter(),o=e[0],s=e[1],i=n[0]-o,r=n[1]-s,u;return 0===i&&0===r&&(i=1),u=Math.sqrt(i*i+r*r),[o+f*i/u,s+f*r/u]}(t,a.feature.getGeometry()):(hc[0]=pi(r[0],o),hc[1]=pi(r[1],o),e=el(iy(d,hc),o)),fy(n,u=i.getPixelFromCoordinate(e))<=this.pixelTolerance_&&(h=!0,this.vertex_&&!k))&&(w=i.getPixelFromCoordinate(r[0]),b=i.getPixelFromCoordinate(r[1]),c=eu(u,w),l=eu(u,b),Math.sqrt(Math.min(c,l))<=this.pixelTolerance_&&(e=c>l?r[1]:r[0],u=i.getPixelFromCoordinate(e))));return h&&(u=[Math.round(u[0]),Math.round(u[1])]),{snapped:h,vertex:e,vertexPixel:u}},t.prototype.updateFeature_=function(n){this.removeFeature(n,!1);this.addFeature(n,!1)},t.prototype.writeCircleGeometry_=function(n,t){for(var r,f,u=cb(t).getCoordinates()[0],i=0,e=u.length-1;i<e;++i)r=u.slice(i,i+2),f={feature:n,segment:r},this.rBush_.insert(oi(r),f)},t.prototype.writeGeometryCollectionGeometry_=function(n,t){for(var u,r=t.getGeometriesArray(),i=0;i<r.length;++i)u=this.SEGMENT_WRITERS_[r[i].getType()],u&&u(n,r[i])},t.prototype.writeLineStringGeometry_=function(n,t){for(var r,f,u=t.getCoordinates(),i=0,e=u.length-1;i<e;++i)r=u.slice(i,i+2),f={feature:n,segment:r},this.rBush_.insert(oi(r),f)},t.prototype.writeMultiLineStringGeometry_=function(n,t){for(var u,o,f=t.getCoordinates(),r=0,s=f.length;r<s;++r)for(var e=f[r],i=0,h=e.length-1;i<h;++i)u=e.slice(i,i+2),o={feature:n,segment:u},this.rBush_.insert(oi(u),o)},t.prototype.writeMultiPointGeometry_=function(n,t){for(var r,f,u=t.getCoordinates(),i=0,e=u.length;i<e;++i)r=u[i],f={feature:n,segment:[r,r]},this.rBush_.insert(t.getExtent(),f)},t.prototype.writeMultiPolygonGeometry_=function(n,t){for(var f,h,e=t.getCoordinates(),r=0,c=e.length;r<c;++r)for(var o=e[r],u=0,l=o.length;u<l;++u)for(var s=o[u],i=0,a=s.length-1;i<a;++i)f=s.slice(i,i+2),h={feature:n,segment:f},this.rBush_.insert(oi(f),h)},t.prototype.writePointGeometry_=function(n,t){var i=t.getCoordinates(),r={feature:n,segment:[i,i]};this.rBush_.insert(t.getExtent(),r)},t.prototype.writePolygonGeometry_=function(n,t){for(var u,o,f=t.getCoordinates(),r=0,s=f.length;r<s;++r)for(var e=f[r],i=0,h=e.length-1;i<h;++i)u=e.slice(i,i+2),o={feature:n,segment:u},this.rBush_.insert(oi(u),o)},t}(ou),gct=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hoi="translatestart",coi="translating",loi="translateend",ag=function(n){function t(t,i,r,u,f){var e=n.call(this,t)||this;return e.features=i,e.coordinate=r,e.startCoordinate=u,e.mapBrowserEvent=f,e}return gct(t,n),t}(ur),aoi=function(n){function t(t){var u,r=this,i=t||{},f;return((r=n.call(this,i)||this).lastCoordinate_=null,r.startCoordinate_=null,r.features_=void 0!==i.features?i.features:null,i.layers)?"function"==typeof i.layers?u=i.layers:(f=i.layers,u=function(n){return di(f,n)}):u=tu,r.layerFilter_=u,r.filter_=i.filter?i.filter:tu,r.hitTolerance_=i.hitTolerance?i.hitTolerance:0,r.lastFeature_=null,r.addEventListener(ri(pl.ACTIVE),r.handleActiveChanged_),r}return gct(t,n),t.prototype.handleDownEvent=function(n){if(this.lastFeature_=this.featuresAtPixel_(n.pixel,n.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=n.coordinate;this.lastCoordinate_=n.coordinate;this.handleMoveEvent(n);var t=this.features_||new gi([this.lastFeature_]);return this.dispatchEvent(new ag(hoi,t,n.coordinate,this.startCoordinate_,n)),!0}return!1},t.prototype.handleUpEvent=function(n){if(this.lastCoordinate_){this.lastCoordinate_=null;this.handleMoveEvent(n);var t=this.features_||new gi([this.lastFeature_]);return this.dispatchEvent(new ag(loi,t,n.coordinate,this.startCoordinate_,n)),this.startCoordinate_=null,!0}return!1},t.prototype.handleDragEvent=function(n){if(this.lastCoordinate_){var t=n.coordinate,r=t[0]-this.lastCoordinate_[0],u=t[1]-this.lastCoordinate_[1],i=this.features_||new gi([this.lastFeature_]);i.forEach(function(n){var t=n.getGeometry();t.translate(r,u);n.setGeometry(t)});this.lastCoordinate_=t;this.dispatchEvent(new ag(coi,i,t,this.startCoordinate_,n))}},t.prototype.handleMoveEvent=function(n){var t=n.map.getViewport();this.featuresAtPixel_(n.pixel,n.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")},t.prototype.featuresAtPixel_=function(n,t){return t.forEachFeatureAtPixel(n,function(n,t){if(this.filter_(n,t)&&(!this.features_||di(this.features_.getArray(),n)))return n}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.setHitTolerance=function(n){this.hitTolerance_=n},t.prototype.setMap=function(t){var i=this.getMap();n.prototype.setMap.call(this,t);this.updateState_(i)},t.prototype.handleActiveChanged_=function(){this.updateState_(null)},t.prototype.updateState_=function(n){var t=this.getMap(),i=this.getActive();t&&i||(t=t||n)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")},t}(ou),voi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();lo=function(n){function t(t){var i=n.call(this)||this;return i.geometries_=t||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return voi(t,n),t.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(ct);this.changeEventsKeys_.length=0},t.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var n=0,t=this.geometries_.length;n<t;++n)this.changeEventsKeys_.push(nt(this.geometries_[n],a.CHANGE,this.changed,this))},t.prototype.clone=function(){var n=new t(null);return n.setGeometries(this.geometries_),n},t.prototype.closestPointXY=function(n,t,i,r){if(r<ns(this.getExtent(),n,t))return r;for(var f=this.geometries_,u=0,e=f.length;u<e;++u)r=f[u].closestPointXY(n,t,i,r);return r},t.prototype.containsXY=function(n,t){for(var r=this.geometries_,i=0,u=r.length;i<u;++i)if(r[i].containsXY(n,t))return!0;return!1},t.prototype.computeExtent=function(n){oh(n);for(var i=this.geometries_,t=0,r=i.length;t<r;++t)ov(n,i[t].getExtent());return n},t.prototype.getGeometries=function(){return nlt(this.geometries_)},t.prototype.getGeometriesArray=function(){return this.geometries_},t.prototype.getSimplifiedGeometry=function(n){var r,u,f;if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),n<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&n<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],o=this.geometries_,s=!1,i=0,h=o.length;i<h;++i)r=o[i],u=r.getSimplifiedGeometry(n),e.push(u),u!==r&&(s=!0);return s?(f=new t(null),f.setGeometriesArray(e),f):(this.simplifiedGeometryMaxMinSquaredTolerance=n,this)},t.prototype.getType=function(){return f.GEOMETRY_COLLECTION},t.prototype.intersectsExtent=function(n){for(var i=this.geometries_,t=0,r=i.length;t<r;++t)if(i[t].intersectsExtent(n))return!0;return!1},t.prototype.isEmpty=function(){return 0===this.geometries_.length},t.prototype.rotate=function(n,t){for(var r=this.geometries_,i=0,u=r.length;i<u;++i)r[i].rotate(n,t);this.changed()},t.prototype.scale=function(n,t,i){var r=i;r||(r=vr(this.getExtent()));for(var f=this.geometries_,u=0,e=f.length;u<e;++u)f[u].scale(n,t,r);this.changed()},t.prototype.setGeometries=function(n){this.setGeometriesArray(nlt(n))},t.prototype.setGeometriesArray=function(n){this.unlistenGeometriesChange_();this.geometries_=n;this.listenGeometriesChange_();this.changed()},t.prototype.applyTransform=function(n){for(var i=this.geometries_,t=0,r=i.length;t<r;++t)i[t].applyTransform(n);this.changed()},t.prototype.translate=function(n,t){for(var r=this.geometries_,i=0,u=r.length;i<u;++i)r[i].translate(n,t);this.changed()},t.prototype.disposeInternal=function(){this.unlistenGeometriesChange_();n.prototype.disposeInternal.call(this)},t}(gw);cc=function(){function n(){this.dataProjection=null;this.defaultFeatureProjection=null}return n.prototype.getReadOptions=function(n,t){var r,i;return t&&(i=t.dataProjection?y(t.dataProjection):this.readProjection(n),t.extent&&i&&i.getUnits()===lu.TILE_PIXELS&&(i=y(i)).setWorldExtent(t.extent),r={dataProjection:i,featureProjection:t.featureProjection}),this.adaptOptions(r)},n.prototype.adaptOptions=function(n){return d({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},n)},n.prototype.getType=function(){return w()},n.prototype.readFeature=function(){return w()},n.prototype.readFeatures=function(){return w()},n.prototype.readGeometry=function(){return w()},n.prototype.readProjection=function(){return w()},n.prototype.writeFeature=function(){return w()},n.prototype.writeFeatures=function(){return w()},n.prototype.writeGeometry=function(){return w()},n}();tlt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var yg=function(n){function t(){return n.call(this)||this}return tlt(t,n),t.prototype.getType=function(){return ue.JSON},t.prototype.readFeature=function(n,t){return this.readFeatureFromObject(pp(n),this.getReadOptions(n,t))},t.prototype.readFeatures=function(n,t){return this.readFeaturesFromObject(pp(n),this.getReadOptions(n,t))},t.prototype.readFeatureFromObject=function(){return w()},t.prototype.readFeaturesFromObject=function(){return w()},t.prototype.readGeometry=function(n,t){return this.readGeometryFromObject(pp(n),this.getReadOptions(n,t))},t.prototype.readGeometryFromObject=function(){return w()},t.prototype.readProjection=function(n){return this.readProjectionFromObject(pp(n))},t.prototype.readProjectionFromObject=function(){return w()},t.prototype.writeFeature=function(n,t){return JSON.stringify(this.writeFeatureObject(n,t))},t.prototype.writeFeatureObject=function(){return w()},t.prototype.writeFeatures=function(n,t){return JSON.stringify(this.writeFeaturesObject(n,t))},t.prototype.writeFeaturesObject=function(){return w()},t.prototype.writeGeometry=function(n,t){return JSON.stringify(this.writeGeometryObject(n,t))},t.prototype.writeGeometryObject=function(){return w()},t}(cc),yoi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nh={};nh[f.POINT]=function(n){return void 0!==n.m&&void 0!==n.z?new si([n.x,n.y,n.z,n.m],l.XYZM):void 0!==n.z?new si([n.x,n.y,n.z],l.XYZ):void 0!==n.m?new si([n.x,n.y,n.m],l.XYM):new si([n.x,n.y])};nh[f.LINE_STRING]=function(n){var t=lc(n);return new ai(n.paths[0],t)};nh[f.POLYGON]=function(n){var t=lc(n);return new fr(n.rings,t)};nh[f.MULTI_POINT]=function(n){var t=lc(n);return new wf(n.points,t)};nh[f.MULTI_LINE_STRING]=function(n){var t=lc(n);return new au(n.paths,t)};nh[f.MULTI_POLYGON]=function(n){var t=lc(n);return new bf(n.rings,t)};ao={};ao[f.POINT]=function(n){var i,t=n.getCoordinates(),r=n.getLayout();return r===l.XYZ?i={x:t[0],y:t[1],z:t[2]}:r===l.XYM?i={x:t[0],y:t[1],m:t[2]}:r===l.XYZM?i={x:t[0],y:t[1],z:t[2],m:t[3]}:r===l.XY?i={x:t[0],y:t[1]}:p(!1,34),i};ao[f.LINE_STRING]=function(n){var t=va(n);return{hasZ:t.hasZ,hasM:t.hasM,paths:[n.getCoordinates()]}};ao[f.POLYGON]=function(n){var t=va(n);return{hasZ:t.hasZ,hasM:t.hasM,rings:n.getCoordinates(!1)}};ao[f.MULTI_POINT]=function(n){var t=va(n);return{hasZ:t.hasZ,hasM:t.hasM,points:n.getCoordinates()}};ao[f.MULTI_LINE_STRING]=function(n){var t=va(n);return{hasZ:t.hasZ,hasM:t.hasM,paths:n.getCoordinates()}};ao[f.MULTI_POLYGON]=function(n){for(var i,u=va(n),r=n.getCoordinates(!1),f=[],t=0;t<r.length;t++)for(i=r[t].length-1;i>=0;i--)f.push(r[t][i]);return{hasZ:u.hasZ,hasM:u.hasM,rings:f}};var poi=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this)||this).geometryName_=r.geometryName,i}return yoi(t,n),t.prototype.readFeatureFromObject=function(n,t){var i=n,u=ilt(i.geometry,t),r=new ui;return this.geometryName_&&r.setGeometryName(this.geometryName_),r.setGeometry(u),t&&t.idField&&i.attributes[t.idField]&&r.setId(i.attributes[t.idField]),i.attributes&&r.setProperties(i.attributes,!0),r},t.prototype.readFeaturesFromObject=function(n,t){var r=t||{},u,f,i,e;if(n.features){for(u=[],f=n.features,r.idField=n.objectIdFieldName,i=0,e=f.length;i<e;++i)u.push(this.readFeatureFromObject(f[i],r));return u}return[this.readFeatureFromObject(n,r)]},t.prototype.readGeometryFromObject=function(n,t){return ilt(n,t)},t.prototype.readProjectionFromObject=function(n){return n.spatialReference&&void 0!==n.spatialReference.wkid?y("EPSG:"+n.spatialReference.wkid):null},t.prototype.writeGeometryObject=function(n,t){return rlt(n,this.adaptOptions(t))},t.prototype.writeFeatureObject=function(n,t){var i,u,r;return t=this.adaptOptions(t),i={},u=n.getGeometry(),u&&(i.geometry=rlt(u,t),t&&t.featureProjection&&(i.geometry.spatialReference={wkid:Number(y(t.featureProjection).getCode().split(":").pop())})),r=n.getProperties(),delete r[n.getGeometryName()],i.attributes=bo(r)?{}:r,i},t.prototype.writeFeaturesObject=function(n,t){t=this.adaptOptions(t);for(var r=[],i=0,u=n.length;i<u;++i)r.push(this.writeFeatureObject(n[i],t));return{features:r}},t}(yg),woi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ac=function(n){function t(){var t=n.call(this)||this;return t.xmlSerializer_=new XMLSerializer,t}return woi(t,n),t.prototype.getType=function(){return ue.XML},t.prototype.readFeature=function(n,t){if(n){if("string"==typeof n){var i=ku(n);return this.readFeatureFromDocument(i,t)}return lf(n)?this.readFeatureFromDocument(n,t):this.readFeatureFromNode(n,t)}return null},t.prototype.readFeatureFromDocument=function(n,t){var i=this.readFeaturesFromDocument(n,t);return i.length>0?i[0]:null},t.prototype.readFeatureFromNode=function(){return null},t.prototype.readFeatures=function(n,t){if(n){if("string"==typeof n){var i=ku(n);return this.readFeaturesFromDocument(i,t)}return lf(n)?this.readFeaturesFromDocument(n,t):this.readFeaturesFromNode(n,t)}return[]},t.prototype.readFeaturesFromDocument=function(n,t){for(var r=[],i=n.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&pt(r,this.readFeaturesFromNode(i,t));return r},t.prototype.readFeaturesFromNode=function(){return w()},t.prototype.readGeometry=function(n,t){if(n){if("string"==typeof n){var i=ku(n);return this.readGeometryFromDocument(i,t)}return lf(n)?this.readGeometryFromDocument(n,t):this.readGeometryFromNode(n,t)}return null},t.prototype.readGeometryFromDocument=function(){return null},t.prototype.readGeometryFromNode=function(){return null},t.prototype.readProjection=function(n){if(n){if("string"==typeof n){var t=ku(n);return this.readProjectionFromDocument(t)}return lf(n)?this.readProjectionFromDocument(n):this.readProjectionFromNode(n)}return null},t.prototype.readProjectionFromDocument=function(){return this.dataProjection},t.prototype.readProjectionFromNode=function(){return this.dataProjection},t.prototype.writeFeature=function(n,t){var i=this.writeFeatureNode(n,t);return this.xmlSerializer_.serializeToString(i)},t.prototype.writeFeatureNode=function(){return null},t.prototype.writeFeatures=function(n,t){var i=this.writeFeaturesNode(n,t);return this.xmlSerializer_.serializeToString(i)},t.prototype.writeFeaturesNode=function(){return null},t.prototype.writeGeometry=function(n,t){var i=this.writeGeometryNode(n,t);return this.xmlSerializer_.serializeToString(i)},t.prototype.writeGeometryNode=function(){return null},t}(cc),boi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kf="http://www.opengis.net/gml",koi=/^[\s\xa0]*$/,vi=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.featureType=r.featureType,i.featureNS=r.featureNS,i.srsName=r.srsName,i.schemaLocation="",i.FEATURE_COLLECTION_PARSERS={},i.FEATURE_COLLECTION_PARSERS[i.namespace]={featureMember:b(i.readFeaturesInternal),featureMembers:tt(i.readFeaturesInternal)},i}return boi(t,n),t.prototype.readFeaturesInternal=function(n,t){var f=n.localName,e=null,r,c,l,v,y,nt,p,o,w,k;if("FeatureCollection"==f)e=s([],this.FEATURE_COLLECTION_PARSERS,n,t,this);else if("featureMembers"==f||"featureMember"==f){var h=t[0],u=h.featureType,i=h.featureNS;if(!u&&n.childNodes){for(u=[],i={},r=0,c=n.childNodes.length;r<c;++r)if(l=n.childNodes[r],1===l.nodeType&&(v=l.nodeName.split(":").pop(),-1===u.indexOf(v))){var a="",d=0,g=l.namespaceURI;for(y in i){if(i[y]===g){a=y;break}++d}a||(i[a="p"+d]=g);u.push(a+":"+v)}"featureMember"!=f&&(h.featureType=u,h.featureNS=i)}"string"==typeof i&&(nt=i,(i={}).p0=nt);p={};o=Array.isArray(u)?u:[u];for(w in i){for(k={},r=0,c=o.length;r<c;++r)(-1===o[r].indexOf(":")?"p0":o[r].split(":")[0])===w&&(k[o[r].split(":").pop()]="featureMembers"==f?b(this.readFeatureElement,this):tt(this.readFeatureElement,this));p[i[w]]=k}e=s("featureMember"==f?void 0:[],p,n,t)}return null===e&&(e=[]),e},t.prototype.readGeometryElement=function(n,t){var r=t[0],i;return r.srsName=n.firstElementChild.getAttribute("srsName"),r.srsDimension=n.firstElementChild.getAttribute("srsDimension"),i=s(null,this.GEOMETRY_PARSERS,n,t,this),i?Array.isArray(i)?vg(i,r):ei(i,!1,r):void 0},t.prototype.readFeatureElementInternal=function(n,t,i){for(var h,e,f,c,o,a,s,l,u={},r=n.firstElementChild;r;r=r.nextElementSibling)if(e=void 0,f=r.localName,0===r.childNodes.length||1===r.childNodes.length&&(3===r.firstChild.nodeType||4===r.firstChild.nodeType)?(e=ar(r,!1),koi.test(e)&&(e=void 0)):(i&&(e=this.readGeometryElement(r,t)),e?"boundedBy"!==f&&(h=f):e=this.readFeatureElementInternal(r,t,!1)),u[f]?(u[f]instanceof Array||(u[f]=[u[f]]),u[f].push(e)):u[f]=e,c=r.attributes.length,c>0)for(u[f]={_content_:u[f]},o=0;o<c;o++)a=r.attributes[o].name,u[f][a]=r.attributes[o].value;return i?(s=new ui(u),h&&s.setGeometryName(h),l=n.getAttribute("fid")||function(n,t,i){return n.getAttributeNS(t,i)||""}(n,this.namespace,"id"),l&&s.setId(l),s):u},t.prototype.readFeatureElement=function(n,t){return this.readFeatureElementInternal(n,t,!0)},t.prototype.readPoint=function(n,t){var i=this.readFlatCoordinatesFromNode_(n,t);if(i)return new si(i,l.XYZ)},t.prototype.readMultiPoint=function(n,t){var i=s([],this.MULTIPOINT_PARSERS_,n,t,this);if(i)return new wf(i)},t.prototype.readMultiLineString=function(n,t){var i=s([],this.MULTILINESTRING_PARSERS_,n,t,this);if(i)return new au(i)},t.prototype.readMultiPolygon=function(n,t){var i=s([],this.MULTIPOLYGON_PARSERS_,n,t,this);if(i)return new bf(i)},t.prototype.pointMemberParser_=function(n,t){kr(this.POINTMEMBER_PARSERS_,n,t,this)},t.prototype.lineStringMemberParser_=function(n,t){kr(this.LINESTRINGMEMBER_PARSERS_,n,t,this)},t.prototype.polygonMemberParser_=function(n,t){kr(this.POLYGONMEMBER_PARSERS_,n,t,this)},t.prototype.readLineString=function(n,t){var i=this.readFlatCoordinatesFromNode_(n,t);if(i)return new ai(i,l.XYZ)},t.prototype.readFlatLinearRing_=function(n,t){var i=s(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,n,t,this);return i||void 0},t.prototype.readLinearRing=function(n,t){var i=this.readFlatCoordinatesFromNode_(n,t);if(i)return new bh(i,l.XYZ)},t.prototype.readPolygon=function(n,t){var i=s([null],this.FLAT_LINEAR_RINGS_PARSERS,n,t,this);if(i&&i[0]){for(var r=i[0],e=[r.length],u=void 0,u=1,f=i.length;u<f;++u)pt(r,i[u]),e.push(r.length);return new fr(r,l.XYZ,e)}},t.prototype.readFlatCoordinatesFromNode_=function(n,t){return s(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,n,t,this)},t.prototype.readGeometryFromNode=function(n,t){var i=this.readGeometryElement(n,[this.getReadOptions(n,t||{})]);return i||null},t.prototype.readFeaturesFromNode=function(n,t){var i={featureType:this.featureType,featureNS:this.featureNS};return t&&d(i,this.getReadOptions(n,t)),this.readFeaturesInternal(n,[i])||[]},t.prototype.readProjectionFromNode=function(n){return y(this.srsName?this.srsName:n.firstElementChild.getAttribute("srsName"))},t}(ac);vi.prototype.namespace=kf;vi.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};vi.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};vi.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};vi.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:b(vi.prototype.pointMemberParser_),pointMembers:b(vi.prototype.pointMemberParser_)}};vi.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:b(vi.prototype.lineStringMemberParser_),lineStringMembers:b(vi.prototype.lineStringMemberParser_)}};vi.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:b(vi.prototype.polygonMemberParser_),polygonMembers:b(vi.prototype.polygonMemberParser_)}};vi.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:b(vi.prototype.readFlatCoordinatesFromNode_)}};vi.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:b(vi.prototype.readLineString)}};vi.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:b(vi.prototype.readPolygon)}};vi.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:tt(vi.prototype.readFlatLinearRing_)}};ht=vi;var doi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),goi=kf+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",nsi={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},k=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this,i)||this).surface_=void 0!==i.surface&&i.surface,r.curve_=void 0!==i.curve&&i.curve,r.multiCurve_=void 0===i.multiCurve||i.multiCurve,r.multiSurface_=void 0===i.multiSurface||i.multiSurface,r.schemaLocation=i.schemaLocation?i.schemaLocation:goi,r.hasZ=void 0!==i.hasZ&&i.hasZ,r}return doi(t,n),t.prototype.readMultiCurve_=function(n,t){var i=s([],this.MULTICURVE_PARSERS_,n,t,this);if(i)return new au(i)},t.prototype.readMultiSurface_=function(n,t){var i=s([],this.MULTISURFACE_PARSERS_,n,t,this);if(i)return new bf(i)},t.prototype.curveMemberParser_=function(n,t){kr(this.CURVEMEMBER_PARSERS_,n,t,this)},t.prototype.surfaceMemberParser_=function(n,t){kr(this.SURFACEMEMBER_PARSERS_,n,t,this)},t.prototype.readPatch_=function(n,t){return s([null],this.PATCHES_PARSERS_,n,t,this)},t.prototype.readSegment_=function(n,t){return s([null],this.SEGMENTS_PARSERS_,n,t,this)},t.prototype.readPolygonPatch_=function(n,t){return s([null],this.FLAT_LINEAR_RINGS_PARSERS,n,t,this)},t.prototype.readLineStringSegment_=function(n,t){return s([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,n,t,this)},t.prototype.interiorParser_=function(n,t){var i=s(void 0,this.RING_PARSERS,n,t,this);i&&t[t.length-1].push(i)},t.prototype.exteriorParser_=function(n,t){var i=s(void 0,this.RING_PARSERS,n,t,this);i&&(t[t.length-1][0]=i)},t.prototype.readSurface_=function(n,t){var i=s([null],this.SURFACE_PARSERS_,n,t,this);if(i&&i[0]){for(var r=i[0],e=[r.length],u=void 0,u=1,f=i.length;u<f;++u)pt(r,i[u]),e.push(r.length);return new fr(r,l.XYZ,e)}},t.prototype.readCurve_=function(n,t){var i=s([null],this.CURVE_PARSERS_,n,t,this);if(i)return new ai(i,l.XYZ)},t.prototype.readEnvelope_=function(n,t){var i=s([null],this.ENVELOPE_PARSERS_,n,t,this);return ru(i[1][0],i[1][1],i[2][0],i[2][1])},t.prototype.readFlatPos_=function(n,t){for(var e,o,h,r,c,l,s,f,u=ar(n,!1),i=[];f=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/.exec(u);)i.push(parseFloat(f[1])),u=u.substr(f[0].length);if(""===u){if(e=t[0].srsName,o="enu",e&&(o=y(e).getAxisOrientation()),"neu"===o)for(r=void 0,r=0,h=i.length;r<h;r+=3)c=i[r],l=i[r+1],i[r]=l,i[r+1]=c;if(s=i.length,2==s&&i.push(0),0!==s)return i}},t.prototype.readFlatPosList_=function(n,t){var v=ar(n,!1).replace(/^\s*|\s*$/g,""),h=t[0],c=h.srsName,l=h.srsDimension,a="enu",f,e,o,r,i;c&&(a=y(c).getAxisOrientation());r=v.split(/\s+/);i=2;n.getAttribute("srsDimension")?i=le(n.getAttribute("srsDimension")):n.getAttribute("dimension")?i=le(n.getAttribute("dimension")):n.parentNode.getAttribute("srsDimension")?i=le(n.parentNode.getAttribute("srsDimension")):l&&(i=le(l));for(var s=[],u=0,p=r.length;u<p;u+=i)f=parseFloat(r[u]),e=parseFloat(r[u+1]),o=3===i?parseFloat(r[u+2]):0,"en"===a.substr(0,2)?s.push(f,e,o):s.push(e,f,o);return s},t.prototype.writePos_=function(n,t,i){var o=i[i.length-1],s=o.hasZ,h=s?"3":"2",u,f,e,r;n.setAttribute("srsDimension",h);u=o.srsName;f="enu";u&&(f=y(u).getAxisOrientation());r=t.getCoordinates();(e="en"===f.substr(0,2)?r[0]+" "+r[1]:r[1]+" "+r[0],s)&&(e+=" "+(r[2]||0));ut(n,e)},t.prototype.getCoords_=function(n,t,i){var u="enu",r;return t&&(u=y(t).getAxisOrientation()),r="en"===u.substr(0,2)?n[0]+" "+n[1]:n[1]+" "+n[0],i&&(r+=" "+(n[2]||0)),r},t.prototype.writePosList_=function(n,t,i){var u=i[i.length-1],f=u.hasZ,c=f?"3":"2";n.setAttribute("srsDimension",c);for(var e,l=u.srsName,o=t.getCoordinates(),s=o.length,h=new Array(s),r=0;r<s;++r)e=o[r],h[r]=this.getCoords_(e,l,f);ut(n,h.join(" "))},t.prototype.writePoint_=function(n,t,i){var u=i[i.length-1].srsName,r;u&&n.setAttribute("srsName",u);r=rt(n.namespaceURI,"pos");n.appendChild(r);this.writePos_(r,t,i)},t.prototype.writeEnvelope=function(n,t,i){var r=i[i.length-1].srsName,u;r&&n.setAttribute("srsName",r);u=[t[0]+" "+t[1],t[2]+" "+t[3]];it({node:n},this.ENVELOPE_SERIALIZERS_,ir,u,i,["lowerCorner","upperCorner"],this)},t.prototype.writeLinearRing_=function(n,t,i){var u=i[i.length-1].srsName,r;u&&n.setAttribute("srsName",u);r=rt(n.namespaceURI,"posList");n.appendChild(r);this.writePosList_(r,t,i)},t.prototype.RING_NODE_FACTORY_=function(n,t){var i=t[t.length-1],u=i.node,r=i.exteriorWritten;return void 0===r&&(i.exteriorWritten=!0),rt(u.namespaceURI,void 0!==r?"interior":"exterior")},t.prototype.writeSurfaceOrPolygon_=function(n,t,i){var f=i[i.length-1],o=f.hasZ,r=f.srsName,e,u;("PolygonPatch"!==n.nodeName&&r&&n.setAttribute("srsName",r),"Polygon"===n.nodeName||"PolygonPatch"===n.nodeName)?(e=t.getLinearRings(),it({node:n,hasZ:o,srsName:r},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,e,i,void 0,this)):"Surface"===n.nodeName&&(u=rt(n.namespaceURI,"patches"),n.appendChild(u),this.writeSurfacePatches_(u,t,i))},t.prototype.writeCurveOrLineString_=function(n,t,i){var f=i[i.length-1].srsName,r,u;("LineStringSegment"!==n.nodeName&&f&&n.setAttribute("srsName",f),"LineString"===n.nodeName||"LineStringSegment"===n.nodeName)?(r=rt(n.namespaceURI,"posList"),n.appendChild(r),this.writePosList_(r,t,i)):"Curve"===n.nodeName&&(u=rt(n.namespaceURI,"segments"),n.appendChild(u),this.writeCurveSegments_(u,t,i))},t.prototype.writeMultiSurfaceOrPolygon_=function(n,t,i){var r=i[i.length-1],e=r.hasZ,u=r.srsName,o=r.surface,f;u&&n.setAttribute("srsName",u);f=t.getPolygons();it({node:n,hasZ:e,srsName:u,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,f,i,void 0,this)},t.prototype.writeMultiPoint_=function(n,t,i){var u=i[i.length-1],r=u.srsName,e=u.hasZ,f;r&&n.setAttribute("srsName",r);f=t.getPoints();it({node:n,hasZ:e,srsName:r},this.POINTMEMBER_SERIALIZERS_,gt("pointMember"),f,i,void 0,this)},t.prototype.writeMultiCurveOrLineString_=function(n,t,i){var r=i[i.length-1],e=r.hasZ,u=r.srsName,o=r.curve,f;u&&n.setAttribute("srsName",u);f=t.getLineStrings();it({node:n,hasZ:e,srsName:u,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,f,i,void 0,this)},t.prototype.writeRing_=function(n,t,i){var r=rt(n.namespaceURI,"LinearRing");n.appendChild(r);this.writeLinearRing_(r,t,i)},t.prototype.writeSurfaceOrPolygonMember_=function(n,t,i){var r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(n.appendChild(r),this.writeSurfaceOrPolygon_(r,t,i))},t.prototype.writePointMember_=function(n,t,i){var r=rt(n.namespaceURI,"Point");n.appendChild(r);this.writePoint_(r,t,i)},t.prototype.writeLineStringOrCurveMember_=function(n,t,i){var r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(n.appendChild(r),this.writeCurveOrLineString_(r,t,i))},t.prototype.writeSurfacePatches_=function(n,t,i){var r=rt(n.namespaceURI,"PolygonPatch");n.appendChild(r);this.writeSurfaceOrPolygon_(r,t,i)},t.prototype.writeCurveSegments_=function(n,t,i){var r=rt(n.namespaceURI,"LineStringSegment");n.appendChild(r);this.writeCurveOrLineString_(r,t,i)},t.prototype.writeGeometryElement=function(n,t,i){var u,r=i[i.length-1],f=d({},r);f.node=n;u=Array.isArray(t)?vg(t,r):ei(t,!0,r);it(f,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[u],i,void 0,this)},t.prototype.writeFeatureElement=function(n,t,i){var h=t.getId(),u,o,s;h&&n.setAttribute("fid",h);var r=i[i.length-1],f=r.featureNS,v=t.getGeometryName();r.serializers||(r.serializers={},r.serializers[f]={});var c=t.getProperties(),l=[],a=[];for(u in c)o=c[u],null!==o&&(l.push(u),a.push(o),u==v||"function"==typeof o.getSimplifiedGeometry?u in r.serializers[f]||(r.serializers[f][u]=e(this.writeGeometryElement,this)):u in r.serializers[f]||(r.serializers[f][u]=e(ut)));s=d({},r);s.node=n;it(s,r.serializers,gt(void 0,f),a,i,l)},t.prototype.writeFeatureMembers_=function(n,t,i){var r=i[i.length-1],s=r.featureType,u=r.featureNS,f={},o;f[u]={};f[u][s]=e(this.writeFeatureElement,this);o=d({},r);o.node=n;it(o,f,gt(s,u),t,i)},t.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(n,t){var i=t[t.length-1].node;return rt(this.namespace,nsi[i.nodeName])},t.prototype.GEOMETRY_NODE_FACTORY_=function(n,t){var i,r=t[t.length-1],u=r.multiSurface,f=r.surface,e=r.curve,o=r.multiCurve;return Array.isArray(n)?i="Envelope":"MultiPolygon"===(i=n.getType())&&!0===u?i="MultiSurface":"Polygon"===i&&!0===f?i="Surface":"LineString"===i&&!0===e?i="Curve":"MultiLineString"===i&&!0===o&&(i="MultiCurve"),rt(this.namespace,i)},t.prototype.writeGeometryNode=function(n,t){t=this.adaptOptions(t);var i=rt(this.namespace,"geom"),r={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&d(r,t),this.writeGeometryElement(i,n,[r]),i},t.prototype.writeFeaturesNode=function(n,t){var i,r;return t=this.adaptOptions(t),i=rt(this.namespace,"featureMembers"),i.setAttributeNS(eo,"xsi:schemaLocation",this.schemaLocation),r={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType},t&&d(r,t),this.writeFeatureMembers_(i,n,[r]),i},t}(ht);k.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:tt(k.prototype.readFlatPos_),posList:tt(k.prototype.readFlatPosList_)}};k.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:k.prototype.interiorParser_,exterior:k.prototype.exteriorParser_}};k.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:tt(ht.prototype.readPoint),MultiPoint:tt(ht.prototype.readMultiPoint),LineString:tt(ht.prototype.readLineString),MultiLineString:tt(ht.prototype.readMultiLineString),LinearRing:tt(ht.prototype.readLinearRing),Polygon:tt(ht.prototype.readPolygon),MultiPolygon:tt(ht.prototype.readMultiPolygon),Surface:tt(k.prototype.readSurface_),MultiSurface:tt(k.prototype.readMultiSurface_),Curve:tt(k.prototype.readCurve_),MultiCurve:tt(k.prototype.readMultiCurve_),Envelope:tt(k.prototype.readEnvelope_)}};k.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:b(k.prototype.curveMemberParser_),curveMembers:b(k.prototype.curveMemberParser_)}};k.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:b(k.prototype.surfaceMemberParser_),surfaceMembers:b(k.prototype.surfaceMemberParser_)}};k.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:b(ht.prototype.readLineString),Curve:b(k.prototype.readCurve_)}};k.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:b(ht.prototype.readPolygon),Surface:b(k.prototype.readSurface_)}};k.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:tt(k.prototype.readPatch_)}};k.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:tt(k.prototype.readSegment_)}};k.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:b(k.prototype.readFlatPosList_),upperCorner:b(k.prototype.readFlatPosList_)}};k.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:tt(k.prototype.readPolygonPatch_)}};k.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:tt(k.prototype.readLineStringSegment_)}};k.prototype.writeFeatures;k.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:e(k.prototype.writeRing_),interior:e(k.prototype.writeRing_)}};k.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:e(ut),upperCorner:e(ut)}};k.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:e(k.prototype.writeSurfaceOrPolygonMember_),polygonMember:e(k.prototype.writeSurfaceOrPolygonMember_)}};k.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:e(k.prototype.writePointMember_)}};k.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:e(k.prototype.writeLineStringOrCurveMember_),curveMember:e(k.prototype.writeLineStringOrCurveMember_)}};k.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:e(k.prototype.writeCurveOrLineString_),MultiCurve:e(k.prototype.writeMultiCurveOrLineString_),Point:e(k.prototype.writePoint_),MultiPoint:e(k.prototype.writeMultiPoint_),LineString:e(k.prototype.writeCurveOrLineString_),MultiLineString:e(k.prototype.writeMultiCurveOrLineString_),LinearRing:e(k.prototype.writeLinearRing_),Polygon:e(k.prototype.writeSurfaceOrPolygon_),MultiPolygon:e(k.prototype.writeMultiSurfaceOrPolygon_),Surface:e(k.prototype.writeSurfaceOrPolygon_),MultiSurface:e(k.prototype.writeMultiSurfaceOrPolygon_),Envelope:e(k.prototype.writeEnvelope)}};ft=k;kp=ft;kp.prototype.writeFeatures;kp.prototype.writeFeaturesNode;var tsi=kp,isi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rsi=kf+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",usi={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},at=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,r)||this).FEATURE_COLLECTION_PARSERS[kf].featureMember=b(i.readFeaturesInternal),i.schemaLocation=r.schemaLocation?r.schemaLocation:rsi,i}return isi(t,n),t.prototype.readFlatCoordinates_=function(n,t){var a=ar(n,!1).replace(/^\s*|\s*$/g,""),e=t[0].srsName,o="enu",r;e&&(r=y(e),r&&(o=r.getAxisOrientation()));for(var s=a.trim().split(/\s+/),u=[],f=0,v=s.length;f<v;f++){var i=s[f].split(/,+/),h=parseFloat(i[0]),c=parseFloat(i[1]),l=3===i.length?parseFloat(i[2]):0;"en"===o.substr(0,2)?u.push(h,c,l):u.push(c,h,l)}return u},t.prototype.readBox_=function(n,t){var i=s([null],this.BOX_PARSERS_,n,t,this);return ru(i[1][0],i[1][1],i[1][3],i[1][4])},t.prototype.innerBoundaryIsParser_=function(n,t){var i=s(void 0,this.RING_PARSERS,n,t,this);i&&t[t.length-1].push(i)},t.prototype.outerBoundaryIsParser_=function(n,t){var i=s(void 0,this.RING_PARSERS,n,t,this);i&&(t[t.length-1][0]=i)},t.prototype.GEOMETRY_NODE_FACTORY_=function(n,t){var i,r=t[t.length-1],u=r.multiSurface,f=r.surface,e=r.multiCurve;return Array.isArray(n)?i="Envelope":"MultiPolygon"===(i=n.getType())&&!0===u?i="MultiSurface":"Polygon"===i&&!0===f?i="Surface":"MultiLineString"===i&&!0===e&&(i="MultiCurve"),rt("http://www.opengis.net/gml",i)},t.prototype.writeFeatureElement=function(n,t,i){var h=t.getId(),u,o,s;h&&n.setAttribute("fid",h);var r=i[i.length-1],f=r.featureNS,v=t.getGeometryName();r.serializers||(r.serializers={},r.serializers[f]={});var c=t.getProperties(),l=[],a=[];for(u in c)o=c[u],null!==o&&(l.push(u),a.push(o),u==v||"function"==typeof o.getSimplifiedGeometry?u in r.serializers[f]||(r.serializers[f][u]=e(this.writeGeometryElement,this)):u in r.serializers[f]||(r.serializers[f][u]=e(ut)));s=d({},r);s.node=n;it(s,r.serializers,gt(void 0,f),a,i,l)},t.prototype.writeCurveOrLineString_=function(n,t,i){var f=i[i.length-1].srsName,r,u;("LineStringSegment"!==n.nodeName&&f&&n.setAttribute("srsName",f),"LineString"===n.nodeName||"LineStringSegment"===n.nodeName)?(r=this.createCoordinatesNode_(n.namespaceURI),n.appendChild(r),this.writeCoordinates_(r,t,i)):"Curve"===n.nodeName&&(u=rt(n.namespaceURI,"segments"),n.appendChild(u),this.writeCurveSegments_(u,t,i))},t.prototype.writeLineStringOrCurveMember_=function(n,t,i){var r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(n.appendChild(r),this.writeCurveOrLineString_(r,t,i))},t.prototype.writeMultiCurveOrLineString_=function(n,t,i){var r=i[i.length-1],e=r.hasZ,u=r.srsName,o=r.curve,f;u&&n.setAttribute("srsName",u);f=t.getLineStrings();it({node:n,hasZ:e,srsName:u,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,f,i,void 0,this)},t.prototype.writeGeometryElement=function(n,t,i){var u,r=i[i.length-1],f=d({},r);f.node=n;u=Array.isArray(t)?vg(t,r):ei(t,!0,r);it(f,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[u],i,void 0,this)},t.prototype.createCoordinatesNode_=function(n){var t=rt(n,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t},t.prototype.writeCoordinates_=function(n,t,i){for(var s,u=i[i.length-1],h=u.hasZ,c=u.srsName,f=t.getCoordinates(),e=f.length,o=new Array(e),r=0;r<e;++r)s=f[r],o[r]=this.getCoords_(s,c,h);ut(n,o.join(" "))},t.prototype.writeCurveSegments_=function(n,t,i){var r=rt(n.namespaceURI,"LineStringSegment");n.appendChild(r);this.writeCurveOrLineString_(r,t,i)},t.prototype.writeSurfaceOrPolygon_=function(n,t,i){var f=i[i.length-1],o=f.hasZ,r=f.srsName,e,u;("PolygonPatch"!==n.nodeName&&r&&n.setAttribute("srsName",r),"Polygon"===n.nodeName||"PolygonPatch"===n.nodeName)?(e=t.getLinearRings(),it({node:n,hasZ:o,srsName:r},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,e,i,void 0,this)):"Surface"===n.nodeName&&(u=rt(n.namespaceURI,"patches"),n.appendChild(u),this.writeSurfacePatches_(u,t,i))},t.prototype.RING_NODE_FACTORY_=function(n,t){var i=t[t.length-1],u=i.node,r=i.exteriorWritten;return void 0===r&&(i.exteriorWritten=!0),rt(u.namespaceURI,void 0!==r?"innerBoundaryIs":"outerBoundaryIs")},t.prototype.writeSurfacePatches_=function(n,t,i){var r=rt(n.namespaceURI,"PolygonPatch");n.appendChild(r);this.writeSurfaceOrPolygon_(r,t,i)},t.prototype.writeRing_=function(n,t,i){var r=rt(n.namespaceURI,"LinearRing");n.appendChild(r);this.writeLinearRing_(r,t,i)},t.prototype.getCoords_=function(n,t,i){var u="enu",r;return t&&(u=y(t).getAxisOrientation()),r="en"===u.substr(0,2)?n[0]+","+n[1]:n[1]+","+n[0],i&&(r+=","+(n[2]||0)),r},t.prototype.writePoint_=function(n,t,i){var f=i[i.length-1],o=f.hasZ,r=f.srsName,u,e;r&&n.setAttribute("srsName",r);u=this.createCoordinatesNode_(n.namespaceURI);n.appendChild(u);e=t.getCoordinates();ut(u,this.getCoords_(e,r,o))},t.prototype.writeMultiPoint_=function(n,t,i){var u=i[i.length-1],e=u.hasZ,r=u.srsName,f;r&&n.setAttribute("srsName",r);f=t.getPoints();it({node:n,hasZ:e,srsName:r},this.POINTMEMBER_SERIALIZERS_,gt("pointMember"),f,i,void 0,this)},t.prototype.writePointMember_=function(n,t,i){var r=rt(n.namespaceURI,"Point");n.appendChild(r);this.writePoint_(r,t,i)},t.prototype.writeLinearRing_=function(n,t,i){var u=i[i.length-1].srsName,r;u&&n.setAttribute("srsName",u);r=this.createCoordinatesNode_(n.namespaceURI);n.appendChild(r);this.writeCoordinates_(r,t,i)},t.prototype.writeMultiSurfaceOrPolygon_=function(n,t,i){var r=i[i.length-1],e=r.hasZ,u=r.srsName,o=r.surface,f;u&&n.setAttribute("srsName",u);f=t.getPolygons();it({node:n,hasZ:e,srsName:u,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,f,i,void 0,this)},t.prototype.writeSurfaceOrPolygonMember_=function(n,t,i){var r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(n.appendChild(r),this.writeSurfaceOrPolygon_(r,t,i))},t.prototype.writeEnvelope=function(n,t,i){var r=i[i.length-1].srsName,u;r&&n.setAttribute("srsName",r);u=[t[0]+" "+t[1],t[2]+" "+t[3]];it({node:n},this.ENVELOPE_SERIALIZERS_,ir,u,i,["lowerCorner","upperCorner"],this)},t.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(n,t){var i=t[t.length-1].node;return rt("http://www.opengis.net/gml",usi[i.nodeName])},t}(ht);at.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:tt(at.prototype.readFlatCoordinates_)}};at.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:at.prototype.innerBoundaryIsParser_,outerBoundaryIs:at.prototype.outerBoundaryIsParser_}};at.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:b(at.prototype.readFlatCoordinates_)}};at.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:tt(ht.prototype.readPoint),MultiPoint:tt(ht.prototype.readMultiPoint),LineString:tt(ht.prototype.readLineString),MultiLineString:tt(ht.prototype.readMultiLineString),LinearRing:tt(ht.prototype.readLinearRing),Polygon:tt(ht.prototype.readPolygon),MultiPolygon:tt(ht.prototype.readMultiPolygon),Box:tt(at.prototype.readBox_)}};at.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:e(at.prototype.writeCurveOrLineString_),MultiCurve:e(at.prototype.writeMultiCurveOrLineString_),Point:e(at.prototype.writePoint_),MultiPoint:e(at.prototype.writeMultiPoint_),LineString:e(at.prototype.writeCurveOrLineString_),MultiLineString:e(at.prototype.writeMultiCurveOrLineString_),LinearRing:e(at.prototype.writeLinearRing_),Polygon:e(at.prototype.writeSurfaceOrPolygon_),MultiPolygon:e(at.prototype.writeMultiSurfaceOrPolygon_),Surface:e(at.prototype.writeSurfaceOrPolygon_),MultiSurface:e(at.prototype.writeMultiSurfaceOrPolygon_),Envelope:e(at.prototype.writeEnvelope)}};at.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:e(at.prototype.writeLineStringOrCurveMember_),curveMember:e(at.prototype.writeLineStringOrCurveMember_)}};at.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:e(at.prototype.writeRing_),innerBoundaryIs:e(at.prototype.writeRing_)}};at.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:e(at.prototype.writePointMember_)}};at.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:e(at.prototype.writeSurfaceOrPolygonMember_),polygonMember:e(at.prototype.writeSurfaceOrPolygonMember_)}};at.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:e(ut),upperCorner:e(ut)}};var dp=at,fsi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wt=function(n){function t(t){var i=this,r=t||{};return(i=n.call(this,r)||this).schemaLocation=r.schemaLocation?r.schemaLocation:i.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",i}return fsi(t,n),t}(ft);wt.prototype.namespace="http://www.opengis.net/gml/3.2";wt.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:tt(ft.prototype.readFlatPos_),posList:tt(ft.prototype.readFlatPosList_)}};wt.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:ft.prototype.interiorParser_,exterior:ft.prototype.exteriorParser_}};wt.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:tt(ht.prototype.readPoint),MultiPoint:tt(ht.prototype.readMultiPoint),LineString:tt(ht.prototype.readLineString),MultiLineString:tt(ht.prototype.readMultiLineString),LinearRing:tt(ht.prototype.readLinearRing),Polygon:tt(ht.prototype.readPolygon),MultiPolygon:tt(ht.prototype.readMultiPolygon),Surface:tt(wt.prototype.readSurface_),MultiSurface:tt(ft.prototype.readMultiSurface_),Curve:tt(wt.prototype.readCurve_),MultiCurve:tt(ft.prototype.readMultiCurve_),Envelope:tt(wt.prototype.readEnvelope_)}};wt.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{curveMember:b(ft.prototype.curveMemberParser_),curveMembers:b(ft.prototype.curveMemberParser_)}};wt.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:b(ft.prototype.surfaceMemberParser_),surfaceMembers:b(ft.prototype.surfaceMemberParser_)}};wt.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:b(ht.prototype.readLineString),Curve:b(ft.prototype.readCurve_)}};wt.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:b(ht.prototype.readPolygon),Surface:b(ft.prototype.readSurface_)}};wt.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{patches:tt(ft.prototype.readPatch_)}};wt.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{segments:tt(ft.prototype.readSegment_)}};wt.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:b(ft.prototype.readFlatPosList_),upperCorner:b(ft.prototype.readFlatPosList_)}};wt.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml/3.2":{PolygonPatch:tt(ft.prototype.readPolygonPatch_)}};wt.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml/3.2":{LineStringSegment:tt(ft.prototype.readLineStringSegment_)}};wt.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml/3.2":{pointMember:b(ht.prototype.pointMemberParser_),pointMembers:b(ht.prototype.pointMemberParser_)}};wt.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:b(ht.prototype.lineStringMemberParser_),lineStringMembers:b(ht.prototype.lineStringMemberParser_)}};wt.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml/3.2":{polygonMember:b(ht.prototype.polygonMemberParser_),polygonMembers:b(ht.prototype.polygonMemberParser_)}};wt.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Point:b(ht.prototype.readFlatCoordinatesFromNode_)}};wt.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:b(ht.prototype.readLineString)}};wt.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:b(ht.prototype.readPolygon)}};wt.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:tt(ht.prototype.readFlatLinearRing_)}};wt.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{exterior:e(ft.prototype.writeRing_),interior:e(ft.prototype.writeRing_)}};wt.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:e(ut),upperCorner:e(ut)}};wt.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:e(ft.prototype.writeSurfaceOrPolygonMember_),polygonMember:e(ft.prototype.writeSurfaceOrPolygonMember_)}};wt.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{pointMember:e(ft.prototype.writePointMember_)}};wt.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:e(ft.prototype.writeLineStringOrCurveMember_),curveMember:e(ft.prototype.writeLineStringOrCurveMember_)}};wt.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{Curve:e(ft.prototype.writeCurveOrLineString_),MultiCurve:e(ft.prototype.writeMultiCurveOrLineString_),Point:e(wt.prototype.writePoint_),MultiPoint:e(ft.prototype.writeMultiPoint_),LineString:e(ft.prototype.writeCurveOrLineString_),MultiLineString:e(ft.prototype.writeMultiCurveOrLineString_),LinearRing:e(ft.prototype.writeLinearRing_),Polygon:e(ft.prototype.writeSurfaceOrPolygon_),MultiPolygon:e(ft.prototype.writeMultiSurfaceOrPolygon_),Surface:e(ft.prototype.writeSurfaceOrPolygon_),MultiSurface:e(ft.prototype.writeMultiSurfaceOrPolygon_),Envelope:e(ft.prototype.writeEnvelope)}};var esi=wt,osi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bi=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],ssi={rte:ult,trk:flt,wpt:elt},hsi=o(bi,{rte:b(ult),trk:b(flt),wpt:b(elt)}),csi=o(bi,{text:u(h,"linkText"),type:u(h,"linkType")}),lsi=o(bi,{rte:e(function(n,t,i){var h=i[0],r=t.getProperties(),u={node:n},e,o;u.properties=r;e=t.getGeometry();e.getType()==f.LINE_STRING&&(o=ei(e,!0,h),u.geometryLayout=o.getLayout(),r.rtept=o.getCoordinates());var c=i[i.length-1].node,s=nhi[c.namespaceURI],l=su(r,s);it(u,thi,ir,l,i,s)}),trk:e(function(n,t,i){var h=i[0],r=t.getProperties(),e={node:n},u,o;e.properties=r;u=t.getGeometry();u.getType()==f.MULTI_LINE_STRING&&(o=ei(u,!0,h),r.trkseg=o.getLineStrings());var c=i[i.length-1].node,s=rhi[c.namespaceURI],l=su(r,s);it(e,uhi,ir,l,i,s)}),wpt:e(function(n,t,i){var o=i[0],e=i[i.length-1],r,u;e.properties=t.getProperties();r=t.getGeometry();r.getType()==f.POINT&&(u=ei(r,!0,o),e.geometryLayout=u.getLayout(),nn(n,u.getCoordinates(),i))})}),asi=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.dataProjection=y("EPSG:4326"),i.readExtensions_=r.readExtensions,i}return osi(t,n),t.prototype.handleReadExtensions_=function(n){var t,r,i,u;for(n||(n=[]),t=0,r=n.length;t<r;++t)i=n[t],this.readExtensions_&&(u=i.get("extensionsNode_")||null,this.readExtensions_(i,u)),i.set("extensionsNode_",void 0)},t.prototype.readFeatureFromNode=function(n,t){var r,i;return di(bi,n.namespaceURI)?(r=ssi[n.localName],!r)?null:(i=r(n,[this.getReadOptions(n,t)]),i?(this.handleReadExtensions_([i]),i):null):null},t.prototype.readFeaturesFromNode=function(n,t){if(!di(bi,n.namespaceURI))return[];if("gpx"==n.localName){var i=s([],hsi,n,[this.getReadOptions(n,t)]);return i?(this.handleReadExtensions_(i),i):[]}return[]},t.prototype.writeFeaturesNode=function(n,t){t=this.adaptOptions(t);var i=rt("http://www.topografix.com/GPX/1/1","gpx");return i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",eo),i.setAttributeNS(eo,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),i.setAttribute("version","1.1"),i.setAttribute("creator","OpenLayers"),it({node:i},lsi,chi,n,[t]),i},t}(ac),vsi=o(bi,{name:u(h),cmt:u(h),desc:u(h),src:u(h),link:kg,number:u(rr),extensions:dg,type:u(h),rtept:function(n,t){var i=s({},ysi,n,t);if(i){var r=t[t.length-1],u=r.flatCoordinates,f=r.layoutOptions;wg(u,f,n,i)}}}),ysi=o(bi,{ele:u(yt),time:u(pg)}),psi=o(bi,{name:u(h),cmt:u(h),desc:u(h),src:u(h),link:kg,number:u(rr),type:u(h),extensions:dg,trkseg:function(n,t){var i=t[t.length-1],r;kr(wsi,n,t);r=i.flatCoordinates;i.ends.push(r.length)}}),wsi=o(bi,{trkpt:function(n,t){var i=s({},bsi,n,t);if(i){var r=t[t.length-1],u=r.flatCoordinates,f=r.layoutOptions;wg(u,f,n,i)}}}),bsi=o(bi,{ele:u(yt),time:u(pg)}),ksi=o(bi,{ele:u(yt),time:u(pg),magvar:u(yt),geoidheight:u(yt),name:u(h),cmt:u(h),desc:u(h),src:u(h),link:kg,sym:u(h),type:u(h),fix:u(h),sat:u(rr),hdop:u(yt),vdop:u(yt),pdop:u(yt),ageofdgpsdata:u(yt),dgpsid:u(rr),extensions:dg}),dsi=["text","type"],gsi=o(bi,{text:e(ut),type:e(ut)}),nhi=o(bi,["name","cmt","desc","src","link","number","type","rtept"]),thi=o(bi,{name:e(ut),cmt:e(ut),desc:e(ut),src:e(ut),link:e(gg),number:e(bp),type:e(ut),rtept:sot(e(nn))}),ihi=o(bi,["ele","time"]),rhi=o(bi,["name","cmt","desc","src","link","number","type","trkseg"]),uhi=o(bi,{name:e(ut),cmt:e(ut),desc:e(ut),src:e(ut),link:e(gg),number:e(bp),type:e(ut),trkseg:sot(e(function(n,t,i){var r={node:n};r.geometryLayout=t.getLayout();r.properties={};it(r,ehi,fhi,t.getCoordinates(),i)}))}),fhi=gt("trkpt"),ehi=o(bi,{trkpt:e(nn)}),ohi=o(bi,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),shi=o(bi,{ele:e(gr),time:e(function(n,t){var i=new Date(1e3*t),r=i.getUTCFullYear()+"-"+os(i.getUTCMonth()+1,2)+"-"+os(i.getUTCDate(),2)+"T"+os(i.getUTCHours(),2)+":"+os(i.getUTCMinutes(),2)+":"+os(i.getUTCSeconds(),2)+"Z";n.appendChild(vs.createTextNode(r))}),magvar:e(gr),geoidheight:e(gr),name:e(ut),cmt:e(ut),desc:e(ut),src:e(ut),link:e(gg),sym:e(ut),type:e(ut),fix:e(ut),sat:e(bp),hdop:e(gr),vdop:e(gr),pdop:e(gr),ageofdgpsdata:e(gr),dgpsid:e(bp)}),hhi={Point:"wpt",LineString:"rte",MultiLineString:"trk"};olt=asi;slt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();hlt=function(n){function t(t){var r=this,i=t||{};return(r=n.call(this)||this).dataProjection=y(i.dataProjection?i.dataProjection:"EPSG:4326"),i.featureProjection&&(r.defaultFeatureProjection=y(i.featureProjection)),r.geometryName_=i.geometryName,r.extractGeometryName_=i.extractGeometryName,r}return slt(t,n),t.prototype.readFeatureFromObject=function(n,t){var i=null,u=tn((i="Feature"===n.type?n:{type:"Feature",geometry:n,properties:null}).geometry,t),r=new ui;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&r.setGeometryName(i.geometry_name),r.setGeometry(u),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r},t.prototype.readFeaturesFromObject=function(n,t){var i=null;if("FeatureCollection"===n.type){i=[];for(var u=n.features,r=0,f=u.length;r<f;++r)i.push(this.readFeatureFromObject(u[r],t))}else i=[this.readFeatureFromObject(n,t)];return i},t.prototype.readGeometryFromObject=function(n,t){return tn(n,t)},t.prototype.readProjectionFromObject=function(n){var t,i=n.crs;return i?"name"==i.type?t=y(i.properties.name):p(!1,36):t=this.dataProjection,t},t.prototype.writeFeatureObject=function(n,t){var i,u,f,r;return t=this.adaptOptions(t),i={type:"Feature",geometry:null,properties:null},u=n.getId(),void 0!==u&&(i.id=u),f=n.getGeometry(),f&&(i.geometry=rn(f,t)),r=n.getProperties(),delete r[n.getGeometryName()],bo(r)||(i.properties=r),i},t.prototype.writeFeaturesObject=function(n,t){t=this.adaptOptions(t);for(var r=[],i=0,u=n.length;i<u;++i)r.push(this.writeFeatureObject(n[i],t));return{type:"FeatureCollection",features:r}},t.prototype.writeGeometryObject=function(n,t){return rn(n,this.adaptOptions(t))},t}(yg);clt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var ya,un,fn,en,nw,pa,on,sn=function(n){function t(){return n.call(this)||this}return clt(t,n),t.prototype.getType=function(){return ue.TEXT},t.prototype.readFeature=function(n,t){return this.readFeatureFromText(gp(n),this.adaptOptions(t))},t.prototype.readFeatureFromText=function(){return w()},t.prototype.readFeatures=function(n,t){return this.readFeaturesFromText(gp(n),this.adaptOptions(t))},t.prototype.readFeaturesFromText=function(){return w()},t.prototype.readGeometry=function(n,t){return this.readGeometryFromText(gp(n),this.adaptOptions(t))},t.prototype.readGeometryFromText=function(){return w()},t.prototype.readProjection=function(n){return this.readProjectionFromText(gp(n))},t.prototype.readProjectionFromText=function(){return this.dataProjection},t.prototype.writeFeature=function(n,t){return this.writeFeatureText(n,this.adaptOptions(t))},t.prototype.writeFeatureText=function(){return w()},t.prototype.writeFeatures=function(n,t){return this.writeFeaturesText(n,this.adaptOptions(t))},t.prototype.writeFeaturesText=function(){return w()},t.prototype.writeGeometry=function(n,t){return this.writeGeometryText(n,this.adaptOptions(t))},t.prototype.writeGeometryText=function(){return w()},t}(cc),lhi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wa={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"},ahi=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,vhi=/^H.([A-Z]{3}).*?:(.*)/,yhi=/^HFDTE(\d{2})(\d{2})(\d{2})/,phi=/\r\n|\r|\n/,whi=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.dataProjection=y("EPSG:4326"),i.altitudeMode_=r.altitudeMode?r.altitudeMode:wa.NONE,i}return lhi(t,n),t.prototype.readFeatureFromText=function(n,t){for(var o=this.altitudeMode_,w=n.split(phi),b={},u=[],h=2e3,c=0,a=1,k=-1,r,i,s,y,f,e=0,p=w.length;e<p;++e)if(r=w[e],i=void 0,"B"==r.charAt(0)){if(i=ahi.exec(r)){var d=parseInt(i[1],10),g=parseInt(i[2],10),nt=parseInt(i[3],10),v=parseInt(i[4],10)+parseInt(i[5],10)/6e4;"S"==i[6]&&(v=-v);s=parseInt(i[7],10)+parseInt(i[8],10)/6e4;("W"==i[9]&&(s=-s),u.push(s,v),o!=wa.NONE)&&(y=void 0,y=o==wa.GPS?parseInt(i[11],10):o==wa.BAROMETRIC?parseInt(i[12],10):0,u.push(y));f=Date.UTC(h,c,a,d,g,nt);f<k&&(f=Date.UTC(h,c,a+1,d,g,nt));u.push(f/1e3);k=f}}else"H"==r.charAt(0)&&((i=yhi.exec(r))?(a=parseInt(i[1],10),c=parseInt(i[2],10)-1,h=2e3+parseInt(i[3],10)):(i=vhi.exec(r))&&(b[i[1]]=i[2].trim()));if(0===u.length)return null;var it=o==wa.NONE?l.XYM:l.XYZM,rt=new ai(u,it),tt=new ui(ei(rt,!1,t));return tt.setProperties(b,!0),tt},t.prototype.readFeaturesFromText=function(n,t){var i=this.readFeatureFromText(n,t);return i?[i]:[]},t}(sn),bhi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ae=["http://www.google.com/kml/ext/2.2"],g=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],llt={fraction:er.FRACTION,pixels:er.PIXELS,insetPixels:er.PIXELS},khi=o(g,{ExtendedData:vat,Region:yat,MultiGeometry:u(eat,"geometry"),LineString:u(rat,"geometry"),LinearRing:u(uat,"geometry"),Point:u(oat,"geometry"),Polygon:u(hat,"geometry"),Style:u(bn),StyleMap:function(n,t){var i=blt(n,t),r;i&&(r=t[t.length-1],Array.isArray(i)?r.Style=i:"string"==typeof i?r.styleUrl=i:p(!1,38))},address:u(h),description:u(h),name:u(h),open:u(vo),phoneNumber:u(h),styleUrl:u(iw),visibility:u(vo)},o(ae,{MultiTrack:u(function(n,t){var i=s([],dlt,n,t);if(i)return new au(i)},"geometry"),Track:u(nat,"geometry")})),dhi=o(g,{ExtendedData:vat,Region:yat,Link:function(n,t){kr(ghi,n,t)},address:u(h),description:u(h),name:u(h),open:u(vo),phoneNumber:u(h),visibility:u(vo)}),ghi=o(g,{href:u(iw)}),alt=o(g,{LatLonAltBox:function(n,t){var i=s({},cci,n,t),r,u;i&&(r=t[t.length-1],u=[parseFloat(i.west),parseFloat(i.south),parseFloat(i.east),parseFloat(i.north)],r.extent=u,r.altitudeMode=i.altitudeMode,r.minAltitude=parseFloat(i.minAltitude),r.maxAltitude=parseFloat(i.maxAltitude))},Lod:function(n,t){var i=s({},lci,n,t),r;i&&(r=t[t.length-1],r.minLodPixels=parseFloat(i.minLodPixels),r.maxLodPixels=parseFloat(i.maxLodPixels),r.minFadeExtent=parseFloat(i.minFadeExtent),r.maxFadeExtent=parseFloat(i.maxFadeExtent))}}),nci=o(g,["Document","Placemark"]),tci=o(g,{Document:e(function(n,t,i){it({node:n},yci,pci,t,i,void 0,this)}),Placemark:e(nvt)}),tw=null,hn,cn=null,ln,an=null,ih=null,vlt=null,vn=null,ici=function(n){function t(t){var r=n.call(this)||this,i=t||{};return vn||(tw=new vf({color:ya=[255,255,255,1]}),un=[20,2],fn=er.PIXELS,en=er.PIXELS,nw=[64,64],pa="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",on=.5,cn=new ip({anchor:un,anchorOrigin:ki.BOTTOM_LEFT,anchorXUnits:fn,anchorYUnits:en,crossOrigin:"anonymous",rotation:0,scale:on,size:nw,src:pa}),hn="NO_IMAGE",an=new gu({color:ya,width:1}),ln=new gu({color:[51,51,51,1],width:2}),ih=new ia({font:"bold 16px Helvetica",fill:tw,stroke:ln,scale:.8}),vlt=new ys({fill:tw,image:cn,text:ih,stroke:an,zIndex:0}),vn=[vlt]),r.dataProjection=y("EPSG:4326"),r.defaultStyle_=i.defaultStyle?i.defaultStyle:vn,r.extractStyles_=void 0===i.extractStyles||i.extractStyles,r.writeStyles_=void 0===i.writeStyles||i.writeStyles,r.sharedStyles_={},r.showPointNames_=void 0===i.showPointNames||i.showPointNames,r}return bhi(t,n),t.prototype.readDocumentOrFolder_=function(n,t){var i=s([],o(g,{Document:oot(this.readDocumentOrFolder_,this),Folder:oot(this.readDocumentOrFolder_,this),Placemark:b(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),n,t,this);return i||void 0},t.prototype.readPlacemark_=function(n,t){var i=s({geometry:null},khi,n,t),r,e,o,u,h;if(i)return r=new ui,e=n.getAttribute("id"),null!==e&&r.setId(e),o=t[0],u=i.geometry,(u&&ei(u,!1,o),r.setGeometry(u),delete i.geometry,this.extractStyles_)&&(h=function(n,t,i,r,u){return function(e){var s,o=u,h="",l,c;return(o&&(l=e.getGeometry(),l&&(o=l.getType()===f.POINT)),o&&(h=e.get("name"),o=o&&!!h),n)?o?(s=yn(n[0],h),n.concat(s)):n:t?(c=function n(t,i,r){return Array.isArray(t)?t:"string"==typeof t?(!(t in r)&&"#"+t in r&&(t="#"+t),n(r[t],i,r)):i}(t,i,r),o?(s=yn(c[0],h),c.concat(s)):c):o?(s=yn(i[0],h),i.concat(s)):i}}(i.Style,i.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_),r.setStyle(h)),delete i.Style,r.setProperties(i,!0),r},t.prototype.readSharedStyle_=function(n,t){var r=n.getAttribute("id"),u,f,i;null!==r&&(u=bn(n,t),u&&(f=void 0,i=n.baseURI,f=(i&&"about:blank"!=i||(i=window.location.href),i)?new URL("#"+r,i).href:"#"+r,this.sharedStyles_[f]=u))},t.prototype.readSharedStyleMap_=function(n,t){var r=n.getAttribute("id"),u,f,i;null!==r&&(u=blt(n,t),u&&(i=n.baseURI,f=(i&&"about:blank"!=i||(i=window.location.href),i)?new URL("#"+r,i).href:"#"+r,this.sharedStyles_[f]=u))},t.prototype.readFeatureFromNode=function(n,t){if(!di(g,n.namespaceURI))return null;var i=this.readPlacemark_(n,[this.getReadOptions(n,t)]);return i||null},t.prototype.readFeaturesFromNode=function(n,t){var u,i,f,r,e;if(!di(g,n.namespaceURI))return[];if(i=n.localName,"Document"==i||"Folder"==i)return(u=this.readDocumentOrFolder_(n,[this.getReadOptions(n,t)]))||[];if("Placemark"==i)return f=this.readPlacemark_(n,[this.getReadOptions(n,t)]),f?[f]:[];if("kml"==i){for(u=[],r=n.firstElementChild;r;r=r.nextElementSibling)e=this.readFeaturesFromNode(r,t),e&&pt(u,e);return u}return[]},t.prototype.readName=function(n){if(n){if("string"==typeof n){var t=ku(n);return this.readNameFromDocument(t)}return lf(n)?this.readNameFromDocument(n):this.readNameFromNode(n)}},t.prototype.readNameFromDocument=function(n){for(var i,t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE&&(i=this.readNameFromNode(t),i))return i},t.prototype.readNameFromNode=function(n){for(var i,r,t=n.firstElementChild;t;t=t.nextElementSibling)if(di(g,t.namespaceURI)&&"name"==t.localName)return h(t);for(t=n.firstElementChild;t;t=t.nextElementSibling)if(i=t.localName,di(g,t.namespaceURI)&&("Document"==i||"Folder"==i||"Placemark"==i||"kml"==i)&&(r=this.readNameFromNode(t),r))return r},t.prototype.readNetworkLinks=function(n){var t=[],i;return"string"==typeof n?(i=ku(n),pt(t,this.readNetworkLinksFromDocument(i))):lf(n)?pt(t,this.readNetworkLinksFromDocument(n)):pt(t,this.readNetworkLinksFromNode(n)),t},t.prototype.readNetworkLinksFromDocument=function(n){for(var i=[],t=n.firstChild;t;t=t.nextSibling)t.nodeType==Node.ELEMENT_NODE&&pt(i,this.readNetworkLinksFromNode(t));return i},t.prototype.readNetworkLinksFromNode=function(n){for(var u,r,i=[],t=n.firstElementChild;t;t=t.nextElementSibling)di(g,t.namespaceURI)&&"NetworkLink"==t.localName&&(u=s({},dhi,t,[]),i.push(u));for(t=n.firstElementChild;t;t=t.nextElementSibling)r=t.localName,di(g,t.namespaceURI)&&("Document"==r||"Folder"==r||"kml"==r)&&pt(i,this.readNetworkLinksFromNode(t));return i},t.prototype.readRegion=function(n){var t=[],i;return"string"==typeof n?(i=ku(n),pt(t,this.readRegionFromDocument(i))):lf(n)?pt(t,this.readRegionFromDocument(n)):pt(t,this.readRegionFromNode(n)),t},t.prototype.readRegionFromDocument=function(n){for(var i=[],t=n.firstChild;t;t=t.nextSibling)t.nodeType==Node.ELEMENT_NODE&&pt(i,this.readRegionFromNode(t));return i},t.prototype.readRegionFromNode=function(n){for(var u,r,i=[],t=n.firstElementChild;t;t=t.nextElementSibling)di(g,t.namespaceURI)&&"Region"==t.localName&&(u=s({},alt,t,[]),i.push(u));for(t=n.firstElementChild;t;t=t.nextElementSibling)r=t.localName,di(g,t.namespaceURI)&&("Document"==r||"Folder"==r||"kml"==r)&&pt(i,this.readRegionFromNode(t));return i},t.prototype.writeFeaturesNode=function(n,t){var i,u,e,r,f,o;return t=this.adaptOptions(t),i=rt(g[4],"kml"),u="http://www.w3.org/2000/xmlns/",i.setAttributeNS(u,"xmlns:gx",ae[0]),i.setAttributeNS(u,"xmlns:xsi",eo),i.setAttributeNS(eo,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd"),e={node:i},r={},n.length>1?r.Document=n:1==n.length&&(r.Placemark=n[0]),f=nci[i.namespaceURI],o=su(r,f),it(e,tci,ir,o,[t],f,this),i},t}(ac);wlt=o(g,{Pair:function(n,t){var i=s({},sci,n,t),r,u,f;i&&(r=i.key,r&&"normal"==r&&(u=i.styleUrl,u&&(t[t.length-1]=u),f=i.Style,f&&(t[t.length-1]=f)))}});var rci=o(g,{Icon:u(function(n,t){var i=s({},tat,n,t);return i||null}),heading:u(yt),hotSpot:u(function(n){var i,r=n.getAttribute("xunits"),t=n.getAttribute("yunits");return i="insetPixels"!==r?"insetPixels"!==t?ki.BOTTOM_LEFT:ki.TOP_LEFT:"insetPixels"!==t?ki.BOTTOM_RIGHT:ki.TOP_RIGHT,{x:parseFloat(n.getAttribute("x")),xunits:llt[r],y:parseFloat(n.getAttribute("y")),yunits:llt[t],origin:i}}),scale:u(plt)}),uci=o(g,{color:u(pn),scale:u(plt)}),fci=o(g,{color:u(pn),width:u(yt)}),eci=o(g,{color:u(pn),fill:u(vo),outline:u(vo)}),oci=o(g,{coordinates:tt(ylt)});dlt=o(ae,{Track:b(nat)});glt=o(g,{when:function(n,t){var r=t[t.length-1].whens,u=ar(n,!1),i=Date.parse(u);r.push(isNaN(i)?0:i)}},o(ae,{coord:function(n,t){var r=t[t.length-1].flatCoordinates,u=ar(n,!1),i=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(u);if(i){var f=parseFloat(i[1]),e=parseFloat(i[2]),o=parseFloat(i[3]);r.push(f,e,o,0)}else r.push(0,0,0,0)}}));tat=o(g,{href:u(iw)},o(ae,{x:u(yt),y:u(yt),w:u(yt),h:u(yt)}));iat=o(g,{coordinates:tt(ylt)});ba=o(g,{extrude:u(vo),tessellate:u(vo),altitudeMode:u(h)});fat=o(g,{LineString:b(rat),LinearRing:b(uat),MultiGeometry:b(eat),Point:b(oat),Polygon:b(hat)});sat=o(g,{innerBoundaryIs:function(n,t){var i=s(void 0,aci,n,t);i&&t[t.length-1].push(i)},outerBoundaryIs:function(n,t){var i=s(void 0,vci,n,t);i&&(t[t.length-1][0]=i)}});cat=o(g,{IconStyle:function(n,t){var i=s({},rci,n,t),nt,l,r,a,v,y,tt,p,w,b,c,it;if(i){var u,e,o,h,k=t[t.length-1],f="Icon"in i?i.Icon:{},d=!("Icon"in i)||Object.keys(f).length>0,g=f.href;g?u=g:d&&(u=pa);l=ki.BOTTOM_LEFT;r=i.hotSpot;r?(e=[r.x,r.y],o=r.xunits,h=r.yunits,l=r.origin):u===pa?(e=un,o=fn,h=en):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(u)&&(e=[.5,0],o=er.FRACTION,h=er.FRACTION);v=f.x;y=f.y;void 0!==v&&void 0!==y&&(nt=[v,y]);p=f.w;w=f.h;void 0!==p&&void 0!==w&&(a=[p,w]);b=i.heading;void 0!==b&&(tt=yu(b));c=i.scale;d?(u==pa&&(a=nw,void 0===c&&(c=on)),it=new ip({anchor:e,anchorOrigin:l,anchorXUnits:o,anchorYUnits:h,crossOrigin:"anonymous",offset:nt,offsetOrigin:ki.BOTTOM_LEFT,rotation:tt,scale:c,size:a,src:u}),k.imageStyle=it):k.imageStyle=hn}},LabelStyle:function(n,t){var i=s({},uci,n,t),r,u;i&&(r=t[t.length-1],u=new ia({fill:new vf({color:"color"in i?i.color:ya}),scale:i.scale}),r.textStyle=u)},LineStyle:function(n,t){var i=s({},fci,n,t),r,u;i&&(r=t[t.length-1],u=new gu({color:"color"in i?i.color:ya,width:"width"in i?i.width:1}),r.strokeStyle=u)},PolyStyle:function(n,t){var i=s({},eci,n,t),r,e,u,f;i&&(r=t[t.length-1],e=new vf({color:"color"in i?i.color:ya}),r.fillStyle=e,u=i.fill,void 0!==u&&(r.fill=u),f=i.outline,void 0!==f&&(r.outline=f))}});lat=o(g,{displayName:u(h),value:u(h)});aat=o(g,{Data:function(n,t){var r=n.getAttribute("name"),i;kr(lat,n,t);i=t[t.length-1];r&&i.displayName?i[r]={value:i.value,displayName:i.displayName,toString:function(){return i.value}}:null!==r?i[r]=i.value:null!==i.displayName&&(i[i.displayName]=i.value);delete i.value},SchemaData:function(n,t){kr(hci,n,t)}});var sci=o(g,{Style:u(bn),key:u(h),styleUrl:u(iw)}),hci=o(g,{SimpleData:function(n,t){var i=n.getAttribute("name"),r;null!==i&&(r=h(n),t[t.length-1][i]=r)}}),cci=o(g,{altitudeMode:u(h),minAltitude:u(yt),maxAltitude:u(yt),north:u(yt),south:u(yt),east:u(yt),west:u(yt)}),lci=o(g,{minLodPixels:u(yt),maxLodPixels:u(yt),minFadeExtent:u(yt),maxFadeExtent:u(yt)}),aci=o(g,{LinearRing:tt(klt)}),vci=o(g,{LinearRing:tt(klt)});var rw=o(g,{Data:e(function(n,t,i){n.setAttribute("name",t.name);var u={node:n},r=t.value;"object"==typeof r?(null!==r&&r.displayName&&it(u,rw,ir,[r.displayName],i,["displayName"]),null!==r&&r.value&&it(u,rw,ir,[r.value],i,["value"])):it(u,rw,ir,[r],i,["value"])}),value:e(function(n,t){ut(n,t)}),displayName:e(function(n,t){!function(n,t){n.appendChild(vs.createCDATASection(t))}(n,t)})}),yci=o(g,{Placemark:e(nvt)}),pci=function(n,t){return rt(t[t.length-1].node.namespaceURI,"Placemark")},wci=gt("Data"),pat=o(g,["href"],o(ae,["x","y","w","h"])),wat=o(g,{href:e(ut)},o(ae,{x:e(gr),y:e(gr),w:e(gr),h:e(gr)})),bci=function(n,t,i){return rt(ae[0],"gx:"+i)},kci=o(g,["scale","heading","Icon","hotSpot"]),dci=o(g,{Icon:e(function(n,t,i){var f={node:n},e=i[i.length-1].node,r=pat[e.namespaceURI],u=su(t,r);it(f,wat,ir,u,i,r);u=su(t,r=pat[ae[0]]);it(f,wat,bci,u,i,r)}),heading:e(gr),hotSpot:e(function(n,t){n.setAttribute("x",String(t.x));n.setAttribute("y",String(t.y));n.setAttribute("xunits",t.xunits);n.setAttribute("yunits",t.yunits)}),scale:e(ovt)}),gci=o(g,["color","scale"]),nli=o(g,{color:e(dn),scale:e(ovt)}),tli=o(g,["color","width"]),ili=o(g,{color:e(dn),width:e(gr)}),rli={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},bat=function(n,t){if(n)return rt(t[t.length-1].node.namespaceURI,rli[n.getType()])},uli=gt("Point"),fli=gt("LineString"),eli=gt("LinearRing"),oli=gt("Polygon"),sli=o(g,{LineString:e(vc),Point:e(vc),Polygon:e(uvt),GeometryCollection:e(kat)});dat=o(g,{LinearRing:e(vc)});var gn=o(g,{ExtendedData:e(function(n,t,i){for(var f={node:n},u=t.names,e=t.values,o=u.length,r=0;r<o;r++)it(f,rw,wci,[{name:u[r],value:e[r]}],i)}),MultiGeometry:e(kat),LineString:e(vc),LinearRing:e(vc),Point:e(vc),Polygon:e(uvt),Style:e(function(n,t,i){var h={node:n},r={},f=t.getFill(),e=t.getStroke(),u=t.getImage(),o=t.getText();u&&"function"==typeof u.getSrc&&(r.IconStyle=u);o&&(r.LabelStyle=o);e&&(r.LineStyle=e);f&&(r.PolyStyle=f);var c=i[i.length-1].node,s=vli[c.namespaceURI],l=su(r,s);it(h,yli,ir,l,i,s)}),address:e(ut),description:e(ut),name:e(ut),open:e(wp),phoneNumber:e(ut),styleUrl:e(ut),visibility:e(wp)}),hli=o(g,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),cli=gt("ExtendedData");tvt=o(g,["extrude","tessellate","altitudeMode","coordinates"]);ivt=o(g,{extrude:e(wp),tessellate:e(wp),altitudeMode:e(ut),coordinates:e(function(n,t,i){var e,h=i[i.length-1],o=h.layout,c=h.stride,s,u,r,f;if(o==l.XY||o==l.XYM?e=2:o==l.XYZ||o==l.XYZM?e=3:p(!1,34),s=t.length,u="",s>0){for(u+=t[0],r=1;r<e;++r)u+=","+t[r];for(f=c;f<s;f+=c)for(u+=" "+t[f],r=1;r<e;++r)u+=","+t[f+r]}ut(n,u)})});var rvt=o(g,{outerBoundaryIs:e(gat),innerBoundaryIs:e(gat)}),lli=gt("innerBoundaryIs"),ali=gt("outerBoundaryIs");fvt=o(g,{color:e(dn)});evt=gt("color");var vli=o(g,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),yli=o(g,{IconStyle:e(function(n,t,i){var v={node:n},e={},y=t.getSrc(),r=t.getSize(),c=t.getImageSize(),o={href:y},u,f,l,s,h;r&&(o.w=r[0],o.h=r[1],u=t.getAnchor(),f=t.getOrigin(),(f&&c&&0!==f[0]&&f[1]!==r[1]&&(o.x=f[0],o.y=c[1]-(f[1]+r[1])),u&&(u[0]!==r[0]/2||u[1]!==r[1]/2))&&(l={x:u[0],xunits:er.PIXELS,y:r[1]-u[1],yunits:er.PIXELS},e.hotSpot=l));e.Icon=o;s=t.getScale();1!==s&&(e.scale=s);h=t.getRotation();0!==h&&(e.heading=h);var p=i[i.length-1].node,a=kci[p.namespaceURI],w=su(e,a);it(v,dci,ir,w,i,a)}),LabelStyle:e(function(n,t,i){var o={node:n},u={},f=t.getFill(),r;f&&(u.color=f.getColor());r=t.getScale();r&&1!==r&&(u.scale=r);var s=i[i.length-1].node,e=gci[s.namespaceURI],h=su(u,e);it(o,nli,ir,h,i,e)}),LineStyle:e(function(n,t,i){var u={node:n},f={color:t.getColor(),width:t.getWidth()},e=i[i.length-1].node,r=tli[e.namespaceURI],o=su(f,r);it(u,ili,ir,o,i,r)}),PolyStyle:e(function(n,t,i){it({node:n},fvt,evt,[t.getColor()],i)})}),pli=ici,wli=i(2),bli=i.n(wli),svt=[1,0,0,1,0,0],yc=function(){function n(n,t,i,r,u){this.extent_;this.id_=u;this.type_=n;this.flatCoordinates_=t;this.flatInteriorPoints_=null;this.flatMidpoints_=null;this.ends_=i;this.properties_=r}return n.prototype.get=function(n){return this.properties_[n]},n.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===f.POINT?sh(this.flatCoordinates_):vw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},n.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var n=vr(this.getExtent());this.flatInteriorPoints_=sb(this.flatCoordinates_,0,this.ends_,2,n,0)}return this.flatInteriorPoints_},n.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var n=fct(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=frt(this.flatCoordinates_,0,this.ends_,2,n)}return this.flatInteriorPoints_},n.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=yp(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},n.prototype.getFlatMidpoints=function(){var t,u;if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var f=this.flatCoordinates_,i=0,r=this.ends_,n=0,e=r.length;n<e;++n)t=r[n],u=yp(f,i,t,2,.5),pt(this.flatMidpoints_,u),i=t}return this.flatMidpoints_},n.prototype.getId=function(){return this.id_},n.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},n.prototype.getGeometry=function(){return this},n.prototype.getSimplifiedGeometry=function(){return this},n.prototype.simplifyTransformed=function(){return this},n.prototype.getProperties=function(){return this.properties_},n.prototype.getStride=function(){return 2},n.prototype.getStyleFunction=function(){},n.prototype.getType=function(){return this.type_},n.prototype.transform=function(n){var r=(n=y(n)).getExtent(),t=n.getWorldExtent(),i=ni(t)/ni(r);wr(svt,t[0],t[3],i,-i,0,0,0);ge(this.flatCoordinates_,0,this.flatCoordinates_.length,2,svt,this.flatCoordinates_)},n}();yc.prototype.getEnds=function(){return this.ends_};yc.prototype.getEndss=yc.prototype.getEnds;yc.prototype.getFlatCoordinates=yc.prototype.getOrientedFlatCoordinates;ntt=yc;hvt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var tai=function(n){function t(t){var r=n.call(this)||this,i=t||{};return r.dataProjection=new fl({code:"",units:lu.TILE_PIXELS}),r.featureClass_=i.featureClass?i.featureClass:ntt,r.geometryName_=i.geometryName,r.layerName_=i.layerName?i.layerName:"layer",r.layers_=i.layers?i.layers:null,r.idProperty_=i.idProperty,r}return hvt(t,n),t.prototype.readRawGeometry_=function(n,t,i,r){var s;n.pos=t.geometry;for(var l=n.readVarint()+n.pos,e=1,o=0,h=0,c=0,u=0,f=0;n.pos<l;)o||(s=n.readVarint(),e=7&s,o=s>>3),o--,1===e||2===e?(h+=n.readSVarint(),c+=n.readSVarint(),1===e&&u>f&&(r.push(u),f=u),i.push(h,c),u+=2):7===e?u>f&&(i.push(i[f],i[f+1]),u+=2):p(!1,59);u>f&&(r.push(u),f=u)},t.prototype.createFeature_=function(n,t,i){var o,p=t.type,c,s,r,u,e,a,y,k;if(0===p)return null;if(s=t.properties,this.idProperty_?(c=s[this.idProperty_],delete s[this.idProperty_]):c=t.id,s[this.layerName_]=t.layer.name,r=[],u=[],this.readRawGeometry_(n,t,r,u),e=function(n,t){var i;return 1===n?i=1===t?f.POINT:f.MULTI_POINT:2===n?i=1===t?f.LINE_STRING:f.MULTI_LINE_STRING:3===n&&(i=f.POLYGON),i}(p,u.length),this.featureClass_===ntt)(o=new this.featureClass_(e,r,u,s,c)).transform(i.dataProjection,i.featureProjection);else{if(a=void 0,e==f.POLYGON){for(var v=[],w=0,b=0,h=0,d=u.length;h<d;++h)y=u[h],kv(r,w,y,2)||(v.push(u.slice(b,h)),b=h),w=y;a=v.length>1?new bf(r,l.XY,v):new fr(r,l.XY,u)}else a=e===f.POINT?new si(r,l.XY):e===f.LINE_STRING?new ai(r,l.XY):e===f.POLYGON?new fr(r,l.XY,u):e===f.MULTI_POINT?new wf(r,l.XY):e===f.MULTI_LINE_STRING?new au(r,l.XY,u):null;o=new this.featureClass_;this.geometryName_&&o.setGeometryName(this.geometryName_);k=ei(a,!1,i);o.setGeometry(k);o.setId(c);o.setProperties(s,!0)}return o},t.prototype.getType=function(){return ue.ARRAY_BUFFER},t.prototype.readFeatures=function(n,t){var s=this.layers_,r=this.adaptOptions(t),f=y(r.dataProjection),o,i,l,u,a,v;f.setWorldExtent(r.extent);r.dataProjection=f;var e=new bli.a(n),h=e.readFields(kli,{}),c=[];for(o in h)if(!s||-1!=s.indexOf(o))for(i=h[o],l=i?[0,0,i.extent,i.extent]:null,f.setExtent(l),u=0,a=i.length;u<a;++u)v=nai(e,i,u),c.push(this.createFeature_(e,v,r));return c},t.prototype.readProjection=function(){return this.dataProjection},t.prototype.setLayers=function(n){this.layers_=n},t}(cc),iai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ttt=[null],rai=o(ttt,{nd:function(n,t){t[t.length-1].ndrefs.push(n.getAttribute("ref"))},tag:cvt}),uai=o(ttt,{node:function(n,t){var h=t[0],f=t[t.length-1],e=n.getAttribute("id"),o=[parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))],r,u,i;f.nodes[e]=o;r=s({tags:{}},eai,n,t);bo(r.tags)||(u=new si(o),ei(u,!1,h),i=new ui(u),i.setId(e),i.setProperties(r.tags,!0),f.features.push(i))},way:function(n,t){var i=s({id:n.getAttribute("id"),ndrefs:[],tags:{}},rai,n,t);t[t.length-1].ways.push(i)}}),fai=function(n){function t(){var t=n.call(this)||this;return t.dataProjection=y("EPSG:4326"),t}return iai(t,n),t.prototype.readFeaturesFromNode=function(n,t){var c=this.getReadOptions(n,t),i,u,h,e;if("osm"==n.localName){for(i=s({nodes:{},ways:[],features:[]},uai,n,[c]),u=0;u<i.ways.length;u++){for(var r=i.ways[u],f=[],o=0,a=r.ndrefs.length;o<a;o++)pt(f,i.nodes[r.ndrefs[o]]);h=void 0;ei(h=r.ndrefs[0]==r.ndrefs[r.ndrefs.length-1]?new fr(f,l.XY,[f.length]):new ai(f,l.XY),!1,c);e=new ui(h);e.setId(r.id);e.setProperties(r.tags,!0);i.features.push(e)}if(i.features)return i.features}return[]},t}(ac),eai=o(ttt,{tag:cvt});lvt=fai;vvt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var sai=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.dataProjection=y("EPSG:4326"),i.factor_=r.factor?r.factor:1e5,i.geometryLayout_=r.geometryLayout?r.geometryLayout:l.XY,i}return vvt(t,n),t.prototype.readFeatureFromText=function(n,t){var i=this.readGeometryFromText(n,t);return new ui(i)},t.prototype.readFeaturesFromText=function(n,t){return[this.readFeatureFromText(n,t)]},t.prototype.readGeometryFromText=function(n,t){var r=nb(this.geometryLayout_),i=pvt(n,r,this.factor_),u;return avt(i,0,i.length,r,i),u=wh(i,0,i.length,r),ei(new ai(u,this.geometryLayout_),!1,this.adaptOptions(t))},t.prototype.writeFeatureText=function(n,t){var i=n.getGeometry();return i?this.writeGeometryText(i,t):(p(!1,40),"")},t.prototype.writeFeaturesText=function(n,t){return this.writeFeatureText(n[0],t)},t.prototype.writeGeometryText=function(n,t){var i=(n=ei(n,!0,this.adaptOptions(t))).getFlatCoordinates(),r=n.getStride();return avt(i,0,i.length,r,i),yvt(i,r,this.factor_)},t}(sn),hai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cai=function(n){function t(t){var r=n.call(this)||this,i=t||{};return r.layerName_=i.layerName,r.layers_=i.layers?i.layers:null,r.dataProjection=y(i.dataProjection?i.dataProjection:"EPSG:4326"),r}return hai(t,n),t.prototype.readFeaturesFromObject=function(n,t){var e,i;if("Topology"==n.type){var r=n,c=void 0,u=null,f=null;r.transform&&(u=(c=r.transform).scale,f=c.translate);e=r.arcs;c&&function(n,t,i){for(var r=0,u=n.length;r<u;++r)vai(n[r],t,i)}(e,u,f);var o=[],s=r.objects,l=this.layerName_,h=void 0;for(i in s)this.layers_&&-1==this.layers_.indexOf(i)||("GeometryCollection"===s[i].type?(h=s[i],o.push.apply(o,aai(h,e,u,f,l,i,t))):(h=s[i],o.push(kvt(h,e,u,f,l,i,t))));return o}return[]},t.prototype.readProjectionFromObject=function(){return this.dataProjection},t}(yg),lai={Point:function(n,t,i){var r=n.coordinates;return t&&i&&itt(r,t,i),new si(r)},LineString:function(n,t){var i=uw(n.arcs,t);return new ai(i)},Polygon:function(n,t){for(var r=[],i=0,u=n.arcs.length;i<u;++i)r[i]=uw(n.arcs[i],t);return new fr(r)},MultiPoint:function(n,t,i){var u=n.coordinates,r,f;if(t&&i)for(r=0,f=u.length;r<f;++r)itt(u[r],t,i);return new wf(u)},MultiLineString:function(n,t){for(var r=[],i=0,u=n.arcs.length;i<u;++i)r[i]=uw(n.arcs[i],t);return new au(r)},MultiPolygon:function(n,t){for(var u=[],i=0,o=n.arcs.length;i<o;++i){for(var f=n.arcs[i],e=[],r=0,s=f.length;r<s;++r)e[r]=uw(f[r],t);u[i]=e}return new bf(u)}};var yai=cai,ka=function(){function n(n){this.tagName_=n}return n.prototype.getTagName=function(){return this.tagName_},n}(),pai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dvt=function(n){function t(t,i){var r=n.call(this,t)||this;return r.conditions=i,p(r.conditions.length>=2,57),r}return pai(t,n),t}(ka),wai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bai=function(n){function t(){return n.call(this,"And",Array.prototype.slice.call(arguments))||this}return wai(t,n),t}(dvt),kai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gvt=function(n){function t(t,i,r){var u=n.call(this,"BBOX")||this;if(u.geometryName=t,u.extent=i,4!==i.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return u.srsName=r,u}return kai(t,n),t}(ka),dai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rtt=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.geometryName=i||"the_geom",f.geometry=r,f.srsName=u,f}return dai(t,n),t}(ka),gai=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nyt=function(n){function t(t,i,r){return n.call(this,"Contains",t,i,r)||this}return gai(t,n),t}(rtt),nvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),da=function(n){function t(t,i){var r=n.call(this,t)||this;return r.propertyName=i,r}return nvi(t,n),t}(ka),tvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tyt=function(n){function t(t,i,r){var u=n.call(this,"During",t)||this;return u.begin=i,u.end=r,u}return tvi(t,n),t}(da),ivi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pc=function(n){function t(t,i,r,u){var f=n.call(this,t,i)||this;return f.expression=r,f.matchCase=u,f}return ivi(t,n),t}(da),rvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iyt=function(n){function t(t,i,r){return n.call(this,"PropertyIsEqualTo",t,i,r)||this}return rvi(t,n),t}(pc),uvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ryt=function(n){function t(t,i){return n.call(this,"PropertyIsGreaterThan",t,i)||this}return uvi(t,n),t}(pc),fvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uyt=function(n){function t(t,i){return n.call(this,"PropertyIsGreaterThanOrEqualTo",t,i)||this}return fvi(t,n),t}(pc),evi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fyt=function(n){function t(t,i,r){return n.call(this,"Intersects",t,i,r)||this}return evi(t,n),t}(rtt),ovi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eyt=function(n){function t(t,i,r){var u=n.call(this,"PropertyIsBetween",t)||this;return u.lowerBoundary=i,u.upperBoundary=r,u}return ovi(t,n),t}(da),svi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oyt=function(n){function t(t,i,r,u,f,e){var o=n.call(this,"PropertyIsLike",t)||this;return o.pattern=i,o.wildCard=void 0!==r?r:"*",o.singleChar=void 0!==u?u:".",o.escapeChar=void 0!==f?f:"!",o.matchCase=e,o}return svi(t,n),t}(da),hvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),syt=function(n){function t(t){return n.call(this,"PropertyIsNull",t)||this}return hvi(t,n),t}(da),cvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hyt=function(n){function t(t,i){return n.call(this,"PropertyIsLessThan",t,i)||this}return cvi(t,n),t}(pc),lvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cyt=function(n){function t(t,i){return n.call(this,"PropertyIsLessThanOrEqualTo",t,i)||this}return lvi(t,n),t}(pc),avi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lyt=function(n){function t(t){var i=n.call(this,"Not")||this;return i.condition=t,i}return avi(t,n),t}(ka),vvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ayt=function(n){function t(t,i,r){return n.call(this,"PropertyIsNotEqualTo",t,i,r)||this}return vvi(t,n),t}(pc),yvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vyt=function(n){function t(){return n.call(this,"Or",Array.prototype.slice.call(arguments))||this}return yvi(t,n),t}(dvt),pvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yyt=function(n){function t(t,i,r){return n.call(this,"Within",t,i,r)||this}return pvi(t,n),t}(rtt);var wvi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bvi={"http://www.opengis.net/gml":{boundedBy:u(ht.prototype.readGeometryElement,"bounds")}},kvi={"http://www.opengis.net/wfs":{totalInserted:u(rr),totalUpdated:u(rr),totalDeleted:u(rr)}},dvi={"http://www.opengis.net/wfs":{TransactionSummary:u(function(n,t){return s({},kvi,n,t)},"transactionSummary"),InsertResults:u(function(n,t){return s([],ryi,n,t)},"insertIds")}},gvi={"http://www.opengis.net/wfs":{PropertyName:e(ut)}},ga={"http://www.opengis.net/wfs":{Insert:e(function(n,t,i){var r=i[i.length-1],f=r.featureType,e=r.featureNS,o=r.gmlVersion,u=rt(e,f);n.appendChild(u);2===o?dp.prototype.writeFeatureElement(u,t,i):ft.prototype.writeFeatureElement(u,t,i)}),Update:e(function(n,t,i){var r=i[i.length-1],e,u,s;p(void 0!==t.getId(),27);var l=r.featureType,h=r.featurePrefix,a=r.featureNS,v=ftt(h,l),y=t.getGeometryName();if(n.setAttribute("typeName",v),n.setAttributeNS(utt,"xmlns:"+h,a),e=t.getId(),void 0!==e){for(var o=t.getKeys(),c=[],f=0,w=o.length;f<w;f++)u=t.get(o[f]),void 0!==u&&(s=o[f],u&&"function"==typeof u.getSimplifiedGeometry&&(s=y),c.push({name:s,value:u}));it({gmlVersion:r.gmlVersion,node:n,hasZ:r.hasZ,srsName:r.srsName},ga,gt("Property"),c,i);gyt(n,e,i)}}),Delete:e(function(n,t,i){var r=i[i.length-1],u;p(void 0!==t.getId(),26);var e=r.featureType,f=r.featurePrefix,o=r.featureNS,s=ftt(f,e);n.setAttribute("typeName",s);n.setAttributeNS(utt,"xmlns:"+f,o);u=t.getId();void 0!==u&&gyt(n,u,i)}),Property:e(function(n,t,i){var u=rt(fw,"Name"),f=i[i.length-1].gmlVersion,r;(n.appendChild(u),ut(u,t.name),void 0!==t.value&&null!==t.value)&&(r=rt(fw,"Value"),n.appendChild(r),t.value&&"function"==typeof t.value.getSimplifiedGeometry?2===f?dp.prototype.writeGeometryElement(r,t.value,i):ft.prototype.writeGeometryElement(r,t.value,i):ut(r,t.value))}),Native:e(function(n,t){t.vendorId&&n.setAttribute("vendorId",t.vendorId);void 0!==t.safeToIgnore&&n.setAttribute("safeToIgnore",String(t.safeToIgnore));void 0!==t.value&&ut(n,t.value)})}},byt="feature",utt="http://www.w3.org/2000/xmlns/",rh="http://www.opengis.net/ogc",fw="http://www.opengis.net/wfs",nyi="http://www.opengis.net/fes",kyt={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},dyt="1.1.0",tyi=function(n){function t(t){var r=n.call(this)||this,i=t||{};return r.featureType_=i.featureType,r.featureNS_=i.featureNS,r.gmlFormat_=i.gmlFormat?i.gmlFormat:new ft,r.schemaLocation_=i.schemaLocation?i.schemaLocation:kyt[dyt],r}return wvi(t,n),t.prototype.getFeatureType=function(){return this.featureType_},t.prototype.setFeatureType=function(n){this.featureType_=n},t.prototype.readFeaturesFromNode=function(n,t){var r={node:n},u,i;return d(r,{featureType:this.featureType_,featureNS:this.featureNS_}),d(r,this.getReadOptions(n,t||{})),u=[r],this.gmlFormat_.FEATURE_COLLECTION_PARSERS[kf].featureMember=b(ht.prototype.readFeaturesInternal),i=s([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,n,u,this.gmlFormat_),i||(i=[]),i},t.prototype.readTransactionResponse=function(n){if(n){if("string"==typeof n){var t=ku(n);return this.readTransactionResponseFromDocument(t)}return lf(n)?this.readTransactionResponseFromDocument(n):this.readTransactionResponseFromNode(n)}},t.prototype.readFeatureCollectionMetadata=function(n){if(n){if("string"==typeof n){var t=ku(n);return this.readFeatureCollectionMetadataFromDocument(t)}return lf(n)?this.readFeatureCollectionMetadataFromDocument(n):this.readFeatureCollectionMetadataFromNode(n)}},t.prototype.readFeatureCollectionMetadataFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)},t.prototype.readFeatureCollectionMetadataFromNode=function(n){var t={},i=le(n.getAttribute("numberOfFeatures"));return t.numberOfFeatures=i,s(t,bvi,n,[],this.gmlFormat_)},t.prototype.readTransactionResponseFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)},t.prototype.readTransactionResponseFromNode=function(n){return s({},dvi,n,[])},t.prototype.writeGetFeature=function(n){var i,t=rt(fw,"GetFeature"),r,u;return(t.setAttribute("service","WFS"),t.setAttribute("version","1.1.0"),n&&(n.handle&&t.setAttribute("handle",n.handle),n.outputFormat&&t.setAttribute("outputFormat",n.outputFormat),void 0!==n.maxFeatures&&t.setAttribute("maxFeatures",String(n.maxFeatures)),n.resultType&&t.setAttribute("resultType",n.resultType),void 0!==n.startIndex&&t.setAttribute("startIndex",String(n.startIndex)),void 0!==n.count&&t.setAttribute("count",String(n.count)),void 0!==n.viewParams&&t.setAttribute("viewParams",n.viewParams),i=n.filter,n.bbox))&&(p(n.geometryName,12),r=wyt(n.geometryName,n.bbox,n.srsName),i=i?pyt(i,r):r),t.setAttributeNS(eo,"xsi:schemaLocation",this.schemaLocation_),u={node:t},d(u,{srsName:n.srsName,featureNS:n.featureNS?n.featureNS:this.featureNS_,featurePrefix:n.featurePrefix,geometryName:n.geometryName,filter:i,propertyNames:n.propertyNames?n.propertyNames:[]}),p(Array.isArray(n.featureTypes),11),function(n,t,i){var u=i[i.length-1],r=d({},u);r.node=n;it(r,nv,gt("Query"),t,i)}(t,n.featureTypes,[u]),t},t.prototype.writeTransaction=function(n,t,i,r){var h,f,o=[],u=rt(fw,"Transaction"),c=r.version?r.version:dyt,s="1.0.0"===c?2:3,l,e;return u.setAttribute("service","WFS"),u.setAttribute("version",c),r&&(h=r.gmlOptions?r.gmlOptions:{},r.handle&&u.setAttribute("handle",r.handle)),l=kyt[c],u.setAttributeNS(eo,"xsi:schemaLocation",l),e=r.featurePrefix?r.featurePrefix:byt,n&&(f=d({node:u},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:e,gmlVersion:s,hasZ:r.hasZ,srsName:r.srsName}),d(f,h),it(f,ga,gt("Insert"),n,o)),t&&(f=d({node:u},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:e,gmlVersion:s,hasZ:r.hasZ,srsName:r.srsName}),d(f,h),it(f,ga,gt("Update"),t,o)),i&&it({node:u,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:e,gmlVersion:s,srsName:r.srsName},ga,gt("Delete"),i,o),r.nativeElements&&it({node:u,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:e,gmlVersion:s,srsName:r.srsName},ga,gt("Native"),r.nativeElements,o),u},t.prototype.readProjectionFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null},t.prototype.readProjectionFromNode=function(n){var t,i;if(n.firstElementChild&&n.firstElementChild.firstElementChild)for(t=(n=n.firstElementChild.firstElementChild).firstElementChild;t;t=t.nextElementSibling)if(0!==t.childNodes.length&&(1!==t.childNodes.length||3!==t.firstChild.nodeType))return i=[{}],this.gmlFormat_.readGeometryElement(t,i),y(i.pop().srsName);return null},t}(ac),iyi={"http://www.opengis.net/ogc":{FeatureId:b(function(n){return n.getAttribute("fid")})}},ryi={"http://www.opengis.net/wfs":{Feature:function(n,t){kr(iyi,n,t)}}};nv={"http://www.opengis.net/wfs":{Query:e(function(n,t,i){var s,r=i[i.length-1],u=r.featurePrefix,h=r.featureNS,l=r.propertyNames,c=r.srsName,f,e,o;s=u?ftt(u,t):t;n.setAttribute("typeName",s);c&&n.setAttribute("srsName",c);h&&n.setAttributeNS(utt,"xmlns:"+u,h);f=d({},r);f.node=n;it(f,gvi,gt("PropertyName"),l,i);e=r.filter;e&&(o=rt(rh,"Filter"),n.appendChild(o),npt(o,e,i))})},"http://www.opengis.net/ogc":{During:e(function(n,t){var f=rt(nyi,"ValueReference"),i,r,u;ut(f,t.propertyName);n.appendChild(f);i=rt(kf,"TimePeriod");n.appendChild(i);r=rt(kf,"begin");i.appendChild(r);rpt(r,t.begin);u=rt(kf,"end");i.appendChild(u);rpt(u,t.end)}),And:e(tpt),Or:e(tpt),Not:e(function(n,t,i){var u={node:n},r=t.condition;it(u,nv,gt(r.getTagName()),[r],i)}),BBOX:e(function(n,t,i){i[i.length-1].srsName=t.srsName;yo(n,t.geometryName);ft.prototype.writeGeometryElement(n,t.extent,i)}),Contains:e(function(n,t,i){i[i.length-1].srsName=t.srsName;yo(n,t.geometryName);ft.prototype.writeGeometryElement(n,t.geometry,i)}),Intersects:e(function(n,t,i){i[i.length-1].srsName=t.srsName;yo(n,t.geometryName);ft.prototype.writeGeometryElement(n,t.geometry,i)}),Within:e(function(n,t,i){i[i.length-1].srsName=t.srsName;yo(n,t.geometryName);ft.prototype.writeGeometryElement(n,t.geometry,i)}),PropertyIsEqualTo:e(wc),PropertyIsNotEqualTo:e(wc),PropertyIsLessThan:e(wc),PropertyIsLessThanOrEqualTo:e(wc),PropertyIsGreaterThan:e(wc),PropertyIsGreaterThanOrEqualTo:e(wc),PropertyIsNull:e(function(n,t){yo(n,t.propertyName)}),PropertyIsBetween:e(function(n,t){var i,r;yo(n,t.propertyName);i=rt(rh,"LowerBoundary");n.appendChild(i);ew(i,""+t.lowerBoundary);r=rt(rh,"UpperBoundary");n.appendChild(r);ew(r,""+t.upperBoundary)}),PropertyIsLike:e(function(n,t){n.setAttribute("wildCard",t.wildCard);n.setAttribute("singleChar",t.singleChar);n.setAttribute("escapeChar",t.escapeChar);void 0!==t.matchCase&&n.setAttribute("matchCase",t.matchCase.toString());yo(n,t.propertyName);ew(n,""+t.pattern)})}};var uyi=tyi,fyi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),upt={POINT:si,LINESTRING:ai,POLYGON:fr,MULTIPOINT:wf,MULTILINESTRING:au,MULTIPOLYGON:bf},fpt="EMPTY",ept="Z",opt="M",ow=1,ve=2,po=3,spt=4,bc=5,eyi=6,oyi={};for(ett in f)oyi[ett]=f[ett].toUpperCase();var syi=function(){function n(n){this.wkt=n;this.index_=-1}return n.prototype.isAlpha_=function(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"},n.prototype.isNumeric_=function(n,t){return n>="0"&&n<="9"||"."==n&&!(void 0!==t&&t)},n.prototype.isWhiteSpace_=function(n){return" "==n||"\t"==n||"\r"==n||"\n"==n},n.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},n.prototype.nextToken=function(){var t,n=this.nextChar_(),r=this.index_,i=n;if("("==n)t=ve;else if(","==n)t=bc;else if(")"==n)t=po;else if(this.isNumeric_(n)||"-"==n)t=spt,i=this.readNumber_();else if(this.isAlpha_(n))t=ow,i=this.readText_();else{if(this.isWhiteSpace_(n))return this.nextToken();if(""!==n)throw new Error("Unexpected character: "+n);t=eyi}return{position:r,value:i,type:t}},n.prototype.readNumber_=function(){var n,r=this.index_,i=!1,t=!1;do"."==n?i=!0:"e"!=n&&"E"!=n||(t=!0),n=this.nextChar_();while(this.isNumeric_(n,i)||!t&&("e"==n||"E"==n)||t&&("-"==n||"+"==n));return parseFloat(this.wkt.substring(r,this.index_--))},n.prototype.readText_=function(){var n,t=this.index_;do n=this.nextChar_();while(this.isAlpha_(n));return this.wkt.substring(t,this.index_--).toUpperCase()},n}(),hyi=function(){function n(n){this.lexer_=n;this.token_;this.layout_=l.XY}return n.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},n.prototype.isTokenType=function(n){return this.token_.type==n},n.prototype.match=function(n){var t=this.isTokenType(n);return t&&this.consume_(),t},n.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},n.prototype.parseGeometryLayout_=function(){var n=l.XY,i=this.token_,t;return this.isTokenType(ow)&&(t=i.value,t===ept?n=l.XYZ:t===opt?n=l.XYM:"ZM"===t&&(n=l.XYZM),n!==l.XY&&this.consume_()),n},n.prototype.parseGeometryCollectionText_=function(){if(this.match(ve)){var n=[];do n.push(this.parseGeometry_());while(this.match(bc));if(this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parsePointText_=function(){if(this.match(ve)){var n=this.parsePoint_();if(this.match(po))return n}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_());},n.prototype.parseLineStringText_=function(){if(this.match(ve)){var n=this.parsePointList_();if(this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parsePolygonText_=function(){if(this.match(ve)){var n=this.parseLineStringTextList_();if(this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parseMultiPointText_=function(){if(this.match(ve)){var n=void 0;if(n=this.token_.type==ve?this.parsePointTextList_():this.parsePointList_(),this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parseMultiLineStringText_=function(){if(this.match(ve)){var n=this.parseLineStringTextList_();if(this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parseMultiPolygonText_=function(){if(this.match(ve)){var n=this.parsePolygonTextList_();if(this.match(po))return n}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_());},n.prototype.parsePoint_=function(){for(var r,n=[],t=this.layout_.length,i=0;i<t;++i){if(r=this.token_,!this.match(spt))break;n.push(r.value)}if(n.length==t)return n;throw new Error(this.formatErrorMessage_());},n.prototype.parsePointList_=function(){for(var n=[this.parsePoint_()];this.match(bc);)n.push(this.parsePoint_());return n},n.prototype.parsePointTextList_=function(){for(var n=[this.parsePointText_()];this.match(bc);)n.push(this.parsePointText_());return n},n.prototype.parseLineStringTextList_=function(){for(var n=[this.parseLineStringText_()];this.match(bc);)n.push(this.parseLineStringText_());return n},n.prototype.parsePolygonTextList_=function(){for(var n=[this.parsePolygonText_()];this.match(bc);)n.push(this.parsePolygonText_());return n},n.prototype.isEmptyGeometry_=function(){var n=this.isTokenType(ow)&&this.token_.value==fpt;return n&&this.consume_(),n},n.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},n.prototype.parseGeometry_=function(){var u=this.token_,t,r,i,n;if(this.match(ow)){if(t=u.value,this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==t)return r=this.parseGeometryCollectionText_(),new lo(r);if(i=upt[t],!i)throw new Error("Invalid geometry type: "+t);n=void 0;switch(t){case"POINT":n=this.parsePointText_();break;case"LINESTRING":n=this.parseLineStringText_();break;case"POLYGON":n=this.parsePolygonText_();break;case"MULTIPOINT":n=this.parseMultiPointText_();break;case"MULTILINESTRING":n=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":n=this.parseMultiPolygonText_();break;default:throw new Error("Invalid geometry type: "+t);}return n||(n=i===upt.POINT?[NaN,NaN]:[]),new i(n,this.layout_)}throw new Error(this.formatErrorMessage_());},n}(),cyi=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.splitCollection_=void 0!==r.splitCollection&&r.splitCollection,i}return fyi(t,n),t.prototype.parse_=function(n){var t=new syi(n);return new hyi(t).parse()},t.prototype.readFeatureFromText=function(n,t){var r=this.readGeometryFromText(n,t),i;return r?(i=new ui,i.setGeometry(r),i):null},t.prototype.readFeaturesFromText=function(n,t){for(var u,e=[],i=this.readGeometryFromText(n,t),o=[],r=0,s=(e=this.splitCollection_&&i.getType()==f.GEOMETRY_COLLECTION?i.getGeometriesArray():[i]).length;r<s;++r)u=new ui,u.setGeometry(e[r]),o.push(u);return o},t.prototype.readGeometryFromText=function(n,t){var i=this.parse_(n);return i?ei(i,!1,t):null},t.prototype.writeFeatureText=function(n,t){var i=n.getGeometry();return i?this.writeGeometryText(i,t):""},t.prototype.writeFeaturesText=function(n,t){var u;if(1==n.length)return this.writeFeatureText(n[0],t);for(var r=[],i=0,f=n.length;i<f;++i)r.push(n[i].getGeometry());return u=new lo(r),this.writeGeometryText(u,t)},t.prototype.writeGeometryText=function(n,t){return apt(ei(n,!0,t))},t}(sn);lpt={Point:hpt,LineString:ott,Polygon:cpt,MultiPoint:function(n){for(var i=[],r=n.getPoints(),t=0,u=r.length;t<u;++t)i.push("("+hpt(r[t])+")");return i.join(",")},MultiLineString:function(n){for(var i=[],r=n.getLineStrings(),t=0,u=r.length;t<u;++t)i.push("("+ott(r[t])+")");return i.join(",")},MultiPolygon:function(n){for(var i=[],r=n.getPolygons(),t=0,u=r.length;t<u;++t)i.push("("+cpt(r[t])+")");return i.join(",")},GeometryCollection:function(n){for(var i=[],r=n.getGeometries(),t=0,u=r.length;t<u;++t)i.push(apt(r[t]));return i.join(",")}};vpt=cyi;ypt="http://www.w3.org/1999/xlink";var stt=function(){function n(){}return n.prototype.read=function(n){if(n){if("string"==typeof n){var t=ku(n);return this.readFromDocument(t)}return lf(n)?this.readFromDocument(n):this.readFromNode(n)}return null},n.prototype.readFromDocument=function(){},n.prototype.readFromNode=function(){},n}(),lyi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),or=[null,"http://www.opengis.net/wms"],ayi=o(or,{Service:u(function(n,t){return s({},pyi,n,t)}),Capability:u(function(n,t){return s({},vyi,n,t)})}),vyi=o(or,{Request:u(function(n,t){return s({},tpi,n,t)}),Exception:u(function(n,t){return s([],dyi,n,t)}),Layer:u(function(n,t){return s({},ppt,n,t)})}),yyi=function(n){function t(){var t=n.call(this)||this;return t.version=void 0,t}return lyi(t,n),t.prototype.readFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(n){this.version=n.getAttribute("version").trim();var t=s({version:this.version},ayi,n,[]);return t||null},t}(stt),pyi=o(or,{Name:u(h),Title:u(h),Abstract:u(h),KeywordList:u(bpt),OnlineResource:u(kc),ContactInformation:u(function(n,t){return s({},wyi,n,t)}),Fees:u(h),AccessConstraints:u(h),LayerLimit:u(rr),MaxWidth:u(rr),MaxHeight:u(rr)}),wyi=o(or,{ContactPersonPrimary:u(function(n,t){return s({},byi,n,t)}),ContactPosition:u(h),ContactAddress:u(function(n,t){return s({},kyi,n,t)}),ContactVoiceTelephone:u(h),ContactFacsimileTelephone:u(h),ContactElectronicMailAddress:u(h)}),byi=o(or,{ContactPerson:u(h),ContactOrganization:u(h)}),kyi=o(or,{AddressType:u(h),Address:u(h),City:u(h),StateOrProvince:u(h),PostCode:u(h),Country:u(h)}),dyi=o(or,{Format:b(h)}),ppt=o(or,{Name:u(h),Title:u(h),Abstract:u(h),KeywordList:u(bpt),CRS:ti(h),EX_GeographicBoundingBox:u(function(n,t){var i=s({},npi,n,t);if(i){var r=i.westBoundLongitude,u=i.southBoundLatitude,f=i.eastBoundLongitude,e=i.northBoundLatitude;if(void 0!==r&&void 0!==u&&void 0!==f&&void 0!==e)return[r,u,f,e]}}),BoundingBox:ti(function(n){var t=[ce(n.getAttribute("minx")),ce(n.getAttribute("miny")),ce(n.getAttribute("maxx")),ce(n.getAttribute("maxy"))],i=[ce(n.getAttribute("resx")),ce(n.getAttribute("resy"))];return{crs:n.getAttribute("CRS"),extent:t,res:i}}),Dimension:ti(function(n){return{name:n.getAttribute("name"),units:n.getAttribute("units"),unitSymbol:n.getAttribute("unitSymbol"),"default":n.getAttribute("default"),multipleValues:th(n.getAttribute("multipleValues")),nearestValue:th(n.getAttribute("nearestValue")),current:th(n.getAttribute("current")),values:h(n)}}),Attribution:u(function(n,t){return s({},gyi,n,t)}),AuthorityURL:ti(function(n,t){var i=ye(n,t);if(i)return i.name=n.getAttribute("name"),i}),Identifier:ti(h),MetadataURL:ti(function(n,t){var i=ye(n,t);if(i)return i.type=n.getAttribute("type"),i}),DataURL:ti(ye),FeatureListURL:ti(ye),Style:ti(function(n,t){return s({},fpi,n,t)}),MinScaleDenominator:u(yt),MaxScaleDenominator:u(yt),Layer:ti(function(n,t){var r=t[t.length-1],i=s({},ppt,n,t),u,o,f,e,h,c;if(i)return u=th(n.getAttribute("queryable")),void 0===u&&(u=r.queryable),i.queryable=void 0!==u&&u,o=le(n.getAttribute("cascaded")),void 0===o&&(o=r.cascaded),i.cascaded=o,f=th(n.getAttribute("opaque")),void 0===f&&(f=r.opaque),i.opaque=void 0!==f&&f,e=th(n.getAttribute("noSubsets")),void 0===e&&(e=r.noSubsets),i.noSubsets=void 0!==e&&e,h=ce(n.getAttribute("fixedWidth")),h||(h=r.fixedWidth),i.fixedWidth=h,c=ce(n.getAttribute("fixedHeight")),c||(c=r.fixedHeight),i.fixedHeight=c,["Style","CRS","AuthorityURL"].forEach(function(n){if(n in r){var t=i[n]||[];i[n]=t.concat(r[n])}}),["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(n){if(!(n in i)){var t=r[n];i[n]=t}}),i})}),gyi=o(or,{Title:u(h),OnlineResource:u(kc),LogoURL:u(wpt)}),npi=o(or,{westBoundLongitude:u(yt),eastBoundLongitude:u(yt),southBoundLatitude:u(yt),northBoundLatitude:u(yt)}),tpi=o(or,{GetCapabilities:u(htt),GetMap:u(htt),GetFeatureInfo:u(htt)}),ipi=o(or,{Format:ti(h),DCPType:ti(function(n,t){return s({},rpi,n,t)})}),rpi=o(or,{HTTP:u(function(n,t){return s({},upi,n,t)})}),upi=o(or,{Get:u(ye),Post:u(ye)}),fpi=o(or,{Name:u(h),Title:u(h),Abstract:u(h),LegendURL:ti(wpt),StyleSheetURL:u(ye),StyleURL:u(ye)}),epi=o(or,{Format:u(h),OnlineResource:u(kc)}),opi=o(or,{Keyword:b(h)});var spi=yyi,hpi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cpi=function(n){function t(t){var i=n.call(this)||this,r=t||{};return i.featureNS_="http://mapserver.gis.umn.edu/mapserver",i.gmlFormat_=new dp,i.layers_=r.layers?r.layers:null,i}return hpi(t,n),t.prototype.getLayers=function(){return this.layers_},t.prototype.setLayers=function(n){this.layers_=n},t.prototype.readFeatures_=function(n,t){var u,i,r,y,f,c,l,w,a,v;if(n.setAttribute("namespaceURI",this.featureNS_),u=n.localName,i=[],0===n.childNodes.length)return i;if("msGMLOutput"==u)for(r=0,y=n.childNodes.length;r<y;r++)if(f=n.childNodes[r],f.nodeType===Node.ELEMENT_NODE){var e=f,h=t[0],p=e.localName.replace("_layer","");(!this.layers_||di(this.layers_,p))&&(c=p+"_feature",h.featureType=c,h.featureNS=this.featureNS_,l={},l[c]=b(this.gmlFormat_.readFeatureElement,this.gmlFormat_),w=o([h.featureNS,null],l),e.setAttribute("namespaceURI",this.featureNS_),a=s([],w,e,t,this.gmlFormat_),a&&pt(i,a))}return"FeatureCollection"==u&&(v=s([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,n,[{}],this.gmlFormat_),v&&(i=v)),i},t.prototype.readFeaturesFromNode=function(n,t){var i={};return t&&d(i,this.getReadOptions(n,t)),this.readFeatures_(n,[i])},t}(ac),lpi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nu=[null,"http://www.opengis.net/ows/1.1"],api=o(nu,{ServiceIdentification:u(function(n,t){return s({},uwi,n,t)}),ServiceProvider:u(function(n,t){return s({},fwi,n,t)}),OperationsMetadata:u(function(n,t){return s({},nwi,n,t)})}),vpi=function(n){function t(){return n.call(this)||this}return lpi(t,n),t.prototype.readFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(n){var t=s({},api,n,[]);return t||null},t}(stt),ypi=o(nu,{DeliveryPoint:u(h),City:u(h),AdministrativeArea:u(h),PostalCode:u(h),Country:u(h),ElectronicMailAddress:u(h)}),ppi=o(nu,{Value:ti(function(n){return h(n)})}),wpi=o(nu,{AllowedValues:u(function(n,t){return s({},ppi,n,t)})}),bpi=o(nu,{Phone:u(function(n,t){return s({},twi,n,t)}),Address:u(function(n,t){return s({},ypi,n,t)})}),kpi=o(nu,{HTTP:u(function(n,t){return s({},dpi,n,t)})}),dpi=o(nu,{Get:ti(function(n,t){var i=kc(n);if(i)return s({href:i},iwi,n,t)}),Post:void 0}),gpi=o(nu,{DCP:u(function(n,t){return s({},kpi,n,t)})}),nwi=o(nu,{Operation:function(n,t){var r=n.getAttribute("name"),i=s({},gpi,n,t);i&&(t[t.length-1][r]=i)}}),twi=o(nu,{Voice:u(h),Facsimile:u(h)}),iwi=o(nu,{Constraint:ti(function(n,t){var i=n.getAttribute("name");if(i)return s({name:i},wpi,n,t)})}),rwi=o(nu,{IndividualName:u(h),PositionName:u(h),ContactInfo:u(function(n,t){return s({},bpi,n,t)})}),uwi=o(nu,{Abstract:u(h),AccessConstraints:u(h),Fees:u(h),Title:u(h),ServiceTypeVersion:u(h),ServiceType:u(h)}),fwi=o(nu,{ProviderName:u(h),ProviderSite:u(kc),ServiceContact:u(function(n,t){return s({},rwi,n,t)})}),ewi=vpi,owi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),df=[null,"http://www.opengis.net/wmts/1.0"],dc=[null,"http://www.opengis.net/ows/1.1"],swi=o(df,{Contents:u(function(n,t){return s({},cwi,n,t)})}),hwi=function(n){function t(){var t=n.call(this)||this;return t.owsParser_=new ewi,t}return owi(t,n),t.prototype.readFromDocument=function(n){for(var t=n.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(n){var i=n.getAttribute("version").trim(),t=this.owsParser_.readFromNode(n);return t?(t.version=i,(t=s(t,swi,n,[]))||null):null},t}(stt),cwi=o(df,{Layer:ti(function(n,t){return s({},lwi,n,t)}),TileMatrixSet:ti(function(n,t){return s({},kwi,n,t)})}),lwi=o(df,{Style:ti(function(n,t){var i=s({},awi,n,t),r;if(i)return r="true"===n.getAttribute("isDefault"),i.isDefault=r,i}),Format:ti(h),TileMatrixSetLink:ti(function(n,t){return s({},vwi,n,t)}),Dimension:ti(function(n,t){return s({},wwi,n,t)}),ResourceURL:ti(function(n){var i=n.getAttribute("format"),r=n.getAttribute("template"),u=n.getAttribute("resourceType"),t={};return i&&(t.format=i),r&&(t.template=r),u&&(t.resourceType=u),t})},o(dc,{Title:u(h),Abstract:u(h),WGS84BoundingBox:u(function(n,t){var i=s([],bwi,n,t);if(2==i.length)return oi(i)}),Identifier:u(h)})),awi=o(df,{LegendURL:ti(function(n){var t={};return t.format=n.getAttribute("format"),t.href=kc(n),t})},o(dc,{Title:u(h),Identifier:u(h)})),vwi=o(df,{TileMatrixSet:u(h),TileMatrixSetLimits:u(function(n,t){return s([],ywi,n,t)})}),ywi=o(df,{TileMatrixLimits:b(function(n,t){return s({},pwi,n,t)})}),pwi=o(df,{TileMatrix:u(h),MinTileRow:u(rr),MaxTileRow:u(rr),MinTileCol:u(rr),MaxTileCol:u(rr)}),wwi=o(df,{Default:u(h),Value:ti(h)},o(dc,{Identifier:u(h)})),bwi=o(dc,{LowerCorner:b(ctt),UpperCorner:b(ctt)}),kwi=o(df,{WellKnownScaleSet:u(h),TileMatrix:ti(function(n,t){return s({},dwi,n,t)})},o(dc,{SupportedCRS:u(h),Identifier:u(h)})),dwi=o(df,{TopLeftCorner:u(ctt),ScaleDenominator:u(yt),TileWidth:u(rr),TileHeight:u(rr),MatrixWidth:u(rr),MatrixHeight:u(rr)},o(dc,{Identifier:u(h)}));var gwi=hwi,nbi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kpt=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"];var tbi=function(n){function t(t){var i=this,r=t||{},u,f,o,s,e;return(i=n.call(this,{element:document.createElement("div"),target:r.target})||this).cssClassName_=void 0!==r.className?r.className:"ol-full-screen",u=void 0!==r.label?r.label:"",i.labelNode_="string"==typeof u?document.createTextNode(u):u,f=void 0!==r.labelActive?r.labelActive:"",i.labelActiveNode_="string"==typeof f?document.createTextNode(f):f,i.button_=document.createElement("button"),o=r.tipLabel?r.tipLabel:"Toggle full-screen",i.setClassName_(i.button_,ltt()),i.button_.setAttribute("type","button"),i.button_.title=o,i.button_.appendChild(i.labelNode_),i.button_.addEventListener(a.CLICK,i.handleClick_.bind(i),!1),s=i.cssClassName_+" "+sf+" "+hs+" "+(dpt()?"":pkt),e=i.element,e.className=s,e.appendChild(i.button_),i.keys_=void 0!==r.keys&&r.keys,i.source_=r.source,i}return nbi(t,n),t.prototype.handleClick_=function(n){n.preventDefault();this.handleFullScreen_()},t.prototype.handleFullScreen_=function(){var t,n;dpt()&&(t=this.getMap(),t&&(ltt()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():(n=void 0,n=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?function(n){n.webkitRequestFullscreen?n.webkitRequestFullscreen():gpt(n)}(n):gpt(n))))},t.prototype.handleFullScreenChange_=function(){var n=this.getMap();ltt()?(this.setClassName_(this.button_,!0),nc(this.labelActiveNode_,this.labelNode_)):(this.setClassName_(this.button_,!1),nc(this.labelNode_,this.labelActiveNode_));n&&n.updateSize()},t.prototype.setClassName_=function(n,t){var i=this.cssClassName_+"-true",r=this.cssClassName_+"-false",u=t?i:r;n.classList.remove(i);n.classList.remove(r);n.classList.add(u)},t.prototype.setMap=function(t){if(n.prototype.setMap.call(this,t),t)for(var i=0,r=kpt.length;i<r;++i)this.listenerKeys.push(nt(document,kpt[i],this.handleFullScreenChange_,this))},t}(of),ibi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),att="projection";var rbi=function(n){function t(t){var i=this,r=t||{},u=document.createElement("div");return u.className=void 0!==r.className?r.className:"ol-mouse-position",(i=n.call(this,{element:u,render:r.render||nwt,target:r.target})||this).addEventListener(ri(att),i.handleProjectionChanged_),r.coordinateFormat&&i.setCoordinateFormat(r.coordinateFormat),r.projection&&i.setProjection(r.projection),i.undefinedHTML_=void 0!==r.undefinedHTML?r.undefinedHTML:"&#160;",i.renderOnMouseOut_=!!i.undefinedHTML_,i.renderedHTML_=u.innerHTML,i.mapProjection_=null,i.transform_=null,i}return ibi(t,n),t.prototype.handleProjectionChanged_=function(){this.transform_=null},t.prototype.getCoordinateFormat=function(){return this.get("coordinateFormat")},t.prototype.getProjection=function(){return this.get(att)},t.prototype.handleMouseMove=function(n){var t=this.getMap();this.updateHTML_(t.getEventPixel(n))},t.prototype.handleMouseOut=function(){this.updateHTML_(null)},t.prototype.setMap=function(t){if(n.prototype.setMap.call(this,t),t){var i=t.getViewport();this.listenerKeys.push(nt(i,te.POINTERMOVE,this.handleMouseMove,this));this.renderOnMouseOut_&&this.listenerKeys.push(nt(i,te.POINTEROUT,this.handleMouseOut,this))}},t.prototype.setCoordinateFormat=function(n){this.set("coordinateFormat",n)},t.prototype.setProjection=function(n){this.set(att,y(n))},t.prototype.updateHTML_=function(n){var i=this.undefinedHTML_,r,t,u,f;n&&this.mapProjection_&&(this.transform_||(r=this.getProjection(),this.transform_=r?wu(this.mapProjection_,r):bw),t=this.getMap().getCoordinateFromPixelInternal(n),t&&(u=yv(),u&&(this.transform_=wu(this.mapProjection_,u)),this.transform_(t,t),f=this.getCoordinateFormat(),i=f?f(t):t.toString()));this.renderedHTML_&&i===this.renderedHTML_||(this.element.innerHTML=i,this.renderedHTML_=i)},t}(of),twt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ubi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return twt(t,n),t.prototype.createRenderer=function(){return new bk(this)},t}(tk);var fbi=function(n){function t(t){var i=this,r=t||{},f,c,u,e,o,l,s;(i=n.call(this,{element:document.createElement("div"),render:r.render||iwt,target:r.target})||this).boundHandleRotationChanged_=i.handleRotationChanged_.bind(i);i.collapsed_=void 0===r.collapsed||r.collapsed;i.collapsible_=void 0===r.collapsible||r.collapsible;i.collapsible_||(i.collapsed_=!1);i.rotateWithView_=void 0!==r.rotateWithView&&r.rotateWithView;i.viewExtent_=void 0;var p=void 0!==r.className?r.className:"ol-overviewmap",w=void 0!==r.tipLabel?r.tipLabel:"Overview map",h=void 0!==r.collapseLabel?r.collapseLabel:"";"string"==typeof h?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=h):i.collapseLabel_=h;f=void 0!==r.label?r.label:"";"string"==typeof f?(i.label_=document.createElement("span"),i.label_.textContent=f):i.label_=f;c=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_;u=document.createElement("button");u.setAttribute("type","button");u.title=w;u.appendChild(c);u.addEventListener(a.CLICK,i.handleClick_.bind(i),!1);i.ovmapDiv_=document.createElement("div");i.ovmapDiv_.className="ol-overviewmap-map";i.ovmap_=new ubi({view:r.view});e=i.ovmap_;r.layers&&r.layers.forEach(function(n){e.addLayer(n)});o=document.createElement("div");o.className="ol-overviewmap-box";o.style.boxSizing="border-box";i.boxOverlay_=new bet({position:[0,0],positioning:br.CENTER_CENTER,element:o});i.ovmap_.addOverlay(i.boxOverlay_);l=p+" "+sf+" "+hs+(i.collapsed_&&i.collapsible_?" "+vy:"")+(i.collapsible_?"":" ol-uncollapsible");s=i.element;s.className=l;s.appendChild(i.ovmapDiv_);s.appendChild(u);var b=i,k=i.boxOverlay_,d=i.boxOverlay_.getElement(),v=function(n){var t,i={clientX:(t=n).clientX,clientY:t.clientY},r=e.getEventCoordinateInternal(i);k.setPosition(r)},y=function(n){var t=e.getEventCoordinateInternal(n);b.getMap().getView().setCenterInternal(t);window.removeEventListener("mousemove",v);window.removeEventListener("mouseup",y)};return d.addEventListener("mousedown",function(){window.addEventListener("mousemove",v);window.addEventListener("mouseup",y)}),i}return twt(t,n),t.prototype.setMap=function(t){var r=this.getMap(),u,i;t!==r&&(r&&(u=r.getView(),u&&this.unbindView_(u),this.ovmap_.setTarget(null)),(n.prototype.setMap.call(this,t),t)&&(this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(nt(t,wo,this.handleMapPropertyChange_,this)),i=t.getView(),i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))))},t.prototype.handleMapPropertyChange_=function(n){var t,i;n.key===sr.VIEW&&(t=n.oldValue,t&&this.unbindView_(t),i=this.getMap().getView(),this.bindView_(i))},t.prototype.bindView_=function(n){n.addEventListener(ri(vl),this.boundHandleRotationChanged_)},t.prototype.unbindView_=function(n){n.removeEventListener(ri(vl),this.boundHandleRotationChanged_)},t.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var i=this.getMap(),t=this.ovmap_,u,n;if(i.isRendered()&&t.isRendered()&&(u=i.getSize(),n=i.getView().calculateExtentInternal(u),!this.viewExtent_||!uu(n,this.viewExtent_))){this.viewExtent_=n;var r=t.getSize(),l=t.getView().calculateExtentInternal(r),f=t.getPixelFromCoordinateInternal(yr(n)),e=t.getPixelFromCoordinateInternal(ke(n)),o=Math.abs(f[0]-e[0]),s=Math.abs(f[1]-e[1]),h=r[0],c=r[1];o<.1*h||s<.1*c||o>.75*h||s>.75*c?this.resetExtent_():tr(l,n)||this.recenter_()}},t.prototype.resetExtent_=function(){var n=this.getMap(),i=this.ovmap_,r=n.getSize(),t=n.getView().calculateExtentInternal(r),u=i.getView(),f=Math.log(7.5)/Math.LN2;il(t,1/(.1*Math.pow(2,f/2)));u.fitInternal(es(t))},t.prototype.recenter_=function(){var n=this.getMap(),t=this.ovmap_,i=n.getView();t.getView().setCenterInternal(i.getCenterInternal())},t.prototype.updateBox_=function(){var t=this.getMap(),r=this.ovmap_,o;if(t.isRendered()&&r.isRendered()){var u=t.getSize(),i=t.getView(),s=r.getView(),h=this.rotateWithView_?0:-i.getRotation(),c=this.boxOverlay_,n=this.boxOverlay_.getElement(),l=i.getCenterInternal(),f=i.getResolution(),e=s.getResolution(),a=u[0]*f/e,v=u[1]*f/e;(c.setPosition(l),n)&&(n.style.width=a+"px",n.style.height=v+"px",o="rotate("+h+"rad)",n.style.transform=o)}},t.prototype.handleClick_=function(n){n.preventDefault();this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(vy);this.collapsed_?nc(this.collapseLabel_,this.label_):nc(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_;var n=this.ovmap_;if(!this.collapsed_){if(n.isRendered())return this.viewExtent_=void 0,void n.render();n.updateSize();this.resetExtent_();fh(n,ny,function(){this.updateBox_()},this)}},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(n){this.collapsible_!==n&&(this.collapsible_=n,this.element.classList.toggle("ol-uncollapsible"),!n&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(n){this.collapsible_&&this.collapsed_!==n&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.setRotateWithView=function(n){this.rotateWithView_!==n&&(this.rotateWithView_=n,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(of),ebi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vtt="units",uh={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"},obi=[1,2,5];var sbi=function(n){function t(t){var i=this,r=t||{},u=void 0!==r.className?r.className:r.bar?"ol-scale-bar":"ol-scale-line";return(i=n.call(this,{element:document.createElement("div"),render:r.render||rwt,target:r.target})||this).innerElement_=document.createElement("div"),i.innerElement_.className=u+"-inner",i.element.className=u+" "+sf,i.element.appendChild(i.innerElement_),i.viewState_=null,i.minWidth_=void 0!==r.minWidth?r.minWidth:64,i.renderedVisible_=!1,i.renderedWidth_=void 0,i.renderedHTML_="",i.addEventListener(ri(vtt),i.handleUnitsChanged_),i.setUnits(r.units||uh.METRIC),i.scaleBar_=r.bar||!1,i.scaleBarSteps_=r.steps||4,i.scaleBarText_=r.text||!1,i}return ebi(t,n),t.prototype.getUnits=function(){return this.get(vtt)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(n){this.set(vtt,n)},t.prototype.updateElement_=function(){var f=this.viewState_,e,o,r,s,h,c,l;if(f){var a=f.center,v=f.projection,u=this.getUnits(),y=u==uh.DEGREES?lu.DEGREES:lu.METERS,t=av(v,f.resolution,a,y),i=this.minWidth_*t,n="";for(u==uh.DEGREES?(e=cu[lu.DEGREES],(i*=e)<e/60?(n="",t*=3600):i<e?(n="",t*=60):n=""):u==uh.IMPERIAL?i<.9144?(n="in",t/=.0254):i<1609.344?(n="ft",t/=.3048):(n="mi",t/=1609.344):u==uh.NAUTICAL?(t/=1852,n="nm"):u==uh.METRIC?i<.001?(n="m",t*=1e6):i<1?(n="mm",t*=1e3):i<1e3?n="m":(n="km",t/=1e3):u==uh.US?i<.9144?(n="in",t*=39.37):i<1609.344?(n="ft",t/=.30480061):(n="mi",t/=1609.3472):p(!1,33),c=3*Math.floor(Math.log(this.minWidth_*t)/Math.log(10));;){if(s=Math.floor(c/3),l=Math.pow(10,s),o=obi[(c%3+3)%3]*l,r=Math.round(o/t),isNaN(r))return this.element.style.display="none",void(this.renderedVisible_=!1);if(r>=this.minWidth_)break;++c}h=this.scaleBar_?this.createScaleBar(r,o,n):o.toFixed(s<0?-s:0)+" "+n;this.renderedHTML_!=h&&(this.innerElement_.innerHTML=h,this.renderedHTML_=h);this.renderedWidth_!=r&&(this.innerElement_.style.width=r+"px",this.renderedWidth_=r);this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.createScaleBar=function(n,t,i){for(var e="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),u=[],o=n/this.scaleBarSteps_,f="#ffffff",r=0;r<this.scaleBarSteps_;r++)0===r&&u.push(this.createMarker("absolute",r)),u.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+f+';"><\/div>'+this.createMarker("relative",r)+(r%2==0||2===this.scaleBarSteps_?this.createStepText(r,n,!1,t,i):"")+"<\/div>"),r===this.scaleBarSteps_-1&&u.push(this.createStepText(r+1,n,!0,t,i)),f="#ffffff"===f?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+n+'px;">'+e+"<\/div>":"")+u.join("")+"<\/div>"},t.prototype.createMarker=function(n){return'<div class="ol-scale-step-marker" style="position: '+n+";top: "+("absolute"===n?3:-10)+'px;"><\/div>'},t.prototype.createStepText=function(n,t,i,r,u){var f=(0===n?0:Math.round(r/this.scaleBarSteps_*n*100)/100)+(0===n?"":" "+u);return'<div class="ol-scale-step-text" style="margin-left: '+(0===n?-3:t/this.scaleBarSteps_*-1)+"px;text-align: "+(0===n?"left":"center")+"; min-width: "+(0===n?0:t/this.scaleBarSteps_*2)+"px;left: "+(i?t+"px":"unset")+';">'+f+"<\/div>"},t.prototype.getScaleForResolution=function(){var n=this.getMap().getView().getResolution(),t=this.viewState_.projection.getMetersPerUnit();return parseFloat(n.toString())*t*39.37*(25.4/.28)},t}(of),hbi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tv={VERTICAL:0,HORIZONTAL:1};var cbi=function(n){function t(t){var i=this,u=t||{},e,f,r;return(i=n.call(this,{element:document.createElement("div"),render:u.render||uwt})||this).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=tv.VERTICAL,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==u.duration?u.duration:200,e=void 0!==u.className?u.className:"ol-zoomslider",f=document.createElement("button"),f.setAttribute("type","button"),f.className=e+"-thumb "+sf,r=i.element,r.setAttribute("touch-action","none"),r.className=e+" "+sf+" "+hs,r.appendChild(f),r.addEventListener(te.POINTERDOWN,i.handleDraggerStart_.bind(i),!1),r.addEventListener(te.POINTERMOVE,i.handleDraggerDrag_.bind(i),!1),r.addEventListener(te.POINTERUP,i.handleDraggerEnd_.bind(i),!1),r.addEventListener(a.CLICK,i.handleContainerClick_.bind(i),!1),f.addEventListener(a.CLICK,owt,!1),i}return hbi(t,n),t.prototype.setMap=function(t){n.prototype.setMap.call(this,t);t&&t.render()},t.prototype.initSlider_=function(){var t=this.element,r=t.offsetWidth,u=t.offsetHeight,i=t.firstElementChild,n=getComputedStyle(i),f=i.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),e=i.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[f,e];r>u?(this.direction_=tv.HORIZONTAL,this.widthLimit_=r-f):(this.direction_=tv.VERTICAL,this.heightLimit_=u-e);this.sliderInitialized_=!0},t.prototype.handleContainerClick_=function(n){var t=this.getMap().getView(),i=this.getRelativePosition_(n.offsetX-this.thumbSize_[0]/2,n.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),u=t.getConstrainedZoom(t.getZoomForResolution(r));t.animateInternal({zoom:u,duration:this.duration_,easing:uo})},t.prototype.handleDraggerStart_=function(n){var t,i,r;this.dragging_||n.target!==this.element.firstElementChild||(t=this.element.firstElementChild,(this.getMap().getView().beginInteraction(),this.startX_=n.clientX-parseFloat(t.style.left),this.startY_=n.clientY-parseFloat(t.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length)&&(i=this.handleDraggerDrag_,r=this.handleDraggerEnd_,this.dragListenerKeys_.push(nt(document,te.POINTERMOVE,i,this),nt(document,te.POINTERUP,r,this))))},t.prototype.handleDraggerDrag_=function(n){if(this.dragging_){var t=n.clientX-this.startX_,i=n.clientY-this.startY_,r=this.getRelativePosition_(t,i);this.currentResolution_=this.getResolutionForPosition_(r);this.getMap().getView().setResolution(this.currentResolution_)}},t.prototype.handleDraggerEnd_=function(){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(ct),this.dragListenerKeys_.length=0)},t.prototype.setThumbPosition_=function(n){var t=this.getPositionForResolution_(n),i=this.element.firstElementChild;this.direction_==tv.HORIZONTAL?i.style.left=this.widthLimit_*t+"px":i.style.top=this.heightLimit_*t+"px"},t.prototype.getRelativePosition_=function(n,t){return kt(this.direction_===tv.HORIZONTAL?n/this.widthLimit_:t/this.heightLimit_,0,1)},t.prototype.getResolutionForPosition_=function(n){return this.getMap().getView().getResolutionForValueFunction()(1-n)},t.prototype.getPositionForResolution_=function(n){return kt(1-this.getMap().getView().getValueForResolutionFunction()(n),0,1)},t}(of),lbi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),abi=function(n){function t(t){var r=this,i=t||{},o,e;(r=n.call(this,{element:document.createElement("div"),target:i.target})||this).extent=i.extent?i.extent:null;var s=void 0!==i.className?i.className:"ol-zoom-extent",f=void 0!==i.label?i.label:"E",h=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",u=document.createElement("button");return u.setAttribute("type","button"),u.title=h,u.appendChild("string"==typeof f?document.createTextNode(f):f),u.addEventListener(a.CLICK,r.handleClick_.bind(r),!1),o=s+" "+sf+" "+hs,e=r.element,e.className=o,e.appendChild(u),r}return lbi(t,n),t.prototype.handleClick_=function(n){n.preventDefault();this.handleZoomToExtent()},t.prototype.handleZoomToExtent=function(){var n=this.getMap().getView(),t=this.extent?this.extent:n.getProjection().getExtent();n.fitInternal(es(t))},t}(of),r={array:{},color:{},colorlike:{},control:{},coordinate:{},easing:{},events:{}};r.events.condition={};r.extent={};r.featureloader={};r.format={};r.format.filter={};r.geom={};r.has={};r.interaction={};r.layer={};r.loadingstrategy={};r.proj={};r.proj.Units={};r.proj.proj4={};r.render={};r.render.canvas={};r.renderer={};r.renderer.canvas={};r.renderer.webgl={};r.size={};r.source={};r.sphere={};r.style={};r.style.IconImageCache={};r.tilegrid={};r.util={};r.webgl={};r.xml={};r.Collection=gi;r.Feature=ui;r.Geolocation=abt;r.Kinetic=vrt;r.Map=lgt;r.Object=hu;r.Observable=cw;r.Observable.unByKey=function(n){if(Array.isArray(n))for(var t=0,i=n.length;t<i;++t)ct(n[t]);else ct(n)};r.Overlay=bet;r.PluggableMap=tk;r.View=bb;r.array.stableSort=function(n,t){for(var u=n.length,r=Array(n.length),i=0;i<u;i++)r[i]={index:i,value:n[i]};for(r.sort(function(n,i){return t(n.value,i.value)||n.index-i.index}),i=0;i<n.length;i++)n[i]=r[i].value};r.color.asArray=wy;r.color.asString=kft;r.colorlike.asColorLike=bu;r.control.Attribution=ik;r.control.Attribution.render=vut;r.control.Control=of;r.control.FullScreen=tbi;r.control.MousePosition=rbi;r.control.MousePosition.render=nwt;r.control.OverviewMap=fbi;r.control.OverviewMap.render=iwt;r.control.Rotate=wut;r.control.Rotate.render=put;r.control.ScaleLine=sbi;r.control.ScaleLine.render=rwt;r.control.Zoom=but;r.control.ZoomSlider=cbi;r.control.ZoomSlider.render=uwt;r.control.ZoomToExtent=abi;r.control.defaults=kut;r.coordinate.add=pb;r.coordinate.createStringXY=function(n){return function(t){return fut(t,n)}};r.coordinate.format=rut;r.coordinate.rotate=uy;r.coordinate.toStringHDMS=function(n,t){return n?ry("NS",n[1],t)+" "+ry("EW",n[0],t):""};r.coordinate.toStringXY=fut;r.easing.easeIn=wb;r.easing.easeOut=uo;r.easing.inAndOut=oy;r.easing.linear=eut;r.easing.upAndDown=function(n){return n<.5?oy(2*n):1-oy(2*(n-.5))};r.events.condition.altKeyOnly=tft;r.events.condition.altShiftKeysOnly=ift;r.events.condition.always=wl;r.events.condition.click=function(n){return n.type==st.CLICK};r.events.condition.doubleClick=function(n){return n.type==st.DBLCLICK};r.events.condition.focus=uk;r.events.condition.mouseOnly=hf;r.events.condition.never=fk;r.events.condition.noModifierKeys=py;r.events.condition.penOnly=function(n){var t=n.pointerEvent;return p(void 0!==t,56),"pen"===t.pointerType};r.events.condition.platformModifierKeyOnly=function(n){var t=n.originalEvent;return!t.altKey&&(prt?t.metaKey:t.ctrlKey)&&!t.shiftKey};r.events.condition.pointerMove=function(n){return"pointermove"==n.type};r.events.condition.primaryAction=sk;r.events.condition.shiftKeyOnly=bl;r.events.condition.singleClick=ek;r.events.condition.targetNotEditable=ok;r.events.condition.touchOnly=function(n){var t=n.pointerEvent;return p(void 0!==t,56),"touch"===t.pointerType};r.extent.applyTransform=rl;r.extent.boundingExtent=oi;r.extent.buffer=iu;r.extent.containsCoordinate=fv;r.extent.containsExtent=tr;r.extent.containsXY=ev;r.extent.createEmpty=tit;r.extent.equals=uu;r.extent.extend=ov;r.extent.getArea=sv;r.extent.getBottomLeft=ne;r.extent.getBottomRight=ke;r.extent.getCenter=vr;r.extent.getHeight=ni;r.extent.getIntersection=vu;r.extent.getSize=function(n){return[n[2]-n[0],n[3]-n[1]]};r.extent.getTopLeft=yr;r.extent.getTopRight=de;r.extent.getWidth=vt;r.extent.intersects=fi;r.extent.isEmpty=ts;r.featureloader.setWithCredentials=function(n){ket=n};r.featureloader.xhr=kk;r.format.EsriJSON=poi;r.format.Feature=cc;r.format.GML=tsi;r.format.GML2=dp;r.format.GML3=ft;r.format.GML32=esi;r.format.GPX=olt;r.format.GeoJSON=hlt;r.format.IGC=whi;r.format.IIIFInfo=vst;r.format.KML=pli;r.format.MVT=tai;r.format.OSMXML=lvt;r.format.Polyline=sai;r.format.Polyline.decodeDeltas=pvt;r.format.Polyline.decodeFloats=bvt;r.format.Polyline.encodeDeltas=yvt;r.format.Polyline.encodeFloats=wvt;r.format.TopoJSON=yai;r.format.WFS=uyi;r.format.WFS.writeFilter=function(n){var t=rt(rh,"Filter");return npt(t,n,[]),t};r.format.WKT=vpt;r.format.WMSCapabilities=spi;r.format.WMSGetFeatureInfo=cpi;r.format.WMTSCapabilities=gwi;r.format.filter.Bbox=gvt;r.format.filter.Contains=nyt;r.format.filter.During=tyt;r.format.filter.EqualTo=iyt;r.format.filter.GreaterThan=ryt;r.format.filter.GreaterThanOrEqualTo=uyt;r.format.filter.Intersects=fyt;r.format.filter.IsBetween=eyt;r.format.filter.IsLike=oyt;r.format.filter.IsNull=syt;r.format.filter.LessThan=hyt;r.format.filter.LessThanOrEqualTo=cyt;r.format.filter.Not=lyt;r.format.filter.NotEqualTo=ayt;r.format.filter.Or=vyt;r.format.filter.Within=yyt;r.format.filter.and=pyt;r.format.filter.bbox=wyt;r.format.filter.between=function(n,t,i){return new eyt(n,t,i)};r.format.filter.contains=function(n,t,i){return new nyt(n,t,i)};r.format.filter.during=function(n,t,i){return new tyt(n,t,i)};r.format.filter.equalTo=function(n,t,i){return new iyt(n,t,i)};r.format.filter.greaterThan=function(n,t){return new ryt(n,t)};r.format.filter.greaterThanOrEqualTo=function(n,t){return new uyt(n,t)};r.format.filter.intersects=function(n,t,i){return new fyt(n,t,i)};r.format.filter.isNull=function(n){return new syt(n)};r.format.filter.lessThan=function(n,t){return new hyt(n,t)};r.format.filter.lessThanOrEqualTo=function(n,t){return new cyt(n,t)};r.format.filter.like=function(n,t,i,r,u,f){return new oyt(n,t,i,r,u,f)};r.format.filter.not=function(n){return new lyt(n)};r.format.filter.notEqualTo=function(n,t,i){return new ayt(n,t,i)};r.format.filter.or=function(){var n=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(vyt,n))};r.format.filter.within=function(n,t,i){return new yyt(n,t,i)};r.geom.Circle=hg;r.geom.Geometry=gw;r.geom.GeometryCollection=lo;r.geom.LineString=ai;r.geom.LinearRing=bh;r.geom.MultiLineString=au;r.geom.MultiPoint=wf;r.geom.MultiPolygon=bf;r.geom.Point=si;r.geom.Polygon=fr;r.geom.Polygon.circular=crt;r.geom.Polygon.fromCircle=cb;r.geom.Polygon.fromExtent=es;r.geom.SimpleGeometry=ff;r.has.DEVICE_PIXEL_RATIO=dh;r.interaction.DoubleClickZoom=nft;r.interaction.DragAndDrop=sei;r.interaction.DragBox=sft;r.interaction.DragPan=fft;r.interaction.DragRotate=eft;r.interaction.DragRotateAndZoom=cei;r.interaction.DragZoom=hft;r.interaction.Draw=wei;r.interaction.Draw.createBox=function(){return function(n,t){var i=oi(n),u=[[ne(i),ke(i),de(i),yr(i),ne(i)]],r=t;return r?r.setCoordinates(u):r=new fr(u),r}};r.interaction.Draw.createRegularPolygon=function(n,t){return function(i,r){var u=i[0],f=i[1],c=Math.sqrt(eu(u,f)),o=r||cb(new hg(u),n),s=t,e,h;return t||(e=f[0]-u[0],h=f[1]-u[1],s=Math.atan(h/e)-(e<0?Math.PI:0)),lrt(o,u,c,s),o}};r.interaction.Extent=noi;r.interaction.Interaction=ie;r.interaction.KeyboardPan=lk;r.interaction.KeyboardZoom=lft;r.interaction.Modify=uoi;r.interaction.MouseWheelZoom=vft;r.interaction.PinchRotate=yft;r.interaction.PinchZoom=pft;r.interaction.Pointer=ou;r.interaction.Select=bct;r.interaction.Snap=soi;r.interaction.Translate=aoi;r.interaction.defaults=wft;r.layer.Base=kb;r.layer.BaseImage=nht;r.layer.BaseTile=rht;r.layer.BaseVector=oa;r.layer.Graticule=kfi;r.layer.Group=hut;r.layer.Heatmap=nei;r.layer.Image=iht;r.layer.Layer=yl;r.layer.Tile=fht;r.layer.Vector=gs;r.layer.VectorImage=iei;r.layer.VectorTile=uei;r.loadingstrategy.all=get;r.loadingstrategy.bbox=not;r.loadingstrategy.tile=function(n){return function(t,i){var f=n.getZForResolution(i),u=n.getTileRangeForExtentAndZ(t,f),e=[],r=[f,0,0];for(r[1]=u.minX;r[1]<=u.maxX;++r[1])for(r[2]=u.minY;r[2]<=u.maxY;++r[2])e.push(n.getTileCoordExtent(r));return e}};r.proj.Projection=fl;r.proj.Units.METERS_PER_UNIT=cu;r.proj.addCoordinateTransforms=yit;r.proj.addEquivalentProjections=vv;r.proj.addProjection=kw;r.proj.equivalent=pr;r.proj.fromLonLat=function(n,t){return to(n,"EPSG:4326",void 0!==t?t:"EPSG:3857")};r.proj.get=y;r.proj.getPointResolution=av;r.proj.getTransform=tf;r.proj.proj4.register=function(n){for(var u,f=Object.keys(n.defs),s=f.length,e,o,i,h,r,c,l,t=0;t<s;++t)e=f[t],y(e)||(o=n.defs(e),kw(new fl({code:e,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:o.units})));for(t=0;t<s;++t)for(i=f[t],h=y(i),u=0;u<s;++u)r=f[u],c=y(r),ait(i,r)||(n.defs[i]===n.defs[r]?vv([h,c]):(l=n(i,r),yit(h,c,l.forward,l.inverse)))};r.proj.toLonLat=function(n,t){var i=to(n,void 0!==t?t:"EPSG:3857","EPSG:4326"),r=i[0];return(r<-180||r>180)&&(i[0]=pu(r+180,360)-180),i};r.proj.transform=to;r.proj.transformExtent=io;r.render.VectorContext=vk;r.render.canvas.labelCache=re;r.render.getRenderPixel=function(n,t){var i=t.slice(0);return bt(n.inversePixelTransform.slice(),i),i};r.render.getVectorContext=function(n){var i,t=n.frameState,u=ph(n.inversePixelTransform.slice(),t.coordinateToPixelTransform),f=wk(t.viewState.resolution,t.pixelRatio),r=yv();return r&&(i=wu(r,t.viewState.projection)),new pk(n.context,t.pixelRatio,t.extent,u,t.viewState.rotation,f,i)};r.render.toContext=function(n,t){var i=n.canvas,f=t||{},r=f.pixelRatio||dh,u=f.size,e,o;return u&&(i.width=u[0]*r,i.height=u[1]*r,i.style.width=u[0]+"px",i.style.height=u[1]+"px"),e=[0,0,i.width,i.height],o=cl([1,0,0,1,0,0],r,r),new pk(n,r,e,o,0)};r.renderer.Composite=bk;r.renderer.canvas.ImageLayer=ng;r.renderer.canvas.TileLayer=tg;r.renderer.canvas.VectorImageLayer=ght;r.renderer.canvas.VectorLayer=eg;r.renderer.canvas.VectorTileLayer=nct;r.renderer.webgl.PointsLayer=vht;r.size.toSize=hr;r.source.BingMaps=iti;r.source.CartoDB=fti;r.source.Cluster=sti;r.source.IIIF=ati;r.source.Image=ee;r.source.ImageArcGISRest=dti;r.source.ImageCanvas=tii;r.source.ImageMapGuide=rii;r.source.ImageStatic=fii;r.source.ImageWMS=oii;r.source.OSM=hii;r.source.OSM.ATTRIBUTION=dd;r.source.Raster=rri;r.source.Source=oc;r.source.Stamen=sri;r.source.Tile=fp;r.source.TileArcGISRest=lri;r.source.TileDebug=vri;r.source.TileImage=fe;r.source.TileJSON=pri;r.source.TileWMS=kri;r.source.UTFGrid=gri;r.source.Vector=ps;r.source.VectorTile=fui;r.source.WMTS=sui;r.source.WMTS.optionsFromCapabilities=function(n,t){var i=gc(n.Contents.Layer,function(n){return n.Identifier==t.layer}),u,g,tt,p,f,w,c,l,a,it,s,b,k,d;if(null===i)return null;g=n.Contents.TileMatrixSet;(u=i.TileMatrixSetLink.length>1?wtt(i.TileMatrixSetLink,"projection"in t?function(n){var i=gc(g,function(t){return t.Identifier==n.TileMatrixSet}).SupportedCRS,r=y(i.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||y(i),u=y(t.projection);return r&&u?pr(r,u):i==t.projection}:function(n){return n.TileMatrixSet==t.matrixSet}):0)<0&&(u=0);var nt=i.TileMatrixSetLink[u].TileMatrixSet,rt=i.TileMatrixSetLink[u].TileMatrixSetLimits,v=i.Format[0];"format"in t&&(v=t.format);(u=wtt(i.Style,function(n){return"style"in t?n.Title==t.style:n.isDefault}))<0&&(u=0);tt=i.Style[u].Identifier;p={};"Dimension"in i&&i.Dimension.forEach(function(n){var i=n.Identifier,t=n.Default;void 0===t&&(t=n.Value[0]);p[i]=t});w=gc(n.Contents.TileMatrixSet,function(n){return n.Identifier==nt});c=w.SupportedCRS;(c&&(f=y(c.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||y(c)),"projection"in t)&&(l=y(t.projection),l&&(f&&!pr(l,f)||(f=l)));s=i.WGS84BoundingBox;void 0!==s&&(b=y("EPSG:4326").getExtent(),it=s[0]==b[0]&&s[2]==b[2],a=io(s,"EPSG:4326",f),k=f.getExtent(),k&&(tr(k,a)||(a=void 0)));var ut=wot(w,a,rt),h=[],r=t.requestEncoding;if(r=void 0!==r?r:"","OperationsMetadata"in n&&"GetTile"in n.OperationsMetadata)for(var o=n.OperationsMetadata.GetTile.DCP.HTTP.Get,e=0,ft=o.length;e<ft;++e)if(o[e].Constraint){if(d=gc(o[e].Constraint,function(n){return"GetEncoding"==n.name}).AllowedValues.Value,""===r&&(r=d[0]),r!==so.KVP)break;di(d,so.KVP)&&h.push(o[e].href)}else o[e].href&&(r=so.KVP,h.push(o[e].href));return 0===h.length&&(r=so.REST,i.ResourceURL.forEach(function(n){"tile"===n.resourceType&&(v=n.format,h.push(n.template))})),{urls:h,layer:t.layer,matrixSet:nt,format:v,projection:f,requestEncoding:r,tileGrid:ut,style:tt,dimensions:p,wrapX:it,crossOrigin:t.crossOrigin}};r.source.XYZ=ua;r.source.Zoomify=hti;r.sphere.getArea=function n(t,i){var v=i||{},s=v.radius||ul,p=v.projection||"EPSG:3857",l=t.getType(),e,h,r,o,c,y,u,a;l!==f.GEOMETRY_COLLECTION&&(t=t.clone().transform(p,"EPSG:4326"));u=0;switch(l){case f.POINT:case f.MULTI_POINT:case f.LINE_STRING:case f.MULTI_LINE_STRING:case f.LINEAR_RING:break;case f.POLYGON:for(e=t.getCoordinates(),u=Math.abs(cv(e[0],s)),r=1,o=e.length;r<o;++r)u-=Math.abs(cv(e[r],s));break;case f.MULTI_POLYGON:for(r=0,o=(e=t.getCoordinates()).length;r<o;++r)for(h=e[r],u+=Math.abs(cv(h[0],s)),c=1,y=h.length;c<y;++c)u-=Math.abs(cv(h[c],s));break;case f.GEOMETRY_COLLECTION:for(a=t.getGeometries(),r=0,o=a.length;r<o;++r)u+=n(a[r],i);break;default:throw new Error("Unsupported geometry type: "+l);}return u};r.sphere.getDistance=hv;r.sphere.getLength=function n(t,i){var a=i||{},h=a.radius||ul,p=a.projection||"EPSG:3857",c=t.getType(),o,v,r,u,s,y,e,l;c!==f.GEOMETRY_COLLECTION&&(t=t.clone().transform(p,"EPSG:4326"));e=0;switch(c){case f.POINT:case f.MULTI_POINT:break;case f.LINE_STRING:case f.LINEAR_RING:e=yw(o=t.getCoordinates(),h);break;case f.MULTI_LINE_STRING:case f.POLYGON:for(r=0,u=(o=t.getCoordinates()).length;r<u;++r)e+=yw(o[r],h);break;case f.MULTI_POLYGON:for(r=0,u=(o=t.getCoordinates()).length;r<u;++r)for(s=0,y=(v=o[r]).length;s<y;++s)e+=yw(v[s],h);break;case f.GEOMETRY_COLLECTION:for(l=t.getGeometries(),r=0,u=l.length;r<u;++r)e+=n(l[r],i);break;default:throw new Error("Unsupported geometry type: "+c);}return e};r.style.Circle=sd;r.style.Fill=vf;r.style.Icon=ip;r.style.IconImageCache.shared=tc;r.style.Image=od;r.style.RegularShape=bot;r.style.Stroke=gu;r.style.Style=ys;r.style.Text=ia;r.tilegrid.TileGrid=ls;r.tilegrid.WMTS=bgt;r.tilegrid.WMTS.createFromCapabilitiesMatrixSet=wot;r.tilegrid.createXYZ=rc;r.util.getUid=v;r.webgl.ARRAY_BUFFER=kl;r.webgl.Buffer=gl;r.webgl.DYNAMIC_DRAW=dl;r.webgl.ELEMENT_ARRAY_BUFFER=np;r.webgl.Helper=vot;r.webgl.Helper.computeAttributesStride=lot;r.webgl.PostProcessingPass=ed;r.webgl.RenderTarget=yot;r.webgl.STATIC_DRAW=35044;r.webgl.STREAM_DRAW=35040;r.xml.getAllTextContent=ar;r.xml.parse=ku;t.default=r}]).default});